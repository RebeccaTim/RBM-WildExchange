!function(f){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=f();else if("function"==typeof define&&define.amd)define([],f);else{var g;g="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,g.uxpinEngine=f()}}(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(_dereq_,module,exports){var asn1=exports;asn1.bignum=_dereq_("bn.js"),asn1.define=_dereq_("./asn1/api").define,asn1.base=_dereq_("./asn1/base"),asn1.constants=_dereq_("./asn1/constants"),asn1.decoders=_dereq_("./asn1/decoders"),asn1.encoders=_dereq_("./asn1/encoders")},{"./asn1/api":2,"./asn1/base":4,"./asn1/constants":8,"./asn1/decoders":10,"./asn1/encoders":13,"bn.js":18}],2:[function(_dereq_,module,exports){function Entity(name,body){this.name=name,this.body=body,this.decoders={},this.encoders={}}var asn1=_dereq_("../asn1"),inherits=_dereq_("inherits"),api=exports;api.define=function(name,body){return new Entity(name,body)},Entity.prototype._createNamed=function(base){var named;try{named=_dereq_("vm").runInThisContext("(function "+this.name+"(entity) {\n  this._initNamed(entity);\n})")}catch(e){named=function(entity){this._initNamed(entity)}}return inherits(named,base),named.prototype._initNamed=function(entity){base.call(this,entity)},new named(this)},Entity.prototype._getDecoder=function(enc){return enc=enc||"der",this.decoders.hasOwnProperty(enc)||(this.decoders[enc]=this._createNamed(asn1.decoders[enc])),this.decoders[enc]},Entity.prototype.decode=function(data,enc,options){return this._getDecoder(enc).decode(data,options)},Entity.prototype._getEncoder=function(enc){return enc=enc||"der",this.encoders.hasOwnProperty(enc)||(this.encoders[enc]=this._createNamed(asn1.encoders[enc])),this.encoders[enc]},Entity.prototype.encode=function(data,enc,reporter){return this._getEncoder(enc).encode(data,reporter)}},{"../asn1":1,inherits:112,vm:421}],3:[function(_dereq_,module,exports){function DecoderBuffer(base,options){return Reporter.call(this,options),Buffer.isBuffer(base)?(this.base=base,this.offset=0,void(this.length=base.length)):void this.error("Input not Buffer")}function EncoderBuffer(value,reporter){if(Array.isArray(value))this.length=0,this.value=value.map(function(item){return item instanceof EncoderBuffer||(item=new EncoderBuffer(item,reporter)),this.length+=item.length,item},this);else if("number"==typeof value){if(!(0<=value&&value<=255))return reporter.error("non-byte EncoderBuffer value");this.value=value,this.length=1}else if("string"==typeof value)this.value=value,this.length=Buffer.byteLength(value);else{if(!Buffer.isBuffer(value))return reporter.error("Unsupported type: "+typeof value);this.value=value,this.length=value.length}}var inherits=_dereq_("inherits"),Reporter=_dereq_("../base").Reporter,Buffer=_dereq_("buffer").Buffer;inherits(DecoderBuffer,Reporter),exports.DecoderBuffer=DecoderBuffer,DecoderBuffer.prototype.save=function(){return{offset:this.offset,reporter:Reporter.prototype.save.call(this)}},DecoderBuffer.prototype.restore=function(save){var res=new DecoderBuffer(this.base);return res.offset=save.offset,res.length=this.offset,this.offset=save.offset,Reporter.prototype.restore.call(this,save.reporter),res},DecoderBuffer.prototype.isEmpty=function(){return this.offset===this.length},DecoderBuffer.prototype.readUInt8=function(fail){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(fail||"DecoderBuffer overrun")},DecoderBuffer.prototype.skip=function(bytes,fail){if(!(this.offset+bytes<=this.length))return this.error(fail||"DecoderBuffer overrun");var res=new DecoderBuffer(this.base);return res._reporterState=this._reporterState,res.offset=this.offset,res.length=this.offset+bytes,this.offset+=bytes,res},DecoderBuffer.prototype.raw=function(save){return this.base.slice(save?save.offset:this.offset,this.length)},exports.EncoderBuffer=EncoderBuffer,EncoderBuffer.prototype.join=function(out,offset){return out||(out=new Buffer(this.length)),offset||(offset=0),0===this.length?out:(Array.isArray(this.value)?this.value.forEach(function(item){item.join(out,offset),offset+=item.length}):("number"==typeof this.value?out[offset]=this.value:"string"==typeof this.value?out.write(this.value,offset):Buffer.isBuffer(this.value)&&this.value.copy(out,offset),offset+=this.length),out)}},{"../base":4,buffer:49,inherits:112}],4:[function(_dereq_,module,exports){var base=exports;base.Reporter=_dereq_("./reporter").Reporter,base.DecoderBuffer=_dereq_("./buffer").DecoderBuffer,base.EncoderBuffer=_dereq_("./buffer").EncoderBuffer,base.Node=_dereq_("./node")},{"./buffer":3,"./node":5,"./reporter":6}],5:[function(_dereq_,module,exports){function Node(enc,parent){var state={};this._baseState=state,state.enc=enc,state.parent=parent||null,state.children=null,state.tag=null,state.args=null,state.reverseArgs=null,state.choice=null,state.optional=!1,state.any=!1,state.obj=!1,state.use=null,state.useDecoder=null,state.key=null,state.default=null,state.explicit=null,state.implicit=null,state.contains=null,state.parent||(state.children=[],this._wrap())}var Reporter=_dereq_("../base").Reporter,EncoderBuffer=_dereq_("../base").EncoderBuffer,DecoderBuffer=_dereq_("../base").DecoderBuffer,assert=_dereq_("minimalistic-assert"),tags=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],methods=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(tags),overrided=["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"];module.exports=Node;var stateProps=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];Node.prototype.clone=function(){var state=this._baseState,cstate={};stateProps.forEach(function(prop){cstate[prop]=state[prop]});var res=new this.constructor(cstate.parent);return res._baseState=cstate,res},Node.prototype._wrap=function(){var state=this._baseState;methods.forEach(function(method){this[method]=function(){var clone=new this.constructor(this);return state.children.push(clone),clone[method].apply(clone,arguments)}},this)},Node.prototype._init=function(body){var state=this._baseState;assert(null===state.parent),body.call(this),state.children=state.children.filter(function(child){return child._baseState.parent===this},this),assert.equal(state.children.length,1,"Root node can have only one child")},Node.prototype._useArgs=function(args){var state=this._baseState,children=args.filter(function(arg){return arg instanceof this.constructor},this);args=args.filter(function(arg){return!(arg instanceof this.constructor)},this),0!==children.length&&(assert(null===state.children),state.children=children,children.forEach(function(child){child._baseState.parent=this},this)),0!==args.length&&(assert(null===state.args),state.args=args,state.reverseArgs=args.map(function(arg){if("object"!=typeof arg||arg.constructor!==Object)return arg;var res={};return Object.keys(arg).forEach(function(key){key==(0|key)&&(key|=0);var value=arg[key];res[value]=key}),res}))},overrided.forEach(function(method){Node.prototype[method]=function(){var state=this._baseState;throw new Error(method+" not implemented for encoding: "+state.enc)}}),tags.forEach(function(tag){Node.prototype[tag]=function(){var state=this._baseState,args=Array.prototype.slice.call(arguments);return assert(null===state.tag),state.tag=tag,this._useArgs(args),this}}),Node.prototype.use=function(item){assert(item);var state=this._baseState;return assert(null===state.use),state.use=item,this},Node.prototype.optional=function(){var state=this._baseState;return state.optional=!0,this},Node.prototype.def=function(val){var state=this._baseState;return assert(null===state.default),state.default=val,state.optional=!0,this},Node.prototype.explicit=function(num){var state=this._baseState;return assert(null===state.explicit&&null===state.implicit),state.explicit=num,this},Node.prototype.implicit=function(num){var state=this._baseState;return assert(null===state.explicit&&null===state.implicit),state.implicit=num,this},Node.prototype.obj=function(){var state=this._baseState,args=Array.prototype.slice.call(arguments);return state.obj=!0,0!==args.length&&this._useArgs(args),this},Node.prototype.key=function(newKey){var state=this._baseState;return assert(null===state.key),state.key=newKey,this},Node.prototype.any=function(){var state=this._baseState;return state.any=!0,this},Node.prototype.choice=function(obj){var state=this._baseState;return assert(null===state.choice),state.choice=obj,this._useArgs(Object.keys(obj).map(function(key){return obj[key]})),this},Node.prototype.contains=function(item){var state=this._baseState;return assert(null===state.use),state.contains=item,this},Node.prototype._decode=function(input,options){var state=this._baseState;if(null===state.parent)return input.wrapResult(state.children[0]._decode(input,options));var result=state.default,present=!0,prevKey=null;if(null!==state.key&&(prevKey=input.enterKey(state.key)),state.optional){var tag=null;if(null!==state.explicit?tag=state.explicit:null!==state.implicit?tag=state.implicit:null!==state.tag&&(tag=state.tag),null!==tag||state.any){if(present=this._peekTag(input,tag,state.any),input.isError(present))return present}else{var save=input.save();try{null===state.choice?this._decodeGeneric(state.tag,input,options):this._decodeChoice(input,options),present=!0}catch(e){present=!1}input.restore(save)}}var prevObj;if(state.obj&&present&&(prevObj=input.enterObject()),present){if(null!==state.explicit){var explicit=this._decodeTag(input,state.explicit);if(input.isError(explicit))return explicit;input=explicit}var start=input.offset;if(null===state.use&&null===state.choice){if(state.any)var save=input.save();var body=this._decodeTag(input,null!==state.implicit?state.implicit:state.tag,state.any);if(input.isError(body))return body;state.any?result=input.raw(save):input=body}if(options&&options.track&&null!==state.tag&&options.track(input.path(),start,input.length,"tagged"),options&&options.track&&null!==state.tag&&options.track(input.path(),input.offset,input.length,"content"),result=state.any?result:null===state.choice?this._decodeGeneric(state.tag,input,options):this._decodeChoice(input,options),input.isError(result))return result;if(state.any||null!==state.choice||null===state.children||state.children.forEach(function(child){child._decode(input,options)}),state.contains&&("octstr"===state.tag||"bitstr"===state.tag)){var data=new DecoderBuffer(result);result=this._getUse(state.contains,input._reporterState.obj)._decode(data,options)}}return state.obj&&present&&(result=input.leaveObject(prevObj)),null===state.key||null===result&&present!==!0?null!==prevKey&&input.exitKey(prevKey):input.leaveKey(prevKey,state.key,result),result},Node.prototype._decodeGeneric=function(tag,input,options){var state=this._baseState;return"seq"===tag||"set"===tag?null:"seqof"===tag||"setof"===tag?this._decodeList(input,tag,state.args[0],options):/str$/.test(tag)?this._decodeStr(input,tag,options):"objid"===tag&&state.args?this._decodeObjid(input,state.args[0],state.args[1],options):"objid"===tag?this._decodeObjid(input,null,null,options):"gentime"===tag||"utctime"===tag?this._decodeTime(input,tag,options):"null_"===tag?this._decodeNull(input,options):"bool"===tag?this._decodeBool(input,options):"objDesc"===tag?this._decodeStr(input,tag,options):"int"===tag||"enum"===tag?this._decodeInt(input,state.args&&state.args[0],options):null!==state.use?this._getUse(state.use,input._reporterState.obj)._decode(input,options):input.error("unknown tag: "+tag)},Node.prototype._getUse=function(entity,obj){var state=this._baseState;return state.useDecoder=this._use(entity,obj),assert(null===state.useDecoder._baseState.parent),state.useDecoder=state.useDecoder._baseState.children[0],state.implicit!==state.useDecoder._baseState.implicit&&(state.useDecoder=state.useDecoder.clone(),state.useDecoder._baseState.implicit=state.implicit),state.useDecoder},Node.prototype._decodeChoice=function(input,options){var state=this._baseState,result=null,match=!1;return Object.keys(state.choice).some(function(key){var save=input.save(),node=state.choice[key];try{var value=node._decode(input,options);if(input.isError(value))return!1;result={type:key,value:value},match=!0}catch(e){return input.restore(save),!1}return!0},this),match?result:input.error("Choice not matched")},Node.prototype._createEncoderBuffer=function(data){return new EncoderBuffer(data,this.reporter)},Node.prototype._encode=function(data,reporter,parent){var state=this._baseState;if(null===state.default||state.default!==data){var result=this._encodeValue(data,reporter,parent);if(void 0!==result&&!this._skipDefault(result,reporter,parent))return result}},Node.prototype._encodeValue=function(data,reporter,parent){var state=this._baseState;if(null===state.parent)return state.children[0]._encode(data,reporter||new Reporter);var result=null;if(this.reporter=reporter,state.optional&&void 0===data){if(null===state.default)return;data=state.default}var content=null,primitive=!1;if(state.any)result=this._createEncoderBuffer(data);else if(state.choice)result=this._encodeChoice(data,reporter);else if(state.contains)content=this._getUse(state.contains,parent)._encode(data,reporter),primitive=!0;else if(state.children)content=state.children.map(function(child){if("null_"===child._baseState.tag)return child._encode(null,reporter,data);if(null===child._baseState.key)return reporter.error("Child should have a key");var prevKey=reporter.enterKey(child._baseState.key);if("object"!=typeof data)return reporter.error("Child expected, but input is not object");var res=child._encode(data[child._baseState.key],reporter,data);return reporter.leaveKey(prevKey),res},this).filter(function(child){return child}),content=this._createEncoderBuffer(content);else if("seqof"===state.tag||"setof"===state.tag){if(!state.args||1!==state.args.length)return reporter.error("Too many args for : "+state.tag);if(!Array.isArray(data))return reporter.error("seqof/setof, but data is not Array");var child=this.clone();child._baseState.implicit=null,content=this._createEncoderBuffer(data.map(function(item){var state=this._baseState;return this._getUse(state.args[0],data)._encode(item,reporter)},child))}else null!==state.use?result=this._getUse(state.use,parent)._encode(data,reporter):(content=this._encodePrimitive(state.tag,data),primitive=!0);var result;if(!state.any&&null===state.choice){var tag=null!==state.implicit?state.implicit:state.tag,cls=null===state.implicit?"universal":"context";null===tag?null===state.use&&reporter.error("Tag could be ommited only for .use()"):null===state.use&&(result=this._encodeComposite(tag,primitive,cls,content))}return null!==state.explicit&&(result=this._encodeComposite(state.explicit,!1,"context",result)),result},Node.prototype._encodeChoice=function(data,reporter){var state=this._baseState,node=state.choice[data.type];return node||assert(!1,data.type+" not found in "+JSON.stringify(Object.keys(state.choice))),node._encode(data.value,reporter)},Node.prototype._encodePrimitive=function(tag,data){var state=this._baseState;if(/str$/.test(tag))return this._encodeStr(data,tag);if("objid"===tag&&state.args)return this._encodeObjid(data,state.reverseArgs[0],state.args[1]);if("objid"===tag)return this._encodeObjid(data,null,null);if("gentime"===tag||"utctime"===tag)return this._encodeTime(data,tag);if("null_"===tag)return this._encodeNull();if("int"===tag||"enum"===tag)return this._encodeInt(data,state.args&&state.reverseArgs[0]);if("bool"===tag)return this._encodeBool(data);if("objDesc"===tag)return this._encodeStr(data,tag);throw new Error("Unsupported tag: "+tag)},Node.prototype._isNumstr=function(str){return/^[0-9 ]*$/.test(str)},Node.prototype._isPrintstr=function(str){return/^[A-Za-z0-9 '\(\)\+,\-\.\/:=\?]*$/.test(str)}},{"../base":4,"minimalistic-assert":117}],6:[function(_dereq_,module,exports){function Reporter(options){this._reporterState={obj:null,path:[],options:options||{},errors:[]}}function ReporterError(path,msg){this.path=path,this.rethrow(msg)}var inherits=_dereq_("inherits");exports.Reporter=Reporter,Reporter.prototype.isError=function(obj){return obj instanceof ReporterError},Reporter.prototype.save=function(){var state=this._reporterState;return{obj:state.obj,pathLen:state.path.length}},Reporter.prototype.restore=function(data){var state=this._reporterState;state.obj=data.obj,state.path=state.path.slice(0,data.pathLen)},Reporter.prototype.enterKey=function(key){return this._reporterState.path.push(key)},Reporter.prototype.exitKey=function(index){var state=this._reporterState;state.path=state.path.slice(0,index-1)},Reporter.prototype.leaveKey=function(index,key,value){var state=this._reporterState;this.exitKey(index),null!==state.obj&&(state.obj[key]=value)},Reporter.prototype.path=function(){return this._reporterState.path.join("/")},Reporter.prototype.enterObject=function(){var state=this._reporterState,prev=state.obj;return state.obj={},prev},Reporter.prototype.leaveObject=function(prev){var state=this._reporterState,now=state.obj;return state.obj=prev,now},Reporter.prototype.error=function(msg){var err,state=this._reporterState,inherited=msg instanceof ReporterError;if(err=inherited?msg:new ReporterError(state.path.map(function(elem){return"["+JSON.stringify(elem)+"]"}).join(""),msg.message||msg,msg.stack),!state.options.partial)throw err;return inherited||state.errors.push(err),err},Reporter.prototype.wrapResult=function(result){var state=this._reporterState;return state.options.partial?{result:this.isError(result)?null:result,errors:state.errors}:result},inherits(ReporterError,Error),ReporterError.prototype.rethrow=function(msg){if(this.message=msg+" at: "+(this.path||"(shallow)"),Error.captureStackTrace&&Error.captureStackTrace(this,ReporterError),!this.stack)try{throw new Error(this.message)}catch(e){this.stack=e.stack}return this}},{inherits:112}],7:[function(_dereq_,module,exports){var constants=_dereq_("../constants");exports.tagClass={0:"universal",1:"application",2:"context",3:"private"},exports.tagClassByName=constants._reverse(exports.tagClass),exports.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"},exports.tagByName=constants._reverse(exports.tag)},{"../constants":8}],8:[function(_dereq_,module,exports){var constants=exports;constants._reverse=function(map){var res={};return Object.keys(map).forEach(function(key){(0|key)==key&&(key=0|key);var value=map[key];res[value]=key}),res},constants.der=_dereq_("./der")},{"./der":7}],9:[function(_dereq_,module,exports){function DERDecoder(entity){this.enc="der",this.name=entity.name,this.entity=entity,this.tree=new DERNode,this.tree._init(entity.body)}function DERNode(parent){base.Node.call(this,"der",parent)}function derDecodeTag(buf,fail){var tag=buf.readUInt8(fail);if(buf.isError(tag))return tag;var cls=der.tagClass[tag>>6],primitive=0===(32&tag);if(31===(31&tag)){var oct=tag;for(tag=0;128===(128&oct);){if(oct=buf.readUInt8(fail),buf.isError(oct))return oct;tag<<=7,tag|=127&oct}}else tag&=31;var tagStr=der.tag[tag];return{cls:cls,primitive:primitive,tag:tag,tagStr:tagStr}}function derDecodeLen(buf,primitive,fail){var len=buf.readUInt8(fail);if(buf.isError(len))return len;if(!primitive&&128===len)return null;if(0===(128&len))return len;var num=127&len;if(num>4)return buf.error("length octect is too long");len=0;for(var i=0;i<num;i++){len<<=8;var j=buf.readUInt8(fail);if(buf.isError(j))return j;len|=j}return len}var inherits=_dereq_("inherits"),asn1=_dereq_("../../asn1"),base=asn1.base,bignum=asn1.bignum,der=asn1.constants.der;module.exports=DERDecoder,DERDecoder.prototype.decode=function(data,options){return data instanceof base.DecoderBuffer||(data=new base.DecoderBuffer(data,options)),this.tree._decode(data,options)},inherits(DERNode,base.Node),DERNode.prototype._peekTag=function(buffer,tag,any){if(buffer.isEmpty())return!1;var state=buffer.save(),decodedTag=derDecodeTag(buffer,'Failed to peek tag: "'+tag+'"');return buffer.isError(decodedTag)?decodedTag:(buffer.restore(state),decodedTag.tag===tag||decodedTag.tagStr===tag||decodedTag.tagStr+"of"===tag||any)},DERNode.prototype._decodeTag=function(buffer,tag,any){var decodedTag=derDecodeTag(buffer,'Failed to decode tag of "'+tag+'"');if(buffer.isError(decodedTag))return decodedTag;var len=derDecodeLen(buffer,decodedTag.primitive,'Failed to get length of "'+tag+'"');if(buffer.isError(len))return len;if(!any&&decodedTag.tag!==tag&&decodedTag.tagStr!==tag&&decodedTag.tagStr+"of"!==tag)return buffer.error('Failed to match tag: "'+tag+'"');if(decodedTag.primitive||null!==len)return buffer.skip(len,'Failed to match body of: "'+tag+'"');var state=buffer.save(),res=this._skipUntilEnd(buffer,'Failed to skip indefinite length body: "'+this.tag+'"');return buffer.isError(res)?res:(len=buffer.offset-state.offset,buffer.restore(state),buffer.skip(len,'Failed to match body of: "'+tag+'"'))},DERNode.prototype._skipUntilEnd=function(buffer,fail){for(;;){var tag=derDecodeTag(buffer,fail);if(buffer.isError(tag))return tag;var len=derDecodeLen(buffer,tag.primitive,fail);if(buffer.isError(len))return len;var res;if(res=tag.primitive||null!==len?buffer.skip(len):this._skipUntilEnd(buffer,fail),buffer.isError(res))return res;if("end"===tag.tagStr)break}},DERNode.prototype._decodeList=function(buffer,tag,decoder,options){for(var result=[];!buffer.isEmpty();){var possibleEnd=this._peekTag(buffer,"end");if(buffer.isError(possibleEnd))return possibleEnd;var res=decoder.decode(buffer,"der",options);if(buffer.isError(res)&&possibleEnd)break;result.push(res)}return result},DERNode.prototype._decodeStr=function(buffer,tag){if("bitstr"===tag){var unused=buffer.readUInt8();return buffer.isError(unused)?unused:{unused:unused,data:buffer.raw()}}if("bmpstr"===tag){var raw=buffer.raw();if(raw.length%2===1)return buffer.error("Decoding of string type: bmpstr length mismatch");for(var str="",i=0;i<raw.length/2;i++)str+=String.fromCharCode(raw.readUInt16BE(2*i));return str}if("numstr"===tag){var numstr=buffer.raw().toString("ascii");return this._isNumstr(numstr)?numstr:buffer.error("Decoding of string type: numstr unsupported characters")}if("octstr"===tag)return buffer.raw();if("objDesc"===tag)return buffer.raw();if("printstr"===tag){var printstr=buffer.raw().toString("ascii");return this._isPrintstr(printstr)?printstr:buffer.error("Decoding of string type: printstr unsupported characters")}return/str$/.test(tag)?buffer.raw().toString():buffer.error("Decoding of string type: "+tag+" unsupported")},DERNode.prototype._decodeObjid=function(buffer,values,relative){for(var result,identifiers=[],ident=0;!buffer.isEmpty();){var subident=buffer.readUInt8();ident<<=7,ident|=127&subident,0===(128&subident)&&(identifiers.push(ident),ident=0)}128&subident&&identifiers.push(ident);var first=identifiers[0]/40|0,second=identifiers[0]%40;if(result=relative?identifiers:[first,second].concat(identifiers.slice(1)),values){var tmp=values[result.join(" ")];void 0===tmp&&(tmp=values[result.join(".")]),void 0!==tmp&&(result=tmp)}return result},DERNode.prototype._decodeTime=function(buffer,tag){var str=buffer.raw().toString();if("gentime"===tag)var year=0|str.slice(0,4),mon=0|str.slice(4,6),day=0|str.slice(6,8),hour=0|str.slice(8,10),min=0|str.slice(10,12),sec=0|str.slice(12,14);else{if("utctime"!==tag)return buffer.error("Decoding "+tag+" time is not supported yet");var year=0|str.slice(0,2),mon=0|str.slice(2,4),day=0|str.slice(4,6),hour=0|str.slice(6,8),min=0|str.slice(8,10),sec=0|str.slice(10,12);year=year<70?2e3+year:1900+year}return Date.UTC(year,mon-1,day,hour,min,sec,0)},DERNode.prototype._decodeNull=function(buffer){return null},DERNode.prototype._decodeBool=function(buffer){var res=buffer.readUInt8();return buffer.isError(res)?res:0!==res},DERNode.prototype._decodeInt=function(buffer,values){var raw=buffer.raw(),res=new bignum(raw);return values&&(res=values[res.toString(10)]||res),res},DERNode.prototype._use=function(entity,obj){return"function"==typeof entity&&(entity=entity(obj)),entity._getDecoder("der").tree}},{"../../asn1":1,inherits:112}],10:[function(_dereq_,module,exports){var decoders=exports;decoders.der=_dereq_("./der"),decoders.pem=_dereq_("./pem")},{"./der":9,"./pem":11}],11:[function(_dereq_,module,exports){function PEMDecoder(entity){DERDecoder.call(this,entity),this.enc="pem"}var inherits=_dereq_("inherits"),Buffer=_dereq_("buffer").Buffer,DERDecoder=_dereq_("./der");inherits(PEMDecoder,DERDecoder),module.exports=PEMDecoder,PEMDecoder.prototype.decode=function(data,options){for(var lines=data.toString().split(/[\r\n]+/g),label=options.label.toUpperCase(),re=/^-----(BEGIN|END) ([^-]+)-----$/,start=-1,end=-1,i=0;i<lines.length;i++){var match=lines[i].match(re);if(null!==match&&match[2]===label){if(start!==-1){if("END"!==match[1])break;end=i;break}if("BEGIN"!==match[1])break;start=i}}if(start===-1||end===-1)throw new Error("PEM section not found for: "+label);var base64=lines.slice(start+1,end).join("");base64.replace(/[^a-z0-9\+\/=]+/gi,"");var input=new Buffer(base64,"base64");return DERDecoder.prototype.decode.call(this,input,options)}},{"./der":9,buffer:49,inherits:112}],12:[function(_dereq_,module,exports){function DEREncoder(entity){this.enc="der",this.name=entity.name,this.entity=entity,this.tree=new DERNode,this.tree._init(entity.body)}function DERNode(parent){base.Node.call(this,"der",parent)}function two(num){return num<10?"0"+num:num}function encodeTag(tag,primitive,cls,reporter){var res;if("seqof"===tag?tag="seq":"setof"===tag&&(tag="set"),der.tagByName.hasOwnProperty(tag))res=der.tagByName[tag];else{if("number"!=typeof tag||(0|tag)!==tag)return reporter.error("Unknown tag: "+tag);res=tag}return res>=31?reporter.error("Multi-octet tag encoding unsupported"):(primitive||(res|=32),res|=der.tagClassByName[cls||"universal"]<<6)}var inherits=_dereq_("inherits"),Buffer=_dereq_("buffer").Buffer,asn1=_dereq_("../../asn1"),base=asn1.base,der=asn1.constants.der;module.exports=DEREncoder,DEREncoder.prototype.encode=function(data,reporter){return this.tree._encode(data,reporter).join()},inherits(DERNode,base.Node),DERNode.prototype._encodeComposite=function(tag,primitive,cls,content){var encodedTag=encodeTag(tag,primitive,cls,this.reporter);if(content.length<128){var header=new Buffer(2);return header[0]=encodedTag,header[1]=content.length,this._createEncoderBuffer([header,content])}for(var lenOctets=1,i=content.length;i>=256;i>>=8)lenOctets++;var header=new Buffer(2+lenOctets);header[0]=encodedTag,header[1]=128|lenOctets;for(var i=1+lenOctets,j=content.length;j>0;i--,j>>=8)header[i]=255&j;return this._createEncoderBuffer([header,content])},DERNode.prototype._encodeStr=function(str,tag){if("bitstr"===tag)return this._createEncoderBuffer([0|str.unused,str.data]);if("bmpstr"===tag){for(var buf=new Buffer(2*str.length),i=0;i<str.length;i++)buf.writeUInt16BE(str.charCodeAt(i),2*i);return this._createEncoderBuffer(buf)}return"numstr"===tag?this._isNumstr(str)?this._createEncoderBuffer(str):this.reporter.error("Encoding of string type: numstr supports only digits and space"):"printstr"===tag?this._isPrintstr(str)?this._createEncoderBuffer(str):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(tag)?this._createEncoderBuffer(str):"objDesc"===tag?this._createEncoderBuffer(str):this.reporter.error("Encoding of string type: "+tag+" unsupported")},DERNode.prototype._encodeObjid=function(id,values,relative){if("string"==typeof id){if(!values)return this.reporter.error("string objid given, but no values map found");if(!values.hasOwnProperty(id))return this.reporter.error("objid not found in values map");id=values[id].split(/[\s\.]+/g);for(var i=0;i<id.length;i++)id[i]|=0}else if(Array.isArray(id)){id=id.slice();for(var i=0;i<id.length;i++)id[i]|=0}if(!Array.isArray(id))return this.reporter.error("objid() should be either array or string, got: "+JSON.stringify(id));if(!relative){if(id[1]>=40)return this.reporter.error("Second objid identifier OOB");id.splice(0,2,40*id[0]+id[1])}for(var size=0,i=0;i<id.length;i++){var ident=id[i];for(size++;ident>=128;ident>>=7)size++}for(var objid=new Buffer(size),offset=objid.length-1,i=id.length-1;i>=0;i--){var ident=id[i];for(objid[offset--]=127&ident;(ident>>=7)>0;)objid[offset--]=128|127&ident}return this._createEncoderBuffer(objid)},DERNode.prototype._encodeTime=function(time,tag){var str,date=new Date(time);return"gentime"===tag?str=[two(date.getFullYear()),two(date.getUTCMonth()+1),two(date.getUTCDate()),two(date.getUTCHours()),two(date.getUTCMinutes()),two(date.getUTCSeconds()),"Z"].join(""):"utctime"===tag?str=[two(date.getFullYear()%100),two(date.getUTCMonth()+1),two(date.getUTCDate()),two(date.getUTCHours()),two(date.getUTCMinutes()),two(date.getUTCSeconds()),"Z"].join(""):this.reporter.error("Encoding "+tag+" time is not supported yet"),this._encodeStr(str,"octstr")},DERNode.prototype._encodeNull=function(){return this._createEncoderBuffer("")},DERNode.prototype._encodeInt=function(num,values){if("string"==typeof num){if(!values)return this.reporter.error("String int or enum given, but no values map");if(!values.hasOwnProperty(num))return this.reporter.error("Values map doesn't contain: "+JSON.stringify(num));num=values[num]}if("number"!=typeof num&&!Buffer.isBuffer(num)){var numArray=num.toArray();!num.sign&&128&numArray[0]&&numArray.unshift(0),num=new Buffer(numArray)}if(Buffer.isBuffer(num)){var size=num.length;0===num.length&&size++;var out=new Buffer(size);return num.copy(out),0===num.length&&(out[0]=0),this._createEncoderBuffer(out)}if(num<128)return this._createEncoderBuffer(num);if(num<256)return this._createEncoderBuffer([0,num]);for(var size=1,i=num;i>=256;i>>=8)size++;for(var out=new Array(size),i=out.length-1;i>=0;i--)out[i]=255&num,num>>=8;return 128&out[0]&&out.unshift(0),this._createEncoderBuffer(new Buffer(out))},DERNode.prototype._encodeBool=function(value){return this._createEncoderBuffer(value?255:0)},DERNode.prototype._use=function(entity,obj){return"function"==typeof entity&&(entity=entity(obj)),entity._getEncoder("der").tree},DERNode.prototype._skipDefault=function(dataBuffer,reporter,parent){var i,state=this._baseState;if(null===state.default)return!1;var data=dataBuffer.join();if(void 0===state.defaultBuffer&&(state.defaultBuffer=this._encodeValue(state.default,reporter,parent).join()),data.length!==state.defaultBuffer.length)return!1;for(i=0;i<data.length;i++)if(data[i]!==state.defaultBuffer[i])return!1;return!0}},{"../../asn1":1,buffer:49,inherits:112}],13:[function(_dereq_,module,exports){var encoders=exports;encoders.der=_dereq_("./der"),encoders.pem=_dereq_("./pem")},{"./der":12,"./pem":14}],14:[function(_dereq_,module,exports){
function PEMEncoder(entity){DEREncoder.call(this,entity),this.enc="pem"}var inherits=_dereq_("inherits"),DEREncoder=_dereq_("./der");inherits(PEMEncoder,DEREncoder),module.exports=PEMEncoder,PEMEncoder.prototype.encode=function(data,options){for(var buf=DEREncoder.prototype.encode.call(this,data),p=buf.toString("base64"),out=["-----BEGIN "+options.label+"-----"],i=0;i<p.length;i+=64)out.push(p.slice(i,i+64));return out.push("-----END "+options.label+"-----"),out.join("\n")}},{"./der":12,inherits:112}],15:[function(_dereq_,module,exports){"use strict";function autobind(){for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return 1===args.length?boundClass.apply(void 0,args):boundMethod.apply(void 0,args)}function boundClass(target){var keys=void 0;return"undefined"!=typeof Reflect&&"function"==typeof Reflect.ownKeys?keys=Reflect.ownKeys(target.prototype):(keys=Object.getOwnPropertyNames(target.prototype),"function"==typeof Object.getOwnPropertySymbols&&(keys=keys.concat(Object.getOwnPropertySymbols(target.prototype)))),keys.forEach(function(key){if("constructor"!==key){var descriptor=Object.getOwnPropertyDescriptor(target.prototype,key);"function"==typeof descriptor.value&&Object.defineProperty(target.prototype,key,boundMethod(target,key,descriptor))}}),target}function boundMethod(target,key,descriptor){var fn=descriptor.value;if("function"!=typeof fn)throw new Error("@autobind decorator can only be applied to methods not: "+typeof fn);var definingProperty=!1;return{configurable:!0,get:function(){if(definingProperty||this===target.prototype||this.hasOwnProperty(key))return fn;var boundFn=fn.bind(this);return definingProperty=!0,Object.defineProperty(this,key,{value:boundFn,configurable:!0,writable:!0}),definingProperty=!1,boundFn}}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=autobind,module.exports=exports.default},{}],16:[function(_dereq_,module,exports){(function(Buffer,process){!function(){function Encoder(){var skip=0,bits=0;this.output="",this.readByte=function(byte){return"string"==typeof byte&&(byte=byte.charCodeAt(0)),skip<0?bits|=byte>>-skip:bits=byte<<skip&248,skip>3?(skip-=8,1):(skip<4&&(this.output+=alphabet[bits>>3],skip+=5),0)},this.finish=function(check){var output=this.output+(skip<0?alphabet[bits>>3]:"")+(check?"$":"");return this.output="",output}}function Decoder(){var skip=0,byte=0;this.output="",this.readChar=function(char){"string"!=typeof char&&"number"==typeof char&&(char=String.fromCharCode(char)),char=char.toLowerCase();var val=lookup()[char];"undefined"!=typeof val&&(val<<=3,byte|=val>>>skip,skip+=5,skip>=8&&(this.output+=String.fromCharCode(byte),skip-=8,byte=skip>0?val<<5-skip&255:0))},this.finish=function(check){var output=this.output+(skip<0?alphabet[bits>>3]:"")+(check?"$":"");return this.output="",output}}function encode(input){var encoder=new Encoder,output=encoder.update(input,!0);return output}function decode(input){var decoder=new Decoder,output=decoder.update(input,!0);return output}function sha1(input,cb){"undefined"==typeof crypto&&(crypto=_dereq_("crypto"));var hash=crypto.createHash("sha1");if(hash.digest=function(digest){return function(){return encode(digest.call(this,"binary"))}}(hash.digest),cb){if("string"==typeof input||Buffer.isBuffer(input))try{return cb(null,sha1(input))}catch(err){return cb(err,null)}return input.on("data",function(chunk){hash.update(chunk)}),void input.on("end",function(){cb(null,hash.digest())})}return input?hash.update(input).digest():hash}var alphabet="0123456789abcdefghjkmnpqrtuvwxyz",alias={o:0,i:1,l:1,s:5},lookup=function(){for(var table={},i=0;i<alphabet.length;i++)table[alphabet[i]]=i;for(var key in alias)alias.hasOwnProperty(key)&&(table[key]=table[""+alias[key]]);return lookup=function(){return table},table};Encoder.prototype.update=function(input,flush){for(var i=0;i<input.length;)i+=this.readByte(input[i]);var output=this.output;return this.output="",flush&&(output+=this.finish()),output},Decoder.prototype.update=function(input,flush){for(var i=0;i<input.length;i++)this.readChar(input[i]);var output=this.output;return this.output="",flush&&(output+=this.finish()),output};var crypto,fs;sha1.file=function(filename,cb){return"-"==filename?(process.stdin.resume(),sha1(process.stdin,cb)):("undefined"==typeof fs&&(fs=_dereq_("fs")),fs.stat(filename,function(err,stats){return err?cb(err,null):stats.isDirectory()?cb({dir:!0,message:"Is a directory"}):sha1(_dereq_("fs").createReadStream(filename),cb)}))};var base32={Decoder:Decoder,Encoder:Encoder,encode:encode,decode:decode,sha1:sha1};"undefined"!=typeof window&&(window.base32=base32),"undefined"!=typeof module&&module.exports&&(module.exports=base32)}()}).call(this,{isBuffer:_dereq_("../../is-buffer/index.js")},_dereq_("_process"))},{"../../is-buffer/index.js":113,_process:127,crypto:57,fs:46}],17:[function(_dereq_,module,exports){"use strict";function placeHoldersCount(b64){var len=b64.length;if(len%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===b64[len-2]?2:"="===b64[len-1]?1:0}function byteLength(b64){return 3*b64.length/4-placeHoldersCount(b64)}function toByteArray(b64){var i,j,l,tmp,placeHolders,arr,len=b64.length;placeHolders=placeHoldersCount(b64),arr=new Arr(3*len/4-placeHolders),l=placeHolders>0?len-4:len;var L=0;for(i=0,j=0;i<l;i+=4,j+=3)tmp=revLookup[b64.charCodeAt(i)]<<18|revLookup[b64.charCodeAt(i+1)]<<12|revLookup[b64.charCodeAt(i+2)]<<6|revLookup[b64.charCodeAt(i+3)],arr[L++]=tmp>>16&255,arr[L++]=tmp>>8&255,arr[L++]=255&tmp;return 2===placeHolders?(tmp=revLookup[b64.charCodeAt(i)]<<2|revLookup[b64.charCodeAt(i+1)]>>4,arr[L++]=255&tmp):1===placeHolders&&(tmp=revLookup[b64.charCodeAt(i)]<<10|revLookup[b64.charCodeAt(i+1)]<<4|revLookup[b64.charCodeAt(i+2)]>>2,arr[L++]=tmp>>8&255,arr[L++]=255&tmp),arr}function tripletToBase64(num){return lookup[num>>18&63]+lookup[num>>12&63]+lookup[num>>6&63]+lookup[63&num]}function encodeChunk(uint8,start,end){for(var tmp,output=[],i=start;i<end;i+=3)tmp=(uint8[i]<<16)+(uint8[i+1]<<8)+uint8[i+2],output.push(tripletToBase64(tmp));return output.join("")}function fromByteArray(uint8){for(var tmp,len=uint8.length,extraBytes=len%3,output="",parts=[],maxChunkLength=16383,i=0,len2=len-extraBytes;i<len2;i+=maxChunkLength)parts.push(encodeChunk(uint8,i,i+maxChunkLength>len2?len2:i+maxChunkLength));return 1===extraBytes?(tmp=uint8[len-1],output+=lookup[tmp>>2],output+=lookup[tmp<<4&63],output+="=="):2===extraBytes&&(tmp=(uint8[len-2]<<8)+uint8[len-1],output+=lookup[tmp>>10],output+=lookup[tmp>>4&63],output+=lookup[tmp<<2&63],output+="="),parts.push(output),parts.join("")}exports.byteLength=byteLength,exports.toByteArray=toByteArray,exports.fromByteArray=fromByteArray;for(var lookup=[],revLookup=[],Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,len=code.length;i<len;++i)lookup[i]=code[i],revLookup[code.charCodeAt(i)]=i;revLookup["-".charCodeAt(0)]=62,revLookup["_".charCodeAt(0)]=63},{}],18:[function(_dereq_,module,exports){!function(module,exports){"use strict";function assert(val,msg){if(!val)throw new Error(msg||"Assertion failed")}function inherits(ctor,superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype,ctor.prototype=new TempCtor,ctor.prototype.constructor=ctor}function BN(number,base,endian){return BN.isBN(number)?number:(this.negative=0,this.words=null,this.length=0,this.red=null,void(null!==number&&("le"!==base&&"be"!==base||(endian=base,base=10),this._init(number||0,base||10,endian||"be"))))}function parseHex(str,start,end){for(var r=0,len=Math.min(str.length,end),i=start;i<len;i++){var c=str.charCodeAt(i)-48;r<<=4,r|=c>=49&&c<=54?c-49+10:c>=17&&c<=22?c-17+10:15&c}return r}function parseBase(str,start,end,mul){for(var r=0,len=Math.min(str.length,end),i=start;i<len;i++){var c=str.charCodeAt(i)-48;r*=mul,r+=c>=49?c-49+10:c>=17?c-17+10:c}return r}function toBitArray(num){for(var w=new Array(num.bitLength()),bit=0;bit<w.length;bit++){var off=bit/26|0,wbit=bit%26;w[bit]=(num.words[off]&1<<wbit)>>>wbit}return w}function smallMulTo(self,num,out){out.negative=num.negative^self.negative;var len=self.length+num.length|0;out.length=len,len=len-1|0;var a=0|self.words[0],b=0|num.words[0],r=a*b,lo=67108863&r,carry=r/67108864|0;out.words[0]=lo;for(var k=1;k<len;k++){for(var ncarry=carry>>>26,rword=67108863&carry,maxJ=Math.min(k,num.length-1),j=Math.max(0,k-self.length+1);j<=maxJ;j++){var i=k-j|0;a=0|self.words[i],b=0|num.words[j],r=a*b+rword,ncarry+=r/67108864|0,rword=67108863&r}out.words[k]=0|rword,carry=0|ncarry}return 0!==carry?out.words[k]=0|carry:out.length--,out.strip()}function bigMulTo(self,num,out){out.negative=num.negative^self.negative,out.length=self.length+num.length;for(var carry=0,hncarry=0,k=0;k<out.length-1;k++){var ncarry=hncarry;hncarry=0;for(var rword=67108863&carry,maxJ=Math.min(k,num.length-1),j=Math.max(0,k-self.length+1);j<=maxJ;j++){var i=k-j,a=0|self.words[i],b=0|num.words[j],r=a*b,lo=67108863&r;ncarry=ncarry+(r/67108864|0)|0,lo=lo+rword|0,rword=67108863&lo,ncarry=ncarry+(lo>>>26)|0,hncarry+=ncarry>>>26,ncarry&=67108863}out.words[k]=rword,carry=ncarry,ncarry=hncarry}return 0!==carry?out.words[k]=carry:out.length--,out.strip()}function jumboMulTo(self,num,out){var fftm=new FFTM;return fftm.mulp(self,num,out)}function FFTM(x,y){this.x=x,this.y=y}function MPrime(name,p){this.name=name,this.p=new BN(p,16),this.n=this.p.bitLength(),this.k=new BN(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function K256(){MPrime.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function P224(){MPrime.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function P192(){MPrime.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function P25519(){MPrime.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function Red(m){if("string"==typeof m){var prime=BN._prime(m);this.m=prime.p,this.prime=prime}else assert(m.gtn(1),"modulus must be greater than 1"),this.m=m,this.prime=null}function Mont(m){Red.call(this,m),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new BN(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}"object"==typeof module?module.exports=BN:exports.BN=BN,BN.BN=BN,BN.wordSize=26;var Buffer;try{Buffer=_dereq_("buffer").Buffer}catch(e){}BN.isBN=function(num){return num instanceof BN||null!==num&&"object"==typeof num&&num.constructor.wordSize===BN.wordSize&&Array.isArray(num.words)},BN.max=function(left,right){return left.cmp(right)>0?left:right},BN.min=function(left,right){return left.cmp(right)<0?left:right},BN.prototype._init=function(number,base,endian){if("number"==typeof number)return this._initNumber(number,base,endian);if("object"==typeof number)return this._initArray(number,base,endian);"hex"===base&&(base=16),assert(base===(0|base)&&base>=2&&base<=36),number=number.toString().replace(/\s+/g,"");var start=0;"-"===number[0]&&start++,16===base?this._parseHex(number,start):this._parseBase(number,base,start),"-"===number[0]&&(this.negative=1),this.strip(),"le"===endian&&this._initArray(this.toArray(),base,endian)},BN.prototype._initNumber=function(number,base,endian){number<0&&(this.negative=1,number=-number),number<67108864?(this.words=[67108863&number],this.length=1):number<4503599627370496?(this.words=[67108863&number,number/67108864&67108863],this.length=2):(assert(number<9007199254740992),this.words=[67108863&number,number/67108864&67108863,1],this.length=3),"le"===endian&&this._initArray(this.toArray(),base,endian)},BN.prototype._initArray=function(number,base,endian){if(assert("number"==typeof number.length),number.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(number.length/3),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var j,w,off=0;if("be"===endian)for(i=number.length-1,j=0;i>=0;i-=3)w=number[i]|number[i-1]<<8|number[i-2]<<16,this.words[j]|=w<<off&67108863,this.words[j+1]=w>>>26-off&67108863,off+=24,off>=26&&(off-=26,j++);else if("le"===endian)for(i=0,j=0;i<number.length;i+=3)w=number[i]|number[i+1]<<8|number[i+2]<<16,this.words[j]|=w<<off&67108863,this.words[j+1]=w>>>26-off&67108863,off+=24,off>=26&&(off-=26,j++);return this.strip()},BN.prototype._parseHex=function(number,start){this.length=Math.ceil((number.length-start)/6),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var j,w,off=0;for(i=number.length-6,j=0;i>=start;i-=6)w=parseHex(number,i,i+6),this.words[j]|=w<<off&67108863,this.words[j+1]|=w>>>26-off&4194303,off+=24,off>=26&&(off-=26,j++);i+6!==start&&(w=parseHex(number,start,i+6),this.words[j]|=w<<off&67108863,this.words[j+1]|=w>>>26-off&4194303),this.strip()},BN.prototype._parseBase=function(number,base,start){this.words=[0],this.length=1;for(var limbLen=0,limbPow=1;limbPow<=67108863;limbPow*=base)limbLen++;limbLen--,limbPow=limbPow/base|0;for(var total=number.length-start,mod=total%limbLen,end=Math.min(total,total-mod)+start,word=0,i=start;i<end;i+=limbLen)word=parseBase(number,i,i+limbLen,base),this.imuln(limbPow),this.words[0]+word<67108864?this.words[0]+=word:this._iaddn(word);if(0!==mod){var pow=1;for(word=parseBase(number,i,number.length,base),i=0;i<mod;i++)pow*=base;this.imuln(pow),this.words[0]+word<67108864?this.words[0]+=word:this._iaddn(word)}},BN.prototype.copy=function(dest){dest.words=new Array(this.length);for(var i=0;i<this.length;i++)dest.words[i]=this.words[i];dest.length=this.length,dest.negative=this.negative,dest.red=this.red},BN.prototype.clone=function(){var r=new BN(null);return this.copy(r),r},BN.prototype._expand=function(size){for(;this.length<size;)this.words[this.length++]=0;return this},BN.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},BN.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},BN.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var zeros=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],groupSizes=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],groupBases=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];BN.prototype.toString=function(base,padding){base=base||10,padding=0|padding||1;var out;if(16===base||"hex"===base){out="";for(var off=0,carry=0,i=0;i<this.length;i++){var w=this.words[i],word=(16777215&(w<<off|carry)).toString(16);carry=w>>>24-off&16777215,out=0!==carry||i!==this.length-1?zeros[6-word.length]+word+out:word+out,off+=2,off>=26&&(off-=26,i--)}for(0!==carry&&(out=carry.toString(16)+out);out.length%padding!==0;)out="0"+out;return 0!==this.negative&&(out="-"+out),out}if(base===(0|base)&&base>=2&&base<=36){var groupSize=groupSizes[base],groupBase=groupBases[base];out="";var c=this.clone();for(c.negative=0;!c.isZero();){var r=c.modn(groupBase).toString(base);c=c.idivn(groupBase),out=c.isZero()?r+out:zeros[groupSize-r.length]+r+out}for(this.isZero()&&(out="0"+out);out.length%padding!==0;)out="0"+out;return 0!==this.negative&&(out="-"+out),out}assert(!1,"Base should be between 2 and 36")},BN.prototype.toNumber=function(){var ret=this.words[0];return 2===this.length?ret+=67108864*this.words[1]:3===this.length&&1===this.words[2]?ret+=4503599627370496+67108864*this.words[1]:this.length>2&&assert(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-ret:ret},BN.prototype.toJSON=function(){return this.toString(16)},BN.prototype.toBuffer=function(endian,length){return assert("undefined"!=typeof Buffer),this.toArrayLike(Buffer,endian,length)},BN.prototype.toArray=function(endian,length){return this.toArrayLike(Array,endian,length)},BN.prototype.toArrayLike=function(ArrayType,endian,length){var byteLength=this.byteLength(),reqLength=length||Math.max(1,byteLength);assert(byteLength<=reqLength,"byte array longer than desired length"),assert(reqLength>0,"Requested array length <= 0"),this.strip();var b,i,littleEndian="le"===endian,res=new ArrayType(reqLength),q=this.clone();if(littleEndian){for(i=0;!q.isZero();i++)b=q.andln(255),q.iushrn(8),res[i]=b;for(;i<reqLength;i++)res[i]=0}else{for(i=0;i<reqLength-byteLength;i++)res[i]=0;for(i=0;!q.isZero();i++)b=q.andln(255),q.iushrn(8),res[reqLength-i-1]=b}return res},Math.clz32?BN.prototype._countBits=function(w){return 32-Math.clz32(w)}:BN.prototype._countBits=function(w){var t=w,r=0;return t>=4096&&(r+=13,t>>>=13),t>=64&&(r+=7,t>>>=7),t>=8&&(r+=4,t>>>=4),t>=2&&(r+=2,t>>>=2),r+t},BN.prototype._zeroBits=function(w){if(0===w)return 26;var t=w,r=0;return 0===(8191&t)&&(r+=13,t>>>=13),0===(127&t)&&(r+=7,t>>>=7),0===(15&t)&&(r+=4,t>>>=4),0===(3&t)&&(r+=2,t>>>=2),0===(1&t)&&r++,r},BN.prototype.bitLength=function(){var w=this.words[this.length-1],hi=this._countBits(w);return 26*(this.length-1)+hi},BN.prototype.zeroBits=function(){if(this.isZero())return 0;for(var r=0,i=0;i<this.length;i++){var b=this._zeroBits(this.words[i]);if(r+=b,26!==b)break}return r},BN.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},BN.prototype.toTwos=function(width){return 0!==this.negative?this.abs().inotn(width).iaddn(1):this.clone()},BN.prototype.fromTwos=function(width){return this.testn(width-1)?this.notn(width).iaddn(1).ineg():this.clone()},BN.prototype.isNeg=function(){return 0!==this.negative},BN.prototype.neg=function(){return this.clone().ineg()},BN.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},BN.prototype.iuor=function(num){for(;this.length<num.length;)this.words[this.length++]=0;for(var i=0;i<num.length;i++)this.words[i]=this.words[i]|num.words[i];return this.strip()},BN.prototype.ior=function(num){return assert(0===(this.negative|num.negative)),this.iuor(num)},BN.prototype.or=function(num){return this.length>num.length?this.clone().ior(num):num.clone().ior(this)},BN.prototype.uor=function(num){return this.length>num.length?this.clone().iuor(num):num.clone().iuor(this)},BN.prototype.iuand=function(num){var b;b=this.length>num.length?num:this;for(var i=0;i<b.length;i++)this.words[i]=this.words[i]&num.words[i];return this.length=b.length,this.strip()},BN.prototype.iand=function(num){return assert(0===(this.negative|num.negative)),this.iuand(num)},BN.prototype.and=function(num){return this.length>num.length?this.clone().iand(num):num.clone().iand(this)},BN.prototype.uand=function(num){return this.length>num.length?this.clone().iuand(num):num.clone().iuand(this)},BN.prototype.iuxor=function(num){var a,b;this.length>num.length?(a=this,b=num):(a=num,b=this);for(var i=0;i<b.length;i++)this.words[i]=a.words[i]^b.words[i];if(this!==a)for(;i<a.length;i++)this.words[i]=a.words[i];return this.length=a.length,this.strip()},BN.prototype.ixor=function(num){return assert(0===(this.negative|num.negative)),this.iuxor(num)},BN.prototype.xor=function(num){return this.length>num.length?this.clone().ixor(num):num.clone().ixor(this)},BN.prototype.uxor=function(num){return this.length>num.length?this.clone().iuxor(num):num.clone().iuxor(this)},BN.prototype.inotn=function(width){assert("number"==typeof width&&width>=0);var bytesNeeded=0|Math.ceil(width/26),bitsLeft=width%26;this._expand(bytesNeeded),bitsLeft>0&&bytesNeeded--;for(var i=0;i<bytesNeeded;i++)this.words[i]=67108863&~this.words[i];return bitsLeft>0&&(this.words[i]=~this.words[i]&67108863>>26-bitsLeft),this.strip()},BN.prototype.notn=function(width){return this.clone().inotn(width)},BN.prototype.setn=function(bit,val){assert("number"==typeof bit&&bit>=0);var off=bit/26|0,wbit=bit%26;return this._expand(off+1),val?this.words[off]=this.words[off]|1<<wbit:this.words[off]=this.words[off]&~(1<<wbit),this.strip()},BN.prototype.iadd=function(num){var r;if(0!==this.negative&&0===num.negative)return this.negative=0,r=this.isub(num),this.negative^=1,this._normSign();if(0===this.negative&&0!==num.negative)return num.negative=0,r=this.isub(num),num.negative=1,r._normSign();var a,b;this.length>num.length?(a=this,b=num):(a=num,b=this);for(var carry=0,i=0;i<b.length;i++)r=(0|a.words[i])+(0|b.words[i])+carry,this.words[i]=67108863&r,carry=r>>>26;for(;0!==carry&&i<a.length;i++)r=(0|a.words[i])+carry,this.words[i]=67108863&r,carry=r>>>26;if(this.length=a.length,0!==carry)this.words[this.length]=carry,this.length++;else if(a!==this)for(;i<a.length;i++)this.words[i]=a.words[i];return this},BN.prototype.add=function(num){var res;return 0!==num.negative&&0===this.negative?(num.negative=0,res=this.sub(num),num.negative^=1,res):0===num.negative&&0!==this.negative?(this.negative=0,res=num.sub(this),this.negative=1,res):this.length>num.length?this.clone().iadd(num):num.clone().iadd(this)},BN.prototype.isub=function(num){if(0!==num.negative){num.negative=0;var r=this.iadd(num);return num.negative=1,r._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(num),this.negative=1,this._normSign();var cmp=this.cmp(num);if(0===cmp)return this.negative=0,this.length=1,this.words[0]=0,this;var a,b;cmp>0?(a=this,b=num):(a=num,b=this);for(var carry=0,i=0;i<b.length;i++)r=(0|a.words[i])-(0|b.words[i])+carry,carry=r>>26,this.words[i]=67108863&r;for(;0!==carry&&i<a.length;i++)r=(0|a.words[i])+carry,carry=r>>26,this.words[i]=67108863&r;if(0===carry&&i<a.length&&a!==this)for(;i<a.length;i++)this.words[i]=a.words[i];return this.length=Math.max(this.length,i),a!==this&&(this.negative=1),this.strip()},BN.prototype.sub=function(num){return this.clone().isub(num)};var comb10MulTo=function(self,num,out){var lo,mid,hi,a=self.words,b=num.words,o=out.words,c=0,a0=0|a[0],al0=8191&a0,ah0=a0>>>13,a1=0|a[1],al1=8191&a1,ah1=a1>>>13,a2=0|a[2],al2=8191&a2,ah2=a2>>>13,a3=0|a[3],al3=8191&a3,ah3=a3>>>13,a4=0|a[4],al4=8191&a4,ah4=a4>>>13,a5=0|a[5],al5=8191&a5,ah5=a5>>>13,a6=0|a[6],al6=8191&a6,ah6=a6>>>13,a7=0|a[7],al7=8191&a7,ah7=a7>>>13,a8=0|a[8],al8=8191&a8,ah8=a8>>>13,a9=0|a[9],al9=8191&a9,ah9=a9>>>13,b0=0|b[0],bl0=8191&b0,bh0=b0>>>13,b1=0|b[1],bl1=8191&b1,bh1=b1>>>13,b2=0|b[2],bl2=8191&b2,bh2=b2>>>13,b3=0|b[3],bl3=8191&b3,bh3=b3>>>13,b4=0|b[4],bl4=8191&b4,bh4=b4>>>13,b5=0|b[5],bl5=8191&b5,bh5=b5>>>13,b6=0|b[6],bl6=8191&b6,bh6=b6>>>13,b7=0|b[7],bl7=8191&b7,bh7=b7>>>13,b8=0|b[8],bl8=8191&b8,bh8=b8>>>13,b9=0|b[9],bl9=8191&b9,bh9=b9>>>13;out.negative=self.negative^num.negative,out.length=19,lo=Math.imul(al0,bl0),mid=Math.imul(al0,bh0),mid=mid+Math.imul(ah0,bl0)|0,hi=Math.imul(ah0,bh0);var w0=(c+lo|0)+((8191&mid)<<13)|0;c=(hi+(mid>>>13)|0)+(w0>>>26)|0,w0&=67108863,lo=Math.imul(al1,bl0),mid=Math.imul(al1,bh0),mid=mid+Math.imul(ah1,bl0)|0,hi=Math.imul(ah1,bh0),lo=lo+Math.imul(al0,bl1)|0,mid=mid+Math.imul(al0,bh1)|0,mid=mid+Math.imul(ah0,bl1)|0,hi=hi+Math.imul(ah0,bh1)|0;var w1=(c+lo|0)+((8191&mid)<<13)|0;c=(hi+(mid>>>13)|0)+(w1>>>26)|0,w1&=67108863,lo=Math.imul(al2,bl0),mid=Math.imul(al2,bh0),mid=mid+Math.imul(ah2,bl0)|0,hi=Math.imul(ah2,bh0),lo=lo+Math.imul(al1,bl1)|0,mid=mid+Math.imul(al1,bh1)|0,mid=mid+Math.imul(ah1,bl1)|0,hi=hi+Math.imul(ah1,bh1)|0,lo=lo+Math.imul(al0,bl2)|0,mid=mid+Math.imul(al0,bh2)|0,mid=mid+Math.imul(ah0,bl2)|0,hi=hi+Math.imul(ah0,bh2)|0;var w2=(c+lo|0)+((8191&mid)<<13)|0;c=(hi+(mid>>>13)|0)+(w2>>>26)|0,w2&=67108863,lo=Math.imul(al3,bl0),mid=Math.imul(al3,bh0),mid=mid+Math.imul(ah3,bl0)|0,hi=Math.imul(ah3,bh0),lo=lo+Math.imul(al2,bl1)|0,mid=mid+Math.imul(al2,bh1)|0,mid=mid+Math.imul(ah2,bl1)|0,hi=hi+Math.imul(ah2,bh1)|0,lo=lo+Math.imul(al1,bl2)|0,mid=mid+Math.imul(al1,bh2)|0,mid=mid+Math.imul(ah1,bl2)|0,hi=hi+Math.imul(ah1,bh2)|0,lo=lo+Math.imul(al0,bl3)|0,mid=mid+Math.imul(al0,bh3)|0,mid=mid+Math.imul(ah0,bl3)|0,hi=hi+Math.imul(ah0,bh3)|0;var w3=(c+lo|0)+((8191&mid)<<13)|0;c=(hi+(mid>>>13)|0)+(w3>>>26)|0,w3&=67108863,lo=Math.imul(al4,bl0),mid=Math.imul(al4,bh0),mid=mid+Math.imul(ah4,bl0)|0,hi=Math.imul(ah4,bh0),lo=lo+Math.imul(al3,bl1)|0,mid=mid+Math.imul(al3,bh1)|0,mid=mid+Math.imul(ah3,bl1)|0,hi=hi+Math.imul(ah3,bh1)|0,lo=lo+Math.imul(al2,bl2)|0,mid=mid+Math.imul(al2,bh2)|0,mid=mid+Math.imul(ah2,bl2)|0,hi=hi+Math.imul(ah2,bh2)|0,lo=lo+Math.imul(al1,bl3)|0,mid=mid+Math.imul(al1,bh3)|0,mid=mid+Math.imul(ah1,bl3)|0,hi=hi+Math.imul(ah1,bh3)|0,lo=lo+Math.imul(al0,bl4)|0,mid=mid+Math.imul(al0,bh4)|0,mid=mid+Math.imul(ah0,bl4)|0,hi=hi+Math.imul(ah0,bh4)|0;var w4=(c+lo|0)+((8191&mid)<<13)|0;c=(hi+(mid>>>13)|0)+(w4>>>26)|0,w4&=67108863,lo=Math.imul(al5,bl0),mid=Math.imul(al5,bh0),mid=mid+Math.imul(ah5,bl0)|0,hi=Math.imul(ah5,bh0),lo=lo+Math.imul(al4,bl1)|0,mid=mid+Math.imul(al4,bh1)|0,mid=mid+Math.imul(ah4,bl1)|0,hi=hi+Math.imul(ah4,bh1)|0,lo=lo+Math.imul(al3,bl2)|0,mid=mid+Math.imul(al3,bh2)|0,mid=mid+Math.imul(ah3,bl2)|0,hi=hi+Math.imul(ah3,bh2)|0,lo=lo+Math.imul(al2,bl3)|0,mid=mid+Math.imul(al2,bh3)|0,mid=mid+Math.imul(ah2,bl3)|0,hi=hi+Math.imul(ah2,bh3)|0,lo=lo+Math.imul(al1,bl4)|0,mid=mid+Math.imul(al1,bh4)|0,mid=mid+Math.imul(ah1,bl4)|0,hi=hi+Math.imul(ah1,bh4)|0,lo=lo+Math.imul(al0,bl5)|0,mid=mid+Math.imul(al0,bh5)|0,mid=mid+Math.imul(ah0,bl5)|0,hi=hi+Math.imul(ah0,bh5)|0;var w5=(c+lo|0)+((8191&mid)<<13)|0;c=(hi+(mid>>>13)|0)+(w5>>>26)|0,w5&=67108863,lo=Math.imul(al6,bl0),mid=Math.imul(al6,bh0),mid=mid+Math.imul(ah6,bl0)|0,hi=Math.imul(ah6,bh0),lo=lo+Math.imul(al5,bl1)|0,mid=mid+Math.imul(al5,bh1)|0,mid=mid+Math.imul(ah5,bl1)|0,hi=hi+Math.imul(ah5,bh1)|0,lo=lo+Math.imul(al4,bl2)|0,mid=mid+Math.imul(al4,bh2)|0,mid=mid+Math.imul(ah4,bl2)|0,hi=hi+Math.imul(ah4,bh2)|0,lo=lo+Math.imul(al3,bl3)|0,mid=mid+Math.imul(al3,bh3)|0,mid=mid+Math.imul(ah3,bl3)|0,hi=hi+Math.imul(ah3,bh3)|0,lo=lo+Math.imul(al2,bl4)|0,mid=mid+Math.imul(al2,bh4)|0,mid=mid+Math.imul(ah2,bl4)|0,hi=hi+Math.imul(ah2,bh4)|0,lo=lo+Math.imul(al1,bl5)|0,mid=mid+Math.imul(al1,bh5)|0,mid=mid+Math.imul(ah1,bl5)|0,hi=hi+Math.imul(ah1,bh5)|0,lo=lo+Math.imul(al0,bl6)|0,mid=mid+Math.imul(al0,bh6)|0,mid=mid+Math.imul(ah0,bl6)|0,hi=hi+Math.imul(ah0,bh6)|0;var w6=(c+lo|0)+((8191&mid)<<13)|0;c=(hi+(mid>>>13)|0)+(w6>>>26)|0,w6&=67108863,lo=Math.imul(al7,bl0),mid=Math.imul(al7,bh0),mid=mid+Math.imul(ah7,bl0)|0,hi=Math.imul(ah7,bh0),lo=lo+Math.imul(al6,bl1)|0,mid=mid+Math.imul(al6,bh1)|0,mid=mid+Math.imul(ah6,bl1)|0,hi=hi+Math.imul(ah6,bh1)|0,lo=lo+Math.imul(al5,bl2)|0,mid=mid+Math.imul(al5,bh2)|0,mid=mid+Math.imul(ah5,bl2)|0,hi=hi+Math.imul(ah5,bh2)|0,lo=lo+Math.imul(al4,bl3)|0,mid=mid+Math.imul(al4,bh3)|0,mid=mid+Math.imul(ah4,bl3)|0,hi=hi+Math.imul(ah4,bh3)|0,lo=lo+Math.imul(al3,bl4)|0,mid=mid+Math.imul(al3,bh4)|0,mid=mid+Math.imul(ah3,bl4)|0,hi=hi+Math.imul(ah3,bh4)|0,lo=lo+Math.imul(al2,bl5)|0,mid=mid+Math.imul(al2,bh5)|0,mid=mid+Math.imul(ah2,bl5)|0,hi=hi+Math.imul(ah2,bh5)|0,lo=lo+Math.imul(al1,bl6)|0,mid=mid+Math.imul(al1,bh6)|0,mid=mid+Math.imul(ah1,bl6)|0,hi=hi+Math.imul(ah1,bh6)|0,lo=lo+Math.imul(al0,bl7)|0,mid=mid+Math.imul(al0,bh7)|0,mid=mid+Math.imul(ah0,bl7)|0,hi=hi+Math.imul(ah0,bh7)|0;var w7=(c+lo|0)+((8191&mid)<<13)|0;c=(hi+(mid>>>13)|0)+(w7>>>26)|0,w7&=67108863,lo=Math.imul(al8,bl0),mid=Math.imul(al8,bh0),mid=mid+Math.imul(ah8,bl0)|0,hi=Math.imul(ah8,bh0),lo=lo+Math.imul(al7,bl1)|0,mid=mid+Math.imul(al7,bh1)|0,mid=mid+Math.imul(ah7,bl1)|0,hi=hi+Math.imul(ah7,bh1)|0,lo=lo+Math.imul(al6,bl2)|0,mid=mid+Math.imul(al6,bh2)|0,mid=mid+Math.imul(ah6,bl2)|0,hi=hi+Math.imul(ah6,bh2)|0,lo=lo+Math.imul(al5,bl3)|0,mid=mid+Math.imul(al5,bh3)|0,mid=mid+Math.imul(ah5,bl3)|0,hi=hi+Math.imul(ah5,bh3)|0,lo=lo+Math.imul(al4,bl4)|0,mid=mid+Math.imul(al4,bh4)|0,mid=mid+Math.imul(ah4,bl4)|0,hi=hi+Math.imul(ah4,bh4)|0,lo=lo+Math.imul(al3,bl5)|0,mid=mid+Math.imul(al3,bh5)|0,mid=mid+Math.imul(ah3,bl5)|0,hi=hi+Math.imul(ah3,bh5)|0,lo=lo+Math.imul(al2,bl6)|0,mid=mid+Math.imul(al2,bh6)|0,mid=mid+Math.imul(ah2,bl6)|0,hi=hi+Math.imul(ah2,bh6)|0,lo=lo+Math.imul(al1,bl7)|0,mid=mid+Math.imul(al1,bh7)|0,mid=mid+Math.imul(ah1,bl7)|0,hi=hi+Math.imul(ah1,bh7)|0,lo=lo+Math.imul(al0,bl8)|0,mid=mid+Math.imul(al0,bh8)|0,mid=mid+Math.imul(ah0,bl8)|0,hi=hi+Math.imul(ah0,bh8)|0;var w8=(c+lo|0)+((8191&mid)<<13)|0;c=(hi+(mid>>>13)|0)+(w8>>>26)|0,w8&=67108863,lo=Math.imul(al9,bl0),mid=Math.imul(al9,bh0),mid=mid+Math.imul(ah9,bl0)|0,hi=Math.imul(ah9,bh0),lo=lo+Math.imul(al8,bl1)|0,mid=mid+Math.imul(al8,bh1)|0,mid=mid+Math.imul(ah8,bl1)|0,hi=hi+Math.imul(ah8,bh1)|0,lo=lo+Math.imul(al7,bl2)|0,mid=mid+Math.imul(al7,bh2)|0,mid=mid+Math.imul(ah7,bl2)|0,hi=hi+Math.imul(ah7,bh2)|0,lo=lo+Math.imul(al6,bl3)|0,mid=mid+Math.imul(al6,bh3)|0,mid=mid+Math.imul(ah6,bl3)|0,hi=hi+Math.imul(ah6,bh3)|0,lo=lo+Math.imul(al5,bl4)|0,mid=mid+Math.imul(al5,bh4)|0,mid=mid+Math.imul(ah5,bl4)|0,hi=hi+Math.imul(ah5,bh4)|0,lo=lo+Math.imul(al4,bl5)|0,mid=mid+Math.imul(al4,bh5)|0,mid=mid+Math.imul(ah4,bl5)|0,hi=hi+Math.imul(ah4,bh5)|0,lo=lo+Math.imul(al3,bl6)|0,mid=mid+Math.imul(al3,bh6)|0,mid=mid+Math.imul(ah3,bl6)|0,hi=hi+Math.imul(ah3,bh6)|0,lo=lo+Math.imul(al2,bl7)|0,mid=mid+Math.imul(al2,bh7)|0,mid=mid+Math.imul(ah2,bl7)|0,hi=hi+Math.imul(ah2,bh7)|0,lo=lo+Math.imul(al1,bl8)|0,mid=mid+Math.imul(al1,bh8)|0,mid=mid+Math.imul(ah1,bl8)|0,hi=hi+Math.imul(ah1,bh8)|0,lo=lo+Math.imul(al0,bl9)|0,mid=mid+Math.imul(al0,bh9)|0,mid=mid+Math.imul(ah0,bl9)|0,hi=hi+Math.imul(ah0,bh9)|0;var w9=(c+lo|0)+((8191&mid)<<13)|0;c=(hi+(mid>>>13)|0)+(w9>>>26)|0,w9&=67108863,lo=Math.imul(al9,bl1),mid=Math.imul(al9,bh1),mid=mid+Math.imul(ah9,bl1)|0,hi=Math.imul(ah9,bh1),lo=lo+Math.imul(al8,bl2)|0,mid=mid+Math.imul(al8,bh2)|0,mid=mid+Math.imul(ah8,bl2)|0,hi=hi+Math.imul(ah8,bh2)|0,lo=lo+Math.imul(al7,bl3)|0,mid=mid+Math.imul(al7,bh3)|0,mid=mid+Math.imul(ah7,bl3)|0,hi=hi+Math.imul(ah7,bh3)|0,lo=lo+Math.imul(al6,bl4)|0,mid=mid+Math.imul(al6,bh4)|0,mid=mid+Math.imul(ah6,bl4)|0,hi=hi+Math.imul(ah6,bh4)|0,lo=lo+Math.imul(al5,bl5)|0,mid=mid+Math.imul(al5,bh5)|0,mid=mid+Math.imul(ah5,bl5)|0,hi=hi+Math.imul(ah5,bh5)|0,lo=lo+Math.imul(al4,bl6)|0,mid=mid+Math.imul(al4,bh6)|0,mid=mid+Math.imul(ah4,bl6)|0,hi=hi+Math.imul(ah4,bh6)|0,lo=lo+Math.imul(al3,bl7)|0,mid=mid+Math.imul(al3,bh7)|0,mid=mid+Math.imul(ah3,bl7)|0,hi=hi+Math.imul(ah3,bh7)|0,lo=lo+Math.imul(al2,bl8)|0,mid=mid+Math.imul(al2,bh8)|0,mid=mid+Math.imul(ah2,bl8)|0,hi=hi+Math.imul(ah2,bh8)|0,lo=lo+Math.imul(al1,bl9)|0,mid=mid+Math.imul(al1,bh9)|0,mid=mid+Math.imul(ah1,bl9)|0,hi=hi+Math.imul(ah1,bh9)|0;var w10=(c+lo|0)+((8191&mid)<<13)|0;c=(hi+(mid>>>13)|0)+(w10>>>26)|0,w10&=67108863,lo=Math.imul(al9,bl2),mid=Math.imul(al9,bh2),mid=mid+Math.imul(ah9,bl2)|0,hi=Math.imul(ah9,bh2),lo=lo+Math.imul(al8,bl3)|0,mid=mid+Math.imul(al8,bh3)|0,mid=mid+Math.imul(ah8,bl3)|0,hi=hi+Math.imul(ah8,bh3)|0,lo=lo+Math.imul(al7,bl4)|0,mid=mid+Math.imul(al7,bh4)|0,mid=mid+Math.imul(ah7,bl4)|0,hi=hi+Math.imul(ah7,bh4)|0,lo=lo+Math.imul(al6,bl5)|0,mid=mid+Math.imul(al6,bh5)|0,mid=mid+Math.imul(ah6,bl5)|0,hi=hi+Math.imul(ah6,bh5)|0,lo=lo+Math.imul(al5,bl6)|0,mid=mid+Math.imul(al5,bh6)|0,mid=mid+Math.imul(ah5,bl6)|0,hi=hi+Math.imul(ah5,bh6)|0,lo=lo+Math.imul(al4,bl7)|0,mid=mid+Math.imul(al4,bh7)|0,mid=mid+Math.imul(ah4,bl7)|0,hi=hi+Math.imul(ah4,bh7)|0,lo=lo+Math.imul(al3,bl8)|0,mid=mid+Math.imul(al3,bh8)|0,mid=mid+Math.imul(ah3,bl8)|0,hi=hi+Math.imul(ah3,bh8)|0,lo=lo+Math.imul(al2,bl9)|0,mid=mid+Math.imul(al2,bh9)|0,mid=mid+Math.imul(ah2,bl9)|0,hi=hi+Math.imul(ah2,bh9)|0;var w11=(c+lo|0)+((8191&mid)<<13)|0;c=(hi+(mid>>>13)|0)+(w11>>>26)|0,w11&=67108863,lo=Math.imul(al9,bl3),
mid=Math.imul(al9,bh3),mid=mid+Math.imul(ah9,bl3)|0,hi=Math.imul(ah9,bh3),lo=lo+Math.imul(al8,bl4)|0,mid=mid+Math.imul(al8,bh4)|0,mid=mid+Math.imul(ah8,bl4)|0,hi=hi+Math.imul(ah8,bh4)|0,lo=lo+Math.imul(al7,bl5)|0,mid=mid+Math.imul(al7,bh5)|0,mid=mid+Math.imul(ah7,bl5)|0,hi=hi+Math.imul(ah7,bh5)|0,lo=lo+Math.imul(al6,bl6)|0,mid=mid+Math.imul(al6,bh6)|0,mid=mid+Math.imul(ah6,bl6)|0,hi=hi+Math.imul(ah6,bh6)|0,lo=lo+Math.imul(al5,bl7)|0,mid=mid+Math.imul(al5,bh7)|0,mid=mid+Math.imul(ah5,bl7)|0,hi=hi+Math.imul(ah5,bh7)|0,lo=lo+Math.imul(al4,bl8)|0,mid=mid+Math.imul(al4,bh8)|0,mid=mid+Math.imul(ah4,bl8)|0,hi=hi+Math.imul(ah4,bh8)|0,lo=lo+Math.imul(al3,bl9)|0,mid=mid+Math.imul(al3,bh9)|0,mid=mid+Math.imul(ah3,bl9)|0,hi=hi+Math.imul(ah3,bh9)|0;var w12=(c+lo|0)+((8191&mid)<<13)|0;c=(hi+(mid>>>13)|0)+(w12>>>26)|0,w12&=67108863,lo=Math.imul(al9,bl4),mid=Math.imul(al9,bh4),mid=mid+Math.imul(ah9,bl4)|0,hi=Math.imul(ah9,bh4),lo=lo+Math.imul(al8,bl5)|0,mid=mid+Math.imul(al8,bh5)|0,mid=mid+Math.imul(ah8,bl5)|0,hi=hi+Math.imul(ah8,bh5)|0,lo=lo+Math.imul(al7,bl6)|0,mid=mid+Math.imul(al7,bh6)|0,mid=mid+Math.imul(ah7,bl6)|0,hi=hi+Math.imul(ah7,bh6)|0,lo=lo+Math.imul(al6,bl7)|0,mid=mid+Math.imul(al6,bh7)|0,mid=mid+Math.imul(ah6,bl7)|0,hi=hi+Math.imul(ah6,bh7)|0,lo=lo+Math.imul(al5,bl8)|0,mid=mid+Math.imul(al5,bh8)|0,mid=mid+Math.imul(ah5,bl8)|0,hi=hi+Math.imul(ah5,bh8)|0,lo=lo+Math.imul(al4,bl9)|0,mid=mid+Math.imul(al4,bh9)|0,mid=mid+Math.imul(ah4,bl9)|0,hi=hi+Math.imul(ah4,bh9)|0;var w13=(c+lo|0)+((8191&mid)<<13)|0;c=(hi+(mid>>>13)|0)+(w13>>>26)|0,w13&=67108863,lo=Math.imul(al9,bl5),mid=Math.imul(al9,bh5),mid=mid+Math.imul(ah9,bl5)|0,hi=Math.imul(ah9,bh5),lo=lo+Math.imul(al8,bl6)|0,mid=mid+Math.imul(al8,bh6)|0,mid=mid+Math.imul(ah8,bl6)|0,hi=hi+Math.imul(ah8,bh6)|0,lo=lo+Math.imul(al7,bl7)|0,mid=mid+Math.imul(al7,bh7)|0,mid=mid+Math.imul(ah7,bl7)|0,hi=hi+Math.imul(ah7,bh7)|0,lo=lo+Math.imul(al6,bl8)|0,mid=mid+Math.imul(al6,bh8)|0,mid=mid+Math.imul(ah6,bl8)|0,hi=hi+Math.imul(ah6,bh8)|0,lo=lo+Math.imul(al5,bl9)|0,mid=mid+Math.imul(al5,bh9)|0,mid=mid+Math.imul(ah5,bl9)|0,hi=hi+Math.imul(ah5,bh9)|0;var w14=(c+lo|0)+((8191&mid)<<13)|0;c=(hi+(mid>>>13)|0)+(w14>>>26)|0,w14&=67108863,lo=Math.imul(al9,bl6),mid=Math.imul(al9,bh6),mid=mid+Math.imul(ah9,bl6)|0,hi=Math.imul(ah9,bh6),lo=lo+Math.imul(al8,bl7)|0,mid=mid+Math.imul(al8,bh7)|0,mid=mid+Math.imul(ah8,bl7)|0,hi=hi+Math.imul(ah8,bh7)|0,lo=lo+Math.imul(al7,bl8)|0,mid=mid+Math.imul(al7,bh8)|0,mid=mid+Math.imul(ah7,bl8)|0,hi=hi+Math.imul(ah7,bh8)|0,lo=lo+Math.imul(al6,bl9)|0,mid=mid+Math.imul(al6,bh9)|0,mid=mid+Math.imul(ah6,bl9)|0,hi=hi+Math.imul(ah6,bh9)|0;var w15=(c+lo|0)+((8191&mid)<<13)|0;c=(hi+(mid>>>13)|0)+(w15>>>26)|0,w15&=67108863,lo=Math.imul(al9,bl7),mid=Math.imul(al9,bh7),mid=mid+Math.imul(ah9,bl7)|0,hi=Math.imul(ah9,bh7),lo=lo+Math.imul(al8,bl8)|0,mid=mid+Math.imul(al8,bh8)|0,mid=mid+Math.imul(ah8,bl8)|0,hi=hi+Math.imul(ah8,bh8)|0,lo=lo+Math.imul(al7,bl9)|0,mid=mid+Math.imul(al7,bh9)|0,mid=mid+Math.imul(ah7,bl9)|0,hi=hi+Math.imul(ah7,bh9)|0;var w16=(c+lo|0)+((8191&mid)<<13)|0;c=(hi+(mid>>>13)|0)+(w16>>>26)|0,w16&=67108863,lo=Math.imul(al9,bl8),mid=Math.imul(al9,bh8),mid=mid+Math.imul(ah9,bl8)|0,hi=Math.imul(ah9,bh8),lo=lo+Math.imul(al8,bl9)|0,mid=mid+Math.imul(al8,bh9)|0,mid=mid+Math.imul(ah8,bl9)|0,hi=hi+Math.imul(ah8,bh9)|0;var w17=(c+lo|0)+((8191&mid)<<13)|0;c=(hi+(mid>>>13)|0)+(w17>>>26)|0,w17&=67108863,lo=Math.imul(al9,bl9),mid=Math.imul(al9,bh9),mid=mid+Math.imul(ah9,bl9)|0,hi=Math.imul(ah9,bh9);var w18=(c+lo|0)+((8191&mid)<<13)|0;return c=(hi+(mid>>>13)|0)+(w18>>>26)|0,w18&=67108863,o[0]=w0,o[1]=w1,o[2]=w2,o[3]=w3,o[4]=w4,o[5]=w5,o[6]=w6,o[7]=w7,o[8]=w8,o[9]=w9,o[10]=w10,o[11]=w11,o[12]=w12,o[13]=w13,o[14]=w14,o[15]=w15,o[16]=w16,o[17]=w17,o[18]=w18,0!==c&&(o[19]=c,out.length++),out};Math.imul||(comb10MulTo=smallMulTo),BN.prototype.mulTo=function(num,out){var res,len=this.length+num.length;return res=10===this.length&&10===num.length?comb10MulTo(this,num,out):len<63?smallMulTo(this,num,out):len<1024?bigMulTo(this,num,out):jumboMulTo(this,num,out)},FFTM.prototype.makeRBT=function(N){for(var t=new Array(N),l=BN.prototype._countBits(N)-1,i=0;i<N;i++)t[i]=this.revBin(i,l,N);return t},FFTM.prototype.revBin=function(x,l,N){if(0===x||x===N-1)return x;for(var rb=0,i=0;i<l;i++)rb|=(1&x)<<l-i-1,x>>=1;return rb},FFTM.prototype.permute=function(rbt,rws,iws,rtws,itws,N){for(var i=0;i<N;i++)rtws[i]=rws[rbt[i]],itws[i]=iws[rbt[i]]},FFTM.prototype.transform=function(rws,iws,rtws,itws,N,rbt){this.permute(rbt,rws,iws,rtws,itws,N);for(var s=1;s<N;s<<=1)for(var l=s<<1,rtwdf=Math.cos(2*Math.PI/l),itwdf=Math.sin(2*Math.PI/l),p=0;p<N;p+=l)for(var rtwdf_=rtwdf,itwdf_=itwdf,j=0;j<s;j++){var re=rtws[p+j],ie=itws[p+j],ro=rtws[p+j+s],io=itws[p+j+s],rx=rtwdf_*ro-itwdf_*io;io=rtwdf_*io+itwdf_*ro,ro=rx,rtws[p+j]=re+ro,itws[p+j]=ie+io,rtws[p+j+s]=re-ro,itws[p+j+s]=ie-io,j!==l&&(rx=rtwdf*rtwdf_-itwdf*itwdf_,itwdf_=rtwdf*itwdf_+itwdf*rtwdf_,rtwdf_=rx)}},FFTM.prototype.guessLen13b=function(n,m){var N=1|Math.max(m,n),odd=1&N,i=0;for(N=N/2|0;N;N>>>=1)i++;return 1<<i+1+odd},FFTM.prototype.conjugate=function(rws,iws,N){if(!(N<=1))for(var i=0;i<N/2;i++){var t=rws[i];rws[i]=rws[N-i-1],rws[N-i-1]=t,t=iws[i],iws[i]=-iws[N-i-1],iws[N-i-1]=-t}},FFTM.prototype.normalize13b=function(ws,N){for(var carry=0,i=0;i<N/2;i++){var w=8192*Math.round(ws[2*i+1]/N)+Math.round(ws[2*i]/N)+carry;ws[i]=67108863&w,carry=w<67108864?0:w/67108864|0}return ws},FFTM.prototype.convert13b=function(ws,len,rws,N){for(var carry=0,i=0;i<len;i++)carry+=0|ws[i],rws[2*i]=8191&carry,carry>>>=13,rws[2*i+1]=8191&carry,carry>>>=13;for(i=2*len;i<N;++i)rws[i]=0;assert(0===carry),assert(0===(carry&-8192))},FFTM.prototype.stub=function(N){for(var ph=new Array(N),i=0;i<N;i++)ph[i]=0;return ph},FFTM.prototype.mulp=function(x,y,out){var N=2*this.guessLen13b(x.length,y.length),rbt=this.makeRBT(N),_=this.stub(N),rws=new Array(N),rwst=new Array(N),iwst=new Array(N),nrws=new Array(N),nrwst=new Array(N),niwst=new Array(N),rmws=out.words;rmws.length=N,this.convert13b(x.words,x.length,rws,N),this.convert13b(y.words,y.length,nrws,N),this.transform(rws,_,rwst,iwst,N,rbt),this.transform(nrws,_,nrwst,niwst,N,rbt);for(var i=0;i<N;i++){var rx=rwst[i]*nrwst[i]-iwst[i]*niwst[i];iwst[i]=rwst[i]*niwst[i]+iwst[i]*nrwst[i],rwst[i]=rx}return this.conjugate(rwst,iwst,N),this.transform(rwst,iwst,rmws,_,N,rbt),this.conjugate(rmws,_,N),this.normalize13b(rmws,N),out.negative=x.negative^y.negative,out.length=x.length+y.length,out.strip()},BN.prototype.mul=function(num){var out=new BN(null);return out.words=new Array(this.length+num.length),this.mulTo(num,out)},BN.prototype.mulf=function(num){var out=new BN(null);return out.words=new Array(this.length+num.length),jumboMulTo(this,num,out)},BN.prototype.imul=function(num){return this.clone().mulTo(num,this)},BN.prototype.imuln=function(num){assert("number"==typeof num),assert(num<67108864);for(var carry=0,i=0;i<this.length;i++){var w=(0|this.words[i])*num,lo=(67108863&w)+(67108863&carry);carry>>=26,carry+=w/67108864|0,carry+=lo>>>26,this.words[i]=67108863&lo}return 0!==carry&&(this.words[i]=carry,this.length++),this},BN.prototype.muln=function(num){return this.clone().imuln(num)},BN.prototype.sqr=function(){return this.mul(this)},BN.prototype.isqr=function(){return this.imul(this.clone())},BN.prototype.pow=function(num){var w=toBitArray(num);if(0===w.length)return new BN(1);for(var res=this,i=0;i<w.length&&0===w[i];i++,res=res.sqr());if(++i<w.length)for(var q=res.sqr();i<w.length;i++,q=q.sqr())0!==w[i]&&(res=res.mul(q));return res},BN.prototype.iushln=function(bits){assert("number"==typeof bits&&bits>=0);var i,r=bits%26,s=(bits-r)/26,carryMask=67108863>>>26-r<<26-r;if(0!==r){var carry=0;for(i=0;i<this.length;i++){var newCarry=this.words[i]&carryMask,c=(0|this.words[i])-newCarry<<r;this.words[i]=c|carry,carry=newCarry>>>26-r}carry&&(this.words[i]=carry,this.length++)}if(0!==s){for(i=this.length-1;i>=0;i--)this.words[i+s]=this.words[i];for(i=0;i<s;i++)this.words[i]=0;this.length+=s}return this.strip()},BN.prototype.ishln=function(bits){return assert(0===this.negative),this.iushln(bits)},BN.prototype.iushrn=function(bits,hint,extended){assert("number"==typeof bits&&bits>=0);var h;h=hint?(hint-hint%26)/26:0;var r=bits%26,s=Math.min((bits-r)/26,this.length),mask=67108863^67108863>>>r<<r,maskedWords=extended;if(h-=s,h=Math.max(0,h),maskedWords){for(var i=0;i<s;i++)maskedWords.words[i]=this.words[i];maskedWords.length=s}if(0===s);else if(this.length>s)for(this.length-=s,i=0;i<this.length;i++)this.words[i]=this.words[i+s];else this.words[0]=0,this.length=1;var carry=0;for(i=this.length-1;i>=0&&(0!==carry||i>=h);i--){var word=0|this.words[i];this.words[i]=carry<<26-r|word>>>r,carry=word&mask}return maskedWords&&0!==carry&&(maskedWords.words[maskedWords.length++]=carry),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},BN.prototype.ishrn=function(bits,hint,extended){return assert(0===this.negative),this.iushrn(bits,hint,extended)},BN.prototype.shln=function(bits){return this.clone().ishln(bits)},BN.prototype.ushln=function(bits){return this.clone().iushln(bits)},BN.prototype.shrn=function(bits){return this.clone().ishrn(bits)},BN.prototype.ushrn=function(bits){return this.clone().iushrn(bits)},BN.prototype.testn=function(bit){assert("number"==typeof bit&&bit>=0);var r=bit%26,s=(bit-r)/26,q=1<<r;if(this.length<=s)return!1;var w=this.words[s];return!!(w&q)},BN.prototype.imaskn=function(bits){assert("number"==typeof bits&&bits>=0);var r=bits%26,s=(bits-r)/26;if(assert(0===this.negative,"imaskn works only with positive numbers"),this.length<=s)return this;if(0!==r&&s++,this.length=Math.min(s,this.length),0!==r){var mask=67108863^67108863>>>r<<r;this.words[this.length-1]&=mask}return this.strip()},BN.prototype.maskn=function(bits){return this.clone().imaskn(bits)},BN.prototype.iaddn=function(num){return assert("number"==typeof num),assert(num<67108864),num<0?this.isubn(-num):0!==this.negative?1===this.length&&(0|this.words[0])<num?(this.words[0]=num-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(num),this.negative=1,this):this._iaddn(num)},BN.prototype._iaddn=function(num){this.words[0]+=num;for(var i=0;i<this.length&&this.words[i]>=67108864;i++)this.words[i]-=67108864,i===this.length-1?this.words[i+1]=1:this.words[i+1]++;return this.length=Math.max(this.length,i+1),this},BN.prototype.isubn=function(num){if(assert("number"==typeof num),assert(num<67108864),num<0)return this.iaddn(-num);if(0!==this.negative)return this.negative=0,this.iaddn(num),this.negative=1,this;if(this.words[0]-=num,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var i=0;i<this.length&&this.words[i]<0;i++)this.words[i]+=67108864,this.words[i+1]-=1;return this.strip()},BN.prototype.addn=function(num){return this.clone().iaddn(num)},BN.prototype.subn=function(num){return this.clone().isubn(num)},BN.prototype.iabs=function(){return this.negative=0,this},BN.prototype.abs=function(){return this.clone().iabs()},BN.prototype._ishlnsubmul=function(num,mul,shift){var i,len=num.length+shift;this._expand(len);var w,carry=0;for(i=0;i<num.length;i++){w=(0|this.words[i+shift])+carry;var right=(0|num.words[i])*mul;w-=67108863&right,carry=(w>>26)-(right/67108864|0),this.words[i+shift]=67108863&w}for(;i<this.length-shift;i++)w=(0|this.words[i+shift])+carry,carry=w>>26,this.words[i+shift]=67108863&w;if(0===carry)return this.strip();for(assert(carry===-1),carry=0,i=0;i<this.length;i++)w=-(0|this.words[i])+carry,carry=w>>26,this.words[i]=67108863&w;return this.negative=1,this.strip()},BN.prototype._wordDiv=function(num,mode){var shift=this.length-num.length,a=this.clone(),b=num,bhi=0|b.words[b.length-1],bhiBits=this._countBits(bhi);shift=26-bhiBits,0!==shift&&(b=b.ushln(shift),a.iushln(shift),bhi=0|b.words[b.length-1]);var q,m=a.length-b.length;if("mod"!==mode){q=new BN(null),q.length=m+1,q.words=new Array(q.length);for(var i=0;i<q.length;i++)q.words[i]=0}var diff=a.clone()._ishlnsubmul(b,1,m);0===diff.negative&&(a=diff,q&&(q.words[m]=1));for(var j=m-1;j>=0;j--){var qj=67108864*(0|a.words[b.length+j])+(0|a.words[b.length+j-1]);for(qj=Math.min(qj/bhi|0,67108863),a._ishlnsubmul(b,qj,j);0!==a.negative;)qj--,a.negative=0,a._ishlnsubmul(b,1,j),a.isZero()||(a.negative^=1);q&&(q.words[j]=qj)}return q&&q.strip(),a.strip(),"div"!==mode&&0!==shift&&a.iushrn(shift),{div:q||null,mod:a}},BN.prototype.divmod=function(num,mode,positive){if(assert(!num.isZero()),this.isZero())return{div:new BN(0),mod:new BN(0)};var div,mod,res;return 0!==this.negative&&0===num.negative?(res=this.neg().divmod(num,mode),"mod"!==mode&&(div=res.div.neg()),"div"!==mode&&(mod=res.mod.neg(),positive&&0!==mod.negative&&mod.iadd(num)),{div:div,mod:mod}):0===this.negative&&0!==num.negative?(res=this.divmod(num.neg(),mode),"mod"!==mode&&(div=res.div.neg()),{div:div,mod:res.mod}):0!==(this.negative&num.negative)?(res=this.neg().divmod(num.neg(),mode),"div"!==mode&&(mod=res.mod.neg(),positive&&0!==mod.negative&&mod.isub(num)),{div:res.div,mod:mod}):num.length>this.length||this.cmp(num)<0?{div:new BN(0),mod:this}:1===num.length?"div"===mode?{div:this.divn(num.words[0]),mod:null}:"mod"===mode?{div:null,mod:new BN(this.modn(num.words[0]))}:{div:this.divn(num.words[0]),mod:new BN(this.modn(num.words[0]))}:this._wordDiv(num,mode)},BN.prototype.div=function(num){return this.divmod(num,"div",!1).div},BN.prototype.mod=function(num){return this.divmod(num,"mod",!1).mod},BN.prototype.umod=function(num){return this.divmod(num,"mod",!0).mod},BN.prototype.divRound=function(num){var dm=this.divmod(num);if(dm.mod.isZero())return dm.div;var mod=0!==dm.div.negative?dm.mod.isub(num):dm.mod,half=num.ushrn(1),r2=num.andln(1),cmp=mod.cmp(half);return cmp<0||1===r2&&0===cmp?dm.div:0!==dm.div.negative?dm.div.isubn(1):dm.div.iaddn(1)},BN.prototype.modn=function(num){assert(num<=67108863);for(var p=(1<<26)%num,acc=0,i=this.length-1;i>=0;i--)acc=(p*acc+(0|this.words[i]))%num;return acc},BN.prototype.idivn=function(num){assert(num<=67108863);for(var carry=0,i=this.length-1;i>=0;i--){var w=(0|this.words[i])+67108864*carry;this.words[i]=w/num|0,carry=w%num}return this.strip()},BN.prototype.divn=function(num){return this.clone().idivn(num)},BN.prototype.egcd=function(p){assert(0===p.negative),assert(!p.isZero());var x=this,y=p.clone();x=0!==x.negative?x.umod(p):x.clone();for(var A=new BN(1),B=new BN(0),C=new BN(0),D=new BN(1),g=0;x.isEven()&&y.isEven();)x.iushrn(1),y.iushrn(1),++g;for(var yp=y.clone(),xp=x.clone();!x.isZero();){for(var i=0,im=1;0===(x.words[0]&im)&&i<26;++i,im<<=1);if(i>0)for(x.iushrn(i);i-- >0;)(A.isOdd()||B.isOdd())&&(A.iadd(yp),B.isub(xp)),A.iushrn(1),B.iushrn(1);for(var j=0,jm=1;0===(y.words[0]&jm)&&j<26;++j,jm<<=1);if(j>0)for(y.iushrn(j);j-- >0;)(C.isOdd()||D.isOdd())&&(C.iadd(yp),D.isub(xp)),C.iushrn(1),D.iushrn(1);x.cmp(y)>=0?(x.isub(y),A.isub(C),B.isub(D)):(y.isub(x),C.isub(A),D.isub(B))}return{a:C,b:D,gcd:y.iushln(g)}},BN.prototype._invmp=function(p){assert(0===p.negative),assert(!p.isZero());var a=this,b=p.clone();a=0!==a.negative?a.umod(p):a.clone();for(var x1=new BN(1),x2=new BN(0),delta=b.clone();a.cmpn(1)>0&&b.cmpn(1)>0;){for(var i=0,im=1;0===(a.words[0]&im)&&i<26;++i,im<<=1);if(i>0)for(a.iushrn(i);i-- >0;)x1.isOdd()&&x1.iadd(delta),x1.iushrn(1);for(var j=0,jm=1;0===(b.words[0]&jm)&&j<26;++j,jm<<=1);if(j>0)for(b.iushrn(j);j-- >0;)x2.isOdd()&&x2.iadd(delta),x2.iushrn(1);a.cmp(b)>=0?(a.isub(b),x1.isub(x2)):(b.isub(a),x2.isub(x1))}var res;return res=0===a.cmpn(1)?x1:x2,res.cmpn(0)<0&&res.iadd(p),res},BN.prototype.gcd=function(num){if(this.isZero())return num.abs();if(num.isZero())return this.abs();var a=this.clone(),b=num.clone();a.negative=0,b.negative=0;for(var shift=0;a.isEven()&&b.isEven();shift++)a.iushrn(1),b.iushrn(1);for(;;){for(;a.isEven();)a.iushrn(1);for(;b.isEven();)b.iushrn(1);var r=a.cmp(b);if(r<0){var t=a;a=b,b=t}else if(0===r||0===b.cmpn(1))break;a.isub(b)}return b.iushln(shift)},BN.prototype.invm=function(num){return this.egcd(num).a.umod(num)},BN.prototype.isEven=function(){return 0===(1&this.words[0])},BN.prototype.isOdd=function(){return 1===(1&this.words[0])},BN.prototype.andln=function(num){return this.words[0]&num},BN.prototype.bincn=function(bit){assert("number"==typeof bit);var r=bit%26,s=(bit-r)/26,q=1<<r;if(this.length<=s)return this._expand(s+1),this.words[s]|=q,this;for(var carry=q,i=s;0!==carry&&i<this.length;i++){var w=0|this.words[i];w+=carry,carry=w>>>26,w&=67108863,this.words[i]=w}return 0!==carry&&(this.words[i]=carry,this.length++),this},BN.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},BN.prototype.cmpn=function(num){var negative=num<0;if(0!==this.negative&&!negative)return-1;if(0===this.negative&&negative)return 1;this.strip();var res;if(this.length>1)res=1;else{negative&&(num=-num),assert(num<=67108863,"Number is too big");var w=0|this.words[0];res=w===num?0:w<num?-1:1}return 0!==this.negative?0|-res:res},BN.prototype.cmp=function(num){if(0!==this.negative&&0===num.negative)return-1;if(0===this.negative&&0!==num.negative)return 1;var res=this.ucmp(num);return 0!==this.negative?0|-res:res},BN.prototype.ucmp=function(num){if(this.length>num.length)return 1;if(this.length<num.length)return-1;for(var res=0,i=this.length-1;i>=0;i--){var a=0|this.words[i],b=0|num.words[i];if(a!==b){a<b?res=-1:a>b&&(res=1);break}}return res},BN.prototype.gtn=function(num){return 1===this.cmpn(num)},BN.prototype.gt=function(num){return 1===this.cmp(num)},BN.prototype.gten=function(num){return this.cmpn(num)>=0},BN.prototype.gte=function(num){return this.cmp(num)>=0},BN.prototype.ltn=function(num){return this.cmpn(num)===-1},BN.prototype.lt=function(num){return this.cmp(num)===-1},BN.prototype.lten=function(num){return this.cmpn(num)<=0},BN.prototype.lte=function(num){return this.cmp(num)<=0},BN.prototype.eqn=function(num){return 0===this.cmpn(num)},BN.prototype.eq=function(num){return 0===this.cmp(num)},BN.red=function(num){return new Red(num)},BN.prototype.toRed=function(ctx){return assert(!this.red,"Already a number in reduction context"),assert(0===this.negative,"red works only with positives"),ctx.convertTo(this)._forceRed(ctx)},BN.prototype.fromRed=function(){return assert(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},BN.prototype._forceRed=function(ctx){return this.red=ctx,this},BN.prototype.forceRed=function(ctx){return assert(!this.red,"Already a number in reduction context"),this._forceRed(ctx)},BN.prototype.redAdd=function(num){return assert(this.red,"redAdd works only with red numbers"),this.red.add(this,num)},BN.prototype.redIAdd=function(num){return assert(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,num)},BN.prototype.redSub=function(num){return assert(this.red,"redSub works only with red numbers"),this.red.sub(this,num)},BN.prototype.redISub=function(num){return assert(this.red,"redISub works only with red numbers"),this.red.isub(this,num)},BN.prototype.redShl=function(num){return assert(this.red,"redShl works only with red numbers"),this.red.shl(this,num)},BN.prototype.redMul=function(num){return assert(this.red,"redMul works only with red numbers"),this.red._verify2(this,num),this.red.mul(this,num)},BN.prototype.redIMul=function(num){return assert(this.red,"redMul works only with red numbers"),this.red._verify2(this,num),this.red.imul(this,num)},BN.prototype.redSqr=function(){return assert(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},BN.prototype.redISqr=function(){return assert(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},BN.prototype.redSqrt=function(){return assert(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},BN.prototype.redInvm=function(){return assert(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},BN.prototype.redNeg=function(){return assert(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},BN.prototype.redPow=function(num){return assert(this.red&&!num.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,num)};var primes={k256:null,p224:null,p192:null,p25519:null};MPrime.prototype._tmp=function(){var tmp=new BN(null);return tmp.words=new Array(Math.ceil(this.n/13)),tmp},MPrime.prototype.ireduce=function(num){var rlen,r=num;do this.split(r,this.tmp),r=this.imulK(r),r=r.iadd(this.tmp),rlen=r.bitLength();while(rlen>this.n);var cmp=rlen<this.n?-1:r.ucmp(this.p);return 0===cmp?(r.words[0]=0,r.length=1):cmp>0?r.isub(this.p):r.strip(),r},MPrime.prototype.split=function(input,out){input.iushrn(this.n,0,out)},MPrime.prototype.imulK=function(num){return num.imul(this.k)},inherits(K256,MPrime),K256.prototype.split=function(input,output){for(var mask=4194303,outLen=Math.min(input.length,9),i=0;i<outLen;i++)output.words[i]=input.words[i];if(output.length=outLen,input.length<=9)return input.words[0]=0,void(input.length=1);var prev=input.words[9];for(output.words[output.length++]=prev&mask,i=10;i<input.length;i++){var next=0|input.words[i];input.words[i-10]=(next&mask)<<4|prev>>>22,prev=next}prev>>>=22,input.words[i-10]=prev,0===prev&&input.length>10?input.length-=10:input.length-=9},K256.prototype.imulK=function(num){num.words[num.length]=0,num.words[num.length+1]=0,num.length+=2;for(var lo=0,i=0;i<num.length;i++){var w=0|num.words[i];lo+=977*w,num.words[i]=67108863&lo,lo=64*w+(lo/67108864|0)}return 0===num.words[num.length-1]&&(num.length--,0===num.words[num.length-1]&&num.length--),num},inherits(P224,MPrime),inherits(P192,MPrime),inherits(P25519,MPrime),P25519.prototype.imulK=function(num){for(var carry=0,i=0;i<num.length;i++){var hi=19*(0|num.words[i])+carry,lo=67108863&hi;hi>>>=26,num.words[i]=lo,carry=hi}return 0!==carry&&(num.words[num.length++]=carry),num},BN._prime=function prime(name){if(primes[name])return primes[name];var prime;if("k256"===name)prime=new K256;else if("p224"===name)prime=new P224;else if("p192"===name)prime=new P192;else{if("p25519"!==name)throw new Error("Unknown prime "+name);prime=new P25519}return primes[name]=prime,prime},Red.prototype._verify1=function(a){assert(0===a.negative,"red works only with positives"),assert(a.red,"red works only with red numbers")},Red.prototype._verify2=function(a,b){assert(0===(a.negative|b.negative),"red works only with positives"),assert(a.red&&a.red===b.red,"red works only with red numbers")},Red.prototype.imod=function(a){return this.prime?this.prime.ireduce(a)._forceRed(this):a.umod(this.m)._forceRed(this)},Red.prototype.neg=function(a){return a.isZero()?a.clone():this.m.sub(a)._forceRed(this)},Red.prototype.add=function(a,b){this._verify2(a,b);var res=a.add(b);return res.cmp(this.m)>=0&&res.isub(this.m),res._forceRed(this)},Red.prototype.iadd=function(a,b){this._verify2(a,b);var res=a.iadd(b);return res.cmp(this.m)>=0&&res.isub(this.m),res},Red.prototype.sub=function(a,b){this._verify2(a,b);var res=a.sub(b);return res.cmpn(0)<0&&res.iadd(this.m),res._forceRed(this)},Red.prototype.isub=function(a,b){this._verify2(a,b);var res=a.isub(b);return res.cmpn(0)<0&&res.iadd(this.m),res},Red.prototype.shl=function(a,num){return this._verify1(a),this.imod(a.ushln(num))},Red.prototype.imul=function(a,b){return this._verify2(a,b),this.imod(a.imul(b))},Red.prototype.mul=function(a,b){return this._verify2(a,b),this.imod(a.mul(b))},Red.prototype.isqr=function(a){return this.imul(a,a.clone())},Red.prototype.sqr=function(a){return this.mul(a,a)},Red.prototype.sqrt=function(a){if(a.isZero())return a.clone();var mod3=this.m.andln(3);if(assert(mod3%2===1),3===mod3){var pow=this.m.add(new BN(1)).iushrn(2);return this.pow(a,pow)}for(var q=this.m.subn(1),s=0;!q.isZero()&&0===q.andln(1);)s++,q.iushrn(1);assert(!q.isZero());var one=new BN(1).toRed(this),nOne=one.redNeg(),lpow=this.m.subn(1).iushrn(1),z=this.m.bitLength();for(z=new BN(2*z*z).toRed(this);0!==this.pow(z,lpow).cmp(nOne);)z.redIAdd(nOne);for(var c=this.pow(z,q),r=this.pow(a,q.addn(1).iushrn(1)),t=this.pow(a,q),m=s;0!==t.cmp(one);){for(var tmp=t,i=0;0!==tmp.cmp(one);i++)tmp=tmp.redSqr();assert(i<m);var b=this.pow(c,new BN(1).iushln(m-i-1));r=r.redMul(b),c=b.redSqr(),t=t.redMul(c),m=i}return r},Red.prototype.invm=function(a){var inv=a._invmp(this.m);return 0!==inv.negative?(inv.negative=0,this.imod(inv).redNeg()):this.imod(inv)},Red.prototype.pow=function(a,num){if(num.isZero())return new BN(1);if(0===num.cmpn(1))return a.clone();var windowSize=4,wnd=new Array(1<<windowSize);wnd[0]=new BN(1).toRed(this),wnd[1]=a;for(var i=2;i<wnd.length;i++)wnd[i]=this.mul(wnd[i-1],a);var res=wnd[0],current=0,currentLen=0,start=num.bitLength()%26;for(0===start&&(start=26),i=num.length-1;i>=0;i--){for(var word=num.words[i],j=start-1;j>=0;j--){var bit=word>>j&1;res!==wnd[0]&&(res=this.sqr(res)),0!==bit||0!==current?(current<<=1,current|=bit,currentLen++,(currentLen===windowSize||0===i&&0===j)&&(res=this.mul(res,wnd[current]),currentLen=0,current=0)):currentLen=0}start=26}return res},Red.prototype.convertTo=function(num){var r=num.umod(this.m);return r===num?r.clone():r},Red.prototype.convertFrom=function(num){var res=num.clone();return res.red=null,res},BN.mont=function(num){return new Mont(num)},inherits(Mont,Red),Mont.prototype.convertTo=function(num){return this.imod(num.ushln(this.shift))},Mont.prototype.convertFrom=function(num){var r=this.imod(num.mul(this.rinv));return r.red=null,r},Mont.prototype.imul=function(a,b){if(a.isZero()||b.isZero())return a.words[0]=0,a.length=1,a;var t=a.imul(b),c=t.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),u=t.isub(c).iushrn(this.shift),res=u;return u.cmp(this.m)>=0?res=u.isub(this.m):u.cmpn(0)<0&&(res=u.iadd(this.m)),res._forceRed(this)},Mont.prototype.mul=function(a,b){if(a.isZero()||b.isZero())return new BN(0)._forceRed(this);var t=a.mul(b),c=t.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),u=t.isub(c).iushrn(this.shift),res=u;return u.cmp(this.m)>=0?res=u.isub(this.m):u.cmpn(0)<0&&(res=u.iadd(this.m)),res._forceRed(this)},Mont.prototype.invm=function(a){var res=this.imod(a._invmp(this.m).mul(this.r2));return res._forceRed(this)}}("undefined"==typeof module||module,this)},{}],19:[function(_dereq_,module,exports){function Rand(rand){this.rand=rand}var r;if(module.exports=function(len){return r||(r=new Rand(null)),r.generate(len)},module.exports.Rand=Rand,Rand.prototype.generate=function(len){return this._rand(len)},Rand.prototype._rand=function(n){if(this.rand.getBytes)return this.rand.getBytes(n);for(var res=new Uint8Array(n),i=0;i<res.length;i++)res[i]=this.rand.getByte();return res},"object"==typeof self)self.crypto&&self.crypto.getRandomValues?Rand.prototype._rand=function(n){var arr=new Uint8Array(n);return self.crypto.getRandomValues(arr),arr}:self.msCrypto&&self.msCrypto.getRandomValues?Rand.prototype._rand=function(n){var arr=new Uint8Array(n);return self.msCrypto.getRandomValues(arr),arr}:"object"==typeof window&&(Rand.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var crypto=_dereq_("crypto");if("function"!=typeof crypto.randomBytes)throw new Error("Not supported");Rand.prototype._rand=function(n){return crypto.randomBytes(n)}}catch(e){}},{crypto:20}],20:[function(_dereq_,module,exports){},{}],21:[function(_dereq_,module,exports){(function(Buffer){function fixup_uint32(x){var ret,x_pos;return ret=x>uint_max||x<0?(x_pos=Math.abs(x)%uint_max,x<0?uint_max-x_pos:x_pos):x}function scrub_vec(v){for(var i=0;i<v.length;v++)v[i]=0;return!1}function Global(){this.SBOX=[],this.INV_SBOX=[],this.SUB_MIX=[[],[],[],[]],this.INV_SUB_MIX=[[],[],[],[]],this.init(),this.RCON=[0,1,2,4,8,16,32,64,128,27,54]}function bufferToArray(buf){for(var len=buf.length/4,out=new Array(len),i=-1;++i<len;)out[i]=buf.readUInt32BE(4*i);return out}function AES(key){this._key=bufferToArray(key),this._doReset()}var uint_max=Math.pow(2,32);Global.prototype.init=function(){var d,i,sx,t,x,x2,x4,x8,xi,_i;for(d=function(){var _i,_results;for(_results=[],i=_i=0;_i<256;i=++_i)i<128?_results.push(i<<1):_results.push(i<<1^283);return _results}(),x=0,xi=0,i=_i=0;_i<256;i=++_i)sx=xi^xi<<1^xi<<2^xi<<3^xi<<4,sx=sx>>>8^255&sx^99,this.SBOX[x]=sx,this.INV_SBOX[sx]=x,x2=d[x],x4=d[x2],x8=d[x4],t=257*d[sx]^16843008*sx,this.SUB_MIX[0][x]=t<<24|t>>>8,this.SUB_MIX[1][x]=t<<16|t>>>16,this.SUB_MIX[2][x]=t<<8|t>>>24,this.SUB_MIX[3][x]=t,t=16843009*x8^65537*x4^257*x2^16843008*x,this.INV_SUB_MIX[0][sx]=t<<24|t>>>8,this.INV_SUB_MIX[1][sx]=t<<16|t>>>16,this.INV_SUB_MIX[2][sx]=t<<8|t>>>24,this.INV_SUB_MIX[3][sx]=t,0===x?x=xi=1:(x=x2^d[d[d[x8^x2]]],xi^=d[d[xi]]);return!0};var G=new Global;AES.blockSize=16,AES.prototype.blockSize=AES.blockSize,AES.keySize=32,AES.prototype.keySize=AES.keySize,AES.prototype._doReset=function(){var invKsRow,keySize,keyWords,ksRow,ksRows,t;for(keyWords=this._key,keySize=keyWords.length,this._nRounds=keySize+6,ksRows=4*(this._nRounds+1),this._keySchedule=[],ksRow=0;ksRow<ksRows;ksRow++)this._keySchedule[ksRow]=ksRow<keySize?keyWords[ksRow]:(t=this._keySchedule[ksRow-1],ksRow%keySize===0?(t=t<<8|t>>>24,t=G.SBOX[t>>>24]<<24|G.SBOX[t>>>16&255]<<16|G.SBOX[t>>>8&255]<<8|G.SBOX[255&t],t^=G.RCON[ksRow/keySize|0]<<24):keySize>6&&ksRow%keySize===4?t=G.SBOX[t>>>24]<<24|G.SBOX[t>>>16&255]<<16|G.SBOX[t>>>8&255]<<8|G.SBOX[255&t]:void 0,this._keySchedule[ksRow-keySize]^t);for(this._invKeySchedule=[],invKsRow=0;invKsRow<ksRows;invKsRow++)ksRow=ksRows-invKsRow,t=this._keySchedule[ksRow-(invKsRow%4?0:4)],this._invKeySchedule[invKsRow]=invKsRow<4||ksRow<=4?t:G.INV_SUB_MIX[0][G.SBOX[t>>>24]]^G.INV_SUB_MIX[1][G.SBOX[t>>>16&255]]^G.INV_SUB_MIX[2][G.SBOX[t>>>8&255]]^G.INV_SUB_MIX[3][G.SBOX[255&t]];return!0},AES.prototype.encryptBlock=function(M){M=bufferToArray(new Buffer(M));var out=this._doCryptBlock(M,this._keySchedule,G.SUB_MIX,G.SBOX),buf=new Buffer(16);return buf.writeUInt32BE(out[0],0),buf.writeUInt32BE(out[1],4),buf.writeUInt32BE(out[2],8),buf.writeUInt32BE(out[3],12),buf},AES.prototype.decryptBlock=function(M){M=bufferToArray(new Buffer(M));var temp=[M[3],M[1]];M[1]=temp[0],M[3]=temp[1];var out=this._doCryptBlock(M,this._invKeySchedule,G.INV_SUB_MIX,G.INV_SBOX),buf=new Buffer(16);return buf.writeUInt32BE(out[0],0),buf.writeUInt32BE(out[3],4),buf.writeUInt32BE(out[2],8),buf.writeUInt32BE(out[1],12),buf},AES.prototype.scrub=function(){scrub_vec(this._keySchedule),scrub_vec(this._invKeySchedule),scrub_vec(this._key)},AES.prototype._doCryptBlock=function(M,keySchedule,SUB_MIX,SBOX){var ksRow,s0,s1,s2,s3,t0,t1,t2,t3;s0=M[0]^keySchedule[0],s1=M[1]^keySchedule[1],s2=M[2]^keySchedule[2],s3=M[3]^keySchedule[3],ksRow=4;for(var round=1;round<this._nRounds;round++)t0=SUB_MIX[0][s0>>>24]^SUB_MIX[1][s1>>>16&255]^SUB_MIX[2][s2>>>8&255]^SUB_MIX[3][255&s3]^keySchedule[ksRow++],t1=SUB_MIX[0][s1>>>24]^SUB_MIX[1][s2>>>16&255]^SUB_MIX[2][s3>>>8&255]^SUB_MIX[3][255&s0]^keySchedule[ksRow++],t2=SUB_MIX[0][s2>>>24]^SUB_MIX[1][s3>>>16&255]^SUB_MIX[2][s0>>>8&255]^SUB_MIX[3][255&s1]^keySchedule[ksRow++],t3=SUB_MIX[0][s3>>>24]^SUB_MIX[1][s0>>>16&255]^SUB_MIX[2][s1>>>8&255]^SUB_MIX[3][255&s2]^keySchedule[ksRow++],s0=t0,s1=t1,s2=t2,s3=t3;return t0=(SBOX[s0>>>24]<<24|SBOX[s1>>>16&255]<<16|SBOX[s2>>>8&255]<<8|SBOX[255&s3])^keySchedule[ksRow++],t1=(SBOX[s1>>>24]<<24|SBOX[s2>>>16&255]<<16|SBOX[s3>>>8&255]<<8|SBOX[255&s0])^keySchedule[ksRow++],t2=(SBOX[s2>>>24]<<24|SBOX[s3>>>16&255]<<16|SBOX[s0>>>8&255]<<8|SBOX[255&s1])^keySchedule[ksRow++],t3=(SBOX[s3>>>24]<<24|SBOX[s0>>>16&255]<<16|SBOX[s1>>>8&255]<<8|SBOX[255&s2])^keySchedule[ksRow++],[fixup_uint32(t0),fixup_uint32(t1),fixup_uint32(t2),fixup_uint32(t3)]},exports.AES=AES}).call(this,_dereq_("buffer").Buffer)},{buffer:49}],22:[function(_dereq_,module,exports){(function(Buffer){function StreamCipher(mode,key,iv,decrypt){if(!(this instanceof StreamCipher))return new StreamCipher(mode,key,iv);Transform.call(this),this._finID=Buffer.concat([iv,new Buffer([0,0,0,1])]),iv=Buffer.concat([iv,new Buffer([0,0,0,2])]),this._cipher=new aes.AES(key),
this._prev=new Buffer(iv.length),this._cache=new Buffer(""),this._secCache=new Buffer(""),this._decrypt=decrypt,this._alen=0,this._len=0,iv.copy(this._prev),this._mode=mode;var h=new Buffer(4);h.fill(0),this._ghash=new GHASH(this._cipher.encryptBlock(h)),this._authTag=null,this._called=!1}function xorTest(a,b){var out=0;a.length!==b.length&&out++;for(var len=Math.min(a.length,b.length),i=-1;++i<len;)out+=a[i]^b[i];return out}var aes=_dereq_("./aes"),Transform=_dereq_("cipher-base"),inherits=_dereq_("inherits"),GHASH=_dereq_("./ghash"),xor=_dereq_("buffer-xor");inherits(StreamCipher,Transform),module.exports=StreamCipher,StreamCipher.prototype._update=function(chunk){if(!this._called&&this._alen){var rump=16-this._alen%16;rump<16&&(rump=new Buffer(rump),rump.fill(0),this._ghash.update(rump))}this._called=!0;var out=this._mode.encrypt(this,chunk);return this._decrypt?this._ghash.update(chunk):this._ghash.update(out),this._len+=chunk.length,out},StreamCipher.prototype._final=function(){if(this._decrypt&&!this._authTag)throw new Error("Unsupported state or unable to authenticate data");var tag=xor(this._ghash.final(8*this._alen,8*this._len),this._cipher.encryptBlock(this._finID));if(this._decrypt){if(xorTest(tag,this._authTag))throw new Error("Unsupported state or unable to authenticate data")}else this._authTag=tag;this._cipher.scrub()},StreamCipher.prototype.getAuthTag=function(){if(!this._decrypt&&Buffer.isBuffer(this._authTag))return this._authTag;throw new Error("Attempting to get auth tag in unsupported state")},StreamCipher.prototype.setAuthTag=function(tag){if(!this._decrypt)throw new Error("Attempting to set auth tag in unsupported state");this._authTag=tag},StreamCipher.prototype.setAAD=function(buf){if(this._called)throw new Error("Attempting to set AAD in unsupported state");this._ghash.update(buf),this._alen+=buf.length}}).call(this,_dereq_("buffer").Buffer)},{"./aes":21,"./ghash":26,buffer:49,"buffer-xor":48,"cipher-base":50,inherits:112}],23:[function(_dereq_,module,exports){function getCiphers(){return Object.keys(modes)}var ciphers=_dereq_("./encrypter");exports.createCipher=exports.Cipher=ciphers.createCipher,exports.createCipheriv=exports.Cipheriv=ciphers.createCipheriv;var deciphers=_dereq_("./decrypter");exports.createDecipher=exports.Decipher=deciphers.createDecipher,exports.createDecipheriv=exports.Decipheriv=deciphers.createDecipheriv;var modes=_dereq_("./modes");exports.listCiphers=exports.getCiphers=getCiphers},{"./decrypter":24,"./encrypter":25,"./modes":27}],24:[function(_dereq_,module,exports){(function(Buffer){function Decipher(mode,key,iv){return this instanceof Decipher?(Transform.call(this),this._cache=new Splitter,this._last=void 0,this._cipher=new aes.AES(key),this._prev=new Buffer(iv.length),iv.copy(this._prev),this._mode=mode,void(this._autopadding=!0)):new Decipher(mode,key,iv)}function Splitter(){return this instanceof Splitter?void(this.cache=new Buffer("")):new Splitter}function unpad(last){for(var padded=last[15],i=-1;++i<padded;)if(last[i+(16-padded)]!==padded)throw new Error("unable to decrypt data");if(16!==padded)return last.slice(0,16-padded)}function createDecipheriv(suite,password,iv){var config=modes[suite.toLowerCase()];if(!config)throw new TypeError("invalid suite type");if("string"==typeof iv&&(iv=new Buffer(iv)),"string"==typeof password&&(password=new Buffer(password)),password.length!==config.key/8)throw new TypeError("invalid key length "+password.length);if(iv.length!==config.iv)throw new TypeError("invalid iv length "+iv.length);return"stream"===config.type?new StreamCipher(modelist[config.mode],password,iv,(!0)):"auth"===config.type?new AuthCipher(modelist[config.mode],password,iv,(!0)):new Decipher(modelist[config.mode],password,iv)}function createDecipher(suite,password){var config=modes[suite.toLowerCase()];if(!config)throw new TypeError("invalid suite type");var keys=ebtk(password,!1,config.key,config.iv);return createDecipheriv(suite,keys.key,keys.iv)}var aes=_dereq_("./aes"),Transform=_dereq_("cipher-base"),inherits=_dereq_("inherits"),modes=_dereq_("./modes"),StreamCipher=_dereq_("./streamCipher"),AuthCipher=_dereq_("./authCipher"),ebtk=_dereq_("evp_bytestokey");inherits(Decipher,Transform),Decipher.prototype._update=function(data){this._cache.add(data);for(var chunk,thing,out=[];chunk=this._cache.get(this._autopadding);)thing=this._mode.decrypt(this,chunk),out.push(thing);return Buffer.concat(out)},Decipher.prototype._final=function(){var chunk=this._cache.flush();if(this._autopadding)return unpad(this._mode.decrypt(this,chunk));if(chunk)throw new Error("data not multiple of block length")},Decipher.prototype.setAutoPadding=function(setTo){return this._autopadding=!!setTo,this},Splitter.prototype.add=function(data){this.cache=Buffer.concat([this.cache,data])},Splitter.prototype.get=function(autoPadding){var out;if(autoPadding){if(this.cache.length>16)return out=this.cache.slice(0,16),this.cache=this.cache.slice(16),out}else if(this.cache.length>=16)return out=this.cache.slice(0,16),this.cache=this.cache.slice(16),out;return null},Splitter.prototype.flush=function(){if(this.cache.length)return this.cache};var modelist={ECB:_dereq_("./modes/ecb"),CBC:_dereq_("./modes/cbc"),CFB:_dereq_("./modes/cfb"),CFB8:_dereq_("./modes/cfb8"),CFB1:_dereq_("./modes/cfb1"),OFB:_dereq_("./modes/ofb"),CTR:_dereq_("./modes/ctr"),GCM:_dereq_("./modes/ctr")};exports.createDecipher=createDecipher,exports.createDecipheriv=createDecipheriv}).call(this,_dereq_("buffer").Buffer)},{"./aes":21,"./authCipher":22,"./modes":27,"./modes/cbc":28,"./modes/cfb":29,"./modes/cfb1":30,"./modes/cfb8":31,"./modes/ctr":32,"./modes/ecb":33,"./modes/ofb":34,"./streamCipher":35,buffer:49,"cipher-base":50,evp_bytestokey:100,inherits:112}],25:[function(_dereq_,module,exports){(function(Buffer){function Cipher(mode,key,iv){return this instanceof Cipher?(Transform.call(this),this._cache=new Splitter,this._cipher=new aes.AES(key),this._prev=new Buffer(iv.length),iv.copy(this._prev),this._mode=mode,void(this._autopadding=!0)):new Cipher(mode,key,iv)}function Splitter(){return this instanceof Splitter?void(this.cache=new Buffer("")):new Splitter}function createCipheriv(suite,password,iv){var config=modes[suite.toLowerCase()];if(!config)throw new TypeError("invalid suite type");if("string"==typeof iv&&(iv=new Buffer(iv)),"string"==typeof password&&(password=new Buffer(password)),password.length!==config.key/8)throw new TypeError("invalid key length "+password.length);if(iv.length!==config.iv)throw new TypeError("invalid iv length "+iv.length);return"stream"===config.type?new StreamCipher(modelist[config.mode],password,iv):"auth"===config.type?new AuthCipher(modelist[config.mode],password,iv):new Cipher(modelist[config.mode],password,iv)}function createCipher(suite,password){var config=modes[suite.toLowerCase()];if(!config)throw new TypeError("invalid suite type");var keys=ebtk(password,!1,config.key,config.iv);return createCipheriv(suite,keys.key,keys.iv)}var aes=_dereq_("./aes"),Transform=_dereq_("cipher-base"),inherits=_dereq_("inherits"),modes=_dereq_("./modes"),ebtk=_dereq_("evp_bytestokey"),StreamCipher=_dereq_("./streamCipher"),AuthCipher=_dereq_("./authCipher");inherits(Cipher,Transform),Cipher.prototype._update=function(data){this._cache.add(data);for(var chunk,thing,out=[];chunk=this._cache.get();)thing=this._mode.encrypt(this,chunk),out.push(thing);return Buffer.concat(out)},Cipher.prototype._final=function(){var chunk=this._cache.flush();if(this._autopadding)return chunk=this._mode.encrypt(this,chunk),this._cipher.scrub(),chunk;if("10101010101010101010101010101010"!==chunk.toString("hex"))throw this._cipher.scrub(),new Error("data not multiple of block length")},Cipher.prototype.setAutoPadding=function(setTo){return this._autopadding=!!setTo,this},Splitter.prototype.add=function(data){this.cache=Buffer.concat([this.cache,data])},Splitter.prototype.get=function(){if(this.cache.length>15){var out=this.cache.slice(0,16);return this.cache=this.cache.slice(16),out}return null},Splitter.prototype.flush=function(){for(var len=16-this.cache.length,padBuff=new Buffer(len),i=-1;++i<len;)padBuff.writeUInt8(len,i);var out=Buffer.concat([this.cache,padBuff]);return out};var modelist={ECB:_dereq_("./modes/ecb"),CBC:_dereq_("./modes/cbc"),CFB:_dereq_("./modes/cfb"),CFB8:_dereq_("./modes/cfb8"),CFB1:_dereq_("./modes/cfb1"),OFB:_dereq_("./modes/ofb"),CTR:_dereq_("./modes/ctr"),GCM:_dereq_("./modes/ctr")};exports.createCipheriv=createCipheriv,exports.createCipher=createCipher}).call(this,_dereq_("buffer").Buffer)},{"./aes":21,"./authCipher":22,"./modes":27,"./modes/cbc":28,"./modes/cfb":29,"./modes/cfb1":30,"./modes/cfb8":31,"./modes/ctr":32,"./modes/ecb":33,"./modes/ofb":34,"./streamCipher":35,buffer:49,"cipher-base":50,evp_bytestokey:100,inherits:112}],26:[function(_dereq_,module,exports){(function(Buffer){function GHASH(key){this.h=key,this.state=new Buffer(16),this.state.fill(0),this.cache=new Buffer("")}function toArray(buf){return[buf.readUInt32BE(0),buf.readUInt32BE(4),buf.readUInt32BE(8),buf.readUInt32BE(12)]}function fromArray(out){out=out.map(fixup_uint32);var buf=new Buffer(16);return buf.writeUInt32BE(out[0],0),buf.writeUInt32BE(out[1],4),buf.writeUInt32BE(out[2],8),buf.writeUInt32BE(out[3],12),buf}function fixup_uint32(x){var ret,x_pos;return ret=x>uint_max||x<0?(x_pos=Math.abs(x)%uint_max,x<0?uint_max-x_pos:x_pos):x}function xor(a,b){return[a[0]^b[0],a[1]^b[1],a[2]^b[2],a[3]^b[3]]}var zeros=new Buffer(16);zeros.fill(0),module.exports=GHASH,GHASH.prototype.ghash=function(block){for(var i=-1;++i<block.length;)this.state[i]^=block[i];this._multiply()},GHASH.prototype._multiply=function(){for(var j,xi,lsb_Vi,Vi=toArray(this.h),Zi=[0,0,0,0],i=-1;++i<128;){for(xi=0!==(this.state[~~(i/8)]&1<<7-i%8),xi&&(Zi=xor(Zi,Vi)),lsb_Vi=0!==(1&Vi[3]),j=3;j>0;j--)Vi[j]=Vi[j]>>>1|(1&Vi[j-1])<<31;Vi[0]=Vi[0]>>>1,lsb_Vi&&(Vi[0]=Vi[0]^225<<24)}this.state=fromArray(Zi)},GHASH.prototype.update=function(buf){this.cache=Buffer.concat([this.cache,buf]);for(var chunk;this.cache.length>=16;)chunk=this.cache.slice(0,16),this.cache=this.cache.slice(16),this.ghash(chunk)},GHASH.prototype.final=function(abl,bl){return this.cache.length&&this.ghash(Buffer.concat([this.cache,zeros],16)),this.ghash(fromArray([0,abl,0,bl])),this.state};var uint_max=Math.pow(2,32)}).call(this,_dereq_("buffer").Buffer)},{buffer:49}],27:[function(_dereq_,module,exports){exports["aes-128-ecb"]={cipher:"AES",key:128,iv:0,mode:"ECB",type:"block"},exports["aes-192-ecb"]={cipher:"AES",key:192,iv:0,mode:"ECB",type:"block"},exports["aes-256-ecb"]={cipher:"AES",key:256,iv:0,mode:"ECB",type:"block"},exports["aes-128-cbc"]={cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},exports["aes-192-cbc"]={cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},exports["aes-256-cbc"]={cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},exports.aes128=exports["aes-128-cbc"],exports.aes192=exports["aes-192-cbc"],exports.aes256=exports["aes-256-cbc"],exports["aes-128-cfb"]={cipher:"AES",key:128,iv:16,mode:"CFB",type:"stream"},exports["aes-192-cfb"]={cipher:"AES",key:192,iv:16,mode:"CFB",type:"stream"},exports["aes-256-cfb"]={cipher:"AES",key:256,iv:16,mode:"CFB",type:"stream"},exports["aes-128-cfb8"]={cipher:"AES",key:128,iv:16,mode:"CFB8",type:"stream"},exports["aes-192-cfb8"]={cipher:"AES",key:192,iv:16,mode:"CFB8",type:"stream"},exports["aes-256-cfb8"]={cipher:"AES",key:256,iv:16,mode:"CFB8",type:"stream"},exports["aes-128-cfb1"]={cipher:"AES",key:128,iv:16,mode:"CFB1",type:"stream"},exports["aes-192-cfb1"]={cipher:"AES",key:192,iv:16,mode:"CFB1",type:"stream"},exports["aes-256-cfb1"]={cipher:"AES",key:256,iv:16,mode:"CFB1",type:"stream"},exports["aes-128-ofb"]={cipher:"AES",key:128,iv:16,mode:"OFB",type:"stream"},exports["aes-192-ofb"]={cipher:"AES",key:192,iv:16,mode:"OFB",type:"stream"},exports["aes-256-ofb"]={cipher:"AES",key:256,iv:16,mode:"OFB",type:"stream"},exports["aes-128-ctr"]={cipher:"AES",key:128,iv:16,mode:"CTR",type:"stream"},exports["aes-192-ctr"]={cipher:"AES",key:192,iv:16,mode:"CTR",type:"stream"},exports["aes-256-ctr"]={cipher:"AES",key:256,iv:16,mode:"CTR",type:"stream"},exports["aes-128-gcm"]={cipher:"AES",key:128,iv:12,mode:"GCM",type:"auth"},exports["aes-192-gcm"]={cipher:"AES",key:192,iv:12,mode:"GCM",type:"auth"},exports["aes-256-gcm"]={cipher:"AES",key:256,iv:12,mode:"GCM",type:"auth"}},{}],28:[function(_dereq_,module,exports){var xor=_dereq_("buffer-xor");exports.encrypt=function(self,block){var data=xor(block,self._prev);return self._prev=self._cipher.encryptBlock(data),self._prev},exports.decrypt=function(self,block){var pad=self._prev;self._prev=block;var out=self._cipher.decryptBlock(block);return xor(out,pad)}},{"buffer-xor":48}],29:[function(_dereq_,module,exports){(function(Buffer){function encryptStart(self,data,decrypt){var len=data.length,out=xor(data,self._cache);return self._cache=self._cache.slice(len),self._prev=Buffer.concat([self._prev,decrypt?data:out]),out}var xor=_dereq_("buffer-xor");exports.encrypt=function(self,data,decrypt){for(var len,out=new Buffer("");data.length;){if(0===self._cache.length&&(self._cache=self._cipher.encryptBlock(self._prev),self._prev=new Buffer("")),!(self._cache.length<=data.length)){out=Buffer.concat([out,encryptStart(self,data,decrypt)]);break}len=self._cache.length,out=Buffer.concat([out,encryptStart(self,data.slice(0,len),decrypt)]),data=data.slice(len)}return out}}).call(this,_dereq_("buffer").Buffer)},{buffer:49,"buffer-xor":48}],30:[function(_dereq_,module,exports){(function(Buffer){function encryptByte(self,byteParam,decrypt){for(var pad,bit,value,i=-1,len=8,out=0;++i<len;)pad=self._cipher.encryptBlock(self._prev),bit=byteParam&1<<7-i?128:0,value=pad[0]^bit,out+=(128&value)>>i%8,self._prev=shiftIn(self._prev,decrypt?bit:value);return out}function shiftIn(buffer,value){var len=buffer.length,i=-1,out=new Buffer(buffer.length);for(buffer=Buffer.concat([buffer,new Buffer([value])]);++i<len;)out[i]=buffer[i]<<1|buffer[i+1]>>7;return out}exports.encrypt=function(self,chunk,decrypt){for(var len=chunk.length,out=new Buffer(len),i=-1;++i<len;)out[i]=encryptByte(self,chunk[i],decrypt);return out}}).call(this,_dereq_("buffer").Buffer)},{buffer:49}],31:[function(_dereq_,module,exports){(function(Buffer){function encryptByte(self,byteParam,decrypt){var pad=self._cipher.encryptBlock(self._prev),out=pad[0]^byteParam;return self._prev=Buffer.concat([self._prev.slice(1),new Buffer([decrypt?byteParam:out])]),out}exports.encrypt=function(self,chunk,decrypt){for(var len=chunk.length,out=new Buffer(len),i=-1;++i<len;)out[i]=encryptByte(self,chunk[i],decrypt);return out}}).call(this,_dereq_("buffer").Buffer)},{buffer:49}],32:[function(_dereq_,module,exports){(function(Buffer){function incr32(iv){for(var item,len=iv.length;len--;){if(item=iv.readUInt8(len),255!==item){item++,iv.writeUInt8(item,len);break}iv.writeUInt8(0,len)}}function getBlock(self){var out=self._cipher.encryptBlock(self._prev);return incr32(self._prev),out}var xor=_dereq_("buffer-xor");exports.encrypt=function(self,chunk){for(;self._cache.length<chunk.length;)self._cache=Buffer.concat([self._cache,getBlock(self)]);var pad=self._cache.slice(0,chunk.length);return self._cache=self._cache.slice(chunk.length),xor(chunk,pad)}}).call(this,_dereq_("buffer").Buffer)},{buffer:49,"buffer-xor":48}],33:[function(_dereq_,module,exports){exports.encrypt=function(self,block){return self._cipher.encryptBlock(block)},exports.decrypt=function(self,block){return self._cipher.decryptBlock(block)}},{}],34:[function(_dereq_,module,exports){(function(Buffer){function getBlock(self){return self._prev=self._cipher.encryptBlock(self._prev),self._prev}var xor=_dereq_("buffer-xor");exports.encrypt=function(self,chunk){for(;self._cache.length<chunk.length;)self._cache=Buffer.concat([self._cache,getBlock(self)]);var pad=self._cache.slice(0,chunk.length);return self._cache=self._cache.slice(chunk.length),xor(chunk,pad)}}).call(this,_dereq_("buffer").Buffer)},{buffer:49,"buffer-xor":48}],35:[function(_dereq_,module,exports){(function(Buffer){function StreamCipher(mode,key,iv,decrypt){return this instanceof StreamCipher?(Transform.call(this),this._cipher=new aes.AES(key),this._prev=new Buffer(iv.length),this._cache=new Buffer(""),this._secCache=new Buffer(""),this._decrypt=decrypt,iv.copy(this._prev),void(this._mode=mode)):new StreamCipher(mode,key,iv)}var aes=_dereq_("./aes"),Transform=_dereq_("cipher-base"),inherits=_dereq_("inherits");inherits(StreamCipher,Transform),module.exports=StreamCipher,StreamCipher.prototype._update=function(chunk){return this._mode.encrypt(this,chunk,this._decrypt)},StreamCipher.prototype._final=function(){this._cipher.scrub()}}).call(this,_dereq_("buffer").Buffer)},{"./aes":21,buffer:49,"cipher-base":50,inherits:112}],36:[function(_dereq_,module,exports){function createCipher(suite,password){var keyLen,ivLen;if(suite=suite.toLowerCase(),aesModes[suite])keyLen=aesModes[suite].key,ivLen=aesModes[suite].iv;else{if(!desModes[suite])throw new TypeError("invalid suite type");keyLen=8*desModes[suite].key,ivLen=desModes[suite].iv}var keys=ebtk(password,!1,keyLen,ivLen);return createCipheriv(suite,keys.key,keys.iv)}function createDecipher(suite,password){var keyLen,ivLen;if(suite=suite.toLowerCase(),aesModes[suite])keyLen=aesModes[suite].key,ivLen=aesModes[suite].iv;else{if(!desModes[suite])throw new TypeError("invalid suite type");keyLen=8*desModes[suite].key,ivLen=desModes[suite].iv}var keys=ebtk(password,!1,keyLen,ivLen);return createDecipheriv(suite,keys.key,keys.iv)}function createCipheriv(suite,key,iv){if(suite=suite.toLowerCase(),aesModes[suite])return aes.createCipheriv(suite,key,iv);if(desModes[suite])return new DES({key:key,iv:iv,mode:suite});throw new TypeError("invalid suite type")}function createDecipheriv(suite,key,iv){if(suite=suite.toLowerCase(),aesModes[suite])return aes.createDecipheriv(suite,key,iv);if(desModes[suite])return new DES({key:key,iv:iv,mode:suite,decrypt:!0});throw new TypeError("invalid suite type")}function getCiphers(){return Object.keys(desModes).concat(aes.getCiphers())}var ebtk=_dereq_("evp_bytestokey"),aes=_dereq_("browserify-aes/browser"),DES=_dereq_("browserify-des"),desModes=_dereq_("browserify-des/modes"),aesModes=_dereq_("browserify-aes/modes");exports.createCipher=exports.Cipher=createCipher,exports.createCipheriv=exports.Cipheriv=createCipheriv,exports.createDecipher=exports.Decipher=createDecipher,exports.createDecipheriv=exports.Decipheriv=createDecipheriv,exports.listCiphers=exports.getCiphers=getCiphers},{"browserify-aes/browser":23,"browserify-aes/modes":27,"browserify-des":37,"browserify-des/modes":38,evp_bytestokey:100}],37:[function(_dereq_,module,exports){(function(Buffer){function DES(opts){CipherBase.call(this);var type,modeName=opts.mode.toLowerCase(),mode=modes[modeName];type=opts.decrypt?"decrypt":"encrypt";var key=opts.key;"des-ede"!==modeName&&"des-ede-cbc"!==modeName||(key=Buffer.concat([key,key.slice(0,8)]));var iv=opts.iv;this._des=mode.create({key:key,iv:iv,type:type})}var CipherBase=_dereq_("cipher-base"),des=_dereq_("des.js"),inherits=_dereq_("inherits"),modes={"des-ede3-cbc":des.CBC.instantiate(des.EDE),"des-ede3":des.EDE,"des-ede-cbc":des.CBC.instantiate(des.EDE),"des-ede":des.EDE,"des-cbc":des.CBC.instantiate(des.DES),"des-ecb":des.DES};modes.des=modes["des-cbc"],modes.des3=modes["des-ede3-cbc"],module.exports=DES,inherits(DES,CipherBase),DES.prototype._update=function(data){return new Buffer(this._des.update(data))},DES.prototype._final=function(){return new Buffer(this._des.final())}}).call(this,_dereq_("buffer").Buffer)},{buffer:49,"cipher-base":50,"des.js":59,inherits:112}],38:[function(_dereq_,module,exports){exports["des-ecb"]={key:8,iv:0},exports["des-cbc"]=exports.des={key:8,iv:8},exports["des-ede3-cbc"]=exports.des3={key:24,iv:8},exports["des-ede3"]={key:24,iv:0},exports["des-ede-cbc"]={key:16,iv:8},exports["des-ede"]={key:16,iv:0}},{}],39:[function(_dereq_,module,exports){(function(Buffer){function blind(priv){var r=getr(priv),blinder=r.toRed(bn.mont(priv.modulus)).redPow(new bn(priv.publicExponent)).fromRed();return{blinder:blinder,unblinder:r.invm(priv.modulus)}}function crt(msg,priv){var blinds=blind(priv),len=priv.modulus.byteLength(),blinded=(bn.mont(priv.modulus),new bn(msg).mul(blinds.blinder).umod(priv.modulus)),c1=blinded.toRed(bn.mont(priv.prime1)),c2=blinded.toRed(bn.mont(priv.prime2)),qinv=priv.coefficient,p=priv.prime1,q=priv.prime2,m1=c1.redPow(priv.exponent1),m2=c2.redPow(priv.exponent2);m1=m1.fromRed(),m2=m2.fromRed();var h=m1.isub(m2).imul(qinv).umod(p);return h.imul(q),m2.iadd(h),new Buffer(m2.imul(blinds.unblinder).umod(priv.modulus).toArray(!1,len))}function getr(priv){for(var len=priv.modulus.byteLength(),r=new bn(randomBytes(len));r.cmp(priv.modulus)>=0||!r.umod(priv.prime1)||!r.umod(priv.prime2);)r=new bn(randomBytes(len));return r}var bn=_dereq_("bn.js"),randomBytes=_dereq_("randombytes");module.exports=crt,crt.getr=getr}).call(this,_dereq_("buffer").Buffer)},{"bn.js":18,buffer:49,randombytes:136}],40:[function(_dereq_,module,exports){module.exports=_dereq_("./browser/algorithms.json")},{"./browser/algorithms.json":41}],41:[function(_dereq_,module,exports){module.exports={sha224WithRSAEncryption:{sign:"rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},"RSA-SHA224":{sign:"ecdsa/rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},sha256WithRSAEncryption:{sign:"rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},"RSA-SHA256":{sign:"ecdsa/rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},sha384WithRSAEncryption:{sign:"rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},"RSA-SHA384":{sign:"ecdsa/rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},sha512WithRSAEncryption:{sign:"rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA512":{sign:"ecdsa/rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA1":{sign:"rsa",hash:"sha1",id:"3021300906052b0e03021a05000414"},"ecdsa-with-SHA1":{sign:"ecdsa",hash:"sha1",id:""},sha256:{sign:"ecdsa",hash:"sha256",id:""},sha224:{sign:"ecdsa",hash:"sha224",id:""},sha384:{sign:"ecdsa",hash:"sha384",id:""},sha512:{sign:"ecdsa",hash:"sha512",id:""},"DSA-SHA":{sign:"dsa",hash:"sha1",id:""},"DSA-SHA1":{sign:"dsa",hash:"sha1",id:""},DSA:{sign:"dsa",hash:"sha1",id:""},"DSA-WITH-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-WITH-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-WITH-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-WITH-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-RIPEMD160":{sign:"dsa",hash:"rmd160",id:""},ripemd160WithRSA:{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},"RSA-RIPEMD160":{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},md5WithRSAEncryption:{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"},"RSA-MD5":{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"}}},{}],42:[function(_dereq_,module,exports){module.exports={"1.3.132.0.10":"secp256k1","1.3.132.0.33":"p224","1.2.840.10045.3.1.1":"p192","1.2.840.10045.3.1.7":"p256","1.3.132.0.34":"p384","1.3.132.0.35":"p521"}},{}],43:[function(_dereq_,module,exports){(function(Buffer){function Sign(algorithm){stream.Writable.call(this);var data=algorithms[algorithm];if(!data)throw new Error("Unknown message digest");this._hashType=data.hash,this._hash=createHash(data.hash),this._tag=data.id,this._signType=data.sign}function Verify(algorithm){stream.Writable.call(this);var data=algorithms[algorithm];if(!data)throw new Error("Unknown message digest");this._hash=createHash(data.hash),this._tag=data.id,this._signType=data.sign}function createSign(algorithm){return new Sign(algorithm)}function createVerify(algorithm){return new Verify(algorithm)}var createHash=_dereq_("create-hash"),stream=_dereq_("stream"),inherits=_dereq_("inherits"),sign=_dereq_("./sign"),verify=_dereq_("./verify"),algorithms=_dereq_("./algorithms.json");Object.keys(algorithms).forEach(function(key){algorithms[key].id=new Buffer(algorithms[key].id,"hex"),algorithms[key.toLowerCase()]=algorithms[key]}),inherits(Sign,stream.Writable),Sign.prototype._write=function(data,_,done){this._hash.update(data),done()},Sign.prototype.update=function(data,enc){return"string"==typeof data&&(data=new Buffer(data,enc)),this._hash.update(data),this},Sign.prototype.sign=function(key,enc){this.end();var hash=this._hash.digest(),sig=sign(hash,key,this._hashType,this._signType,this._tag);return enc?sig.toString(enc):sig},inherits(Verify,stream.Writable),Verify.prototype._write=function(data,_,done){this._hash.update(data),done()},Verify.prototype.update=function(data,enc){return"string"==typeof data&&(data=new Buffer(data,enc)),this._hash.update(data),this},Verify.prototype.verify=function(key,sig,enc){"string"==typeof sig&&(sig=new Buffer(sig,enc)),this.end();var hash=this._hash.digest();return verify(sig,hash,key,this._signType,this._tag)},module.exports={Sign:createSign,Verify:createVerify,createSign:createSign,createVerify:createVerify}}).call(this,_dereq_("buffer").Buffer)},{"./algorithms.json":41,"./sign":44,"./verify":45,buffer:49,"create-hash":53,inherits:112,stream:157}],44:[function(_dereq_,module,exports){(function(Buffer){function sign(hash,key,hashType,signType,tag){var priv=parseKeys(key);if(priv.curve){if("ecdsa"!==signType&&"ecdsa/rsa"!==signType)throw new Error("wrong private key type");return ecSign(hash,priv)}if("dsa"===priv.type){if("dsa"!==signType)throw new Error("wrong private key type");return dsaSign(hash,priv,hashType)}if("rsa"!==signType&&"ecdsa/rsa"!==signType)throw new Error("wrong private key type");hash=Buffer.concat([tag,hash]);for(var len=priv.modulus.byteLength(),pad=[0,1];hash.length+pad.length+1<len;)pad.push(255);pad.push(0);for(var i=-1;++i<hash.length;)pad.push(hash[i]);var out=crt(pad,priv);return out}function ecSign(hash,priv){var curveId=curves[priv.curve.join(".")];if(!curveId)throw new Error("unknown curve "+priv.curve.join("."));var curve=new EC(curveId),key=curve.keyFromPrivate(priv.privateKey),out=key.sign(hash);return new Buffer(out.toDER())}function dsaSign(hash,priv,algo){for(var k,x=priv.params.priv_key,p=priv.params.p,q=priv.params.q,g=priv.params.g,r=new BN(0),H=bits2int(hash,q).mod(q),s=!1,kv=getKey(x,q,hash,algo);s===!1;)k=makeKey(q,kv,algo),r=makeR(g,k,p,q),s=k.invm(q).imul(H.add(x.mul(r))).mod(q),0===s.cmpn(0)&&(s=!1,r=new BN(0));return toDER(r,s)}function toDER(r,s){r=r.toArray(),s=s.toArray(),128&r[0]&&(r=[0].concat(r)),128&s[0]&&(s=[0].concat(s));var total=r.length+s.length+4,res=[48,total,2,r.length];return res=res.concat(r,[2,s.length],s),new Buffer(res)}function getKey(x,q,hash,algo){if(x=new Buffer(x.toArray()),x.length<q.byteLength()){var zeros=new Buffer(q.byteLength()-x.length);zeros.fill(0),x=Buffer.concat([zeros,x])}var hlen=hash.length,hbits=bits2octets(hash,q),v=new Buffer(hlen);v.fill(1);var k=new Buffer(hlen);return k.fill(0),k=createHmac(algo,k).update(v).update(new Buffer([0])).update(x).update(hbits).digest(),v=createHmac(algo,k).update(v).digest(),k=createHmac(algo,k).update(v).update(new Buffer([1])).update(x).update(hbits).digest(),v=createHmac(algo,k).update(v).digest(),{k:k,v:v}}function bits2int(obits,q){var bits=new BN(obits),shift=(obits.length<<3)-q.bitLength();return shift>0&&bits.ishrn(shift),bits}function bits2octets(bits,q){bits=bits2int(bits,q),bits=bits.mod(q);var out=new Buffer(bits.toArray());if(out.length<q.byteLength()){var zeros=new Buffer(q.byteLength()-out.length);zeros.fill(0),out=Buffer.concat([zeros,out])}return out}function makeKey(q,kv,algo){var t,k;do{for(t=new Buffer(0);8*t.length<q.bitLength();)kv.v=createHmac(algo,kv.k).update(kv.v).digest(),t=Buffer.concat([t,kv.v]);k=bits2int(t,q),kv.k=createHmac(algo,kv.k).update(kv.v).update(new Buffer([0])).digest(),kv.v=createHmac(algo,kv.k).update(kv.v).digest()}while(k.cmp(q)!==-1);return k}function makeR(g,k,p,q){return g.toRed(BN.mont(p)).redPow(k).fromRed().mod(q)}var createHmac=_dereq_("create-hmac"),crt=_dereq_("browserify-rsa"),EC=_dereq_("elliptic").ec,BN=_dereq_("bn.js"),parseKeys=_dereq_("parse-asn1"),curves=_dereq_("./curves.json");module.exports=sign,module.exports.getKey=getKey,module.exports.makeKey=makeKey}).call(this,_dereq_("buffer").Buffer)},{"./curves.json":42,"bn.js":18,"browserify-rsa":39,buffer:49,"create-hmac":56,elliptic:69,"parse-asn1":123}],45:[function(_dereq_,module,exports){(function(Buffer){function verify(sig,hash,key,signType,tag){var pub=parseKeys(key);if("ec"===pub.type){if("ecdsa"!==signType&&"ecdsa/rsa"!==signType)throw new Error("wrong public key type");return ecVerify(sig,hash,pub)}if("dsa"===pub.type){if("dsa"!==signType)throw new Error("wrong public key type");return dsaVerify(sig,hash,pub)}if("rsa"!==signType&&"ecdsa/rsa"!==signType)throw new Error("wrong public key type");hash=Buffer.concat([tag,hash]);for(var len=pub.modulus.byteLength(),pad=[1],padNum=0;hash.length+pad.length+2<len;)pad.push(255),padNum++;pad.push(0);for(var i=-1;++i<hash.length;)pad.push(hash[i]);pad=new Buffer(pad);var red=BN.mont(pub.modulus);sig=new BN(sig).toRed(red),sig=sig.redPow(new BN(pub.publicExponent)),sig=new Buffer(sig.fromRed().toArray());var out=padNum<8?1:0;for(len=Math.min(sig.length,pad.length),sig.length!==pad.length&&(out=1),i=-1;++i<len;)out|=sig[i]^pad[i];return 0===out}function ecVerify(sig,hash,pub){var curveId=curves[pub.data.algorithm.curve.join(".")];if(!curveId)throw new Error("unknown curve "+pub.data.algorithm.curve.join("."));var curve=new EC(curveId),pubkey=pub.data.subjectPrivateKey.data;return curve.verify(hash,sig,pubkey)}function dsaVerify(sig,hash,pub){var p=pub.data.p,q=pub.data.q,g=pub.data.g,y=pub.data.pub_key,unpacked=parseKeys.signature.decode(sig,"der"),s=unpacked.s,r=unpacked.r;checkValue(s,q),checkValue(r,q);var montp=BN.mont(p),w=s.invm(q),v=g.toRed(montp).redPow(new BN(hash).mul(w).mod(q)).fromRed().mul(y.toRed(montp).redPow(r.mul(w).mod(q)).fromRed()).mod(p).mod(q);return 0===v.cmp(r)}function checkValue(b,q){if(b.cmpn(0)<=0)throw new Error("invalid sig");if(b.cmp(q)>=q)throw new Error("invalid sig")}var BN=_dereq_("bn.js"),EC=_dereq_("elliptic").ec,parseKeys=_dereq_("parse-asn1"),curves=_dereq_("./curves.json");module.exports=verify}).call(this,_dereq_("buffer").Buffer)},{"./curves.json":42,"bn.js":18,buffer:49,elliptic:69,"parse-asn1":123}],46:[function(_dereq_,module,exports){arguments[4][20][0].apply(exports,arguments)},{dup:20}],47:[function(_dereq_,module,exports){(function(global){"use strict";var buffer=_dereq_("buffer"),Buffer=buffer.Buffer,SlowBuffer=buffer.SlowBuffer,MAX_LEN=buffer.kMaxLength||2147483647;exports.alloc=function(size,fill,encoding){if("function"==typeof Buffer.alloc)return Buffer.alloc(size,fill,encoding);if("number"==typeof encoding)throw new TypeError("encoding must not be number");if("number"!=typeof size)throw new TypeError("size must be a number");if(size>MAX_LEN)throw new RangeError("size is too large");var enc=encoding,_fill=fill;void 0===_fill&&(enc=void 0,_fill=0);var buf=new Buffer(size);if("string"==typeof _fill)for(var fillBuf=new Buffer(_fill,enc),flen=fillBuf.length,i=-1;++i<size;)buf[i]=fillBuf[i%flen];else buf.fill(_fill);return buf},exports.allocUnsafe=function(size){if("function"==typeof Buffer.allocUnsafe)return Buffer.allocUnsafe(size);if("number"!=typeof size)throw new TypeError("size must be a number");if(size>MAX_LEN)throw new RangeError("size is too large");return new Buffer(size)},exports.from=function(value,encodingOrOffset,length){if("function"==typeof Buffer.from&&(!global.Uint8Array||Uint8Array.from!==Buffer.from))return Buffer.from(value,encodingOrOffset,length);if("number"==typeof value)throw new TypeError('"value" argument must not be a number');if("string"==typeof value)return new Buffer(value,encodingOrOffset);
if("undefined"!=typeof ArrayBuffer&&value instanceof ArrayBuffer){var offset=encodingOrOffset;if(1===arguments.length)return new Buffer(value);"undefined"==typeof offset&&(offset=0);var len=length;if("undefined"==typeof len&&(len=value.byteLength-offset),offset>=value.byteLength)throw new RangeError("'offset' is out of bounds");if(len>value.byteLength-offset)throw new RangeError("'length' is out of bounds");return new Buffer(value.slice(offset,offset+len))}if(Buffer.isBuffer(value)){var out=new Buffer(value.length);return value.copy(out,0,0,value.length),out}if(value){if(Array.isArray(value)||"undefined"!=typeof ArrayBuffer&&value.buffer instanceof ArrayBuffer||"length"in value)return new Buffer(value);if("Buffer"===value.type&&Array.isArray(value.data))return new Buffer(value.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")},exports.allocUnsafeSlow=function(size){if("function"==typeof Buffer.allocUnsafeSlow)return Buffer.allocUnsafeSlow(size);if("number"!=typeof size)throw new TypeError("size must be a number");if(size>=MAX_LEN)throw new RangeError("size is too large");return new SlowBuffer(size)}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{buffer:49}],48:[function(_dereq_,module,exports){(function(Buffer){module.exports=function(a,b){for(var length=Math.min(a.length,b.length),buffer=new Buffer(length),i=0;i<length;++i)buffer[i]=a[i]^b[i];return buffer}}).call(this,_dereq_("buffer").Buffer)},{buffer:49}],49:[function(_dereq_,module,exports){(function(global){"use strict";function typedArraySupport(){try{var arr=new Uint8Array(1);return arr.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===arr.foo()&&"function"==typeof arr.subarray&&0===arr.subarray(1,1).byteLength}catch(e){return!1}}function kMaxLength(){return Buffer.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function createBuffer(that,length){if(kMaxLength()<length)throw new RangeError("Invalid typed array length");return Buffer.TYPED_ARRAY_SUPPORT?(that=new Uint8Array(length),that.__proto__=Buffer.prototype):(null===that&&(that=new Buffer(length)),that.length=length),that}function Buffer(arg,encodingOrOffset,length){if(!(Buffer.TYPED_ARRAY_SUPPORT||this instanceof Buffer))return new Buffer(arg,encodingOrOffset,length);if("number"==typeof arg){if("string"==typeof encodingOrOffset)throw new Error("If encoding is specified then the first argument must be a string");return allocUnsafe(this,arg)}return from(this,arg,encodingOrOffset,length)}function from(that,value,encodingOrOffset,length){if("number"==typeof value)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&value instanceof ArrayBuffer?fromArrayBuffer(that,value,encodingOrOffset,length):"string"==typeof value?fromString(that,value,encodingOrOffset):fromObject(that,value)}function assertSize(size){if("number"!=typeof size)throw new TypeError('"size" argument must be a number');if(size<0)throw new RangeError('"size" argument must not be negative')}function alloc(that,size,fill,encoding){return assertSize(size),size<=0?createBuffer(that,size):void 0!==fill?"string"==typeof encoding?createBuffer(that,size).fill(fill,encoding):createBuffer(that,size).fill(fill):createBuffer(that,size)}function allocUnsafe(that,size){if(assertSize(size),that=createBuffer(that,size<0?0:0|checked(size)),!Buffer.TYPED_ARRAY_SUPPORT)for(var i=0;i<size;++i)that[i]=0;return that}function fromString(that,string,encoding){if("string"==typeof encoding&&""!==encoding||(encoding="utf8"),!Buffer.isEncoding(encoding))throw new TypeError('"encoding" must be a valid string encoding');var length=0|byteLength(string,encoding);that=createBuffer(that,length);var actual=that.write(string,encoding);return actual!==length&&(that=that.slice(0,actual)),that}function fromArrayLike(that,array){var length=array.length<0?0:0|checked(array.length);that=createBuffer(that,length);for(var i=0;i<length;i+=1)that[i]=255&array[i];return that}function fromArrayBuffer(that,array,byteOffset,length){if(array.byteLength,byteOffset<0||array.byteLength<byteOffset)throw new RangeError("'offset' is out of bounds");if(array.byteLength<byteOffset+(length||0))throw new RangeError("'length' is out of bounds");return array=void 0===byteOffset&&void 0===length?new Uint8Array(array):void 0===length?new Uint8Array(array,byteOffset):new Uint8Array(array,byteOffset,length),Buffer.TYPED_ARRAY_SUPPORT?(that=array,that.__proto__=Buffer.prototype):that=fromArrayLike(that,array),that}function fromObject(that,obj){if(Buffer.isBuffer(obj)){var len=0|checked(obj.length);return that=createBuffer(that,len),0===that.length?that:(obj.copy(that,0,0,len),that)}if(obj){if("undefined"!=typeof ArrayBuffer&&obj.buffer instanceof ArrayBuffer||"length"in obj)return"number"!=typeof obj.length||isnan(obj.length)?createBuffer(that,0):fromArrayLike(that,obj);if("Buffer"===obj.type&&isArray(obj.data))return fromArrayLike(that,obj.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function checked(length){if(length>=kMaxLength())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+kMaxLength().toString(16)+" bytes");return 0|length}function SlowBuffer(length){return+length!=length&&(length=0),Buffer.alloc(+length)}function byteLength(string,encoding){if(Buffer.isBuffer(string))return string.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(string)||string instanceof ArrayBuffer))return string.byteLength;"string"!=typeof string&&(string=""+string);var len=string.length;if(0===len)return 0;for(var loweredCase=!1;;)switch(encoding){case"ascii":case"latin1":case"binary":return len;case"utf8":case"utf-8":case void 0:return utf8ToBytes(string).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*len;case"hex":return len>>>1;case"base64":return base64ToBytes(string).length;default:if(loweredCase)return utf8ToBytes(string).length;encoding=(""+encoding).toLowerCase(),loweredCase=!0}}function slowToString(encoding,start,end){var loweredCase=!1;if((void 0===start||start<0)&&(start=0),start>this.length)return"";if((void 0===end||end>this.length)&&(end=this.length),end<=0)return"";if(end>>>=0,start>>>=0,end<=start)return"";for(encoding||(encoding="utf8");;)switch(encoding){case"hex":return hexSlice(this,start,end);case"utf8":case"utf-8":return utf8Slice(this,start,end);case"ascii":return asciiSlice(this,start,end);case"latin1":case"binary":return latin1Slice(this,start,end);case"base64":return base64Slice(this,start,end);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,start,end);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(encoding+"").toLowerCase(),loweredCase=!0}}function swap(b,n,m){var i=b[n];b[n]=b[m],b[m]=i}function bidirectionalIndexOf(buffer,val,byteOffset,encoding,dir){if(0===buffer.length)return-1;if("string"==typeof byteOffset?(encoding=byteOffset,byteOffset=0):byteOffset>2147483647?byteOffset=2147483647:byteOffset<-2147483648&&(byteOffset=-2147483648),byteOffset=+byteOffset,isNaN(byteOffset)&&(byteOffset=dir?0:buffer.length-1),byteOffset<0&&(byteOffset=buffer.length+byteOffset),byteOffset>=buffer.length){if(dir)return-1;byteOffset=buffer.length-1}else if(byteOffset<0){if(!dir)return-1;byteOffset=0}if("string"==typeof val&&(val=Buffer.from(val,encoding)),Buffer.isBuffer(val))return 0===val.length?-1:arrayIndexOf(buffer,val,byteOffset,encoding,dir);if("number"==typeof val)return val=255&val,Buffer.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?dir?Uint8Array.prototype.indexOf.call(buffer,val,byteOffset):Uint8Array.prototype.lastIndexOf.call(buffer,val,byteOffset):arrayIndexOf(buffer,[val],byteOffset,encoding,dir);throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(arr,val,byteOffset,encoding,dir){function read(buf,i){return 1===indexSize?buf[i]:buf.readUInt16BE(i*indexSize)}var indexSize=1,arrLength=arr.length,valLength=val.length;if(void 0!==encoding&&(encoding=String(encoding).toLowerCase(),"ucs2"===encoding||"ucs-2"===encoding||"utf16le"===encoding||"utf-16le"===encoding)){if(arr.length<2||val.length<2)return-1;indexSize=2,arrLength/=2,valLength/=2,byteOffset/=2}var i;if(dir){var foundIndex=-1;for(i=byteOffset;i<arrLength;i++)if(read(arr,i)===read(val,foundIndex===-1?0:i-foundIndex)){if(foundIndex===-1&&(foundIndex=i),i-foundIndex+1===valLength)return foundIndex*indexSize}else foundIndex!==-1&&(i-=i-foundIndex),foundIndex=-1}else for(byteOffset+valLength>arrLength&&(byteOffset=arrLength-valLength),i=byteOffset;i>=0;i--){for(var found=!0,j=0;j<valLength;j++)if(read(arr,i+j)!==read(val,j)){found=!1;break}if(found)return i}return-1}function hexWrite(buf,string,offset,length){offset=Number(offset)||0;var remaining=buf.length-offset;length?(length=Number(length),length>remaining&&(length=remaining)):length=remaining;var strLen=string.length;if(strLen%2!==0)throw new TypeError("Invalid hex string");length>strLen/2&&(length=strLen/2);for(var i=0;i<length;++i){var parsed=parseInt(string.substr(2*i,2),16);if(isNaN(parsed))return i;buf[offset+i]=parsed}return i}function utf8Write(buf,string,offset,length){return blitBuffer(utf8ToBytes(string,buf.length-offset),buf,offset,length)}function asciiWrite(buf,string,offset,length){return blitBuffer(asciiToBytes(string),buf,offset,length)}function latin1Write(buf,string,offset,length){return asciiWrite(buf,string,offset,length)}function base64Write(buf,string,offset,length){return blitBuffer(base64ToBytes(string),buf,offset,length)}function ucs2Write(buf,string,offset,length){return blitBuffer(utf16leToBytes(string,buf.length-offset),buf,offset,length)}function base64Slice(buf,start,end){return 0===start&&end===buf.length?base64.fromByteArray(buf):base64.fromByteArray(buf.slice(start,end))}function utf8Slice(buf,start,end){end=Math.min(buf.length,end);for(var res=[],i=start;i<end;){var firstByte=buf[i],codePoint=null,bytesPerSequence=firstByte>239?4:firstByte>223?3:firstByte>191?2:1;if(i+bytesPerSequence<=end){var secondByte,thirdByte,fourthByte,tempCodePoint;switch(bytesPerSequence){case 1:firstByte<128&&(codePoint=firstByte);break;case 2:secondByte=buf[i+1],128===(192&secondByte)&&(tempCodePoint=(31&firstByte)<<6|63&secondByte,tempCodePoint>127&&(codePoint=tempCodePoint));break;case 3:secondByte=buf[i+1],thirdByte=buf[i+2],128===(192&secondByte)&&128===(192&thirdByte)&&(tempCodePoint=(15&firstByte)<<12|(63&secondByte)<<6|63&thirdByte,tempCodePoint>2047&&(tempCodePoint<55296||tempCodePoint>57343)&&(codePoint=tempCodePoint));break;case 4:secondByte=buf[i+1],thirdByte=buf[i+2],fourthByte=buf[i+3],128===(192&secondByte)&&128===(192&thirdByte)&&128===(192&fourthByte)&&(tempCodePoint=(15&firstByte)<<18|(63&secondByte)<<12|(63&thirdByte)<<6|63&fourthByte,tempCodePoint>65535&&tempCodePoint<1114112&&(codePoint=tempCodePoint))}}null===codePoint?(codePoint=65533,bytesPerSequence=1):codePoint>65535&&(codePoint-=65536,res.push(codePoint>>>10&1023|55296),codePoint=56320|1023&codePoint),res.push(codePoint),i+=bytesPerSequence}return decodeCodePointsArray(res)}function decodeCodePointsArray(codePoints){var len=codePoints.length;if(len<=MAX_ARGUMENTS_LENGTH)return String.fromCharCode.apply(String,codePoints);for(var res="",i=0;i<len;)res+=String.fromCharCode.apply(String,codePoints.slice(i,i+=MAX_ARGUMENTS_LENGTH));return res}function asciiSlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i)ret+=String.fromCharCode(127&buf[i]);return ret}function latin1Slice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i)ret+=String.fromCharCode(buf[i]);return ret}function hexSlice(buf,start,end){var len=buf.length;(!start||start<0)&&(start=0),(!end||end<0||end>len)&&(end=len);for(var out="",i=start;i<end;++i)out+=toHex(buf[i]);return out}function utf16leSlice(buf,start,end){for(var bytes=buf.slice(start,end),res="",i=0;i<bytes.length;i+=2)res+=String.fromCharCode(bytes[i]+256*bytes[i+1]);return res}function checkOffset(offset,ext,length){if(offset%1!==0||offset<0)throw new RangeError("offset is not uint");if(offset+ext>length)throw new RangeError("Trying to access beyond buffer length")}function checkInt(buf,value,offset,ext,max,min){if(!Buffer.isBuffer(buf))throw new TypeError('"buffer" argument must be a Buffer instance');if(value>max||value<min)throw new RangeError('"value" argument is out of bounds');if(offset+ext>buf.length)throw new RangeError("Index out of range")}function objectWriteUInt16(buf,value,offset,littleEndian){value<0&&(value=65535+value+1);for(var i=0,j=Math.min(buf.length-offset,2);i<j;++i)buf[offset+i]=(value&255<<8*(littleEndian?i:1-i))>>>8*(littleEndian?i:1-i)}function objectWriteUInt32(buf,value,offset,littleEndian){value<0&&(value=4294967295+value+1);for(var i=0,j=Math.min(buf.length-offset,4);i<j;++i)buf[offset+i]=value>>>8*(littleEndian?i:3-i)&255}function checkIEEE754(buf,value,offset,ext,max,min){if(offset+ext>buf.length)throw new RangeError("Index out of range");if(offset<0)throw new RangeError("Index out of range")}function writeFloat(buf,value,offset,littleEndian,noAssert){return noAssert||checkIEEE754(buf,value,offset,4,3.4028234663852886e38,-3.4028234663852886e38),ieee754.write(buf,value,offset,littleEndian,23,4),offset+4}function writeDouble(buf,value,offset,littleEndian,noAssert){return noAssert||checkIEEE754(buf,value,offset,8,1.7976931348623157e308,-1.7976931348623157e308),ieee754.write(buf,value,offset,littleEndian,52,8),offset+8}function base64clean(str){if(str=stringtrim(str).replace(INVALID_BASE64_RE,""),str.length<2)return"";for(;str.length%4!==0;)str+="=";return str}function stringtrim(str){return str.trim?str.trim():str.replace(/^\s+|\s+$/g,"")}function toHex(n){return n<16?"0"+n.toString(16):n.toString(16)}function utf8ToBytes(string,units){units=units||1/0;for(var codePoint,length=string.length,leadSurrogate=null,bytes=[],i=0;i<length;++i){if(codePoint=string.charCodeAt(i),codePoint>55295&&codePoint<57344){if(!leadSurrogate){if(codePoint>56319){(units-=3)>-1&&bytes.push(239,191,189);continue}if(i+1===length){(units-=3)>-1&&bytes.push(239,191,189);continue}leadSurrogate=codePoint;continue}if(codePoint<56320){(units-=3)>-1&&bytes.push(239,191,189),leadSurrogate=codePoint;continue}codePoint=(leadSurrogate-55296<<10|codePoint-56320)+65536}else leadSurrogate&&(units-=3)>-1&&bytes.push(239,191,189);if(leadSurrogate=null,codePoint<128){if((units-=1)<0)break;bytes.push(codePoint)}else if(codePoint<2048){if((units-=2)<0)break;bytes.push(codePoint>>6|192,63&codePoint|128)}else if(codePoint<65536){if((units-=3)<0)break;bytes.push(codePoint>>12|224,codePoint>>6&63|128,63&codePoint|128)}else{if(!(codePoint<1114112))throw new Error("Invalid code point");if((units-=4)<0)break;bytes.push(codePoint>>18|240,codePoint>>12&63|128,codePoint>>6&63|128,63&codePoint|128)}}return bytes}function asciiToBytes(str){for(var byteArray=[],i=0;i<str.length;++i)byteArray.push(255&str.charCodeAt(i));return byteArray}function utf16leToBytes(str,units){for(var c,hi,lo,byteArray=[],i=0;i<str.length&&!((units-=2)<0);++i)c=str.charCodeAt(i),hi=c>>8,lo=c%256,byteArray.push(lo),byteArray.push(hi);return byteArray}function base64ToBytes(str){return base64.toByteArray(base64clean(str))}function blitBuffer(src,dst,offset,length){for(var i=0;i<length&&!(i+offset>=dst.length||i>=src.length);++i)dst[i+offset]=src[i];return i}function isnan(val){return val!==val}var base64=_dereq_("base64-js"),ieee754=_dereq_("ieee754"),isArray=_dereq_("isarray");exports.Buffer=Buffer,exports.SlowBuffer=SlowBuffer,exports.INSPECT_MAX_BYTES=50,Buffer.TYPED_ARRAY_SUPPORT=void 0!==global.TYPED_ARRAY_SUPPORT?global.TYPED_ARRAY_SUPPORT:typedArraySupport(),exports.kMaxLength=kMaxLength(),Buffer.poolSize=8192,Buffer._augment=function(arr){return arr.__proto__=Buffer.prototype,arr},Buffer.from=function(value,encodingOrOffset,length){return from(null,value,encodingOrOffset,length)},Buffer.TYPED_ARRAY_SUPPORT&&(Buffer.prototype.__proto__=Uint8Array.prototype,Buffer.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&Buffer[Symbol.species]===Buffer&&Object.defineProperty(Buffer,Symbol.species,{value:null,configurable:!0})),Buffer.alloc=function(size,fill,encoding){return alloc(null,size,fill,encoding)},Buffer.allocUnsafe=function(size){return allocUnsafe(null,size)},Buffer.allocUnsafeSlow=function(size){return allocUnsafe(null,size)},Buffer.isBuffer=function(b){return!(null==b||!b._isBuffer)},Buffer.compare=function(a,b){if(!Buffer.isBuffer(a)||!Buffer.isBuffer(b))throw new TypeError("Arguments must be Buffers");if(a===b)return 0;for(var x=a.length,y=b.length,i=0,len=Math.min(x,y);i<len;++i)if(a[i]!==b[i]){x=a[i],y=b[i];break}return x<y?-1:y<x?1:0},Buffer.isEncoding=function(encoding){switch(String(encoding).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function(list,length){if(!isArray(list))throw new TypeError('"list" argument must be an Array of Buffers');if(0===list.length)return Buffer.alloc(0);var i;if(void 0===length)for(length=0,i=0;i<list.length;++i)length+=list[i].length;var buffer=Buffer.allocUnsafe(length),pos=0;for(i=0;i<list.length;++i){var buf=list[i];if(!Buffer.isBuffer(buf))throw new TypeError('"list" argument must be an Array of Buffers');buf.copy(buffer,pos),pos+=buf.length}return buffer},Buffer.byteLength=byteLength,Buffer.prototype._isBuffer=!0,Buffer.prototype.swap16=function(){var len=this.length;if(len%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var i=0;i<len;i+=2)swap(this,i,i+1);return this},Buffer.prototype.swap32=function(){var len=this.length;if(len%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var i=0;i<len;i+=4)swap(this,i,i+3),swap(this,i+1,i+2);return this},Buffer.prototype.swap64=function(){var len=this.length;if(len%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var i=0;i<len;i+=8)swap(this,i,i+7),swap(this,i+1,i+6),swap(this,i+2,i+5),swap(this,i+3,i+4);return this},Buffer.prototype.toString=function(){var length=0|this.length;return 0===length?"":0===arguments.length?utf8Slice(this,0,length):slowToString.apply(this,arguments)},Buffer.prototype.equals=function(b){if(!Buffer.isBuffer(b))throw new TypeError("Argument must be a Buffer");return this===b||0===Buffer.compare(this,b)},Buffer.prototype.inspect=function(){var str="",max=exports.INSPECT_MAX_BYTES;return this.length>0&&(str=this.toString("hex",0,max).match(/.{2}/g).join(" "),this.length>max&&(str+=" ... ")),"<Buffer "+str+">"},Buffer.prototype.compare=function(target,start,end,thisStart,thisEnd){if(!Buffer.isBuffer(target))throw new TypeError("Argument must be a Buffer");if(void 0===start&&(start=0),void 0===end&&(end=target?target.length:0),void 0===thisStart&&(thisStart=0),void 0===thisEnd&&(thisEnd=this.length),start<0||end>target.length||thisStart<0||thisEnd>this.length)throw new RangeError("out of range index");if(thisStart>=thisEnd&&start>=end)return 0;if(thisStart>=thisEnd)return-1;if(start>=end)return 1;if(start>>>=0,end>>>=0,thisStart>>>=0,thisEnd>>>=0,this===target)return 0;for(var x=thisEnd-thisStart,y=end-start,len=Math.min(x,y),thisCopy=this.slice(thisStart,thisEnd),targetCopy=target.slice(start,end),i=0;i<len;++i)if(thisCopy[i]!==targetCopy[i]){x=thisCopy[i],y=targetCopy[i];break}return x<y?-1:y<x?1:0},Buffer.prototype.includes=function(val,byteOffset,encoding){return this.indexOf(val,byteOffset,encoding)!==-1},Buffer.prototype.indexOf=function(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,!0)},Buffer.prototype.lastIndexOf=function(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,!1)},Buffer.prototype.write=function(string,offset,length,encoding){if(void 0===offset)encoding="utf8",length=this.length,offset=0;else if(void 0===length&&"string"==typeof offset)encoding=offset,length=this.length,offset=0;else{if(!isFinite(offset))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");offset=0|offset,isFinite(length)?(length=0|length,void 0===encoding&&(encoding="utf8")):(encoding=length,length=void 0)}var remaining=this.length-offset;if((void 0===length||length>remaining)&&(length=remaining),string.length>0&&(length<0||offset<0)||offset>this.length)throw new RangeError("Attempt to write outside buffer bounds");encoding||(encoding="utf8");for(var loweredCase=!1;;)switch(encoding){case"hex":return hexWrite(this,string,offset,length);case"utf8":case"utf-8":return utf8Write(this,string,offset,length);case"ascii":return asciiWrite(this,string,offset,length);case"latin1":case"binary":return latin1Write(this,string,offset,length);case"base64":return base64Write(this,string,offset,length);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,string,offset,length);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(""+encoding).toLowerCase(),loweredCase=!0}},Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var MAX_ARGUMENTS_LENGTH=4096;Buffer.prototype.slice=function(start,end){var len=this.length;start=~~start,end=void 0===end?len:~~end,start<0?(start+=len,start<0&&(start=0)):start>len&&(start=len),end<0?(end+=len,end<0&&(end=0)):end>len&&(end=len),end<start&&(end=start);var newBuf;if(Buffer.TYPED_ARRAY_SUPPORT)newBuf=this.subarray(start,end),newBuf.__proto__=Buffer.prototype;else{var sliceLen=end-start;newBuf=new Buffer(sliceLen,(void 0));for(var i=0;i<sliceLen;++i)newBuf[i]=this[i+start]}return newBuf},Buffer.prototype.readUIntLE=function(offset,byteLength,noAssert){offset=0|offset,byteLength=0|byteLength,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset],mul=1,i=0;++i<byteLength&&(mul*=256);)val+=this[offset+i]*mul;return val},Buffer.prototype.readUIntBE=function(offset,byteLength,noAssert){offset=0|offset,byteLength=0|byteLength,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset+--byteLength],mul=1;byteLength>0&&(mul*=256);)val+=this[offset+--byteLength]*mul;return val},Buffer.prototype.readUInt8=function(offset,noAssert){return noAssert||checkOffset(offset,1,this.length),this[offset]},Buffer.prototype.readUInt16LE=function(offset,noAssert){return noAssert||checkOffset(offset,2,this.length),this[offset]|this[offset+1]<<8},Buffer.prototype.readUInt16BE=function(offset,noAssert){return noAssert||checkOffset(offset,2,this.length),this[offset]<<8|this[offset+1]},Buffer.prototype.readUInt32LE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),(this[offset]|this[offset+1]<<8|this[offset+2]<<16)+16777216*this[offset+3]},Buffer.prototype.readUInt32BE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),16777216*this[offset]+(this[offset+1]<<16|this[offset+2]<<8|this[offset+3])},Buffer.prototype.readIntLE=function(offset,byteLength,noAssert){offset=0|offset,byteLength=0|byteLength,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset],mul=1,i=0;++i<byteLength&&(mul*=256);)val+=this[offset+i]*mul;return mul*=128,val>=mul&&(val-=Math.pow(2,8*byteLength)),val},Buffer.prototype.readIntBE=function(offset,byteLength,noAssert){offset=0|offset,byteLength=0|byteLength,noAssert||checkOffset(offset,byteLength,this.length);for(var i=byteLength,mul=1,val=this[offset+--i];i>0&&(mul*=256);)val+=this[offset+--i]*mul;return mul*=128,val>=mul&&(val-=Math.pow(2,8*byteLength)),val},Buffer.prototype.readInt8=function(offset,noAssert){return noAssert||checkOffset(offset,1,this.length),128&this[offset]?(255-this[offset]+1)*-1:this[offset]},Buffer.prototype.readInt16LE=function(offset,noAssert){noAssert||checkOffset(offset,2,this.length);var val=this[offset]|this[offset+1]<<8;return 32768&val?4294901760|val:val},Buffer.prototype.readInt16BE=function(offset,noAssert){noAssert||checkOffset(offset,2,this.length);var val=this[offset+1]|this[offset]<<8;return 32768&val?4294901760|val:val},Buffer.prototype.readInt32LE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),this[offset]|this[offset+1]<<8|this[offset+2]<<16|this[offset+3]<<24},Buffer.prototype.readInt32BE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),this[offset]<<24|this[offset+1]<<16|this[offset+2]<<8|this[offset+3]},Buffer.prototype.readFloatLE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),ieee754.read(this,offset,!0,23,4)},Buffer.prototype.readFloatBE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),ieee754.read(this,offset,!1,23,4)},Buffer.prototype.readDoubleLE=function(offset,noAssert){return noAssert||checkOffset(offset,8,this.length),ieee754.read(this,offset,!0,52,8)},Buffer.prototype.readDoubleBE=function(offset,noAssert){return noAssert||checkOffset(offset,8,this.length),ieee754.read(this,offset,!1,52,8)},Buffer.prototype.writeUIntLE=function(value,offset,byteLength,noAssert){if(value=+value,offset=0|offset,byteLength=0|byteLength,!noAssert){var maxBytes=Math.pow(2,8*byteLength)-1;checkInt(this,value,offset,byteLength,maxBytes,0)}var mul=1,i=0;for(this[offset]=255&value;++i<byteLength&&(mul*=256);)this[offset+i]=value/mul&255;return offset+byteLength},Buffer.prototype.writeUIntBE=function(value,offset,byteLength,noAssert){if(value=+value,offset=0|offset,byteLength=0|byteLength,!noAssert){var maxBytes=Math.pow(2,8*byteLength)-1;checkInt(this,value,offset,byteLength,maxBytes,0)}var i=byteLength-1,mul=1;for(this[offset+i]=255&value;--i>=0&&(mul*=256);)this[offset+i]=value/mul&255;return offset+byteLength},Buffer.prototype.writeUInt8=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,1,255,0),Buffer.TYPED_ARRAY_SUPPORT||(value=Math.floor(value)),this[offset]=255&value,offset+1},Buffer.prototype.writeUInt16LE=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=255&value,this[offset+1]=value>>>8):objectWriteUInt16(this,value,offset,!0),offset+2},Buffer.prototype.writeUInt16BE=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>8,this[offset+1]=255&value):objectWriteUInt16(this,value,offset,!1),offset+2},Buffer.prototype.writeUInt32LE=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset+3]=value>>>24,this[offset+2]=value>>>16,this[offset+1]=value>>>8,this[offset]=255&value):objectWriteUInt32(this,value,offset,!0),offset+4},Buffer.prototype.writeUInt32BE=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>24,this[offset+1]=value>>>16,this[offset+2]=value>>>8,this[offset+3]=255&value):objectWriteUInt32(this,value,offset,!1),offset+4},Buffer.prototype.writeIntLE=function(value,offset,byteLength,noAssert){if(value=+value,offset=0|offset,!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=0,mul=1,sub=0;for(this[offset]=255&value;++i<byteLength&&(mul*=256);)value<0&&0===sub&&0!==this[offset+i-1]&&(sub=1),this[offset+i]=(value/mul>>0)-sub&255;return offset+byteLength},Buffer.prototype.writeIntBE=function(value,offset,byteLength,noAssert){if(value=+value,offset=0|offset,!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=byteLength-1,mul=1,sub=0;for(this[offset+i]=255&value;--i>=0&&(mul*=256);)value<0&&0===sub&&0!==this[offset+i+1]&&(sub=1),this[offset+i]=(value/mul>>0)-sub&255;return offset+byteLength},Buffer.prototype.writeInt8=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,1,127,-128),Buffer.TYPED_ARRAY_SUPPORT||(value=Math.floor(value)),value<0&&(value=255+value+1),this[offset]=255&value,offset+1},Buffer.prototype.writeInt16LE=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=255&value,this[offset+1]=value>>>8):objectWriteUInt16(this,value,offset,!0),offset+2},Buffer.prototype.writeInt16BE=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>8,this[offset+1]=255&value):objectWriteUInt16(this,value,offset,!1),offset+2},Buffer.prototype.writeInt32LE=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,4,2147483647,-2147483648),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=255&value,this[offset+1]=value>>>8,this[offset+2]=value>>>16,this[offset+3]=value>>>24):objectWriteUInt32(this,value,offset,!0),offset+4},Buffer.prototype.writeInt32BE=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,4,2147483647,-2147483648),value<0&&(value=4294967295+value+1),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>24,this[offset+1]=value>>>16,this[offset+2]=value>>>8,this[offset+3]=255&value):objectWriteUInt32(this,value,offset,!1),offset+4},Buffer.prototype.writeFloatLE=function(value,offset,noAssert){return writeFloat(this,value,offset,!0,noAssert)},Buffer.prototype.writeFloatBE=function(value,offset,noAssert){return writeFloat(this,value,offset,!1,noAssert)},Buffer.prototype.writeDoubleLE=function(value,offset,noAssert){return writeDouble(this,value,offset,!0,noAssert)},Buffer.prototype.writeDoubleBE=function(value,offset,noAssert){return writeDouble(this,value,offset,!1,noAssert)},Buffer.prototype.copy=function(target,targetStart,start,end){if(start||(start=0),end||0===end||(end=this.length),targetStart>=target.length&&(targetStart=target.length),targetStart||(targetStart=0),end>0&&end<start&&(end=start),end===start)return 0;if(0===target.length||0===this.length)return 0;if(targetStart<0)throw new RangeError("targetStart out of bounds");if(start<0||start>=this.length)throw new RangeError("sourceStart out of bounds");if(end<0)throw new RangeError("sourceEnd out of bounds");end>this.length&&(end=this.length),target.length-targetStart<end-start&&(end=target.length-targetStart+start);var i,len=end-start;if(this===target&&start<targetStart&&targetStart<end)for(i=len-1;i>=0;--i)target[i+targetStart]=this[i+start];else if(len<1e3||!Buffer.TYPED_ARRAY_SUPPORT)for(i=0;i<len;++i)target[i+targetStart]=this[i+start];else Uint8Array.prototype.set.call(target,this.subarray(start,start+len),targetStart);return len},Buffer.prototype.fill=function(val,start,end,encoding){if("string"==typeof val){if("string"==typeof start?(encoding=start,start=0,end=this.length):"string"==typeof end&&(encoding=end,end=this.length),1===val.length){var code=val.charCodeAt(0);code<256&&(val=code)}if(void 0!==encoding&&"string"!=typeof encoding)throw new TypeError("encoding must be a string");if("string"==typeof encoding&&!Buffer.isEncoding(encoding))throw new TypeError("Unknown encoding: "+encoding)}else"number"==typeof val&&(val=255&val);if(start<0||this.length<start||this.length<end)throw new RangeError("Out of range index");if(end<=start)return this;start>>>=0,end=void 0===end?this.length:end>>>0,val||(val=0);var i;if("number"==typeof val)for(i=start;i<end;++i)this[i]=val;else{var bytes=Buffer.isBuffer(val)?val:utf8ToBytes(new Buffer(val,encoding).toString()),len=bytes.length;for(i=0;i<end-start;++i)this[i+start]=bytes[i%len];
}return this};var INVALID_BASE64_RE=/[^+\/0-9A-Za-z-_]/g}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"base64-js":17,ieee754:110,isarray:114}],50:[function(_dereq_,module,exports){(function(Buffer){function CipherBase(hashMode){Transform.call(this),this.hashMode="string"==typeof hashMode,this.hashMode?this[hashMode]=this._finalOrDigest:this.final=this._finalOrDigest,this._decoder=null,this._encoding=null}var Transform=_dereq_("stream").Transform,inherits=_dereq_("inherits"),StringDecoder=_dereq_("string_decoder").StringDecoder;module.exports=CipherBase,inherits(CipherBase,Transform),CipherBase.prototype.update=function(data,inputEnc,outputEnc){"string"==typeof data&&(data=new Buffer(data,inputEnc));var outData=this._update(data);return this.hashMode?this:(outputEnc&&(outData=this._toString(outData,outputEnc)),outData)},CipherBase.prototype.setAutoPadding=function(){},CipherBase.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")},CipherBase.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")},CipherBase.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")},CipherBase.prototype._transform=function(data,_,next){var err;try{this.hashMode?this._update(data):this.push(this._update(data))}catch(e){err=e}finally{next(err)}},CipherBase.prototype._flush=function(done){var err;try{this.push(this._final())}catch(e){err=e}finally{done(err)}},CipherBase.prototype._finalOrDigest=function(outputEnc){var outData=this._final()||new Buffer("");return outputEnc&&(outData=this._toString(outData,outputEnc,!0)),outData},CipherBase.prototype._toString=function(value,enc,fin){if(this._decoder||(this._decoder=new StringDecoder(enc),this._encoding=enc),this._encoding!==enc)throw new Error("can't switch encodings");var out=this._decoder.write(value);return fin&&(out+=this._decoder.end()),out}}).call(this,_dereq_("buffer").Buffer)},{buffer:49,inherits:112,stream:157,string_decoder:158}],51:[function(_dereq_,module,exports){(function(Buffer){function isArray(arg){return Array.isArray?Array.isArray(arg):"[object Array]"===objectToString(arg)}function isBoolean(arg){return"boolean"==typeof arg}function isNull(arg){return null===arg}function isNullOrUndefined(arg){return null==arg}function isNumber(arg){return"number"==typeof arg}function isString(arg){return"string"==typeof arg}function isSymbol(arg){return"symbol"==typeof arg}function isUndefined(arg){return void 0===arg}function isRegExp(re){return"[object RegExp]"===objectToString(re)}function isObject(arg){return"object"==typeof arg&&null!==arg}function isDate(d){return"[object Date]"===objectToString(d)}function isError(e){return"[object Error]"===objectToString(e)||e instanceof Error}function isFunction(arg){return"function"==typeof arg}function isPrimitive(arg){return null===arg||"boolean"==typeof arg||"number"==typeof arg||"string"==typeof arg||"symbol"==typeof arg||"undefined"==typeof arg}function objectToString(o){return Object.prototype.toString.call(o)}exports.isArray=isArray,exports.isBoolean=isBoolean,exports.isNull=isNull,exports.isNullOrUndefined=isNullOrUndefined,exports.isNumber=isNumber,exports.isString=isString,exports.isSymbol=isSymbol,exports.isUndefined=isUndefined,exports.isRegExp=isRegExp,exports.isObject=isObject,exports.isDate=isDate,exports.isError=isError,exports.isFunction=isFunction,exports.isPrimitive=isPrimitive,exports.isBuffer=Buffer.isBuffer}).call(this,{isBuffer:_dereq_("../../is-buffer/index.js")})},{"../../is-buffer/index.js":113}],52:[function(_dereq_,module,exports){(function(Buffer){function ECDH(curve){this.curveType=aliases[curve],this.curveType||(this.curveType={name:curve}),this.curve=new elliptic.ec(this.curveType.name),this.keys=void 0}function formatReturnValue(bn,enc,len){Array.isArray(bn)||(bn=bn.toArray());var buf=new Buffer(bn);if(len&&buf.length<len){var zeros=new Buffer(len-buf.length);zeros.fill(0),buf=Buffer.concat([zeros,buf])}return enc?buf.toString(enc):buf}var elliptic=_dereq_("elliptic"),BN=_dereq_("bn.js");module.exports=function(curve){return new ECDH(curve)};var aliases={secp256k1:{name:"secp256k1",byteLength:32},secp224r1:{name:"p224",byteLength:28},prime256v1:{name:"p256",byteLength:32},prime192v1:{name:"p192",byteLength:24},ed25519:{name:"ed25519",byteLength:32},secp384r1:{name:"p384",byteLength:48},secp521r1:{name:"p521",byteLength:66}};aliases.p224=aliases.secp224r1,aliases.p256=aliases.secp256r1=aliases.prime256v1,aliases.p192=aliases.secp192r1=aliases.prime192v1,aliases.p384=aliases.secp384r1,aliases.p521=aliases.secp521r1,ECDH.prototype.generateKeys=function(enc,format){return this.keys=this.curve.genKeyPair(),this.getPublicKey(enc,format)},ECDH.prototype.computeSecret=function(other,inenc,enc){inenc=inenc||"utf8",Buffer.isBuffer(other)||(other=new Buffer(other,inenc));var otherPub=this.curve.keyFromPublic(other).getPublic(),out=otherPub.mul(this.keys.getPrivate()).getX();return formatReturnValue(out,enc,this.curveType.byteLength)},ECDH.prototype.getPublicKey=function(enc,format){var key=this.keys.getPublic("compressed"===format,!0);return"hybrid"===format&&(key[key.length-1]%2?key[0]=7:key[0]=6),formatReturnValue(key,enc)},ECDH.prototype.getPrivateKey=function(enc){return formatReturnValue(this.keys.getPrivate(),enc)},ECDH.prototype.setPublicKey=function(pub,enc){return enc=enc||"utf8",Buffer.isBuffer(pub)||(pub=new Buffer(pub,enc)),this.keys._importPublic(pub),this},ECDH.prototype.setPrivateKey=function(priv,enc){enc=enc||"utf8",Buffer.isBuffer(priv)||(priv=new Buffer(priv,enc));var _priv=new BN(priv);return _priv=_priv.toString(16),this.keys._importPrivate(_priv),this}}).call(this,_dereq_("buffer").Buffer)},{"bn.js":18,buffer:49,elliptic:69}],53:[function(_dereq_,module,exports){(function(Buffer){"use strict";function HashNoConstructor(hash){Base.call(this,"digest"),this._hash=hash,this.buffers=[]}function Hash(hash){Base.call(this,"digest"),this._hash=hash}var inherits=_dereq_("inherits"),md5=_dereq_("./md5"),rmd160=_dereq_("ripemd160"),sha=_dereq_("sha.js"),Base=_dereq_("cipher-base");inherits(HashNoConstructor,Base),HashNoConstructor.prototype._update=function(data){this.buffers.push(data)},HashNoConstructor.prototype._final=function(){var buf=Buffer.concat(this.buffers),r=this._hash(buf);return this.buffers=null,r},inherits(Hash,Base),Hash.prototype._update=function(data){this._hash.update(data)},Hash.prototype._final=function(){return this._hash.digest()},module.exports=function(alg){return alg=alg.toLowerCase(),"md5"===alg?new HashNoConstructor(md5):"rmd160"===alg||"ripemd160"===alg?new HashNoConstructor(rmd160):new Hash(sha(alg))}}).call(this,_dereq_("buffer").Buffer)},{"./md5":55,buffer:49,"cipher-base":50,inherits:112,ripemd160:148,"sha.js":150}],54:[function(_dereq_,module,exports){(function(Buffer){"use strict";function toArray(buf,bigEndian){if(buf.length%intSize!==0){var len=buf.length+(intSize-buf.length%intSize);buf=Buffer.concat([buf,zeroBuffer],len)}for(var arr=[],fn=bigEndian?buf.readInt32BE:buf.readInt32LE,i=0;i<buf.length;i+=intSize)arr.push(fn.call(buf,i));return arr}function toBuffer(arr,size,bigEndian){for(var buf=new Buffer(size),fn=bigEndian?buf.writeInt32BE:buf.writeInt32LE,i=0;i<arr.length;i++)fn.call(buf,arr[i],4*i,!0);return buf}function hash(buf,fn,hashSize,bigEndian){Buffer.isBuffer(buf)||(buf=new Buffer(buf));var arr=fn(toArray(buf,bigEndian),buf.length*chrsz);return toBuffer(arr,hashSize,bigEndian)}var intSize=4,zeroBuffer=new Buffer(intSize);zeroBuffer.fill(0);var chrsz=8;exports.hash=hash}).call(this,_dereq_("buffer").Buffer)},{buffer:49}],55:[function(_dereq_,module,exports){"use strict";function core_md5(x,len){x[len>>5]|=128<<len%32,x[(len+64>>>9<<4)+14]=len;for(var a=1732584193,b=-271733879,c=-1732584194,d=271733878,i=0;i<x.length;i+=16){var olda=a,oldb=b,oldc=c,oldd=d;a=md5_ff(a,b,c,d,x[i+0],7,-680876936),d=md5_ff(d,a,b,c,x[i+1],12,-389564586),c=md5_ff(c,d,a,b,x[i+2],17,606105819),b=md5_ff(b,c,d,a,x[i+3],22,-1044525330),a=md5_ff(a,b,c,d,x[i+4],7,-176418897),d=md5_ff(d,a,b,c,x[i+5],12,1200080426),c=md5_ff(c,d,a,b,x[i+6],17,-1473231341),b=md5_ff(b,c,d,a,x[i+7],22,-45705983),a=md5_ff(a,b,c,d,x[i+8],7,1770035416),d=md5_ff(d,a,b,c,x[i+9],12,-1958414417),c=md5_ff(c,d,a,b,x[i+10],17,-42063),b=md5_ff(b,c,d,a,x[i+11],22,-1990404162),a=md5_ff(a,b,c,d,x[i+12],7,1804603682),d=md5_ff(d,a,b,c,x[i+13],12,-40341101),c=md5_ff(c,d,a,b,x[i+14],17,-1502002290),b=md5_ff(b,c,d,a,x[i+15],22,1236535329),a=md5_gg(a,b,c,d,x[i+1],5,-165796510),d=md5_gg(d,a,b,c,x[i+6],9,-1069501632),c=md5_gg(c,d,a,b,x[i+11],14,643717713),b=md5_gg(b,c,d,a,x[i+0],20,-373897302),a=md5_gg(a,b,c,d,x[i+5],5,-701558691),d=md5_gg(d,a,b,c,x[i+10],9,38016083),c=md5_gg(c,d,a,b,x[i+15],14,-660478335),b=md5_gg(b,c,d,a,x[i+4],20,-405537848),a=md5_gg(a,b,c,d,x[i+9],5,568446438),d=md5_gg(d,a,b,c,x[i+14],9,-1019803690),c=md5_gg(c,d,a,b,x[i+3],14,-187363961),b=md5_gg(b,c,d,a,x[i+8],20,1163531501),a=md5_gg(a,b,c,d,x[i+13],5,-1444681467),d=md5_gg(d,a,b,c,x[i+2],9,-51403784),c=md5_gg(c,d,a,b,x[i+7],14,1735328473),b=md5_gg(b,c,d,a,x[i+12],20,-1926607734),a=md5_hh(a,b,c,d,x[i+5],4,-378558),d=md5_hh(d,a,b,c,x[i+8],11,-2022574463),c=md5_hh(c,d,a,b,x[i+11],16,1839030562),b=md5_hh(b,c,d,a,x[i+14],23,-35309556),a=md5_hh(a,b,c,d,x[i+1],4,-1530992060),d=md5_hh(d,a,b,c,x[i+4],11,1272893353),c=md5_hh(c,d,a,b,x[i+7],16,-155497632),b=md5_hh(b,c,d,a,x[i+10],23,-1094730640),a=md5_hh(a,b,c,d,x[i+13],4,681279174),d=md5_hh(d,a,b,c,x[i+0],11,-358537222),c=md5_hh(c,d,a,b,x[i+3],16,-722521979),b=md5_hh(b,c,d,a,x[i+6],23,76029189),a=md5_hh(a,b,c,d,x[i+9],4,-640364487),d=md5_hh(d,a,b,c,x[i+12],11,-421815835),c=md5_hh(c,d,a,b,x[i+15],16,530742520),b=md5_hh(b,c,d,a,x[i+2],23,-995338651),a=md5_ii(a,b,c,d,x[i+0],6,-198630844),d=md5_ii(d,a,b,c,x[i+7],10,1126891415),c=md5_ii(c,d,a,b,x[i+14],15,-1416354905),b=md5_ii(b,c,d,a,x[i+5],21,-57434055),a=md5_ii(a,b,c,d,x[i+12],6,1700485571),d=md5_ii(d,a,b,c,x[i+3],10,-1894986606),c=md5_ii(c,d,a,b,x[i+10],15,-1051523),b=md5_ii(b,c,d,a,x[i+1],21,-2054922799),a=md5_ii(a,b,c,d,x[i+8],6,1873313359),d=md5_ii(d,a,b,c,x[i+15],10,-30611744),c=md5_ii(c,d,a,b,x[i+6],15,-1560198380),b=md5_ii(b,c,d,a,x[i+13],21,1309151649),a=md5_ii(a,b,c,d,x[i+4],6,-145523070),d=md5_ii(d,a,b,c,x[i+11],10,-1120210379),c=md5_ii(c,d,a,b,x[i+2],15,718787259),b=md5_ii(b,c,d,a,x[i+9],21,-343485551),a=safe_add(a,olda),b=safe_add(b,oldb),c=safe_add(c,oldc),d=safe_add(d,oldd)}return Array(a,b,c,d)}function md5_cmn(q,a,b,x,s,t){return safe_add(bit_rol(safe_add(safe_add(a,q),safe_add(x,t)),s),b)}function md5_ff(a,b,c,d,x,s,t){return md5_cmn(b&c|~b&d,a,b,x,s,t)}function md5_gg(a,b,c,d,x,s,t){return md5_cmn(b&d|c&~d,a,b,x,s,t)}function md5_hh(a,b,c,d,x,s,t){return md5_cmn(b^c^d,a,b,x,s,t)}function md5_ii(a,b,c,d,x,s,t){return md5_cmn(c^(b|~d),a,b,x,s,t)}function safe_add(x,y){var lsw=(65535&x)+(65535&y),msw=(x>>16)+(y>>16)+(lsw>>16);return msw<<16|65535&lsw}function bit_rol(num,cnt){return num<<cnt|num>>>32-cnt}var helpers=_dereq_("./helpers");module.exports=function(buf){return helpers.hash(buf,core_md5,16)}},{"./helpers":54}],56:[function(_dereq_,module,exports){(function(Buffer){"use strict";function Hmac(alg,key){Transform.call(this),alg=alg.toLowerCase(),"string"==typeof key&&(key=new Buffer(key));var blocksize="sha512"===alg||"sha384"===alg?128:64;this._alg=alg,this._key=key,key.length>blocksize?key=createHash(alg).update(key).digest():key.length<blocksize&&(key=Buffer.concat([key,ZEROS],blocksize));for(var ipad=this._ipad=new Buffer(blocksize),opad=this._opad=new Buffer(blocksize),i=0;i<blocksize;i++)ipad[i]=54^key[i],opad[i]=92^key[i];this._hash=createHash(alg).update(ipad)}var createHash=_dereq_("create-hash/browser"),inherits=_dereq_("inherits"),Transform=_dereq_("stream").Transform,ZEROS=new Buffer(128);ZEROS.fill(0),inherits(Hmac,Transform),Hmac.prototype.update=function(data,enc){return this._hash.update(data,enc),this},Hmac.prototype._transform=function(data,_,next){this._hash.update(data),next()},Hmac.prototype._flush=function(next){this.push(this.digest()),next()},Hmac.prototype.digest=function(enc){var h=this._hash.digest();return createHash(this._alg).update(this._opad).update(h).digest(enc)},module.exports=function(alg,key){return new Hmac(alg,key)}}).call(this,_dereq_("buffer").Buffer)},{buffer:49,"create-hash/browser":53,inherits:112,stream:157}],57:[function(_dereq_,module,exports){"use strict";exports.randomBytes=exports.rng=exports.pseudoRandomBytes=exports.prng=_dereq_("randombytes"),exports.createHash=exports.Hash=_dereq_("create-hash"),exports.createHmac=exports.Hmac=_dereq_("create-hmac");var hashes=["sha1","sha224","sha256","sha384","sha512","md5","rmd160"].concat(Object.keys(_dereq_("browserify-sign/algos")));exports.getHashes=function(){return hashes};var p=_dereq_("pbkdf2");exports.pbkdf2=p.pbkdf2,exports.pbkdf2Sync=p.pbkdf2Sync;var aes=_dereq_("browserify-cipher");["Cipher","createCipher","Cipheriv","createCipheriv","Decipher","createDecipher","Decipheriv","createDecipheriv","getCiphers","listCiphers"].forEach(function(key){exports[key]=aes[key]});var dh=_dereq_("diffie-hellman");["DiffieHellmanGroup","createDiffieHellmanGroup","getDiffieHellman","createDiffieHellman","DiffieHellman"].forEach(function(key){exports[key]=dh[key]});var sign=_dereq_("browserify-sign");["createSign","Sign","createVerify","Verify"].forEach(function(key){exports[key]=sign[key]}),exports.createECDH=_dereq_("create-ecdh");var publicEncrypt=_dereq_("public-encrypt");["publicEncrypt","privateEncrypt","publicDecrypt","privateDecrypt"].forEach(function(key){exports[key]=publicEncrypt[key]}),["createCredentials"].forEach(function(name){exports[name]=function(){throw new Error(["sorry, "+name+" is not implemented yet","we accept pull requests","https://github.com/crypto-browserify/crypto-browserify"].join("\n"))}})},{"browserify-cipher":36,"browserify-sign":43,"browserify-sign/algos":40,"create-ecdh":52,"create-hash":53,"create-hmac":56,"diffie-hellman":65,pbkdf2:124,"public-encrypt":130,randombytes:136}],58:[function(_dereq_,module,exports){"use strict";var d,assign=_dereq_("es5-ext/object/assign"),normalizeOpts=_dereq_("es5-ext/object/normalize-options"),isCallable=_dereq_("es5-ext/object/is-callable"),contains=_dereq_("es5-ext/string/#/contains");d=module.exports=function(dscr,value){var c,e,w,options,desc;return arguments.length<2||"string"!=typeof dscr?(options=value,value=dscr,dscr=null):options=arguments[2],null==dscr?(c=w=!0,e=!1):(c=contains.call(dscr,"c"),e=contains.call(dscr,"e"),w=contains.call(dscr,"w")),desc={value:value,configurable:c,enumerable:e,writable:w},options?assign(normalizeOpts(options),desc):desc},d.gs=function(dscr,get,set){var c,e,options,desc;return"string"!=typeof dscr?(options=set,set=get,get=dscr,dscr=null):options=arguments[3],null==get?get=void 0:isCallable(get)?null==set?set=void 0:isCallable(set)||(options=set,set=void 0):(options=get,get=set=void 0),null==dscr?(c=!0,e=!1):(c=contains.call(dscr,"c"),e=contains.call(dscr,"e")),desc={get:get,set:set,configurable:c,enumerable:e},options?assign(normalizeOpts(options),desc):desc}},{"es5-ext/object/assign":85,"es5-ext/object/is-callable":88,"es5-ext/object/normalize-options":92,"es5-ext/string/#/contains":95}],59:[function(_dereq_,module,exports){"use strict";exports.utils=_dereq_("./des/utils"),exports.Cipher=_dereq_("./des/cipher"),exports.DES=_dereq_("./des/des"),exports.CBC=_dereq_("./des/cbc"),exports.EDE=_dereq_("./des/ede")},{"./des/cbc":60,"./des/cipher":61,"./des/des":62,"./des/ede":63,"./des/utils":64}],60:[function(_dereq_,module,exports){"use strict";function CBCState(iv){assert.equal(iv.length,8,"Invalid IV length"),this.iv=new Array(8);for(var i=0;i<this.iv.length;i++)this.iv[i]=iv[i]}function instantiate(Base){function CBC(options){Base.call(this,options),this._cbcInit()}inherits(CBC,Base);for(var keys=Object.keys(proto),i=0;i<keys.length;i++){var key=keys[i];CBC.prototype[key]=proto[key]}return CBC.create=function(options){return new CBC(options)},CBC}var assert=_dereq_("minimalistic-assert"),inherits=_dereq_("inherits"),proto={};exports.instantiate=instantiate,proto._cbcInit=function(){var state=new CBCState(this.options.iv);this._cbcState=state},proto._update=function(inp,inOff,out,outOff){var state=this._cbcState,superProto=this.constructor.super_.prototype,iv=state.iv;if("encrypt"===this.type){for(var i=0;i<this.blockSize;i++)iv[i]^=inp[inOff+i];superProto._update.call(this,iv,0,out,outOff);for(var i=0;i<this.blockSize;i++)iv[i]=out[outOff+i]}else{superProto._update.call(this,inp,inOff,out,outOff);for(var i=0;i<this.blockSize;i++)out[outOff+i]^=iv[i];for(var i=0;i<this.blockSize;i++)iv[i]=inp[inOff+i]}}},{inherits:112,"minimalistic-assert":117}],61:[function(_dereq_,module,exports){"use strict";function Cipher(options){this.options=options,this.type=this.options.type,this.blockSize=8,this._init(),this.buffer=new Array(this.blockSize),this.bufferOff=0}var assert=_dereq_("minimalistic-assert");module.exports=Cipher,Cipher.prototype._init=function(){},Cipher.prototype.update=function(data){return 0===data.length?[]:"decrypt"===this.type?this._updateDecrypt(data):this._updateEncrypt(data)},Cipher.prototype._buffer=function(data,off){for(var min=Math.min(this.buffer.length-this.bufferOff,data.length-off),i=0;i<min;i++)this.buffer[this.bufferOff+i]=data[off+i];return this.bufferOff+=min,min},Cipher.prototype._flushBuffer=function(out,off){return this._update(this.buffer,0,out,off),this.bufferOff=0,this.blockSize},Cipher.prototype._updateEncrypt=function(data){var inputOff=0,outputOff=0,count=(this.bufferOff+data.length)/this.blockSize|0,out=new Array(count*this.blockSize);0!==this.bufferOff&&(inputOff+=this._buffer(data,inputOff),this.bufferOff===this.buffer.length&&(outputOff+=this._flushBuffer(out,outputOff)));for(var max=data.length-(data.length-inputOff)%this.blockSize;inputOff<max;inputOff+=this.blockSize)this._update(data,inputOff,out,outputOff),outputOff+=this.blockSize;for(;inputOff<data.length;inputOff++,this.bufferOff++)this.buffer[this.bufferOff]=data[inputOff];return out},Cipher.prototype._updateDecrypt=function(data){for(var inputOff=0,outputOff=0,count=Math.ceil((this.bufferOff+data.length)/this.blockSize)-1,out=new Array(count*this.blockSize);count>0;count--)inputOff+=this._buffer(data,inputOff),outputOff+=this._flushBuffer(out,outputOff);return inputOff+=this._buffer(data,inputOff),out},Cipher.prototype.final=function(buffer){var first;buffer&&(first=this.update(buffer));var last;return last="encrypt"===this.type?this._finalEncrypt():this._finalDecrypt(),first?first.concat(last):last},Cipher.prototype._pad=function(buffer,off){if(0===off)return!1;for(;off<buffer.length;)buffer[off++]=0;return!0},Cipher.prototype._finalEncrypt=function(){if(!this._pad(this.buffer,this.bufferOff))return[];var out=new Array(this.blockSize);return this._update(this.buffer,0,out,0),out},Cipher.prototype._unpad=function(buffer){return buffer},Cipher.prototype._finalDecrypt=function(){assert.equal(this.bufferOff,this.blockSize,"Not enough data to decrypt");var out=new Array(this.blockSize);return this._flushBuffer(out,0),this._unpad(out)}},{"minimalistic-assert":117}],62:[function(_dereq_,module,exports){"use strict";function DESState(){this.tmp=new Array(2),this.keys=null}function DES(options){Cipher.call(this,options);var state=new DESState;this._desState=state,this.deriveKeys(state,options.key)}var assert=_dereq_("minimalistic-assert"),inherits=_dereq_("inherits"),des=_dereq_("../des"),utils=des.utils,Cipher=des.Cipher;inherits(DES,Cipher),module.exports=DES,DES.create=function(options){return new DES(options)};var shiftTable=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];DES.prototype.deriveKeys=function(state,key){state.keys=new Array(32),assert.equal(key.length,this.blockSize,"Invalid key length");var kL=utils.readUInt32BE(key,0),kR=utils.readUInt32BE(key,4);utils.pc1(kL,kR,state.tmp,0),kL=state.tmp[0],kR=state.tmp[1];for(var i=0;i<state.keys.length;i+=2){var shift=shiftTable[i>>>1];kL=utils.r28shl(kL,shift),kR=utils.r28shl(kR,shift),utils.pc2(kL,kR,state.keys,i)}},DES.prototype._update=function(inp,inOff,out,outOff){var state=this._desState,l=utils.readUInt32BE(inp,inOff),r=utils.readUInt32BE(inp,inOff+4);utils.ip(l,r,state.tmp,0),l=state.tmp[0],r=state.tmp[1],"encrypt"===this.type?this._encrypt(state,l,r,state.tmp,0):this._decrypt(state,l,r,state.tmp,0),l=state.tmp[0],r=state.tmp[1],utils.writeUInt32BE(out,l,outOff),utils.writeUInt32BE(out,r,outOff+4)},DES.prototype._pad=function(buffer,off){for(var value=buffer.length-off,i=off;i<buffer.length;i++)buffer[i]=value;return!0},DES.prototype._unpad=function(buffer){for(var pad=buffer[buffer.length-1],i=buffer.length-pad;i<buffer.length;i++)assert.equal(buffer[i],pad);return buffer.slice(0,buffer.length-pad)},DES.prototype._encrypt=function(state,lStart,rStart,out,off){for(var l=lStart,r=rStart,i=0;i<state.keys.length;i+=2){var keyL=state.keys[i],keyR=state.keys[i+1];utils.expand(r,state.tmp,0),keyL^=state.tmp[0],keyR^=state.tmp[1];var s=utils.substitute(keyL,keyR),f=utils.permute(s),t=r;r=(l^f)>>>0,l=t}utils.rip(r,l,out,off)},DES.prototype._decrypt=function(state,lStart,rStart,out,off){for(var l=rStart,r=lStart,i=state.keys.length-2;i>=0;i-=2){var keyL=state.keys[i],keyR=state.keys[i+1];utils.expand(l,state.tmp,0),keyL^=state.tmp[0],keyR^=state.tmp[1];var s=utils.substitute(keyL,keyR),f=utils.permute(s),t=l;l=(r^f)>>>0,r=t}utils.rip(l,r,out,off)}},{"../des":59,inherits:112,"minimalistic-assert":117}],63:[function(_dereq_,module,exports){"use strict";function EDEState(type,key){assert.equal(key.length,24,"Invalid key length");var k1=key.slice(0,8),k2=key.slice(8,16),k3=key.slice(16,24);"encrypt"===type?this.ciphers=[DES.create({type:"encrypt",key:k1}),DES.create({type:"decrypt",key:k2}),DES.create({type:"encrypt",key:k3})]:this.ciphers=[DES.create({type:"decrypt",key:k3}),DES.create({type:"encrypt",key:k2}),DES.create({type:"decrypt",key:k1})]}function EDE(options){Cipher.call(this,options);var state=new EDEState(this.type,this.options.key);this._edeState=state}var assert=_dereq_("minimalistic-assert"),inherits=_dereq_("inherits"),des=_dereq_("../des"),Cipher=des.Cipher,DES=des.DES;inherits(EDE,Cipher),module.exports=EDE,EDE.create=function(options){return new EDE(options)},EDE.prototype._update=function(inp,inOff,out,outOff){var state=this._edeState;state.ciphers[0]._update(inp,inOff,out,outOff),state.ciphers[1]._update(out,outOff,out,outOff),state.ciphers[2]._update(out,outOff,out,outOff)},EDE.prototype._pad=DES.prototype._pad,EDE.prototype._unpad=DES.prototype._unpad},{"../des":59,inherits:112,"minimalistic-assert":117}],64:[function(_dereq_,module,exports){"use strict";exports.readUInt32BE=function(bytes,off){var res=bytes[0+off]<<24|bytes[1+off]<<16|bytes[2+off]<<8|bytes[3+off];return res>>>0},exports.writeUInt32BE=function(bytes,value,off){bytes[0+off]=value>>>24,bytes[1+off]=value>>>16&255,bytes[2+off]=value>>>8&255,bytes[3+off]=255&value},exports.ip=function(inL,inR,out,off){for(var outL=0,outR=0,i=6;i>=0;i-=2){for(var j=0;j<=24;j+=8)outL<<=1,outL|=inR>>>j+i&1;for(var j=0;j<=24;j+=8)outL<<=1,outL|=inL>>>j+i&1}for(var i=6;i>=0;i-=2){for(var j=1;j<=25;j+=8)outR<<=1,outR|=inR>>>j+i&1;for(var j=1;j<=25;j+=8)outR<<=1,outR|=inL>>>j+i&1}out[off+0]=outL>>>0,out[off+1]=outR>>>0},exports.rip=function(inL,inR,out,off){for(var outL=0,outR=0,i=0;i<4;i++)for(var j=24;j>=0;j-=8)outL<<=1,outL|=inR>>>j+i&1,outL<<=1,outL|=inL>>>j+i&1;for(var i=4;i<8;i++)for(var j=24;j>=0;j-=8)outR<<=1,outR|=inR>>>j+i&1,outR<<=1,outR|=inL>>>j+i&1;out[off+0]=outL>>>0,out[off+1]=outR>>>0},exports.pc1=function(inL,inR,out,off){for(var outL=0,outR=0,i=7;i>=5;i--){for(var j=0;j<=24;j+=8)outL<<=1,outL|=inR>>j+i&1;for(var j=0;j<=24;j+=8)outL<<=1,outL|=inL>>j+i&1}for(var j=0;j<=24;j+=8)outL<<=1,outL|=inR>>j+i&1;for(var i=1;i<=3;i++){for(var j=0;j<=24;j+=8)outR<<=1,outR|=inR>>j+i&1;for(var j=0;j<=24;j+=8)outR<<=1,outR|=inL>>j+i&1}for(var j=0;j<=24;j+=8)outR<<=1,outR|=inL>>j+i&1;out[off+0]=outL>>>0,out[off+1]=outR>>>0},exports.r28shl=function(num,shift){return num<<shift&268435455|num>>>28-shift};var pc2table=[14,11,17,4,27,23,25,0,13,22,7,18,5,9,16,24,2,20,12,21,1,8,15,26,15,4,25,19,9,1,26,16,5,11,23,8,12,7,17,0,22,3,10,14,6,20,27,24];exports.pc2=function(inL,inR,out,off){for(var outL=0,outR=0,len=pc2table.length>>>1,i=0;i<len;i++)outL<<=1,outL|=inL>>>pc2table[i]&1;for(var i=len;i<pc2table.length;i++)outR<<=1,outR|=inR>>>pc2table[i]&1;out[off+0]=outL>>>0,out[off+1]=outR>>>0},exports.expand=function(r,out,off){var outL=0,outR=0;outL=(1&r)<<5|r>>>27;for(var i=23;i>=15;i-=4)outL<<=6,outL|=r>>>i&63;for(var i=11;i>=3;i-=4)outR|=r>>>i&63,outR<<=6;outR|=(31&r)<<1|r>>>31,out[off+0]=outL>>>0,out[off+1]=outR>>>0};var sTable=[14,0,4,15,13,7,1,4,2,14,15,2,11,13,8,1,3,10,10,6,6,12,12,11,5,9,9,5,0,3,7,8,4,15,1,12,14,8,8,2,13,4,6,9,2,1,11,7,15,5,12,11,9,3,7,14,3,10,10,0,5,6,0,13,15,3,1,13,8,4,14,7,6,15,11,2,3,8,4,14,9,12,7,0,2,1,13,10,12,6,0,9,5,11,10,5,0,13,14,8,7,10,11,1,10,3,4,15,13,4,1,2,5,11,8,6,12,7,6,12,9,0,3,5,2,14,15,9,10,13,0,7,9,0,14,9,6,3,3,4,15,6,5,10,1,2,13,8,12,5,7,14,11,12,4,11,2,15,8,1,13,1,6,10,4,13,9,0,8,6,15,9,3,8,0,7,11,4,1,15,2,14,12,3,5,11,10,5,14,2,7,12,7,13,13,8,14,11,3,5,0,6,6,15,9,0,10,3,1,4,2,7,8,2,5,12,11,1,12,10,4,14,15,9,10,3,6,15,9,0,0,6,12,10,11,1,7,13,13,8,15,9,1,4,3,5,14,11,5,12,2,7,8,2,4,14,2,14,12,11,4,2,1,12,7,4,10,7,11,13,6,1,8,5,5,0,3,15,15,10,13,3,0,9,14,8,9,6,4,11,2,8,1,12,11,7,10,1,13,14,7,2,8,13,15,6,9,15,12,0,5,9,6,10,3,4,0,5,14,3,12,10,1,15,10,4,15,2,9,7,2,12,6,9,8,5,0,6,13,1,3,13,4,14,14,0,7,11,5,3,11,8,9,4,14,3,15,2,5,12,2,9,8,5,12,15,3,10,7,11,0,14,4,1,10,7,1,6,13,0,11,8,6,13,4,13,11,0,2,11,14,7,15,4,0,9,8,1,13,10,3,14,12,3,9,5,7,12,5,2,10,15,6,8,1,6,1,6,4,11,11,13,13,8,12,1,3,4,7,10,14,7,10,9,15,5,6,0,8,15,0,14,5,2,9,3,2,12,13,1,2,15,8,13,4,8,6,10,15,3,11,7,1,4,10,12,9,5,3,6,14,11,5,0,0,14,12,9,7,2,7,2,11,1,4,14,1,7,9,4,12,10,14,8,2,13,0,15,6,12,10,9,13,0,15,3,3,5,5,6,8,11];exports.substitute=function(inL,inR){for(var out=0,i=0;i<4;i++){var b=inL>>>18-6*i&63,sb=sTable[64*i+b];out<<=4,out|=sb}for(var i=0;i<4;i++){var b=inR>>>18-6*i&63,sb=sTable[256+64*i+b];out<<=4,out|=sb}return out>>>0};var permuteTable=[16,25,12,11,3,20,4,15,31,17,9,6,27,14,1,22,30,24,8,18,0,5,29,23,13,19,2,26,10,21,28,7];exports.permute=function(num){for(var out=0,i=0;i<permuteTable.length;i++)out<<=1,out|=num>>>permuteTable[i]&1;return out>>>0},exports.padSplit=function(num,size,group){for(var str=num.toString(2);str.length<size;)str="0"+str;for(var out=[],i=0;i<size;i+=group)out.push(str.slice(i,i+group));return out.join(" ")}},{}],65:[function(_dereq_,module,exports){(function(Buffer){function getDiffieHellman(mod){var prime=new Buffer(primes[mod].prime,"hex"),gen=new Buffer(primes[mod].gen,"hex");return new DH(prime,gen)}function createDiffieHellman(prime,enc,generator,genc){return Buffer.isBuffer(enc)||void 0===ENCODINGS[enc]?createDiffieHellman(prime,"binary",enc,generator):(enc=enc||"binary",genc=genc||"binary",generator=generator||new Buffer([2]),Buffer.isBuffer(generator)||(generator=new Buffer(generator,genc)),"number"==typeof prime?new DH(generatePrime(prime,generator),generator,(!0)):(Buffer.isBuffer(prime)||(prime=new Buffer(prime,enc)),new DH(prime,generator,(!0))))}var generatePrime=_dereq_("./lib/generatePrime"),primes=_dereq_("./lib/primes.json"),DH=_dereq_("./lib/dh"),ENCODINGS={binary:!0,hex:!0,base64:!0};exports.DiffieHellmanGroup=exports.createDiffieHellmanGroup=exports.getDiffieHellman=getDiffieHellman,exports.createDiffieHellman=exports.DiffieHellman=createDiffieHellman}).call(this,_dereq_("buffer").Buffer)},{"./lib/dh":66,"./lib/generatePrime":67,"./lib/primes.json":68,buffer:49}],66:[function(_dereq_,module,exports){(function(Buffer){function setPublicKey(pub,enc){return enc=enc||"utf8",Buffer.isBuffer(pub)||(pub=new Buffer(pub,enc)),this._pub=new BN(pub),this}function setPrivateKey(priv,enc){return enc=enc||"utf8",Buffer.isBuffer(priv)||(priv=new Buffer(priv,enc)),this._priv=new BN(priv),this}function checkPrime(prime,generator){var gen=generator.toString("hex"),hex=[gen,prime.toString(16)].join("_");if(hex in primeCache)return primeCache[hex];var error=0;if(prime.isEven()||!primes.simpleSieve||!primes.fermatTest(prime)||!millerRabin.test(prime))return error+=1,error+="02"===gen||"05"===gen?8:4,primeCache[hex]=error,error;millerRabin.test(prime.shrn(1))||(error+=2);var rem;switch(gen){case"02":prime.mod(TWENTYFOUR).cmp(ELEVEN)&&(error+=8);break;case"05":rem=prime.mod(TEN),rem.cmp(THREE)&&rem.cmp(SEVEN)&&(error+=8);break;default:error+=4}return primeCache[hex]=error,error}function DH(prime,generator,malleable){this.setGenerator(generator),this.__prime=new BN(prime),this._prime=BN.mont(this.__prime),this._primeLen=prime.length,this._pub=void 0,this._priv=void 0,this._primeCode=void 0,malleable?(this.setPublicKey=setPublicKey,this.setPrivateKey=setPrivateKey):this._primeCode=8}function formatReturnValue(bn,enc){var buf=new Buffer(bn.toArray());return enc?buf.toString(enc):buf}var BN=_dereq_("bn.js"),MillerRabin=_dereq_("miller-rabin"),millerRabin=new MillerRabin,TWENTYFOUR=new BN(24),ELEVEN=new BN(11),TEN=new BN(10),THREE=new BN(3),SEVEN=new BN(7),primes=_dereq_("./generatePrime"),randomBytes=_dereq_("randombytes");module.exports=DH;var primeCache={};Object.defineProperty(DH.prototype,"verifyError",{enumerable:!0,get:function(){return"number"!=typeof this._primeCode&&(this._primeCode=checkPrime(this.__prime,this.__gen)),this._primeCode}}),DH.prototype.generateKeys=function(){return this._priv||(this._priv=new BN(randomBytes(this._primeLen))),this._pub=this._gen.toRed(this._prime).redPow(this._priv).fromRed(),this.getPublicKey()},DH.prototype.computeSecret=function(other){other=new BN(other),other=other.toRed(this._prime);var secret=other.redPow(this._priv).fromRed(),out=new Buffer(secret.toArray()),prime=this.getPrime();if(out.length<prime.length){var front=new Buffer(prime.length-out.length);front.fill(0),out=Buffer.concat([front,out])}return out},DH.prototype.getPublicKey=function(enc){return formatReturnValue(this._pub,enc)},DH.prototype.getPrivateKey=function(enc){return formatReturnValue(this._priv,enc)},DH.prototype.getPrime=function(enc){return formatReturnValue(this.__prime,enc)},DH.prototype.getGenerator=function(enc){return formatReturnValue(this._gen,enc)},DH.prototype.setGenerator=function(gen,enc){return enc=enc||"utf8",Buffer.isBuffer(gen)||(gen=new Buffer(gen,enc)),this.__gen=gen,this._gen=new BN(gen),this}}).call(this,_dereq_("buffer").Buffer)},{"./generatePrime":67,"bn.js":18,buffer:49,"miller-rabin":116,randombytes:136}],67:[function(_dereq_,module,exports){function _getPrimes(){if(null!==primes)return primes;var limit=1048576,res=[];res[0]=2;for(var i=1,k=3;k<limit;k+=2){for(var sqrt=Math.ceil(Math.sqrt(k)),j=0;j<i&&res[j]<=sqrt&&k%res[j]!==0;j++);i!==j&&res[j]<=sqrt||(res[i++]=k)}return primes=res,res}function simpleSieve(p){for(var primes=_getPrimes(),i=0;i<primes.length;i++)if(0===p.modn(primes[i]))return 0===p.cmpn(primes[i]);return!0}function fermatTest(p){var red=BN.mont(p);return 0===TWO.toRed(red).redPow(p.subn(1)).fromRed().cmpn(1)}function findPrime(bits,gen){if(bits<16)return new BN(2===gen||5===gen?[140,123]:[140,39]);gen=new BN(gen);for(var num,n2;;){for(num=new BN(randomBytes(Math.ceil(bits/8)));num.bitLength()>bits;)num.ishrn(1);if(num.isEven()&&num.iadd(ONE),num.testn(1)||num.iadd(TWO),gen.cmp(TWO)){if(!gen.cmp(FIVE))for(;num.mod(TEN).cmp(THREE);)num.iadd(FOUR)}else for(;num.mod(TWENTYFOUR).cmp(ELEVEN);)num.iadd(FOUR);if(n2=num.shrn(1),simpleSieve(n2)&&simpleSieve(num)&&fermatTest(n2)&&fermatTest(num)&&millerRabin.test(n2)&&millerRabin.test(num))return num}}var randomBytes=_dereq_("randombytes");module.exports=findPrime,findPrime.simpleSieve=simpleSieve,findPrime.fermatTest=fermatTest;var BN=_dereq_("bn.js"),TWENTYFOUR=new BN(24),MillerRabin=_dereq_("miller-rabin"),millerRabin=new MillerRabin,ONE=new BN(1),TWO=new BN(2),FIVE=new BN(5),TEN=(new BN(16),
new BN(8),new BN(10)),THREE=new BN(3),ELEVEN=(new BN(7),new BN(11)),FOUR=new BN(4),primes=(new BN(12),null)},{"bn.js":18,"miller-rabin":116,randombytes:136}],68:[function(_dereq_,module,exports){module.exports={modp1:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a63a3620ffffffffffffffff"},modp2:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece65381ffffffffffffffff"},modp5:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff"},modp14:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff"},modp15:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a93ad2caffffffffffffffff"},modp16:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c934063199ffffffffffffffff"},modp17:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dcc4024ffffffffffffffff"},modp18:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dbe115974a3926f12fee5e438777cb6a932df8cd8bec4d073b931ba3bc832b68d9dd300741fa7bf8afc47ed2576f6936ba424663aab639c5ae4f5683423b4742bf1c978238f16cbe39d652de3fdb8befc848ad922222e04a4037c0713eb57a81a23f0c73473fc646cea306b4bcbc8862f8385ddfa9d4b7fa2c087e879683303ed5bdd3a062b3cf5b3a278a66d2a13f83f44f82ddf310ee074ab6a364597e899a0255dc164f31cc50846851df9ab48195ded7ea1b1d510bd7ee74d73faf36bc31ecfa268359046f4eb879f924009438b481c6cd7889a002ed5ee382bc9190da6fc026e479558e4475677e9aa9e3050e2765694dfc81f56e880b96e7160c980dd98edd3dfffffffffffffffff"}}},{}],69:[function(_dereq_,module,exports){"use strict";var elliptic=exports;elliptic.version=_dereq_("../package.json").version,elliptic.utils=_dereq_("./elliptic/utils"),elliptic.rand=_dereq_("brorand"),elliptic.curve=_dereq_("./elliptic/curve"),elliptic.curves=_dereq_("./elliptic/curves"),elliptic.ec=_dereq_("./elliptic/ec"),elliptic.eddsa=_dereq_("./elliptic/eddsa")},{"../package.json":84,"./elliptic/curve":72,"./elliptic/curves":75,"./elliptic/ec":76,"./elliptic/eddsa":79,"./elliptic/utils":83,brorand:19}],70:[function(_dereq_,module,exports){"use strict";function BaseCurve(type,conf){this.type=type,this.p=new BN(conf.p,16),this.red=conf.prime?BN.red(conf.prime):BN.mont(this.p),this.zero=new BN(0).toRed(this.red),this.one=new BN(1).toRed(this.red),this.two=new BN(2).toRed(this.red),this.n=conf.n&&new BN(conf.n,16),this.g=conf.g&&this.pointFromJSON(conf.g,conf.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4);var adjustCount=this.n&&this.p.div(this.n);!adjustCount||adjustCount.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}function BasePoint(curve,type){this.curve=curve,this.type=type,this.precomputed=null}var BN=_dereq_("bn.js"),elliptic=_dereq_("../../elliptic"),utils=elliptic.utils,getNAF=utils.getNAF,getJSF=utils.getJSF,assert=utils.assert;module.exports=BaseCurve,BaseCurve.prototype.point=function(){throw new Error("Not implemented")},BaseCurve.prototype.validate=function(){throw new Error("Not implemented")},BaseCurve.prototype._fixedNafMul=function(p,k){assert(p.precomputed);var doubles=p._getDoubles(),naf=getNAF(k,1),I=(1<<doubles.step+1)-(doubles.step%2===0?2:1);I/=3;for(var repr=[],j=0;j<naf.length;j+=doubles.step){for(var nafW=0,k=j+doubles.step-1;k>=j;k--)nafW=(nafW<<1)+naf[k];repr.push(nafW)}for(var a=this.jpoint(null,null,null),b=this.jpoint(null,null,null),i=I;i>0;i--){for(var j=0;j<repr.length;j++){var nafW=repr[j];nafW===i?b=b.mixedAdd(doubles.points[j]):nafW===-i&&(b=b.mixedAdd(doubles.points[j].neg()))}a=a.add(b)}return a.toP()},BaseCurve.prototype._wnafMul=function(p,k){var w=4,nafPoints=p._getNAFPoints(w);w=nafPoints.wnd;for(var wnd=nafPoints.points,naf=getNAF(k,w),acc=this.jpoint(null,null,null),i=naf.length-1;i>=0;i--){for(var k=0;i>=0&&0===naf[i];i--)k++;if(i>=0&&k++,acc=acc.dblp(k),i<0)break;var z=naf[i];assert(0!==z),acc="affine"===p.type?z>0?acc.mixedAdd(wnd[z-1>>1]):acc.mixedAdd(wnd[-z-1>>1].neg()):z>0?acc.add(wnd[z-1>>1]):acc.add(wnd[-z-1>>1].neg())}return"affine"===p.type?acc.toP():acc},BaseCurve.prototype._wnafMulAdd=function(defW,points,coeffs,len,jacobianResult){for(var wndWidth=this._wnafT1,wnd=this._wnafT2,naf=this._wnafT3,max=0,i=0;i<len;i++){var p=points[i],nafPoints=p._getNAFPoints(defW);wndWidth[i]=nafPoints.wnd,wnd[i]=nafPoints.points}for(var i=len-1;i>=1;i-=2){var a=i-1,b=i;if(1===wndWidth[a]&&1===wndWidth[b]){var comb=[points[a],null,null,points[b]];0===points[a].y.cmp(points[b].y)?(comb[1]=points[a].add(points[b]),comb[2]=points[a].toJ().mixedAdd(points[b].neg())):0===points[a].y.cmp(points[b].y.redNeg())?(comb[1]=points[a].toJ().mixedAdd(points[b]),comb[2]=points[a].add(points[b].neg())):(comb[1]=points[a].toJ().mixedAdd(points[b]),comb[2]=points[a].toJ().mixedAdd(points[b].neg()));var index=[-3,-1,-5,-7,0,7,5,1,3],jsf=getJSF(coeffs[a],coeffs[b]);max=Math.max(jsf[0].length,max),naf[a]=new Array(max),naf[b]=new Array(max);for(var j=0;j<max;j++){var ja=0|jsf[0][j],jb=0|jsf[1][j];naf[a][j]=index[3*(ja+1)+(jb+1)],naf[b][j]=0,wnd[a]=comb}}else naf[a]=getNAF(coeffs[a],wndWidth[a]),naf[b]=getNAF(coeffs[b],wndWidth[b]),max=Math.max(naf[a].length,max),max=Math.max(naf[b].length,max)}for(var acc=this.jpoint(null,null,null),tmp=this._wnafT4,i=max;i>=0;i--){for(var k=0;i>=0;){for(var zero=!0,j=0;j<len;j++)tmp[j]=0|naf[j][i],0!==tmp[j]&&(zero=!1);if(!zero)break;k++,i--}if(i>=0&&k++,acc=acc.dblp(k),i<0)break;for(var j=0;j<len;j++){var p,z=tmp[j];0!==z&&(z>0?p=wnd[j][z-1>>1]:z<0&&(p=wnd[j][-z-1>>1].neg()),acc="affine"===p.type?acc.mixedAdd(p):acc.add(p))}}for(var i=0;i<len;i++)wnd[i]=null;return jacobianResult?acc:acc.toP()},BaseCurve.BasePoint=BasePoint,BasePoint.prototype.eq=function(){throw new Error("Not implemented")},BasePoint.prototype.validate=function(){return this.curve.validate(this)},BaseCurve.prototype.decodePoint=function(bytes,enc){bytes=utils.toArray(bytes,enc);var len=this.p.byteLength();if((4===bytes[0]||6===bytes[0]||7===bytes[0])&&bytes.length-1===2*len){6===bytes[0]?assert(bytes[bytes.length-1]%2===0):7===bytes[0]&&assert(bytes[bytes.length-1]%2===1);var res=this.point(bytes.slice(1,1+len),bytes.slice(1+len,1+2*len));return res}if((2===bytes[0]||3===bytes[0])&&bytes.length-1===len)return this.pointFromX(bytes.slice(1,1+len),3===bytes[0]);throw new Error("Unknown point format")},BasePoint.prototype.encodeCompressed=function(enc){return this.encode(enc,!0)},BasePoint.prototype._encode=function(compact){var len=this.curve.p.byteLength(),x=this.getX().toArray("be",len);return compact?[this.getY().isEven()?2:3].concat(x):[4].concat(x,this.getY().toArray("be",len))},BasePoint.prototype.encode=function(enc,compact){return utils.encode(this._encode(compact),enc)},BasePoint.prototype.precompute=function(power){if(this.precomputed)return this;var precomputed={doubles:null,naf:null,beta:null};return precomputed.naf=this._getNAFPoints(8),precomputed.doubles=this._getDoubles(4,power),precomputed.beta=this._getBeta(),this.precomputed=precomputed,this},BasePoint.prototype._hasDoubles=function(k){if(!this.precomputed)return!1;var doubles=this.precomputed.doubles;return!!doubles&&doubles.points.length>=Math.ceil((k.bitLength()+1)/doubles.step)},BasePoint.prototype._getDoubles=function(step,power){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var doubles=[this],acc=this,i=0;i<power;i+=step){for(var j=0;j<step;j++)acc=acc.dbl();doubles.push(acc)}return{step:step,points:doubles}},BasePoint.prototype._getNAFPoints=function(wnd){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var res=[this],max=(1<<wnd)-1,dbl=1===max?null:this.dbl(),i=1;i<max;i++)res[i]=res[i-1].add(dbl);return{wnd:wnd,points:res}},BasePoint.prototype._getBeta=function(){return null},BasePoint.prototype.dblp=function(k){for(var r=this,i=0;i<k;i++)r=r.dbl();return r}},{"../../elliptic":69,"bn.js":18}],71:[function(_dereq_,module,exports){"use strict";function EdwardsCurve(conf){this.twisted=1!==(0|conf.a),this.mOneA=this.twisted&&(0|conf.a)===-1,this.extended=this.mOneA,Base.call(this,"edwards",conf),this.a=new BN(conf.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new BN(conf.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new BN(conf.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),assert(!this.twisted||0===this.c.fromRed().cmpn(1)),this.oneC=1===(0|conf.c)}function Point(curve,x,y,z,t){Base.BasePoint.call(this,curve,"projective"),null===x&&null===y&&null===z?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new BN(x,16),this.y=new BN(y,16),this.z=z?new BN(z,16):this.curve.one,this.t=t&&new BN(t,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}var curve=_dereq_("../curve"),elliptic=_dereq_("../../elliptic"),BN=_dereq_("bn.js"),inherits=_dereq_("inherits"),Base=curve.base,assert=elliptic.utils.assert;inherits(EdwardsCurve,Base),module.exports=EdwardsCurve,EdwardsCurve.prototype._mulA=function(num){return this.mOneA?num.redNeg():this.a.redMul(num)},EdwardsCurve.prototype._mulC=function(num){return this.oneC?num:this.c.redMul(num)},EdwardsCurve.prototype.jpoint=function(x,y,z,t){return this.point(x,y,z,t)},EdwardsCurve.prototype.pointFromX=function(x,odd){x=new BN(x,16),x.red||(x=x.toRed(this.red));var x2=x.redSqr(),rhs=this.c2.redSub(this.a.redMul(x2)),lhs=this.one.redSub(this.c2.redMul(this.d).redMul(x2)),y2=rhs.redMul(lhs.redInvm()),y=y2.redSqrt();if(0!==y.redSqr().redSub(y2).cmp(this.zero))throw new Error("invalid point");var isOdd=y.fromRed().isOdd();return(odd&&!isOdd||!odd&&isOdd)&&(y=y.redNeg()),this.point(x,y)},EdwardsCurve.prototype.pointFromY=function(y,odd){y=new BN(y,16),y.red||(y=y.toRed(this.red));var y2=y.redSqr(),lhs=y2.redSub(this.one),rhs=y2.redMul(this.d).redAdd(this.one),x2=lhs.redMul(rhs.redInvm());if(0===x2.cmp(this.zero)){if(odd)throw new Error("invalid point");return this.point(this.zero,y)}var x=x2.redSqrt();if(0!==x.redSqr().redSub(x2).cmp(this.zero))throw new Error("invalid point");return x.isOdd()!==odd&&(x=x.redNeg()),this.point(x,y)},EdwardsCurve.prototype.validate=function(point){if(point.isInfinity())return!0;point.normalize();var x2=point.x.redSqr(),y2=point.y.redSqr(),lhs=x2.redMul(this.a).redAdd(y2),rhs=this.c2.redMul(this.one.redAdd(this.d.redMul(x2).redMul(y2)));return 0===lhs.cmp(rhs)},inherits(Point,Base.BasePoint),EdwardsCurve.prototype.pointFromJSON=function(obj){return Point.fromJSON(this,obj)},EdwardsCurve.prototype.point=function(x,y,z,t){return new Point(this,x,y,z,t)},Point.fromJSON=function(curve,obj){return new Point(curve,obj[0],obj[1],obj[2])},Point.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},Point.prototype.isInfinity=function(){return 0===this.x.cmpn(0)&&0===this.y.cmp(this.z)},Point.prototype._extDbl=function(){var a=this.x.redSqr(),b=this.y.redSqr(),c=this.z.redSqr();c=c.redIAdd(c);var d=this.curve._mulA(a),e=this.x.redAdd(this.y).redSqr().redISub(a).redISub(b),g=d.redAdd(b),f=g.redSub(c),h=d.redSub(b),nx=e.redMul(f),ny=g.redMul(h),nt=e.redMul(h),nz=f.redMul(g);return this.curve.point(nx,ny,nz,nt)},Point.prototype._projDbl=function(){var nx,ny,nz,b=this.x.redAdd(this.y).redSqr(),c=this.x.redSqr(),d=this.y.redSqr();if(this.curve.twisted){var e=this.curve._mulA(c),f=e.redAdd(d);if(this.zOne)nx=b.redSub(c).redSub(d).redMul(f.redSub(this.curve.two)),ny=f.redMul(e.redSub(d)),nz=f.redSqr().redSub(f).redSub(f);else{var h=this.z.redSqr(),j=f.redSub(h).redISub(h);nx=b.redSub(c).redISub(d).redMul(j),ny=f.redMul(e.redSub(d)),nz=f.redMul(j)}}else{var e=c.redAdd(d),h=this.curve._mulC(this.c.redMul(this.z)).redSqr(),j=e.redSub(h).redSub(h);nx=this.curve._mulC(b.redISub(e)).redMul(j),ny=this.curve._mulC(e).redMul(c.redISub(d)),nz=e.redMul(j)}return this.curve.point(nx,ny,nz)},Point.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},Point.prototype._extAdd=function(p){var a=this.y.redSub(this.x).redMul(p.y.redSub(p.x)),b=this.y.redAdd(this.x).redMul(p.y.redAdd(p.x)),c=this.t.redMul(this.curve.dd).redMul(p.t),d=this.z.redMul(p.z.redAdd(p.z)),e=b.redSub(a),f=d.redSub(c),g=d.redAdd(c),h=b.redAdd(a),nx=e.redMul(f),ny=g.redMul(h),nt=e.redMul(h),nz=f.redMul(g);return this.curve.point(nx,ny,nz,nt)},Point.prototype._projAdd=function(p){var ny,nz,a=this.z.redMul(p.z),b=a.redSqr(),c=this.x.redMul(p.x),d=this.y.redMul(p.y),e=this.curve.d.redMul(c).redMul(d),f=b.redSub(e),g=b.redAdd(e),tmp=this.x.redAdd(this.y).redMul(p.x.redAdd(p.y)).redISub(c).redISub(d),nx=a.redMul(f).redMul(tmp);return this.curve.twisted?(ny=a.redMul(g).redMul(d.redSub(this.curve._mulA(c))),nz=f.redMul(g)):(ny=a.redMul(g).redMul(d.redSub(c)),nz=this.curve._mulC(f).redMul(g)),this.curve.point(nx,ny,nz)},Point.prototype.add=function(p){return this.isInfinity()?p:p.isInfinity()?this:this.curve.extended?this._extAdd(p):this._projAdd(p)},Point.prototype.mul=function(k){return this._hasDoubles(k)?this.curve._fixedNafMul(this,k):this.curve._wnafMul(this,k)},Point.prototype.mulAdd=function(k1,p,k2){return this.curve._wnafMulAdd(1,[this,p],[k1,k2],2,!1)},Point.prototype.jmulAdd=function(k1,p,k2){return this.curve._wnafMulAdd(1,[this,p],[k1,k2],2,!0)},Point.prototype.normalize=function(){if(this.zOne)return this;var zi=this.z.redInvm();return this.x=this.x.redMul(zi),this.y=this.y.redMul(zi),this.t&&(this.t=this.t.redMul(zi)),this.z=this.curve.one,this.zOne=!0,this},Point.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},Point.prototype.getX=function(){return this.normalize(),this.x.fromRed()},Point.prototype.getY=function(){return this.normalize(),this.y.fromRed()},Point.prototype.eq=function(other){return this===other||0===this.getX().cmp(other.getX())&&0===this.getY().cmp(other.getY())},Point.prototype.eqXToP=function(x){var rx=x.toRed(this.curve.red).redMul(this.z);if(0===this.x.cmp(rx))return!0;for(var xc=x.clone(),t=this.curve.redN.redMul(this.z);;){if(xc.iadd(this.curve.n),xc.cmp(this.curve.p)>=0)return!1;if(rx.redIAdd(t),0===this.x.cmp(rx))return!0}return!1},Point.prototype.toP=Point.prototype.normalize,Point.prototype.mixedAdd=Point.prototype.add},{"../../elliptic":69,"../curve":72,"bn.js":18,inherits:112}],72:[function(_dereq_,module,exports){"use strict";var curve=exports;curve.base=_dereq_("./base"),curve.short=_dereq_("./short"),curve.mont=_dereq_("./mont"),curve.edwards=_dereq_("./edwards")},{"./base":70,"./edwards":71,"./mont":73,"./short":74}],73:[function(_dereq_,module,exports){"use strict";function MontCurve(conf){Base.call(this,"mont",conf),this.a=new BN(conf.a,16).toRed(this.red),this.b=new BN(conf.b,16).toRed(this.red),this.i4=new BN(4).toRed(this.red).redInvm(),this.two=new BN(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}function Point(curve,x,z){Base.BasePoint.call(this,curve,"projective"),null===x&&null===z?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new BN(x,16),this.z=new BN(z,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}var curve=_dereq_("../curve"),BN=_dereq_("bn.js"),inherits=_dereq_("inherits"),Base=curve.base,elliptic=_dereq_("../../elliptic"),utils=elliptic.utils;inherits(MontCurve,Base),module.exports=MontCurve,MontCurve.prototype.validate=function(point){var x=point.normalize().x,x2=x.redSqr(),rhs=x2.redMul(x).redAdd(x2.redMul(this.a)).redAdd(x),y=rhs.redSqrt();return 0===y.redSqr().cmp(rhs)},inherits(Point,Base.BasePoint),MontCurve.prototype.decodePoint=function(bytes,enc){return this.point(utils.toArray(bytes,enc),1)},MontCurve.prototype.point=function(x,z){return new Point(this,x,z)},MontCurve.prototype.pointFromJSON=function(obj){return Point.fromJSON(this,obj)},Point.prototype.precompute=function(){},Point.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},Point.fromJSON=function(curve,obj){return new Point(curve,obj[0],obj[1]||curve.one)},Point.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},Point.prototype.isInfinity=function(){return 0===this.z.cmpn(0)},Point.prototype.dbl=function(){var a=this.x.redAdd(this.z),aa=a.redSqr(),b=this.x.redSub(this.z),bb=b.redSqr(),c=aa.redSub(bb),nx=aa.redMul(bb),nz=c.redMul(bb.redAdd(this.curve.a24.redMul(c)));return this.curve.point(nx,nz)},Point.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},Point.prototype.diffAdd=function(p,diff){var a=this.x.redAdd(this.z),b=this.x.redSub(this.z),c=p.x.redAdd(p.z),d=p.x.redSub(p.z),da=d.redMul(a),cb=c.redMul(b),nx=diff.z.redMul(da.redAdd(cb).redSqr()),nz=diff.x.redMul(da.redISub(cb).redSqr());return this.curve.point(nx,nz)},Point.prototype.mul=function(k){for(var t=k.clone(),a=this,b=this.curve.point(null,null),c=this,bits=[];0!==t.cmpn(0);t.iushrn(1))bits.push(t.andln(1));for(var i=bits.length-1;i>=0;i--)0===bits[i]?(a=a.diffAdd(b,c),b=b.dbl()):(b=a.diffAdd(b,c),a=a.dbl());return b},Point.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},Point.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},Point.prototype.eq=function(other){return 0===this.getX().cmp(other.getX())},Point.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},Point.prototype.getX=function(){return this.normalize(),this.x.fromRed()}},{"../../elliptic":69,"../curve":72,"bn.js":18,inherits:112}],74:[function(_dereq_,module,exports){"use strict";function ShortCurve(conf){Base.call(this,"short",conf),this.a=new BN(conf.a,16).toRed(this.red),this.b=new BN(conf.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=0===this.a.fromRed().cmpn(0),this.threeA=0===this.a.fromRed().sub(this.p).cmpn(-3),this.endo=this._getEndomorphism(conf),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}function Point(curve,x,y,isRed){Base.BasePoint.call(this,curve,"affine"),null===x&&null===y?(this.x=null,this.y=null,this.inf=!0):(this.x=new BN(x,16),this.y=new BN(y,16),isRed&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function JPoint(curve,x,y,z){Base.BasePoint.call(this,curve,"jacobian"),null===x&&null===y&&null===z?(this.x=this.curve.one,this.y=this.curve.one,this.z=new BN(0)):(this.x=new BN(x,16),this.y=new BN(y,16),this.z=new BN(z,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}var curve=_dereq_("../curve"),elliptic=_dereq_("../../elliptic"),BN=_dereq_("bn.js"),inherits=_dereq_("inherits"),Base=curve.base,assert=elliptic.utils.assert;inherits(ShortCurve,Base),module.exports=ShortCurve,ShortCurve.prototype._getEndomorphism=function(conf){if(this.zeroA&&this.g&&this.n&&1===this.p.modn(3)){var beta,lambda;if(conf.beta)beta=new BN(conf.beta,16).toRed(this.red);else{var betas=this._getEndoRoots(this.p);beta=betas[0].cmp(betas[1])<0?betas[0]:betas[1],beta=beta.toRed(this.red)}if(conf.lambda)lambda=new BN(conf.lambda,16);else{var lambdas=this._getEndoRoots(this.n);0===this.g.mul(lambdas[0]).x.cmp(this.g.x.redMul(beta))?lambda=lambdas[0]:(lambda=lambdas[1],assert(0===this.g.mul(lambda).x.cmp(this.g.x.redMul(beta))))}var basis;return basis=conf.basis?conf.basis.map(function(vec){return{a:new BN(vec.a,16),b:new BN(vec.b,16)}}):this._getEndoBasis(lambda),{beta:beta,lambda:lambda,basis:basis}}},ShortCurve.prototype._getEndoRoots=function(num){var red=num===this.p?this.red:BN.mont(num),tinv=new BN(2).toRed(red).redInvm(),ntinv=tinv.redNeg(),s=new BN(3).toRed(red).redNeg().redSqrt().redMul(tinv),l1=ntinv.redAdd(s).fromRed(),l2=ntinv.redSub(s).fromRed();return[l1,l2]},ShortCurve.prototype._getEndoBasis=function(lambda){for(var a0,b0,a1,b1,a2,b2,prevR,r,x,aprxSqrt=this.n.ushrn(Math.floor(this.n.bitLength()/2)),u=lambda,v=this.n.clone(),x1=new BN(1),y1=new BN(0),x2=new BN(0),y2=new BN(1),i=0;0!==u.cmpn(0);){var q=v.div(u);r=v.sub(q.mul(u)),x=x2.sub(q.mul(x1));var y=y2.sub(q.mul(y1));if(!a1&&r.cmp(aprxSqrt)<0)a0=prevR.neg(),b0=x1,a1=r.neg(),b1=x;else if(a1&&2===++i)break;prevR=r,v=u,u=r,x2=x1,x1=x,y2=y1,y1=y}a2=r.neg(),b2=x;var len1=a1.sqr().add(b1.sqr()),len2=a2.sqr().add(b2.sqr());return len2.cmp(len1)>=0&&(a2=a0,b2=b0),a1.negative&&(a1=a1.neg(),b1=b1.neg()),a2.negative&&(a2=a2.neg(),b2=b2.neg()),[{a:a1,b:b1},{a:a2,b:b2}]},ShortCurve.prototype._endoSplit=function(k){var basis=this.endo.basis,v1=basis[0],v2=basis[1],c1=v2.b.mul(k).divRound(this.n),c2=v1.b.neg().mul(k).divRound(this.n),p1=c1.mul(v1.a),p2=c2.mul(v2.a),q1=c1.mul(v1.b),q2=c2.mul(v2.b),k1=k.sub(p1).sub(p2),k2=q1.add(q2).neg();return{k1:k1,k2:k2}},ShortCurve.prototype.pointFromX=function(x,odd){x=new BN(x,16),x.red||(x=x.toRed(this.red));var y2=x.redSqr().redMul(x).redIAdd(x.redMul(this.a)).redIAdd(this.b),y=y2.redSqrt();if(0!==y.redSqr().redSub(y2).cmp(this.zero))throw new Error("invalid point");var isOdd=y.fromRed().isOdd();return(odd&&!isOdd||!odd&&isOdd)&&(y=y.redNeg()),this.point(x,y)},ShortCurve.prototype.validate=function(point){if(point.inf)return!0;var x=point.x,y=point.y,ax=this.a.redMul(x),rhs=x.redSqr().redMul(x).redIAdd(ax).redIAdd(this.b);return 0===y.redSqr().redISub(rhs).cmpn(0)},ShortCurve.prototype._endoWnafMulAdd=function(points,coeffs,jacobianResult){for(var npoints=this._endoWnafT1,ncoeffs=this._endoWnafT2,i=0;i<points.length;i++){var split=this._endoSplit(coeffs[i]),p=points[i],beta=p._getBeta();split.k1.negative&&(split.k1.ineg(),p=p.neg(!0)),split.k2.negative&&(split.k2.ineg(),beta=beta.neg(!0)),npoints[2*i]=p,npoints[2*i+1]=beta,ncoeffs[2*i]=split.k1,ncoeffs[2*i+1]=split.k2}for(var res=this._wnafMulAdd(1,npoints,ncoeffs,2*i,jacobianResult),j=0;j<2*i;j++)npoints[j]=null,ncoeffs[j]=null;return res},inherits(Point,Base.BasePoint),ShortCurve.prototype.point=function(x,y,isRed){return new Point(this,x,y,isRed)},ShortCurve.prototype.pointFromJSON=function(obj,red){return Point.fromJSON(this,obj,red)},Point.prototype._getBeta=function(){if(this.curve.endo){var pre=this.precomputed;if(pre&&pre.beta)return pre.beta;var beta=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(pre){var curve=this.curve,endoMul=function(p){return curve.point(p.x.redMul(curve.endo.beta),p.y)};pre.beta=beta,beta.precomputed={beta:null,naf:pre.naf&&{wnd:pre.naf.wnd,points:pre.naf.points.map(endoMul)},doubles:pre.doubles&&{step:pre.doubles.step,points:pre.doubles.points.map(endoMul)}}}return beta}},Point.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},Point.fromJSON=function(curve,obj,red){function obj2point(obj){return curve.point(obj[0],obj[1],red)}"string"==typeof obj&&(obj=JSON.parse(obj));var res=curve.point(obj[0],obj[1],red);if(!obj[2])return res;var pre=obj[2];return res.precomputed={beta:null,doubles:pre.doubles&&{step:pre.doubles.step,points:[res].concat(pre.doubles.points.map(obj2point))},naf:pre.naf&&{wnd:pre.naf.wnd,points:[res].concat(pre.naf.points.map(obj2point))}},res},Point.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},Point.prototype.isInfinity=function(){return this.inf},Point.prototype.add=function(p){if(this.inf)return p;if(p.inf)return this;if(this.eq(p))return this.dbl();if(this.neg().eq(p))return this.curve.point(null,null);if(0===this.x.cmp(p.x))return this.curve.point(null,null);var c=this.y.redSub(p.y);0!==c.cmpn(0)&&(c=c.redMul(this.x.redSub(p.x).redInvm()));var nx=c.redSqr().redISub(this.x).redISub(p.x),ny=c.redMul(this.x.redSub(nx)).redISub(this.y);return this.curve.point(nx,ny)},Point.prototype.dbl=function(){if(this.inf)return this;var ys1=this.y.redAdd(this.y);if(0===ys1.cmpn(0))return this.curve.point(null,null);var a=this.curve.a,x2=this.x.redSqr(),dyinv=ys1.redInvm(),c=x2.redAdd(x2).redIAdd(x2).redIAdd(a).redMul(dyinv),nx=c.redSqr().redISub(this.x.redAdd(this.x)),ny=c.redMul(this.x.redSub(nx)).redISub(this.y);return this.curve.point(nx,ny)},Point.prototype.getX=function(){return this.x.fromRed()},Point.prototype.getY=function(){return this.y.fromRed()},Point.prototype.mul=function(k){return k=new BN(k,16),this._hasDoubles(k)?this.curve._fixedNafMul(this,k):this.curve.endo?this.curve._endoWnafMulAdd([this],[k]):this.curve._wnafMul(this,k)},Point.prototype.mulAdd=function(k1,p2,k2){var points=[this,p2],coeffs=[k1,k2];return this.curve.endo?this.curve._endoWnafMulAdd(points,coeffs):this.curve._wnafMulAdd(1,points,coeffs,2)},Point.prototype.jmulAdd=function(k1,p2,k2){var points=[this,p2],coeffs=[k1,k2];return this.curve.endo?this.curve._endoWnafMulAdd(points,coeffs,!0):this.curve._wnafMulAdd(1,points,coeffs,2,!0)},Point.prototype.eq=function(p){return this===p||this.inf===p.inf&&(this.inf||0===this.x.cmp(p.x)&&0===this.y.cmp(p.y))},Point.prototype.neg=function(_precompute){if(this.inf)return this;var res=this.curve.point(this.x,this.y.redNeg());if(_precompute&&this.precomputed){var pre=this.precomputed,negate=function(p){return p.neg()};res.precomputed={naf:pre.naf&&{wnd:pre.naf.wnd,points:pre.naf.points.map(negate)},doubles:pre.doubles&&{step:pre.doubles.step,points:pre.doubles.points.map(negate)}}}return res},Point.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var res=this.curve.jpoint(this.x,this.y,this.curve.one);return res},inherits(JPoint,Base.BasePoint),ShortCurve.prototype.jpoint=function(x,y,z){return new JPoint(this,x,y,z)},JPoint.prototype.toP=function(){
if(this.isInfinity())return this.curve.point(null,null);var zinv=this.z.redInvm(),zinv2=zinv.redSqr(),ax=this.x.redMul(zinv2),ay=this.y.redMul(zinv2).redMul(zinv);return this.curve.point(ax,ay)},JPoint.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},JPoint.prototype.add=function(p){if(this.isInfinity())return p;if(p.isInfinity())return this;var pz2=p.z.redSqr(),z2=this.z.redSqr(),u1=this.x.redMul(pz2),u2=p.x.redMul(z2),s1=this.y.redMul(pz2.redMul(p.z)),s2=p.y.redMul(z2.redMul(this.z)),h=u1.redSub(u2),r=s1.redSub(s2);if(0===h.cmpn(0))return 0!==r.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var h2=h.redSqr(),h3=h2.redMul(h),v=u1.redMul(h2),nx=r.redSqr().redIAdd(h3).redISub(v).redISub(v),ny=r.redMul(v.redISub(nx)).redISub(s1.redMul(h3)),nz=this.z.redMul(p.z).redMul(h);return this.curve.jpoint(nx,ny,nz)},JPoint.prototype.mixedAdd=function(p){if(this.isInfinity())return p.toJ();if(p.isInfinity())return this;var z2=this.z.redSqr(),u1=this.x,u2=p.x.redMul(z2),s1=this.y,s2=p.y.redMul(z2).redMul(this.z),h=u1.redSub(u2),r=s1.redSub(s2);if(0===h.cmpn(0))return 0!==r.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var h2=h.redSqr(),h3=h2.redMul(h),v=u1.redMul(h2),nx=r.redSqr().redIAdd(h3).redISub(v).redISub(v),ny=r.redMul(v.redISub(nx)).redISub(s1.redMul(h3)),nz=this.z.redMul(h);return this.curve.jpoint(nx,ny,nz)},JPoint.prototype.dblp=function(pow){if(0===pow)return this;if(this.isInfinity())return this;if(!pow)return this.dbl();if(this.curve.zeroA||this.curve.threeA){for(var r=this,i=0;i<pow;i++)r=r.dbl();return r}for(var a=this.curve.a,tinv=this.curve.tinv,jx=this.x,jy=this.y,jz=this.z,jz4=jz.redSqr().redSqr(),jyd=jy.redAdd(jy),i=0;i<pow;i++){var jx2=jx.redSqr(),jyd2=jyd.redSqr(),jyd4=jyd2.redSqr(),c=jx2.redAdd(jx2).redIAdd(jx2).redIAdd(a.redMul(jz4)),t1=jx.redMul(jyd2),nx=c.redSqr().redISub(t1.redAdd(t1)),t2=t1.redISub(nx),dny=c.redMul(t2);dny=dny.redIAdd(dny).redISub(jyd4);var nz=jyd.redMul(jz);i+1<pow&&(jz4=jz4.redMul(jyd4)),jx=nx,jz=nz,jyd=dny}return this.curve.jpoint(jx,jyd.redMul(tinv),jz)},JPoint.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},JPoint.prototype._zeroDbl=function(){var nx,ny,nz;if(this.zOne){var xx=this.x.redSqr(),yy=this.y.redSqr(),yyyy=yy.redSqr(),s=this.x.redAdd(yy).redSqr().redISub(xx).redISub(yyyy);s=s.redIAdd(s);var m=xx.redAdd(xx).redIAdd(xx),t=m.redSqr().redISub(s).redISub(s),yyyy8=yyyy.redIAdd(yyyy);yyyy8=yyyy8.redIAdd(yyyy8),yyyy8=yyyy8.redIAdd(yyyy8),nx=t,ny=m.redMul(s.redISub(t)).redISub(yyyy8),nz=this.y.redAdd(this.y)}else{var a=this.x.redSqr(),b=this.y.redSqr(),c=b.redSqr(),d=this.x.redAdd(b).redSqr().redISub(a).redISub(c);d=d.redIAdd(d);var e=a.redAdd(a).redIAdd(a),f=e.redSqr(),c8=c.redIAdd(c);c8=c8.redIAdd(c8),c8=c8.redIAdd(c8),nx=f.redISub(d).redISub(d),ny=e.redMul(d.redISub(nx)).redISub(c8),nz=this.y.redMul(this.z),nz=nz.redIAdd(nz)}return this.curve.jpoint(nx,ny,nz)},JPoint.prototype._threeDbl=function(){var nx,ny,nz;if(this.zOne){var xx=this.x.redSqr(),yy=this.y.redSqr(),yyyy=yy.redSqr(),s=this.x.redAdd(yy).redSqr().redISub(xx).redISub(yyyy);s=s.redIAdd(s);var m=xx.redAdd(xx).redIAdd(xx).redIAdd(this.curve.a),t=m.redSqr().redISub(s).redISub(s);nx=t;var yyyy8=yyyy.redIAdd(yyyy);yyyy8=yyyy8.redIAdd(yyyy8),yyyy8=yyyy8.redIAdd(yyyy8),ny=m.redMul(s.redISub(t)).redISub(yyyy8),nz=this.y.redAdd(this.y)}else{var delta=this.z.redSqr(),gamma=this.y.redSqr(),beta=this.x.redMul(gamma),alpha=this.x.redSub(delta).redMul(this.x.redAdd(delta));alpha=alpha.redAdd(alpha).redIAdd(alpha);var beta4=beta.redIAdd(beta);beta4=beta4.redIAdd(beta4);var beta8=beta4.redAdd(beta4);nx=alpha.redSqr().redISub(beta8),nz=this.y.redAdd(this.z).redSqr().redISub(gamma).redISub(delta);var ggamma8=gamma.redSqr();ggamma8=ggamma8.redIAdd(ggamma8),ggamma8=ggamma8.redIAdd(ggamma8),ggamma8=ggamma8.redIAdd(ggamma8),ny=alpha.redMul(beta4.redISub(nx)).redISub(ggamma8)}return this.curve.jpoint(nx,ny,nz)},JPoint.prototype._dbl=function(){var a=this.curve.a,jx=this.x,jy=this.y,jz=this.z,jz4=jz.redSqr().redSqr(),jx2=jx.redSqr(),jy2=jy.redSqr(),c=jx2.redAdd(jx2).redIAdd(jx2).redIAdd(a.redMul(jz4)),jxd4=jx.redAdd(jx);jxd4=jxd4.redIAdd(jxd4);var t1=jxd4.redMul(jy2),nx=c.redSqr().redISub(t1.redAdd(t1)),t2=t1.redISub(nx),jyd8=jy2.redSqr();jyd8=jyd8.redIAdd(jyd8),jyd8=jyd8.redIAdd(jyd8),jyd8=jyd8.redIAdd(jyd8);var ny=c.redMul(t2).redISub(jyd8),nz=jy.redAdd(jy).redMul(jz);return this.curve.jpoint(nx,ny,nz)},JPoint.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var xx=this.x.redSqr(),yy=this.y.redSqr(),zz=this.z.redSqr(),yyyy=yy.redSqr(),m=xx.redAdd(xx).redIAdd(xx),mm=m.redSqr(),e=this.x.redAdd(yy).redSqr().redISub(xx).redISub(yyyy);e=e.redIAdd(e),e=e.redAdd(e).redIAdd(e),e=e.redISub(mm);var ee=e.redSqr(),t=yyyy.redIAdd(yyyy);t=t.redIAdd(t),t=t.redIAdd(t),t=t.redIAdd(t);var u=m.redIAdd(e).redSqr().redISub(mm).redISub(ee).redISub(t),yyu4=yy.redMul(u);yyu4=yyu4.redIAdd(yyu4),yyu4=yyu4.redIAdd(yyu4);var nx=this.x.redMul(ee).redISub(yyu4);nx=nx.redIAdd(nx),nx=nx.redIAdd(nx);var ny=this.y.redMul(u.redMul(t.redISub(u)).redISub(e.redMul(ee)));ny=ny.redIAdd(ny),ny=ny.redIAdd(ny),ny=ny.redIAdd(ny);var nz=this.z.redAdd(e).redSqr().redISub(zz).redISub(ee);return this.curve.jpoint(nx,ny,nz)},JPoint.prototype.mul=function(k,kbase){return k=new BN(k,kbase),this.curve._wnafMul(this,k)},JPoint.prototype.eq=function(p){if("affine"===p.type)return this.eq(p.toJ());if(this===p)return!0;var z2=this.z.redSqr(),pz2=p.z.redSqr();if(0!==this.x.redMul(pz2).redISub(p.x.redMul(z2)).cmpn(0))return!1;var z3=z2.redMul(this.z),pz3=pz2.redMul(p.z);return 0===this.y.redMul(pz3).redISub(p.y.redMul(z3)).cmpn(0)},JPoint.prototype.eqXToP=function(x){var zs=this.z.redSqr(),rx=x.toRed(this.curve.red).redMul(zs);if(0===this.x.cmp(rx))return!0;for(var xc=x.clone(),t=this.curve.redN.redMul(zs);;){if(xc.iadd(this.curve.n),xc.cmp(this.curve.p)>=0)return!1;if(rx.redIAdd(t),0===this.x.cmp(rx))return!0}return!1},JPoint.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},JPoint.prototype.isInfinity=function(){return 0===this.z.cmpn(0)}},{"../../elliptic":69,"../curve":72,"bn.js":18,inherits:112}],75:[function(_dereq_,module,exports){"use strict";function PresetCurve(options){"short"===options.type?this.curve=new elliptic.curve.short(options):"edwards"===options.type?this.curve=new elliptic.curve.edwards(options):this.curve=new elliptic.curve.mont(options),this.g=this.curve.g,this.n=this.curve.n,this.hash=options.hash,assert(this.g.validate(),"Invalid curve"),assert(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function defineCurve(name,options){Object.defineProperty(curves,name,{configurable:!0,enumerable:!0,get:function(){var curve=new PresetCurve(options);return Object.defineProperty(curves,name,{configurable:!0,enumerable:!0,value:curve}),curve}})}var curves=exports,hash=_dereq_("hash.js"),elliptic=_dereq_("../elliptic"),assert=elliptic.utils.assert;curves.PresetCurve=PresetCurve,defineCurve("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:hash.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),defineCurve("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:hash.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),defineCurve("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:hash.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),defineCurve("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:hash.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),defineCurve("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:hash.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),defineCurve("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:hash.sha256,gRed:!1,g:["9"]}),defineCurve("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:hash.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var pre;try{pre=_dereq_("./precomputed/secp256k1")}catch(e){pre=void 0}defineCurve("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:hash.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",pre]})},{"../elliptic":69,"./precomputed/secp256k1":82,"hash.js":103}],76:[function(_dereq_,module,exports){"use strict";function EC(options){return this instanceof EC?("string"==typeof options&&(assert(elliptic.curves.hasOwnProperty(options),"Unknown curve "+options),options=elliptic.curves[options]),options instanceof elliptic.curves.PresetCurve&&(options={curve:options}),this.curve=options.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=options.curve.g,this.g.precompute(options.curve.n.bitLength()+1),void(this.hash=options.hash||options.curve.hash)):new EC(options)}var BN=_dereq_("bn.js"),HmacDRBG=_dereq_("hmac-drbg"),elliptic=_dereq_("../../elliptic"),utils=elliptic.utils,assert=utils.assert,KeyPair=_dereq_("./key"),Signature=_dereq_("./signature");module.exports=EC,EC.prototype.keyPair=function(options){return new KeyPair(this,options)},EC.prototype.keyFromPrivate=function(priv,enc){return KeyPair.fromPrivate(this,priv,enc)},EC.prototype.keyFromPublic=function(pub,enc){return KeyPair.fromPublic(this,pub,enc)},EC.prototype.genKeyPair=function(options){options||(options={});for(var drbg=new HmacDRBG({hash:this.hash,pers:options.pers,persEnc:options.persEnc||"utf8",entropy:options.entropy||elliptic.rand(this.hash.hmacStrength),entropyEnc:options.entropy&&options.entropyEnc||"utf8",nonce:this.n.toArray()}),bytes=this.n.byteLength(),ns2=this.n.sub(new BN(2));;){var priv=new BN(drbg.generate(bytes));if(!(priv.cmp(ns2)>0))return priv.iaddn(1),this.keyFromPrivate(priv)}},EC.prototype._truncateToN=function(msg,truncOnly){var delta=8*msg.byteLength()-this.n.bitLength();return delta>0&&(msg=msg.ushrn(delta)),!truncOnly&&msg.cmp(this.n)>=0?msg.sub(this.n):msg},EC.prototype.sign=function(msg,key,enc,options){"object"==typeof enc&&(options=enc,enc=null),options||(options={}),key=this.keyFromPrivate(key,enc),msg=this._truncateToN(new BN(msg,16));for(var bytes=this.n.byteLength(),bkey=key.getPrivate().toArray("be",bytes),nonce=msg.toArray("be",bytes),drbg=new HmacDRBG({hash:this.hash,entropy:bkey,nonce:nonce,pers:options.pers,persEnc:options.persEnc||"utf8"}),ns1=this.n.sub(new BN(1)),iter=0;!0;iter++){var k=options.k?options.k(iter):new BN(drbg.generate(this.n.byteLength()));if(k=this._truncateToN(k,!0),!(k.cmpn(1)<=0||k.cmp(ns1)>=0)){var kp=this.g.mul(k);if(!kp.isInfinity()){var kpX=kp.getX(),r=kpX.umod(this.n);if(0!==r.cmpn(0)){var s=k.invm(this.n).mul(r.mul(key.getPrivate()).iadd(msg));if(s=s.umod(this.n),0!==s.cmpn(0)){var recoveryParam=(kp.getY().isOdd()?1:0)|(0!==kpX.cmp(r)?2:0);return options.canonical&&s.cmp(this.nh)>0&&(s=this.n.sub(s),recoveryParam^=1),new Signature({r:r,s:s,recoveryParam:recoveryParam})}}}}}},EC.prototype.verify=function(msg,signature,key,enc){msg=this._truncateToN(new BN(msg,16)),key=this.keyFromPublic(key,enc),signature=new Signature(signature,"hex");var r=signature.r,s=signature.s;if(r.cmpn(1)<0||r.cmp(this.n)>=0)return!1;if(s.cmpn(1)<0||s.cmp(this.n)>=0)return!1;var sinv=s.invm(this.n),u1=sinv.mul(msg).umod(this.n),u2=sinv.mul(r).umod(this.n);if(!this.curve._maxwellTrick){var p=this.g.mulAdd(u1,key.getPublic(),u2);return!p.isInfinity()&&0===p.getX().umod(this.n).cmp(r)}var p=this.g.jmulAdd(u1,key.getPublic(),u2);return!p.isInfinity()&&p.eqXToP(r)},EC.prototype.recoverPubKey=function(msg,signature,j,enc){assert((3&j)===j,"The recovery param is more than two bits"),signature=new Signature(signature,enc);var n=this.n,e=new BN(msg),r=signature.r,s=signature.s,isYOdd=1&j,isSecondKey=j>>1;if(r.cmp(this.curve.p.umod(this.curve.n))>=0&&isSecondKey)throw new Error("Unable to find sencond key candinate");r=isSecondKey?this.curve.pointFromX(r.add(this.curve.n),isYOdd):this.curve.pointFromX(r,isYOdd);var rInv=signature.r.invm(n),s1=n.sub(e).mul(rInv).umod(n),s2=s.mul(rInv).umod(n);return this.g.mulAdd(s1,r,s2)},EC.prototype.getKeyRecoveryParam=function(e,signature,Q,enc){if(signature=new Signature(signature,enc),null!==signature.recoveryParam)return signature.recoveryParam;for(var i=0;i<4;i++){var Qprime;try{Qprime=this.recoverPubKey(e,signature,i)}catch(e){continue}if(Qprime.eq(Q))return i}throw new Error("Unable to find valid recovery factor")}},{"../../elliptic":69,"./key":77,"./signature":78,"bn.js":18,"hmac-drbg":109}],77:[function(_dereq_,module,exports){"use strict";function KeyPair(ec,options){this.ec=ec,this.priv=null,this.pub=null,options.priv&&this._importPrivate(options.priv,options.privEnc),options.pub&&this._importPublic(options.pub,options.pubEnc)}var BN=_dereq_("bn.js"),elliptic=_dereq_("../../elliptic"),utils=elliptic.utils,assert=utils.assert;module.exports=KeyPair,KeyPair.fromPublic=function(ec,pub,enc){return pub instanceof KeyPair?pub:new KeyPair(ec,{pub:pub,pubEnc:enc})},KeyPair.fromPrivate=function(ec,priv,enc){return priv instanceof KeyPair?priv:new KeyPair(ec,{priv:priv,privEnc:enc})},KeyPair.prototype.validate=function(){var pub=this.getPublic();return pub.isInfinity()?{result:!1,reason:"Invalid public key"}:pub.validate()?pub.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},KeyPair.prototype.getPublic=function(compact,enc){return"string"==typeof compact&&(enc=compact,compact=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),enc?this.pub.encode(enc,compact):this.pub},KeyPair.prototype.getPrivate=function(enc){return"hex"===enc?this.priv.toString(16,2):this.priv},KeyPair.prototype._importPrivate=function(key,enc){this.priv=new BN(key,enc||16),this.priv=this.priv.umod(this.ec.curve.n)},KeyPair.prototype._importPublic=function(key,enc){return key.x||key.y?("mont"===this.ec.curve.type?assert(key.x,"Need x coordinate"):"short"!==this.ec.curve.type&&"edwards"!==this.ec.curve.type||assert(key.x&&key.y,"Need both x and y coordinate"),void(this.pub=this.ec.curve.point(key.x,key.y))):void(this.pub=this.ec.curve.decodePoint(key,enc))},KeyPair.prototype.derive=function(pub){return pub.mul(this.priv).getX()},KeyPair.prototype.sign=function(msg,enc,options){return this.ec.sign(msg,this,enc,options)},KeyPair.prototype.verify=function(msg,signature){return this.ec.verify(msg,signature,this)},KeyPair.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}},{"../../elliptic":69,"bn.js":18}],78:[function(_dereq_,module,exports){"use strict";function Signature(options,enc){return options instanceof Signature?options:void(this._importDER(options,enc)||(assert(options.r&&options.s,"Signature without r or s"),this.r=new BN(options.r,16),this.s=new BN(options.s,16),void 0===options.recoveryParam?this.recoveryParam=null:this.recoveryParam=options.recoveryParam))}function Position(){this.place=0}function getLength(buf,p){var initial=buf[p.place++];if(!(128&initial))return initial;for(var octetLen=15&initial,val=0,i=0,off=p.place;i<octetLen;i++,off++)val<<=8,val|=buf[off];return p.place=off,val}function rmPadding(buf){for(var i=0,len=buf.length-1;!buf[i]&&!(128&buf[i+1])&&i<len;)i++;return 0===i?buf:buf.slice(i)}function constructLength(arr,len){if(len<128)return void arr.push(len);var octets=1+(Math.log(len)/Math.LN2>>>3);for(arr.push(128|octets);--octets;)arr.push(len>>>(octets<<3)&255);arr.push(len)}var BN=_dereq_("bn.js"),elliptic=_dereq_("../../elliptic"),utils=elliptic.utils,assert=utils.assert;module.exports=Signature,Signature.prototype._importDER=function(data,enc){data=utils.toArray(data,enc);var p=new Position;if(48!==data[p.place++])return!1;var len=getLength(data,p);if(len+p.place!==data.length)return!1;if(2!==data[p.place++])return!1;var rlen=getLength(data,p),r=data.slice(p.place,rlen+p.place);if(p.place+=rlen,2!==data[p.place++])return!1;var slen=getLength(data,p);if(data.length!==slen+p.place)return!1;var s=data.slice(p.place,slen+p.place);return 0===r[0]&&128&r[1]&&(r=r.slice(1)),0===s[0]&&128&s[1]&&(s=s.slice(1)),this.r=new BN(r),this.s=new BN(s),this.recoveryParam=null,!0},Signature.prototype.toDER=function(enc){var r=this.r.toArray(),s=this.s.toArray();for(128&r[0]&&(r=[0].concat(r)),128&s[0]&&(s=[0].concat(s)),r=rmPadding(r),s=rmPadding(s);!(s[0]||128&s[1]);)s=s.slice(1);var arr=[2];constructLength(arr,r.length),arr=arr.concat(r),arr.push(2),constructLength(arr,s.length);var backHalf=arr.concat(s),res=[48];return constructLength(res,backHalf.length),res=res.concat(backHalf),utils.encode(res,enc)}},{"../../elliptic":69,"bn.js":18}],79:[function(_dereq_,module,exports){"use strict";function EDDSA(curve){if(assert("ed25519"===curve,"only tested with ed25519 so far"),!(this instanceof EDDSA))return new EDDSA(curve);var curve=elliptic.curves[curve].curve;this.curve=curve,this.g=curve.g,this.g.precompute(curve.n.bitLength()+1),this.pointClass=curve.point().constructor,this.encodingLength=Math.ceil(curve.n.bitLength()/8),this.hash=hash.sha512}var hash=_dereq_("hash.js"),elliptic=_dereq_("../../elliptic"),utils=elliptic.utils,assert=utils.assert,parseBytes=utils.parseBytes,KeyPair=_dereq_("./key"),Signature=_dereq_("./signature");module.exports=EDDSA,EDDSA.prototype.sign=function(message,secret){message=parseBytes(message);var key=this.keyFromSecret(secret),r=this.hashInt(key.messagePrefix(),message),R=this.g.mul(r),Rencoded=this.encodePoint(R),s_=this.hashInt(Rencoded,key.pubBytes(),message).mul(key.priv()),S=r.add(s_).umod(this.curve.n);return this.makeSignature({R:R,S:S,Rencoded:Rencoded})},EDDSA.prototype.verify=function(message,sig,pub){message=parseBytes(message),sig=this.makeSignature(sig);var key=this.keyFromPublic(pub),h=this.hashInt(sig.Rencoded(),key.pubBytes(),message),SG=this.g.mul(sig.S()),RplusAh=sig.R().add(key.pub().mul(h));return RplusAh.eq(SG)},EDDSA.prototype.hashInt=function(){for(var hash=this.hash(),i=0;i<arguments.length;i++)hash.update(arguments[i]);return utils.intFromLE(hash.digest()).umod(this.curve.n)},EDDSA.prototype.keyFromPublic=function(pub){return KeyPair.fromPublic(this,pub)},EDDSA.prototype.keyFromSecret=function(secret){return KeyPair.fromSecret(this,secret)},EDDSA.prototype.makeSignature=function(sig){return sig instanceof Signature?sig:new Signature(this,sig)},EDDSA.prototype.encodePoint=function(point){var enc=point.getY().toArray("le",this.encodingLength);return enc[this.encodingLength-1]|=point.getX().isOdd()?128:0,enc},EDDSA.prototype.decodePoint=function(bytes){bytes=utils.parseBytes(bytes);var lastIx=bytes.length-1,normed=bytes.slice(0,lastIx).concat(bytes[lastIx]&-129),xIsOdd=0!==(128&bytes[lastIx]),y=utils.intFromLE(normed);return this.curve.pointFromY(y,xIsOdd)},EDDSA.prototype.encodeInt=function(num){return num.toArray("le",this.encodingLength)},EDDSA.prototype.decodeInt=function(bytes){return utils.intFromLE(bytes)},EDDSA.prototype.isPoint=function(val){return val instanceof this.pointClass}},{"../../elliptic":69,"./key":80,"./signature":81,"hash.js":103}],80:[function(_dereq_,module,exports){"use strict";function KeyPair(eddsa,params){this.eddsa=eddsa,this._secret=parseBytes(params.secret),eddsa.isPoint(params.pub)?this._pub=params.pub:this._pubBytes=parseBytes(params.pub)}var elliptic=_dereq_("../../elliptic"),utils=elliptic.utils,assert=utils.assert,parseBytes=utils.parseBytes,cachedProperty=utils.cachedProperty;KeyPair.fromPublic=function(eddsa,pub){return pub instanceof KeyPair?pub:new KeyPair(eddsa,{pub:pub})},KeyPair.fromSecret=function(eddsa,secret){return secret instanceof KeyPair?secret:new KeyPair(eddsa,{secret:secret})},KeyPair.prototype.secret=function(){return this._secret},cachedProperty(KeyPair,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())}),cachedProperty(KeyPair,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())}),cachedProperty(KeyPair,"privBytes",function(){var eddsa=this.eddsa,hash=this.hash(),lastIx=eddsa.encodingLength-1,a=hash.slice(0,eddsa.encodingLength);return a[0]&=248,a[lastIx]&=127,a[lastIx]|=64,a}),cachedProperty(KeyPair,"priv",function(){return this.eddsa.decodeInt(this.privBytes())}),cachedProperty(KeyPair,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()}),cachedProperty(KeyPair,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)}),KeyPair.prototype.sign=function(message){return assert(this._secret,"KeyPair can only verify"),this.eddsa.sign(message,this)},KeyPair.prototype.verify=function(message,sig){return this.eddsa.verify(message,sig,this)},KeyPair.prototype.getSecret=function(enc){return assert(this._secret,"KeyPair is public only"),utils.encode(this.secret(),enc)},KeyPair.prototype.getPublic=function(enc){return utils.encode(this.pubBytes(),enc)},module.exports=KeyPair},{"../../elliptic":69}],81:[function(_dereq_,module,exports){"use strict";function Signature(eddsa,sig){this.eddsa=eddsa,"object"!=typeof sig&&(sig=parseBytes(sig)),Array.isArray(sig)&&(sig={R:sig.slice(0,eddsa.encodingLength),S:sig.slice(eddsa.encodingLength)}),assert(sig.R&&sig.S,"Signature without R or S"),eddsa.isPoint(sig.R)&&(this._R=sig.R),sig.S instanceof BN&&(this._S=sig.S),this._Rencoded=Array.isArray(sig.R)?sig.R:sig.Rencoded,this._Sencoded=Array.isArray(sig.S)?sig.S:sig.Sencoded}var BN=_dereq_("bn.js"),elliptic=_dereq_("../../elliptic"),utils=elliptic.utils,assert=utils.assert,cachedProperty=utils.cachedProperty,parseBytes=utils.parseBytes;cachedProperty(Signature,"S",function(){return this.eddsa.decodeInt(this.Sencoded())}),cachedProperty(Signature,"R",function(){return this.eddsa.decodePoint(this.Rencoded())}),cachedProperty(Signature,"Rencoded",function(){return this.eddsa.encodePoint(this.R())}),cachedProperty(Signature,"Sencoded",function(){return this.eddsa.encodeInt(this.S())}),Signature.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},Signature.prototype.toHex=function(){return utils.encode(this.toBytes(),"hex").toUpperCase()},module.exports=Signature},{"../../elliptic":69,"bn.js":18}],82:[function(_dereq_,module,exports){module.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]
},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}},{}],83:[function(_dereq_,module,exports){"use strict";function getNAF(num,w){for(var naf=[],ws=1<<w+1,k=num.clone();k.cmpn(1)>=0;){var z;if(k.isOdd()){var mod=k.andln(ws-1);z=mod>(ws>>1)-1?(ws>>1)-mod:mod,k.isubn(z)}else z=0;naf.push(z);for(var shift=0!==k.cmpn(0)&&0===k.andln(ws-1)?w+1:1,i=1;i<shift;i++)naf.push(0);k.iushrn(shift)}return naf}function getJSF(k1,k2){var jsf=[[],[]];k1=k1.clone(),k2=k2.clone();for(var d1=0,d2=0;k1.cmpn(-d1)>0||k2.cmpn(-d2)>0;){var m14=k1.andln(3)+d1&3,m24=k2.andln(3)+d2&3;3===m14&&(m14=-1),3===m24&&(m24=-1);var u1;if(0===(1&m14))u1=0;else{var m8=k1.andln(7)+d1&7;u1=3!==m8&&5!==m8||2!==m24?m14:-m14}jsf[0].push(u1);var u2;if(0===(1&m24))u2=0;else{var m8=k2.andln(7)+d2&7;u2=3!==m8&&5!==m8||2!==m14?m24:-m24}jsf[1].push(u2),2*d1===u1+1&&(d1=1-d1),2*d2===u2+1&&(d2=1-d2),k1.iushrn(1),k2.iushrn(1)}return jsf}function cachedProperty(obj,name,computer){var key="_"+name;obj.prototype[name]=function(){return void 0!==this[key]?this[key]:this[key]=computer.call(this)}}function parseBytes(bytes){return"string"==typeof bytes?utils.toArray(bytes,"hex"):bytes}function intFromLE(bytes){return new BN(bytes,"hex","le")}var utils=exports,BN=_dereq_("bn.js"),minAssert=_dereq_("minimalistic-assert"),minUtils=_dereq_("minimalistic-crypto-utils");utils.assert=minAssert,utils.toArray=minUtils.toArray,utils.zero2=minUtils.zero2,utils.toHex=minUtils.toHex,utils.encode=minUtils.encode,utils.getNAF=getNAF,utils.getJSF=getJSF,utils.cachedProperty=cachedProperty,utils.parseBytes=parseBytes,utils.intFromLE=intFromLE},{"bn.js":18,"minimalistic-assert":117,"minimalistic-crypto-utils":118}],84:[function(_dereq_,module,exports){module.exports={_args:[[{raw:"elliptic@^6.0.0",scope:null,escapedName:"elliptic",name:"elliptic",rawSpec:"^6.0.0",spec:">=6.0.0 <7.0.0",type:"range"},"/var/capistrano/shipit/data/stacks/uxpin/uxpin-preview/production/deploys/3543/public/node_modules/browserify-sign"]],_from:"elliptic@>=6.0.0 <7.0.0",_id:"elliptic@6.4.0",_inCache:!0,_location:"/elliptic",_nodeVersion:"7.0.0",_npmOperationalInternal:{host:"packages-18-east.internal.npmjs.com",tmp:"tmp/elliptic-6.4.0.tgz_1487798866428_0.30510620190761983"},_npmUser:{name:"indutny",email:"fedor@indutny.com"},_npmVersion:"3.10.8",_phantomChildren:{},_requested:{raw:"elliptic@^6.0.0",scope:null,escapedName:"elliptic",name:"elliptic",rawSpec:"^6.0.0",spec:">=6.0.0 <7.0.0",type:"range"},_requiredBy:["/browserify-sign","/create-ecdh"],_resolved:"https://registry.npmjs.org/elliptic/-/elliptic-6.4.0.tgz",_shasum:"cac9af8762c85836187003c8dfe193e5e2eae5df",_shrinkwrap:null,_spec:"elliptic@^6.0.0",_where:"/var/capistrano/shipit/data/stacks/uxpin/uxpin-preview/production/deploys/3543/public/node_modules/browserify-sign",author:{name:"Fedor Indutny",email:"fedor@indutny.com"},bugs:{url:"https://github.com/indutny/elliptic/issues"},dependencies:{"bn.js":"^4.4.0",brorand:"^1.0.1","hash.js":"^1.0.0","hmac-drbg":"^1.0.0",inherits:"^2.0.1","minimalistic-assert":"^1.0.0","minimalistic-crypto-utils":"^1.0.0"},description:"EC cryptography",devDependencies:{brfs:"^1.4.3",coveralls:"^2.11.3",grunt:"^0.4.5","grunt-browserify":"^5.0.0","grunt-cli":"^1.2.0","grunt-contrib-connect":"^1.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^1.0.1","grunt-mocha-istanbul":"^3.0.1","grunt-saucelabs":"^8.6.2",istanbul:"^0.4.2",jscs:"^2.9.0",jshint:"^2.6.0",mocha:"^2.1.0"},directories:{},dist:{shasum:"cac9af8762c85836187003c8dfe193e5e2eae5df",tarball:"https://registry.npmjs.org/elliptic/-/elliptic-6.4.0.tgz"},files:["lib"],gitHead:"6b0d2b76caae91471649c8e21f0b1d3ba0f96090",homepage:"https://github.com/indutny/elliptic",keywords:["EC","Elliptic","curve","Cryptography"],license:"MIT",main:"lib/elliptic.js",maintainers:[{name:"indutny",email:"fedor@indutny.com"}],name:"elliptic",optionalDependencies:{},readme:"ERROR: No README data found!",repository:{type:"git",url:"git+ssh://git@github.com/indutny/elliptic.git"},scripts:{jscs:"jscs benchmarks/*.js lib/*.js lib/**/*.js lib/**/**/*.js test/index.js",jshint:"jscs benchmarks/*.js lib/*.js lib/**/*.js lib/**/**/*.js test/index.js",lint:"npm run jscs && npm run jshint",test:"npm run lint && npm run unit",unit:"istanbul test _mocha --reporter=spec test/index.js",version:"grunt dist && git add dist/"},version:"6.4.0"}},{}],85:[function(_dereq_,module,exports){"use strict";module.exports=_dereq_("./is-implemented")()?Object.assign:_dereq_("./shim")},{"./is-implemented":86,"./shim":87}],86:[function(_dereq_,module,exports){"use strict";module.exports=function(){var obj,assign=Object.assign;return"function"==typeof assign&&(obj={foo:"raz"},assign(obj,{bar:"dwa"},{trzy:"trzy"}),obj.foo+obj.bar+obj.trzy==="razdwatrzy")}},{}],87:[function(_dereq_,module,exports){"use strict";var keys=_dereq_("../keys"),value=_dereq_("../valid-value"),max=Math.max;module.exports=function(dest,src){var error,i,assign,l=max(arguments.length,2);for(dest=Object(value(dest)),assign=function(key){try{dest[key]=src[key]}catch(e){error||(error=e)}},i=1;i<l;++i)src=arguments[i],keys(src).forEach(assign);if(void 0!==error)throw error;return dest}},{"../keys":89,"../valid-value":94}],88:[function(_dereq_,module,exports){"use strict";module.exports=function(obj){return"function"==typeof obj}},{}],89:[function(_dereq_,module,exports){"use strict";module.exports=_dereq_("./is-implemented")()?Object.keys:_dereq_("./shim")},{"./is-implemented":90,"./shim":91}],90:[function(_dereq_,module,exports){"use strict";module.exports=function(){try{return Object.keys("primitive"),!0}catch(e){return!1}}},{}],91:[function(_dereq_,module,exports){"use strict";var keys=Object.keys;module.exports=function(object){return keys(null==object?object:Object(object))}},{}],92:[function(_dereq_,module,exports){"use strict";var forEach=Array.prototype.forEach,create=Object.create,process=function(src,obj){var key;for(key in src)obj[key]=src[key]};module.exports=function(options){var result=create(null);return forEach.call(arguments,function(options){null!=options&&process(Object(options),result)}),result}},{}],93:[function(_dereq_,module,exports){"use strict";module.exports=function(fn){if("function"!=typeof fn)throw new TypeError(fn+" is not a function");return fn}},{}],94:[function(_dereq_,module,exports){"use strict";module.exports=function(value){if(null==value)throw new TypeError("Cannot use null or undefined");return value}},{}],95:[function(_dereq_,module,exports){"use strict";module.exports=_dereq_("./is-implemented")()?String.prototype.contains:_dereq_("./shim")},{"./is-implemented":96,"./shim":97}],96:[function(_dereq_,module,exports){"use strict";var str="razdwatrzy";module.exports=function(){return"function"==typeof str.contains&&(str.contains("dwa")===!0&&str.contains("foo")===!1)}},{}],97:[function(_dereq_,module,exports){"use strict";var indexOf=String.prototype.indexOf;module.exports=function(searchString){return indexOf.call(this,searchString,arguments[1])>-1}},{}],98:[function(_dereq_,module,exports){"use strict";var on,once,off,emit,methods,descriptors,base,d=_dereq_("d"),callable=_dereq_("es5-ext/object/valid-callable"),apply=Function.prototype.apply,call=Function.prototype.call,create=Object.create,defineProperty=Object.defineProperty,defineProperties=Object.defineProperties,hasOwnProperty=Object.prototype.hasOwnProperty,descriptor={configurable:!0,enumerable:!1,writable:!0};on=function(type,listener){var data;return callable(listener),hasOwnProperty.call(this,"__ee__")?data=this.__ee__:(data=descriptor.value=create(null),defineProperty(this,"__ee__",descriptor),descriptor.value=null),data[type]?"object"==typeof data[type]?data[type].push(listener):data[type]=[data[type],listener]:data[type]=listener,this},once=function(type,listener){var once,self;return callable(listener),self=this,on.call(this,type,once=function(){off.call(self,type,once),apply.call(listener,this,arguments)}),once.__eeOnceListener__=listener,this},off=function(type,listener){var data,listeners,candidate,i;if(callable(listener),!hasOwnProperty.call(this,"__ee__"))return this;if(data=this.__ee__,!data[type])return this;if(listeners=data[type],"object"==typeof listeners)for(i=0;candidate=listeners[i];++i)candidate!==listener&&candidate.__eeOnceListener__!==listener||(2===listeners.length?data[type]=listeners[i?0:1]:listeners.splice(i,1));else listeners!==listener&&listeners.__eeOnceListener__!==listener||delete data[type];return this},emit=function(type){var i,l,listener,listeners,args;if(hasOwnProperty.call(this,"__ee__")&&(listeners=this.__ee__[type]))if("object"==typeof listeners){for(l=arguments.length,args=new Array(l-1),i=1;i<l;++i)args[i-1]=arguments[i];for(listeners=listeners.slice(),i=0;listener=listeners[i];++i)apply.call(listener,this,args)}else switch(arguments.length){case 1:call.call(listeners,this);break;case 2:call.call(listeners,this,arguments[1]);break;case 3:call.call(listeners,this,arguments[1],arguments[2]);break;default:for(l=arguments.length,args=new Array(l-1),i=1;i<l;++i)args[i-1]=arguments[i];apply.call(listeners,this,args)}},methods={on:on,once:once,off:off,emit:emit},descriptors={on:d(on),once:d(once),off:d(off),emit:d(emit)},base=defineProperties({},descriptors),module.exports=exports=function(o){return null==o?create(base):defineProperties(Object(o),descriptors)},exports.methods=methods},{d:58,"es5-ext/object/valid-callable":93}],99:[function(_dereq_,module,exports){function EventEmitter(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function isFunction(arg){return"function"==typeof arg}function isNumber(arg){return"number"==typeof arg}function isObject(arg){return"object"==typeof arg&&null!==arg}function isUndefined(arg){return void 0===arg}module.exports=EventEmitter,EventEmitter.EventEmitter=EventEmitter,EventEmitter.prototype._events=void 0,EventEmitter.prototype._maxListeners=void 0,EventEmitter.defaultMaxListeners=10,EventEmitter.prototype.setMaxListeners=function(n){if(!isNumber(n)||n<0||isNaN(n))throw TypeError("n must be a positive number");return this._maxListeners=n,this},EventEmitter.prototype.emit=function(type){var er,handler,len,args,i,listeners;if(this._events||(this._events={}),"error"===type&&(!this._events.error||isObject(this._events.error)&&!this._events.error.length)){if(er=arguments[1],er instanceof Error)throw er;var err=new Error('Uncaught, unspecified "error" event. ('+er+")");throw err.context=er,err}if(handler=this._events[type],isUndefined(handler))return!1;if(isFunction(handler))switch(arguments.length){case 1:handler.call(this);break;case 2:handler.call(this,arguments[1]);break;case 3:handler.call(this,arguments[1],arguments[2]);break;default:args=Array.prototype.slice.call(arguments,1),handler.apply(this,args)}else if(isObject(handler))for(args=Array.prototype.slice.call(arguments,1),listeners=handler.slice(),len=listeners.length,i=0;i<len;i++)listeners[i].apply(this,args);return!0},EventEmitter.prototype.addListener=function(type,listener){var m;if(!isFunction(listener))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",type,isFunction(listener.listener)?listener.listener:listener),this._events[type]?isObject(this._events[type])?this._events[type].push(listener):this._events[type]=[this._events[type],listener]:this._events[type]=listener,isObject(this._events[type])&&!this._events[type].warned&&(m=isUndefined(this._maxListeners)?EventEmitter.defaultMaxListeners:this._maxListeners,m&&m>0&&this._events[type].length>m&&(this._events[type].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[type].length),"function"==typeof console.trace&&console.trace())),this},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.once=function(type,listener){function g(){this.removeListener(type,g),fired||(fired=!0,listener.apply(this,arguments))}if(!isFunction(listener))throw TypeError("listener must be a function");var fired=!1;return g.listener=listener,this.on(type,g),this},EventEmitter.prototype.removeListener=function(type,listener){var list,position,length,i;if(!isFunction(listener))throw TypeError("listener must be a function");if(!this._events||!this._events[type])return this;if(list=this._events[type],length=list.length,position=-1,list===listener||isFunction(list.listener)&&list.listener===listener)delete this._events[type],this._events.removeListener&&this.emit("removeListener",type,listener);else if(isObject(list)){for(i=length;i-- >0;)if(list[i]===listener||list[i].listener&&list[i].listener===listener){position=i;break}if(position<0)return this;1===list.length?(list.length=0,delete this._events[type]):list.splice(position,1),this._events.removeListener&&this.emit("removeListener",type,listener)}return this},EventEmitter.prototype.removeAllListeners=function(type){var key,listeners;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[type]&&delete this._events[type],this;if(0===arguments.length){for(key in this._events)"removeListener"!==key&&this.removeAllListeners(key);return this.removeAllListeners("removeListener"),this._events={},this}if(listeners=this._events[type],isFunction(listeners))this.removeListener(type,listeners);else if(listeners)for(;listeners.length;)this.removeListener(type,listeners[listeners.length-1]);return delete this._events[type],this},EventEmitter.prototype.listeners=function(type){var ret;return ret=this._events&&this._events[type]?isFunction(this._events[type])?[this._events[type]]:this._events[type].slice():[]},EventEmitter.prototype.listenerCount=function(type){if(this._events){var evlistener=this._events[type];if(isFunction(evlistener))return 1;if(evlistener)return evlistener.length}return 0},EventEmitter.listenerCount=function(emitter,type){return emitter.listenerCount(type)}},{}],100:[function(_dereq_,module,exports){(function(Buffer){function EVP_BytesToKey(password,salt,keyLen,ivLen){Buffer.isBuffer(password)||(password=new Buffer(password,"binary")),salt&&!Buffer.isBuffer(salt)&&(salt=new Buffer(salt,"binary")),keyLen/=8,ivLen=ivLen||0;for(var md_buf,i,ki=0,ii=0,key=new Buffer(keyLen),iv=new Buffer(ivLen),addmd=0,bufs=[];;){if(addmd++>0&&bufs.push(md_buf),bufs.push(password),salt&&bufs.push(salt),md_buf=md5(Buffer.concat(bufs)),bufs=[],i=0,keyLen>0)for(;;){if(0===keyLen)break;if(i===md_buf.length)break;key[ki++]=md_buf[i],keyLen--,i++}if(ivLen>0&&i!==md_buf.length)for(;;){if(0===ivLen)break;if(i===md_buf.length)break;iv[ii++]=md_buf[i],ivLen--,i++}if(0===keyLen&&0===ivLen)break}for(i=0;i<md_buf.length;i++)md_buf[i]=0;return{key:key,
iv:iv}}var md5=_dereq_("create-hash/md5");module.exports=EVP_BytesToKey}).call(this,_dereq_("buffer").Buffer)},{buffer:49,"create-hash/md5":55}],101:[function(_dereq_,module,exports){(function(global){var _gsScope="undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window;(_gsScope._gsQueue||(_gsScope._gsQueue=[])).push(function(){"use strict";_gsScope._gsDefine("TweenMax",["core.Animation","core.SimpleTimeline","TweenLite"],function(Animation,SimpleTimeline,TweenLite){var _slice=function(a){var i,b=[],l=a.length;for(i=0;i!==l;b.push(a[i++]));return b},_applyCycle=function(vars,targets,i){var p,val,alt=vars.cycle;for(p in alt)val=alt[p],vars[p]="function"==typeof val?val(i,targets[i]):val[i%val.length];delete vars.cycle},TweenMax=function(target,duration,vars){TweenLite.call(this,target,duration,vars),this._cycle=0,this._yoyo=this.vars.yoyo===!0,this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._dirty=!0,this.render=TweenMax.prototype.render},_tinyNum=1e-10,TweenLiteInternals=TweenLite._internals,_isSelector=TweenLiteInternals.isSelector,_isArray=TweenLiteInternals.isArray,p=TweenMax.prototype=TweenLite.to({},.1,{}),_blankArray=[];TweenMax.version="1.19.1",p.constructor=TweenMax,p.kill()._gc=!1,TweenMax.killTweensOf=TweenMax.killDelayedCallsTo=TweenLite.killTweensOf,TweenMax.getTweensOf=TweenLite.getTweensOf,TweenMax.lagSmoothing=TweenLite.lagSmoothing,TweenMax.ticker=TweenLite.ticker,TweenMax.render=TweenLite.render,p.invalidate=function(){return this._yoyo=this.vars.yoyo===!0,this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._uncache(!0),TweenLite.prototype.invalidate.call(this)},p.updateTo=function(vars,resetDuration){var p,curRatio=this.ratio,immediate=this.vars.immediateRender||vars.immediateRender;resetDuration&&this._startTime<this._timeline._time&&(this._startTime=this._timeline._time,this._uncache(!1),this._gc?this._enabled(!0,!1):this._timeline.insert(this,this._startTime-this._delay));for(p in vars)this.vars[p]=vars[p];if(this._initted||immediate)if(resetDuration)this._initted=!1,immediate&&this.render(0,!0,!0);else if(this._gc&&this._enabled(!0,!1),this._notifyPluginsOfEnabled&&this._firstPT&&TweenLite._onPluginEvent("_onDisable",this),this._time/this._duration>.998){var prevTime=this._totalTime;this.render(0,!0,!1),this._initted=!1,this.render(prevTime,!0,!1)}else if(this._initted=!1,this._init(),this._time>0||immediate)for(var endValue,inv=1/(1-curRatio),pt=this._firstPT;pt;)endValue=pt.s+pt.c,pt.c*=inv,pt.s=endValue-pt.c,pt=pt._next;return this},p.render=function(time,suppressEvents,force){this._initted||0===this._duration&&this.vars.repeat&&this.invalidate();var isComplete,callback,pt,cycleDuration,r,type,pow,rawPrevTime,totalDur=this._dirty?this.totalDuration():this._totalDuration,prevTime=this._time,prevTotalTime=this._totalTime,prevCycle=this._cycle,duration=this._duration,prevRawPrevTime=this._rawPrevTime;if(time>=totalDur-1e-7&&time>=0?(this._totalTime=totalDur,this._cycle=this._repeat,this._yoyo&&0!==(1&this._cycle)?(this._time=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0):(this._time=duration,this.ratio=this._ease._calcEnd?this._ease.getRatio(1):1),this._reversed||(isComplete=!0,callback="onComplete",force=force||this._timeline.autoRemoveChildren),0===duration&&(this._initted||!this.vars.lazy||force)&&(this._startTime===this._timeline._duration&&(time=0),(prevRawPrevTime<0||time<=0&&time>=-1e-7||prevRawPrevTime===_tinyNum&&"isPause"!==this.data)&&prevRawPrevTime!==time&&(force=!0,prevRawPrevTime>_tinyNum&&(callback="onReverseComplete")),this._rawPrevTime=rawPrevTime=!suppressEvents||time||prevRawPrevTime===time?time:_tinyNum)):time<1e-7?(this._totalTime=this._time=this._cycle=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0,(0!==prevTotalTime||0===duration&&prevRawPrevTime>0)&&(callback="onReverseComplete",isComplete=this._reversed),time<0&&(this._active=!1,0===duration&&(this._initted||!this.vars.lazy||force)&&(prevRawPrevTime>=0&&(force=!0),this._rawPrevTime=rawPrevTime=!suppressEvents||time||prevRawPrevTime===time?time:_tinyNum)),this._initted||(force=!0)):(this._totalTime=this._time=time,0!==this._repeat&&(cycleDuration=duration+this._repeatDelay,this._cycle=this._totalTime/cycleDuration>>0,0!==this._cycle&&this._cycle===this._totalTime/cycleDuration&&prevTotalTime<=time&&this._cycle--,this._time=this._totalTime-this._cycle*cycleDuration,this._yoyo&&0!==(1&this._cycle)&&(this._time=duration-this._time),this._time>duration?this._time=duration:this._time<0&&(this._time=0)),this._easeType?(r=this._time/duration,type=this._easeType,pow=this._easePower,(1===type||3===type&&r>=.5)&&(r=1-r),3===type&&(r*=2),1===pow?r*=r:2===pow?r*=r*r:3===pow?r*=r*r*r:4===pow&&(r*=r*r*r*r),1===type?this.ratio=1-r:2===type?this.ratio=r:this._time/duration<.5?this.ratio=r/2:this.ratio=1-r/2):this.ratio=this._ease.getRatio(this._time/duration)),prevTime===this._time&&!force&&prevCycle===this._cycle)return void(prevTotalTime!==this._totalTime&&this._onUpdate&&(suppressEvents||this._callback("onUpdate")));if(!this._initted){if(this._init(),!this._initted||this._gc)return;if(!force&&this._firstPT&&(this.vars.lazy!==!1&&this._duration||this.vars.lazy&&!this._duration))return this._time=prevTime,this._totalTime=prevTotalTime,this._rawPrevTime=prevRawPrevTime,this._cycle=prevCycle,TweenLiteInternals.lazyTweens.push(this),void(this._lazy=[time,suppressEvents]);this._time&&!isComplete?this.ratio=this._ease.getRatio(this._time/duration):isComplete&&this._ease._calcEnd&&(this.ratio=this._ease.getRatio(0===this._time?0:1))}for(this._lazy!==!1&&(this._lazy=!1),this._active||!this._paused&&this._time!==prevTime&&time>=0&&(this._active=!0),0===prevTotalTime&&(2===this._initted&&time>0&&this._init(),this._startAt&&(time>=0?this._startAt.render(time,suppressEvents,force):callback||(callback="_dummyGS")),this.vars.onStart&&(0===this._totalTime&&0!==duration||suppressEvents||this._callback("onStart"))),pt=this._firstPT;pt;)pt.f?pt.t[pt.p](pt.c*this.ratio+pt.s):pt.t[pt.p]=pt.c*this.ratio+pt.s,pt=pt._next;this._onUpdate&&(time<0&&this._startAt&&this._startTime&&this._startAt.render(time,suppressEvents,force),suppressEvents||(this._totalTime!==prevTotalTime||callback)&&this._callback("onUpdate")),this._cycle!==prevCycle&&(suppressEvents||this._gc||this.vars.onRepeat&&this._callback("onRepeat")),callback&&(this._gc&&!force||(time<0&&this._startAt&&!this._onUpdate&&this._startTime&&this._startAt.render(time,suppressEvents,force),isComplete&&(this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!suppressEvents&&this.vars[callback]&&this._callback(callback),0===duration&&this._rawPrevTime===_tinyNum&&rawPrevTime!==_tinyNum&&(this._rawPrevTime=0)))},TweenMax.to=function(target,duration,vars){return new TweenMax(target,duration,vars)},TweenMax.from=function(target,duration,vars){return vars.runBackwards=!0,vars.immediateRender=0!=vars.immediateRender,new TweenMax(target,duration,vars)},TweenMax.fromTo=function(target,duration,fromVars,toVars){return toVars.startAt=fromVars,toVars.immediateRender=0!=toVars.immediateRender&&0!=fromVars.immediateRender,new TweenMax(target,duration,toVars)},TweenMax.staggerTo=TweenMax.allTo=function(targets,duration,vars,stagger,onCompleteAll,onCompleteAllParams,onCompleteAllScope){stagger=stagger||0;var l,copy,i,p,delay=0,a=[],finalComplete=function(){vars.onComplete&&vars.onComplete.apply(vars.onCompleteScope||this,arguments),onCompleteAll.apply(onCompleteAllScope||vars.callbackScope||this,onCompleteAllParams||_blankArray)},cycle=vars.cycle,fromCycle=vars.startAt&&vars.startAt.cycle;for(_isArray(targets)||("string"==typeof targets&&(targets=TweenLite.selector(targets)||targets),_isSelector(targets)&&(targets=_slice(targets))),targets=targets||[],stagger<0&&(targets=_slice(targets),targets.reverse(),stagger*=-1),l=targets.length-1,i=0;i<=l;i++){copy={};for(p in vars)copy[p]=vars[p];if(cycle&&(_applyCycle(copy,targets,i),null!=copy.duration&&(duration=copy.duration,delete copy.duration)),fromCycle){fromCycle=copy.startAt={};for(p in vars.startAt)fromCycle[p]=vars.startAt[p];_applyCycle(copy.startAt,targets,i)}copy.delay=delay+(copy.delay||0),i===l&&onCompleteAll&&(copy.onComplete=finalComplete),a[i]=new TweenMax(targets[i],duration,copy),delay+=stagger}return a},TweenMax.staggerFrom=TweenMax.allFrom=function(targets,duration,vars,stagger,onCompleteAll,onCompleteAllParams,onCompleteAllScope){return vars.runBackwards=!0,vars.immediateRender=0!=vars.immediateRender,TweenMax.staggerTo(targets,duration,vars,stagger,onCompleteAll,onCompleteAllParams,onCompleteAllScope)},TweenMax.staggerFromTo=TweenMax.allFromTo=function(targets,duration,fromVars,toVars,stagger,onCompleteAll,onCompleteAllParams,onCompleteAllScope){return toVars.startAt=fromVars,toVars.immediateRender=0!=toVars.immediateRender&&0!=fromVars.immediateRender,TweenMax.staggerTo(targets,duration,toVars,stagger,onCompleteAll,onCompleteAllParams,onCompleteAllScope)},TweenMax.delayedCall=function(delay,callback,params,scope,useFrames){return new TweenMax(callback,0,{delay:delay,onComplete:callback,onCompleteParams:params,callbackScope:scope,onReverseComplete:callback,onReverseCompleteParams:params,immediateRender:!1,useFrames:useFrames,overwrite:0})},TweenMax.set=function(target,vars){return new TweenMax(target,0,vars)},TweenMax.isTweening=function(target){return TweenLite.getTweensOf(target,!0).length>0};var _getChildrenOf=function(timeline,includeTimelines){for(var a=[],cnt=0,tween=timeline._first;tween;)tween instanceof TweenLite?a[cnt++]=tween:(includeTimelines&&(a[cnt++]=tween),a=a.concat(_getChildrenOf(tween,includeTimelines)),cnt=a.length),tween=tween._next;return a},getAllTweens=TweenMax.getAllTweens=function(includeTimelines){return _getChildrenOf(Animation._rootTimeline,includeTimelines).concat(_getChildrenOf(Animation._rootFramesTimeline,includeTimelines))};TweenMax.killAll=function(complete,tweens,delayedCalls,timelines){null==tweens&&(tweens=!0),null==delayedCalls&&(delayedCalls=!0);var isDC,tween,i,a=getAllTweens(0!=timelines),l=a.length,allTrue=tweens&&delayedCalls&&timelines;for(i=0;i<l;i++)tween=a[i],(allTrue||tween instanceof SimpleTimeline||(isDC=tween.target===tween.vars.onComplete)&&delayedCalls||tweens&&!isDC)&&(complete?tween.totalTime(tween._reversed?0:tween.totalDuration()):tween._enabled(!1,!1))},TweenMax.killChildTweensOf=function(parent,complete){if(null!=parent){var a,curParent,p,i,l,tl=TweenLiteInternals.tweenLookup;if("string"==typeof parent&&(parent=TweenLite.selector(parent)||parent),_isSelector(parent)&&(parent=_slice(parent)),_isArray(parent))for(i=parent.length;--i>-1;)TweenMax.killChildTweensOf(parent[i],complete);else{a=[];for(p in tl)for(curParent=tl[p].target.parentNode;curParent;)curParent===parent&&(a=a.concat(tl[p].tweens)),curParent=curParent.parentNode;for(l=a.length,i=0;i<l;i++)complete&&a[i].totalTime(a[i].totalDuration()),a[i]._enabled(!1,!1)}}};var _changePause=function(pause,tweens,delayedCalls,timelines){tweens=tweens!==!1,delayedCalls=delayedCalls!==!1,timelines=timelines!==!1;for(var isDC,tween,a=getAllTweens(timelines),allTrue=tweens&&delayedCalls&&timelines,i=a.length;--i>-1;)tween=a[i],(allTrue||tween instanceof SimpleTimeline||(isDC=tween.target===tween.vars.onComplete)&&delayedCalls||tweens&&!isDC)&&tween.paused(pause)};return TweenMax.pauseAll=function(tweens,delayedCalls,timelines){_changePause(!0,tweens,delayedCalls,timelines)},TweenMax.resumeAll=function(tweens,delayedCalls,timelines){_changePause(!1,tweens,delayedCalls,timelines)},TweenMax.globalTimeScale=function(value){var tl=Animation._rootTimeline,t=TweenLite.ticker.time;return arguments.length?(value=value||_tinyNum,tl._startTime=t-(t-tl._startTime)*tl._timeScale/value,tl=Animation._rootFramesTimeline,t=TweenLite.ticker.frame,tl._startTime=t-(t-tl._startTime)*tl._timeScale/value,tl._timeScale=Animation._rootTimeline._timeScale=value,value):tl._timeScale},p.progress=function(value,suppressEvents){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&0!==(1&this._cycle)?1-value:value)+this._cycle*(this._duration+this._repeatDelay),suppressEvents):this._time/this.duration()},p.totalProgress=function(value,suppressEvents){return arguments.length?this.totalTime(this.totalDuration()*value,suppressEvents):this._totalTime/this.totalDuration()},p.time=function(value,suppressEvents){return arguments.length?(this._dirty&&this.totalDuration(),value>this._duration&&(value=this._duration),this._yoyo&&0!==(1&this._cycle)?value=this._duration-value+this._cycle*(this._duration+this._repeatDelay):0!==this._repeat&&(value+=this._cycle*(this._duration+this._repeatDelay)),this.totalTime(value,suppressEvents)):this._time},p.duration=function(value){return arguments.length?Animation.prototype.duration.call(this,value):this._duration},p.totalDuration=function(value){return arguments.length?this._repeat===-1?this:this.duration((value-this._repeat*this._repeatDelay)/(this._repeat+1)):(this._dirty&&(this._totalDuration=this._repeat===-1?999999999999:this._duration*(this._repeat+1)+this._repeatDelay*this._repeat,this._dirty=!1),this._totalDuration)},p.repeat=function(value){return arguments.length?(this._repeat=value,this._uncache(!0)):this._repeat},p.repeatDelay=function(value){return arguments.length?(this._repeatDelay=value,this._uncache(!0)):this._repeatDelay},p.yoyo=function(value){return arguments.length?(this._yoyo=value,this):this._yoyo},TweenMax},!0),_gsScope._gsDefine("TimelineLite",["core.Animation","core.SimpleTimeline","TweenLite"],function(Animation,SimpleTimeline,TweenLite){var TimelineLite=function(vars){SimpleTimeline.call(this,vars),this._labels={},this.autoRemoveChildren=this.vars.autoRemoveChildren===!0,this.smoothChildTiming=this.vars.smoothChildTiming===!0,this._sortChildren=!0,this._onUpdate=this.vars.onUpdate;var val,p,v=this.vars;for(p in v)val=v[p],_isArray(val)&&val.join("").indexOf("{self}")!==-1&&(v[p]=this._swapSelfInParams(val));_isArray(v.tweens)&&this.add(v.tweens,0,v.align,v.stagger)},_tinyNum=1e-10,TweenLiteInternals=TweenLite._internals,_internals=TimelineLite._internals={},_isSelector=TweenLiteInternals.isSelector,_isArray=TweenLiteInternals.isArray,_lazyTweens=TweenLiteInternals.lazyTweens,_lazyRender=TweenLiteInternals.lazyRender,_globals=_gsScope._gsDefine.globals,_copy=function(vars){var p,copy={};for(p in vars)copy[p]=vars[p];return copy},_applyCycle=function(vars,targets,i){var p,val,alt=vars.cycle;for(p in alt)val=alt[p],vars[p]="function"==typeof val?val(i,targets[i]):val[i%val.length];delete vars.cycle},_pauseCallback=_internals.pauseCallback=function(){},_slice=function(a){var i,b=[],l=a.length;for(i=0;i!==l;b.push(a[i++]));return b},p=TimelineLite.prototype=new SimpleTimeline;return TimelineLite.version="1.19.1",p.constructor=TimelineLite,p.kill()._gc=p._forcingPlayhead=p._hasPause=!1,p.to=function(target,duration,vars,position){var Engine=vars.repeat&&_globals.TweenMax||TweenLite;return duration?this.add(new Engine(target,duration,vars),position):this.set(target,vars,position)},p.from=function(target,duration,vars,position){return this.add((vars.repeat&&_globals.TweenMax||TweenLite).from(target,duration,vars),position)},p.fromTo=function(target,duration,fromVars,toVars,position){var Engine=toVars.repeat&&_globals.TweenMax||TweenLite;return duration?this.add(Engine.fromTo(target,duration,fromVars,toVars),position):this.set(target,toVars,position)},p.staggerTo=function(targets,duration,vars,stagger,position,onCompleteAll,onCompleteAllParams,onCompleteAllScope){var copy,i,tl=new TimelineLite({onComplete:onCompleteAll,onCompleteParams:onCompleteAllParams,callbackScope:onCompleteAllScope,smoothChildTiming:this.smoothChildTiming}),cycle=vars.cycle;for("string"==typeof targets&&(targets=TweenLite.selector(targets)||targets),targets=targets||[],_isSelector(targets)&&(targets=_slice(targets)),stagger=stagger||0,stagger<0&&(targets=_slice(targets),targets.reverse(),stagger*=-1),i=0;i<targets.length;i++)copy=_copy(vars),copy.startAt&&(copy.startAt=_copy(copy.startAt),copy.startAt.cycle&&_applyCycle(copy.startAt,targets,i)),cycle&&(_applyCycle(copy,targets,i),null!=copy.duration&&(duration=copy.duration,delete copy.duration)),tl.to(targets[i],duration,copy,i*stagger);return this.add(tl,position)},p.staggerFrom=function(targets,duration,vars,stagger,position,onCompleteAll,onCompleteAllParams,onCompleteAllScope){return vars.immediateRender=0!=vars.immediateRender,vars.runBackwards=!0,this.staggerTo(targets,duration,vars,stagger,position,onCompleteAll,onCompleteAllParams,onCompleteAllScope)},p.staggerFromTo=function(targets,duration,fromVars,toVars,stagger,position,onCompleteAll,onCompleteAllParams,onCompleteAllScope){return toVars.startAt=fromVars,toVars.immediateRender=0!=toVars.immediateRender&&0!=fromVars.immediateRender,this.staggerTo(targets,duration,toVars,stagger,position,onCompleteAll,onCompleteAllParams,onCompleteAllScope)},p.call=function(callback,params,scope,position){return this.add(TweenLite.delayedCall(0,callback,params,scope),position)},p.set=function(target,vars,position){return position=this._parseTimeOrLabel(position,0,!0),null==vars.immediateRender&&(vars.immediateRender=position===this._time&&!this._paused),this.add(new TweenLite(target,0,vars),position)},TimelineLite.exportRoot=function(vars,ignoreDelayedCalls){vars=vars||{},null==vars.smoothChildTiming&&(vars.smoothChildTiming=!0);var tween,next,tl=new TimelineLite(vars),root=tl._timeline;for(null==ignoreDelayedCalls&&(ignoreDelayedCalls=!0),root._remove(tl,!0),tl._startTime=0,tl._rawPrevTime=tl._time=tl._totalTime=root._time,tween=root._first;tween;)next=tween._next,ignoreDelayedCalls&&tween instanceof TweenLite&&tween.target===tween.vars.onComplete||tl.add(tween,tween._startTime-tween._delay),tween=next;return root.add(tl,0),tl},p.add=function(value,position,align,stagger){var curTime,l,i,child,tl,beforeRawTime;if("number"!=typeof position&&(position=this._parseTimeOrLabel(position,0,!0,value)),!(value instanceof Animation)){if(value instanceof Array||value&&value.push&&_isArray(value)){for(align=align||"normal",stagger=stagger||0,curTime=position,l=value.length,i=0;i<l;i++)_isArray(child=value[i])&&(child=new TimelineLite({tweens:child})),this.add(child,curTime),"string"!=typeof child&&"function"!=typeof child&&("sequence"===align?curTime=child._startTime+child.totalDuration()/child._timeScale:"start"===align&&(child._startTime-=child.delay())),curTime+=stagger;return this._uncache(!0)}if("string"==typeof value)return this.addLabel(value,position);if("function"!=typeof value)throw"Cannot add "+value+" into the timeline; it is not a tween, timeline, function, or string.";value=TweenLite.delayedCall(0,value)}if(SimpleTimeline.prototype.add.call(this,value,position),(this._gc||this._time===this._duration)&&!this._paused&&this._duration<this.duration())for(tl=this,beforeRawTime=tl.rawTime()>value._startTime;tl._timeline;)beforeRawTime&&tl._timeline.smoothChildTiming?tl.totalTime(tl._totalTime,!0):tl._gc&&tl._enabled(!0,!1),tl=tl._timeline;return this},p.remove=function(value){if(value instanceof Animation){this._remove(value,!1);var tl=value._timeline=value.vars.useFrames?Animation._rootFramesTimeline:Animation._rootTimeline;return value._startTime=(value._paused?value._pauseTime:tl._time)-(value._reversed?value.totalDuration()-value._totalTime:value._totalTime)/value._timeScale,this}if(value instanceof Array||value&&value.push&&_isArray(value)){for(var i=value.length;--i>-1;)this.remove(value[i]);return this}return"string"==typeof value?this.removeLabel(value):this.kill(null,value)},p._remove=function(tween,skipDisable){SimpleTimeline.prototype._remove.call(this,tween,skipDisable);var last=this._last;return last?this._time>this.duration()&&(this._time=this._duration,this._totalTime=this._totalDuration):this._time=this._totalTime=this._duration=this._totalDuration=0,this},p.append=function(value,offsetOrLabel){return this.add(value,this._parseTimeOrLabel(null,offsetOrLabel,!0,value))},p.insert=p.insertMultiple=function(value,position,align,stagger){return this.add(value,position||0,align,stagger)},p.appendMultiple=function(tweens,offsetOrLabel,align,stagger){return this.add(tweens,this._parseTimeOrLabel(null,offsetOrLabel,!0,tweens),align,stagger)},p.addLabel=function(label,position){return this._labels[label]=this._parseTimeOrLabel(position),this},p.addPause=function(position,callback,params,scope){var t=TweenLite.delayedCall(0,_pauseCallback,params,scope||this);return t.vars.onComplete=t.vars.onReverseComplete=callback,t.data="isPause",this._hasPause=!0,this.add(t,position)},p.removeLabel=function(label){return delete this._labels[label],this},p.getLabelTime=function(label){return null!=this._labels[label]?this._labels[label]:-1},p._parseTimeOrLabel=function(timeOrLabel,offsetOrLabel,appendIfAbsent,ignore){var i;if(ignore instanceof Animation&&ignore.timeline===this)this.remove(ignore);else if(ignore&&(ignore instanceof Array||ignore.push&&_isArray(ignore)))for(i=ignore.length;--i>-1;)ignore[i]instanceof Animation&&ignore[i].timeline===this&&this.remove(ignore[i]);if("string"==typeof offsetOrLabel)return this._parseTimeOrLabel(offsetOrLabel,appendIfAbsent&&"number"==typeof timeOrLabel&&null==this._labels[offsetOrLabel]?timeOrLabel-this.duration():0,appendIfAbsent);if(offsetOrLabel=offsetOrLabel||0,"string"!=typeof timeOrLabel||!isNaN(timeOrLabel)&&null==this._labels[timeOrLabel])null==timeOrLabel&&(timeOrLabel=this.duration());else{if(i=timeOrLabel.indexOf("="),i===-1)return null==this._labels[timeOrLabel]?appendIfAbsent?this._labels[timeOrLabel]=this.duration()+offsetOrLabel:offsetOrLabel:this._labels[timeOrLabel]+offsetOrLabel;offsetOrLabel=parseInt(timeOrLabel.charAt(i-1)+"1",10)*Number(timeOrLabel.substr(i+1)),timeOrLabel=i>1?this._parseTimeOrLabel(timeOrLabel.substr(0,i-1),0,appendIfAbsent):this.duration()}return Number(timeOrLabel)+offsetOrLabel},p.seek=function(position,suppressEvents){return this.totalTime("number"==typeof position?position:this._parseTimeOrLabel(position),suppressEvents!==!1)},p.stop=function(){return this.paused(!0)},p.gotoAndPlay=function(position,suppressEvents){return this.play(position,suppressEvents)},p.gotoAndStop=function(position,suppressEvents){return this.pause(position,suppressEvents)},p.render=function(time,suppressEvents,force){this._gc&&this._enabled(!0,!1);var tween,isComplete,next,callback,internalForce,pauseTween,curTime,totalDur=this._dirty?this.totalDuration():this._totalDuration,prevTime=this._time,prevStart=this._startTime,prevTimeScale=this._timeScale,prevPaused=this._paused;if(time>=totalDur-1e-7&&time>=0)this._totalTime=this._time=totalDur,this._reversed||this._hasPausedChild()||(isComplete=!0,callback="onComplete",internalForce=!!this._timeline.autoRemoveChildren,0===this._duration&&(time<=0&&time>=-1e-7||this._rawPrevTime<0||this._rawPrevTime===_tinyNum)&&this._rawPrevTime!==time&&this._first&&(internalForce=!0,this._rawPrevTime>_tinyNum&&(callback="onReverseComplete"))),this._rawPrevTime=this._duration||!suppressEvents||time||this._rawPrevTime===time?time:_tinyNum,time=totalDur+1e-4;else if(time<1e-7)if(this._totalTime=this._time=0,(0!==prevTime||0===this._duration&&this._rawPrevTime!==_tinyNum&&(this._rawPrevTime>0||time<0&&this._rawPrevTime>=0))&&(callback="onReverseComplete",isComplete=this._reversed),time<0)this._active=!1,this._timeline.autoRemoveChildren&&this._reversed?(internalForce=isComplete=!0,callback="onReverseComplete"):this._rawPrevTime>=0&&this._first&&(internalForce=!0),this._rawPrevTime=time;else{if(this._rawPrevTime=this._duration||!suppressEvents||time||this._rawPrevTime===time?time:_tinyNum,0===time&&isComplete)for(tween=this._first;tween&&0===tween._startTime;)tween._duration||(isComplete=!1),tween=tween._next;time=0,this._initted||(internalForce=!0)}else{if(this._hasPause&&!this._forcingPlayhead&&!suppressEvents){if(time>=prevTime)for(tween=this._first;tween&&tween._startTime<=time&&!pauseTween;)tween._duration||"isPause"!==tween.data||tween.ratio||0===tween._startTime&&0===this._rawPrevTime||(pauseTween=tween),tween=tween._next;else for(tween=this._last;tween&&tween._startTime>=time&&!pauseTween;)tween._duration||"isPause"===tween.data&&tween._rawPrevTime>0&&(pauseTween=tween),tween=tween._prev;pauseTween&&(this._time=time=pauseTween._startTime,this._totalTime=time+this._cycle*(this._totalDuration+this._repeatDelay))}this._totalTime=this._time=this._rawPrevTime=time}if(this._time!==prevTime&&this._first||force||internalForce||pauseTween){if(this._initted||(this._initted=!0),this._active||!this._paused&&this._time!==prevTime&&time>0&&(this._active=!0),0===prevTime&&this.vars.onStart&&(0===this._time&&this._duration||suppressEvents||this._callback("onStart")),curTime=this._time,curTime>=prevTime)for(tween=this._first;tween&&(next=tween._next,curTime===this._time&&(!this._paused||prevPaused));)(tween._active||tween._startTime<=curTime&&!tween._paused&&!tween._gc)&&(pauseTween===tween&&this.pause(),tween._reversed?tween.render((tween._dirty?tween.totalDuration():tween._totalDuration)-(time-tween._startTime)*tween._timeScale,suppressEvents,force):tween.render((time-tween._startTime)*tween._timeScale,suppressEvents,force)),tween=next;else for(tween=this._last;tween&&(next=tween._prev,curTime===this._time&&(!this._paused||prevPaused));){if(tween._active||tween._startTime<=prevTime&&!tween._paused&&!tween._gc){if(pauseTween===tween){for(pauseTween=tween._prev;pauseTween&&pauseTween.endTime()>this._time;)pauseTween.render(pauseTween._reversed?pauseTween.totalDuration()-(time-pauseTween._startTime)*pauseTween._timeScale:(time-pauseTween._startTime)*pauseTween._timeScale,suppressEvents,force),pauseTween=pauseTween._prev;pauseTween=null,this.pause()}tween._reversed?tween.render((tween._dirty?tween.totalDuration():tween._totalDuration)-(time-tween._startTime)*tween._timeScale,suppressEvents,force):tween.render((time-tween._startTime)*tween._timeScale,suppressEvents,force)}tween=next}this._onUpdate&&(suppressEvents||(_lazyTweens.length&&_lazyRender(),this._callback("onUpdate"))),callback&&(this._gc||prevStart!==this._startTime&&prevTimeScale===this._timeScale||(0===this._time||totalDur>=this.totalDuration())&&(isComplete&&(_lazyTweens.length&&_lazyRender(),this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!suppressEvents&&this.vars[callback]&&this._callback(callback)))}},p._hasPausedChild=function(){for(var tween=this._first;tween;){if(tween._paused||tween instanceof TimelineLite&&tween._hasPausedChild())return!0;tween=tween._next}return!1},p.getChildren=function(nested,tweens,timelines,ignoreBeforeTime){ignoreBeforeTime=ignoreBeforeTime||-9999999999;for(var a=[],tween=this._first,cnt=0;tween;)tween._startTime<ignoreBeforeTime||(tween instanceof TweenLite?tweens!==!1&&(a[cnt++]=tween):(timelines!==!1&&(a[cnt++]=tween),nested!==!1&&(a=a.concat(tween.getChildren(!0,tweens,timelines)),cnt=a.length))),tween=tween._next;return a},p.getTweensOf=function(target,nested){var tweens,i,disabled=this._gc,a=[],cnt=0;for(disabled&&this._enabled(!0,!0),tweens=TweenLite.getTweensOf(target),i=tweens.length;--i>-1;)(tweens[i].timeline===this||nested&&this._contains(tweens[i]))&&(a[cnt++]=tweens[i]);return disabled&&this._enabled(!1,!0),a},p.recent=function(){return this._recent},p._contains=function(tween){for(var tl=tween.timeline;tl;){if(tl===this)return!0;tl=tl.timeline}return!1},p.shiftChildren=function(amount,adjustLabels,ignoreBeforeTime){ignoreBeforeTime=ignoreBeforeTime||0;for(var p,tween=this._first,labels=this._labels;tween;)tween._startTime>=ignoreBeforeTime&&(tween._startTime+=amount),tween=tween._next;if(adjustLabels)for(p in labels)labels[p]>=ignoreBeforeTime&&(labels[p]+=amount);return this._uncache(!0)},p._kill=function(vars,target){if(!vars&&!target)return this._enabled(!1,!1);for(var tweens=target?this.getTweensOf(target):this.getChildren(!0,!0,!1),i=tweens.length,changed=!1;--i>-1;)tweens[i]._kill(vars,target)&&(changed=!0);return changed},p.clear=function(labels){var tweens=this.getChildren(!1,!0,!0),i=tweens.length;for(this._time=this._totalTime=0;--i>-1;)tweens[i]._enabled(!1,!1);return labels!==!1&&(this._labels={}),this._uncache(!0)},p.invalidate=function(){for(var tween=this._first;tween;)tween.invalidate(),tween=tween._next;return Animation.prototype.invalidate.call(this)},p._enabled=function(enabled,ignoreTimeline){if(enabled===this._gc)for(var tween=this._first;tween;)tween._enabled(enabled,!0),tween=tween._next;return SimpleTimeline.prototype._enabled.call(this,enabled,ignoreTimeline)},p.totalTime=function(time,suppressEvents,uncapped){this._forcingPlayhead=!0;var val=Animation.prototype.totalTime.apply(this,arguments);return this._forcingPlayhead=!1,val},p.duration=function(value){return arguments.length?(0!==this.duration()&&0!==value&&this.timeScale(this._duration/value),this):(this._dirty&&this.totalDuration(),this._duration)},p.totalDuration=function(value){if(!arguments.length){if(this._dirty){for(var prev,end,max=0,tween=this._last,prevStart=999999999999;tween;)prev=tween._prev,tween._dirty&&tween.totalDuration(),tween._startTime>prevStart&&this._sortChildren&&!tween._paused?this.add(tween,tween._startTime-tween._delay):prevStart=tween._startTime,tween._startTime<0&&!tween._paused&&(max-=tween._startTime,this._timeline.smoothChildTiming&&(this._startTime+=tween._startTime/this._timeScale),this.shiftChildren(-tween._startTime,!1,-9999999999),prevStart=0),end=tween._startTime+tween._totalDuration/tween._timeScale,end>max&&(max=end),tween=prev;this._duration=this._totalDuration=max,this._dirty=!1}return this._totalDuration}return value&&this.totalDuration()?this.timeScale(this._totalDuration/value):this},p.paused=function(value){if(!value)for(var tween=this._first,time=this._time;tween;)tween._startTime===time&&"isPause"===tween.data&&(tween._rawPrevTime=0),tween=tween._next;return Animation.prototype.paused.apply(this,arguments)},p.usesFrames=function(){for(var tl=this._timeline;tl._timeline;)tl=tl._timeline;return tl===Animation._rootFramesTimeline},p.rawTime=function(wrapRepeats){return wrapRepeats&&(this._paused||this._repeat&&this.time()>0&&this.totalProgress()<1)?this._totalTime%(this._duration+this._repeatDelay):this._paused?this._totalTime:(this._timeline.rawTime(wrapRepeats)-this._startTime)*this._timeScale},TimelineLite},!0),_gsScope._gsDefine("TimelineMax",["TimelineLite","TweenLite","easing.Ease"],function(TimelineLite,TweenLite,Ease){var TimelineMax=function(vars){TimelineLite.call(this,vars),this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._cycle=0,this._yoyo=this.vars.yoyo===!0,this._dirty=!0},_tinyNum=1e-10,TweenLiteInternals=TweenLite._internals,_lazyTweens=TweenLiteInternals.lazyTweens,_lazyRender=TweenLiteInternals.lazyRender,_globals=_gsScope._gsDefine.globals,_easeNone=new Ease(null,null,1,0),p=TimelineMax.prototype=new TimelineLite;return p.constructor=TimelineMax,p.kill()._gc=!1,TimelineMax.version="1.19.1",p.invalidate=function(){return this._yoyo=this.vars.yoyo===!0,this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._uncache(!0),TimelineLite.prototype.invalidate.call(this)},p.addCallback=function(callback,position,params,scope){return this.add(TweenLite.delayedCall(0,callback,params,scope),position)},p.removeCallback=function(callback,position){if(callback)if(null==position)this._kill(null,callback);else for(var a=this.getTweensOf(callback,!1),i=a.length,time=this._parseTimeOrLabel(position);--i>-1;)a[i]._startTime===time&&a[i]._enabled(!1,!1);return this},p.removePause=function(position){return this.removeCallback(TimelineLite._internals.pauseCallback,position)},p.tweenTo=function(position,vars){vars=vars||{};var duration,p,t,copy={ease:_easeNone,useFrames:this.usesFrames(),immediateRender:!1},Engine=vars.repeat&&_globals.TweenMax||TweenLite;for(p in vars)copy[p]=vars[p];return copy.time=this._parseTimeOrLabel(position),
duration=Math.abs(Number(copy.time)-this._time)/this._timeScale||.001,t=new Engine(this,duration,copy),copy.onStart=function(){t.target.paused(!0),t.vars.time!==t.target.time()&&duration===t.duration()&&t.duration(Math.abs(t.vars.time-t.target.time())/t.target._timeScale),vars.onStart&&vars.onStart.apply(vars.onStartScope||vars.callbackScope||t,vars.onStartParams||[])},t},p.tweenFromTo=function(fromPosition,toPosition,vars){vars=vars||{},fromPosition=this._parseTimeOrLabel(fromPosition),vars.startAt={onComplete:this.seek,onCompleteParams:[fromPosition],callbackScope:this},vars.immediateRender=vars.immediateRender!==!1;var t=this.tweenTo(toPosition,vars);return t.duration(Math.abs(t.vars.time-fromPosition)/this._timeScale||.001)},p.render=function(time,suppressEvents,force){this._gc&&this._enabled(!0,!1);var tween,isComplete,next,callback,internalForce,cycleDuration,pauseTween,curTime,totalDur=this._dirty?this.totalDuration():this._totalDuration,dur=this._duration,prevTime=this._time,prevTotalTime=this._totalTime,prevStart=this._startTime,prevTimeScale=this._timeScale,prevRawPrevTime=this._rawPrevTime,prevPaused=this._paused,prevCycle=this._cycle;if(time>=totalDur-1e-7&&time>=0)this._locked||(this._totalTime=totalDur,this._cycle=this._repeat),this._reversed||this._hasPausedChild()||(isComplete=!0,callback="onComplete",internalForce=!!this._timeline.autoRemoveChildren,0===this._duration&&(time<=0&&time>=-1e-7||prevRawPrevTime<0||prevRawPrevTime===_tinyNum)&&prevRawPrevTime!==time&&this._first&&(internalForce=!0,prevRawPrevTime>_tinyNum&&(callback="onReverseComplete"))),this._rawPrevTime=this._duration||!suppressEvents||time||this._rawPrevTime===time?time:_tinyNum,this._yoyo&&0!==(1&this._cycle)?this._time=time=0:(this._time=dur,time=dur+1e-4);else if(time<1e-7)if(this._locked||(this._totalTime=this._cycle=0),this._time=0,(0!==prevTime||0===dur&&prevRawPrevTime!==_tinyNum&&(prevRawPrevTime>0||time<0&&prevRawPrevTime>=0)&&!this._locked)&&(callback="onReverseComplete",isComplete=this._reversed),time<0)this._active=!1,this._timeline.autoRemoveChildren&&this._reversed?(internalForce=isComplete=!0,callback="onReverseComplete"):prevRawPrevTime>=0&&this._first&&(internalForce=!0),this._rawPrevTime=time;else{if(this._rawPrevTime=dur||!suppressEvents||time||this._rawPrevTime===time?time:_tinyNum,0===time&&isComplete)for(tween=this._first;tween&&0===tween._startTime;)tween._duration||(isComplete=!1),tween=tween._next;time=0,this._initted||(internalForce=!0)}else if(0===dur&&prevRawPrevTime<0&&(internalForce=!0),this._time=this._rawPrevTime=time,this._locked||(this._totalTime=time,0!==this._repeat&&(cycleDuration=dur+this._repeatDelay,this._cycle=this._totalTime/cycleDuration>>0,0!==this._cycle&&this._cycle===this._totalTime/cycleDuration&&prevTotalTime<=time&&this._cycle--,this._time=this._totalTime-this._cycle*cycleDuration,this._yoyo&&0!==(1&this._cycle)&&(this._time=dur-this._time),this._time>dur?(this._time=dur,time=dur+1e-4):this._time<0?this._time=time=0:time=this._time)),this._hasPause&&!this._forcingPlayhead&&!suppressEvents&&time<dur){if(time=this._time,time>=prevTime||this._repeat&&prevCycle!==this._cycle)for(tween=this._first;tween&&tween._startTime<=time&&!pauseTween;)tween._duration||"isPause"!==tween.data||tween.ratio||0===tween._startTime&&0===this._rawPrevTime||(pauseTween=tween),tween=tween._next;else for(tween=this._last;tween&&tween._startTime>=time&&!pauseTween;)tween._duration||"isPause"===tween.data&&tween._rawPrevTime>0&&(pauseTween=tween),tween=tween._prev;pauseTween&&(this._time=time=pauseTween._startTime,this._totalTime=time+this._cycle*(this._totalDuration+this._repeatDelay))}if(this._cycle!==prevCycle&&!this._locked){var backwards=this._yoyo&&0!==(1&prevCycle),wrap=backwards===(this._yoyo&&0!==(1&this._cycle)),recTotalTime=this._totalTime,recCycle=this._cycle,recRawPrevTime=this._rawPrevTime,recTime=this._time;if(this._totalTime=prevCycle*dur,this._cycle<prevCycle?backwards=!backwards:this._totalTime+=dur,this._time=prevTime,this._rawPrevTime=0===dur?prevRawPrevTime-1e-4:prevRawPrevTime,this._cycle=prevCycle,this._locked=!0,prevTime=backwards?0:dur,this.render(prevTime,suppressEvents,0===dur),suppressEvents||this._gc||this.vars.onRepeat&&(this._cycle=recCycle,this._locked=!1,this._callback("onRepeat")),prevTime!==this._time)return;if(wrap&&(this._cycle=prevCycle,this._locked=!0,prevTime=backwards?dur+1e-4:-1e-4,this.render(prevTime,!0,!1)),this._locked=!1,this._paused&&!prevPaused)return;this._time=recTime,this._totalTime=recTotalTime,this._cycle=recCycle,this._rawPrevTime=recRawPrevTime}if(!(this._time!==prevTime&&this._first||force||internalForce||pauseTween))return void(prevTotalTime!==this._totalTime&&this._onUpdate&&(suppressEvents||this._callback("onUpdate")));if(this._initted||(this._initted=!0),this._active||!this._paused&&this._totalTime!==prevTotalTime&&time>0&&(this._active=!0),0===prevTotalTime&&this.vars.onStart&&(0===this._totalTime&&this._totalDuration||suppressEvents||this._callback("onStart")),curTime=this._time,curTime>=prevTime)for(tween=this._first;tween&&(next=tween._next,curTime===this._time&&(!this._paused||prevPaused));)(tween._active||tween._startTime<=this._time&&!tween._paused&&!tween._gc)&&(pauseTween===tween&&this.pause(),tween._reversed?tween.render((tween._dirty?tween.totalDuration():tween._totalDuration)-(time-tween._startTime)*tween._timeScale,suppressEvents,force):tween.render((time-tween._startTime)*tween._timeScale,suppressEvents,force)),tween=next;else for(tween=this._last;tween&&(next=tween._prev,curTime===this._time&&(!this._paused||prevPaused));){if(tween._active||tween._startTime<=prevTime&&!tween._paused&&!tween._gc){if(pauseTween===tween){for(pauseTween=tween._prev;pauseTween&&pauseTween.endTime()>this._time;)pauseTween.render(pauseTween._reversed?pauseTween.totalDuration()-(time-pauseTween._startTime)*pauseTween._timeScale:(time-pauseTween._startTime)*pauseTween._timeScale,suppressEvents,force),pauseTween=pauseTween._prev;pauseTween=null,this.pause()}tween._reversed?tween.render((tween._dirty?tween.totalDuration():tween._totalDuration)-(time-tween._startTime)*tween._timeScale,suppressEvents,force):tween.render((time-tween._startTime)*tween._timeScale,suppressEvents,force)}tween=next}this._onUpdate&&(suppressEvents||(_lazyTweens.length&&_lazyRender(),this._callback("onUpdate"))),callback&&(this._locked||this._gc||prevStart!==this._startTime&&prevTimeScale===this._timeScale||(0===this._time||totalDur>=this.totalDuration())&&(isComplete&&(_lazyTweens.length&&_lazyRender(),this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!suppressEvents&&this.vars[callback]&&this._callback(callback)))},p.getActive=function(nested,tweens,timelines){null==nested&&(nested=!0),null==tweens&&(tweens=!0),null==timelines&&(timelines=!1);var i,tween,a=[],all=this.getChildren(nested,tweens,timelines),cnt=0,l=all.length;for(i=0;i<l;i++)tween=all[i],tween.isActive()&&(a[cnt++]=tween);return a},p.getLabelAfter=function(time){time||0!==time&&(time=this._time);var i,labels=this.getLabelsArray(),l=labels.length;for(i=0;i<l;i++)if(labels[i].time>time)return labels[i].name;return null},p.getLabelBefore=function(time){null==time&&(time=this._time);for(var labels=this.getLabelsArray(),i=labels.length;--i>-1;)if(labels[i].time<time)return labels[i].name;return null},p.getLabelsArray=function(){var p,a=[],cnt=0;for(p in this._labels)a[cnt++]={time:this._labels[p],name:p};return a.sort(function(a,b){return a.time-b.time}),a},p.invalidate=function(){return this._locked=!1,TimelineLite.prototype.invalidate.call(this)},p.progress=function(value,suppressEvents){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&0!==(1&this._cycle)?1-value:value)+this._cycle*(this._duration+this._repeatDelay),suppressEvents):this._time/this.duration()},p.totalProgress=function(value,suppressEvents){return arguments.length?this.totalTime(this.totalDuration()*value,suppressEvents):this._totalTime/this.totalDuration()},p.totalDuration=function(value){return arguments.length?this._repeat!==-1&&value?this.timeScale(this.totalDuration()/value):this:(this._dirty&&(TimelineLite.prototype.totalDuration.call(this),this._totalDuration=this._repeat===-1?999999999999:this._duration*(this._repeat+1)+this._repeatDelay*this._repeat),this._totalDuration)},p.time=function(value,suppressEvents){return arguments.length?(this._dirty&&this.totalDuration(),value>this._duration&&(value=this._duration),this._yoyo&&0!==(1&this._cycle)?value=this._duration-value+this._cycle*(this._duration+this._repeatDelay):0!==this._repeat&&(value+=this._cycle*(this._duration+this._repeatDelay)),this.totalTime(value,suppressEvents)):this._time},p.repeat=function(value){return arguments.length?(this._repeat=value,this._uncache(!0)):this._repeat},p.repeatDelay=function(value){return arguments.length?(this._repeatDelay=value,this._uncache(!0)):this._repeatDelay},p.yoyo=function(value){return arguments.length?(this._yoyo=value,this):this._yoyo},p.currentLabel=function(value){return arguments.length?this.seek(value,!0):this.getLabelBefore(this._time+1e-8)},TimelineMax},!0),function(){var _RAD2DEG=180/Math.PI,_r1=[],_r2=[],_r3=[],_corProps={},_globals=_gsScope._gsDefine.globals,Segment=function(a,b,c,d){c===d&&(c=d-(d-b)/1e6),a===b&&(b=a+(c-a)/1e6),this.a=a,this.b=b,this.c=c,this.d=d,this.da=d-a,this.ca=c-a,this.ba=b-a},_correlate=",x,y,z,left,top,right,bottom,marginTop,marginLeft,marginRight,marginBottom,paddingLeft,paddingTop,paddingRight,paddingBottom,backgroundPosition,backgroundPosition_y,",cubicToQuadratic=function(a,b,c,d){var q1={a:a},q2={},q3={},q4={c:d},mab=(a+b)/2,mbc=(b+c)/2,mcd=(c+d)/2,mabc=(mab+mbc)/2,mbcd=(mbc+mcd)/2,m8=(mbcd-mabc)/8;return q1.b=mab+(a-mab)/4,q2.b=mabc+m8,q1.c=q2.a=(q1.b+q2.b)/2,q2.c=q3.a=(mabc+mbcd)/2,q3.b=mbcd-m8,q4.b=mcd+(d-mcd)/4,q3.c=q4.a=(q3.b+q4.b)/2,[q1,q2,q3,q4]},_calculateControlPoints=function(a,curviness,quad,basic,correlate){var i,p1,p2,p3,seg,m1,m2,mm,cp2,qb,r1,r2,tl,l=a.length-1,ii=0,cp1=a[0].a;for(i=0;i<l;i++)seg=a[ii],p1=seg.a,p2=seg.d,p3=a[ii+1].d,correlate?(r1=_r1[i],r2=_r2[i],tl=(r2+r1)*curviness*.25/(basic?.5:_r3[i]||.5),m1=p2-(p2-p1)*(basic?.5*curviness:0!==r1?tl/r1:0),m2=p2+(p3-p2)*(basic?.5*curviness:0!==r2?tl/r2:0),mm=p2-(m1+((m2-m1)*(3*r1/(r1+r2)+.5)/4||0))):(m1=p2-(p2-p1)*curviness*.5,m2=p2+(p3-p2)*curviness*.5,mm=p2-(m1+m2)/2),m1+=mm,m2+=mm,seg.c=cp2=m1,0!==i?seg.b=cp1:seg.b=cp1=seg.a+.6*(seg.c-seg.a),seg.da=p2-p1,seg.ca=cp2-p1,seg.ba=cp1-p1,quad?(qb=cubicToQuadratic(p1,cp1,cp2,p2),a.splice(ii,1,qb[0],qb[1],qb[2],qb[3]),ii+=4):ii++,cp1=m2;seg=a[ii],seg.b=cp1,seg.c=cp1+.4*(seg.d-cp1),seg.da=seg.d-seg.a,seg.ca=seg.c-seg.a,seg.ba=cp1-seg.a,quad&&(qb=cubicToQuadratic(seg.a,cp1,seg.c,seg.d),a.splice(ii,1,qb[0],qb[1],qb[2],qb[3]))},_parseAnchors=function(values,p,correlate,prepend){var l,i,p1,p2,p3,tmp,a=[];if(prepend)for(values=[prepend].concat(values),i=values.length;--i>-1;)"string"==typeof(tmp=values[i][p])&&"="===tmp.charAt(1)&&(values[i][p]=prepend[p]+Number(tmp.charAt(0)+tmp.substr(2)));if(l=values.length-2,l<0)return a[0]=new Segment(values[0][p],0,0,values[l<-1?0:1][p]),a;for(i=0;i<l;i++)p1=values[i][p],p2=values[i+1][p],a[i]=new Segment(p1,0,0,p2),correlate&&(p3=values[i+2][p],_r1[i]=(_r1[i]||0)+(p2-p1)*(p2-p1),_r2[i]=(_r2[i]||0)+(p3-p2)*(p3-p2));return a[i]=new Segment(values[i][p],0,0,values[i+1][p]),a},bezierThrough=function(values,curviness,quadratic,basic,correlate,prepend){var i,p,a,j,r,l,seamless,last,obj={},props=[],first=prepend||values[0];correlate="string"==typeof correlate?","+correlate+",":_correlate,null==curviness&&(curviness=1);for(p in values[0])props.push(p);if(values.length>1){for(last=values[values.length-1],seamless=!0,i=props.length;--i>-1;)if(p=props[i],Math.abs(first[p]-last[p])>.05){seamless=!1;break}seamless&&(values=values.concat(),prepend&&values.unshift(prepend),values.push(values[1]),prepend=values[values.length-3])}for(_r1.length=_r2.length=_r3.length=0,i=props.length;--i>-1;)p=props[i],_corProps[p]=correlate.indexOf(","+p+",")!==-1,obj[p]=_parseAnchors(values,p,_corProps[p],prepend);for(i=_r1.length;--i>-1;)_r1[i]=Math.sqrt(_r1[i]),_r2[i]=Math.sqrt(_r2[i]);if(!basic){for(i=props.length;--i>-1;)if(_corProps[p])for(a=obj[props[i]],l=a.length-1,j=0;j<l;j++)r=a[j+1].da/_r2[j]+a[j].da/_r1[j]||0,_r3[j]=(_r3[j]||0)+r*r;for(i=_r3.length;--i>-1;)_r3[i]=Math.sqrt(_r3[i])}for(i=props.length,j=quadratic?4:1;--i>-1;)p=props[i],a=obj[p],_calculateControlPoints(a,curviness,quadratic,basic,_corProps[p]),seamless&&(a.splice(0,j),a.splice(a.length-j,j));return obj},_parseBezierData=function(values,type,prepend){type=type||"soft";var a,b,c,d,cur,i,j,l,p,cnt,tmp,obj={},inc="cubic"===type?3:2,soft="soft"===type,props=[];if(soft&&prepend&&(values=[prepend].concat(values)),null==values||values.length<inc+1)throw"invalid Bezier data";for(p in values[0])props.push(p);for(i=props.length;--i>-1;){for(p=props[i],obj[p]=cur=[],cnt=0,l=values.length,j=0;j<l;j++)a=null==prepend?values[j][p]:"string"==typeof(tmp=values[j][p])&&"="===tmp.charAt(1)?prepend[p]+Number(tmp.charAt(0)+tmp.substr(2)):Number(tmp),soft&&j>1&&j<l-1&&(cur[cnt++]=(a+cur[cnt-2])/2),cur[cnt++]=a;for(l=cnt-inc+1,cnt=0,j=0;j<l;j+=inc)a=cur[j],b=cur[j+1],c=cur[j+2],d=2===inc?0:cur[j+3],cur[cnt++]=tmp=3===inc?new Segment(a,b,c,d):new Segment(a,(2*b+a)/3,(2*b+c)/3,c);cur.length=cnt}return obj},_addCubicLengths=function(a,steps,resolution){for(var d,d1,s,da,ca,ba,p,i,inv,bez,index,inc=1/resolution,j=a.length;--j>-1;)for(bez=a[j],s=bez.a,da=bez.d-s,ca=bez.c-s,ba=bez.b-s,d=d1=0,i=1;i<=resolution;i++)p=inc*i,inv=1-p,d=d1-(d1=(p*p*da+3*inv*(p*ca+inv*ba))*p),index=j*resolution+i-1,steps[index]=(steps[index]||0)+d*d},_parseLengthData=function(obj,resolution){resolution=resolution>>0||6;var p,i,l,index,a=[],lengths=[],d=0,total=0,threshold=resolution-1,segments=[],curLS=[];for(p in obj)_addCubicLengths(obj[p],a,resolution);for(l=a.length,i=0;i<l;i++)d+=Math.sqrt(a[i]),index=i%resolution,curLS[index]=d,index===threshold&&(total+=d,index=i/resolution>>0,segments[index]=curLS,lengths[index]=total,d=0,curLS=[]);return{length:total,lengths:lengths,segments:segments}},BezierPlugin=_gsScope._gsDefine.plugin({propName:"bezier",priority:-1,version:"1.3.7",API:2,global:!0,init:function(target,vars,tween){this._target=target,vars instanceof Array&&(vars={values:vars}),this._func={},this._mod={},this._props=[],this._timeRes=null==vars.timeResolution?6:parseInt(vars.timeResolution,10);var p,isFunc,i,j,prepend,values=vars.values||[],first={},second=values[0],autoRotate=vars.autoRotate||tween.vars.orientToBezier;this._autoRotate=autoRotate?autoRotate instanceof Array?autoRotate:[["x","y","rotation",autoRotate===!0?0:Number(autoRotate)||0]]:null;for(p in second)this._props.push(p);for(i=this._props.length;--i>-1;)p=this._props[i],this._overwriteProps.push(p),isFunc=this._func[p]="function"==typeof target[p],first[p]=isFunc?target[p.indexOf("set")||"function"!=typeof target["get"+p.substr(3)]?p:"get"+p.substr(3)]():parseFloat(target[p]),prepend||first[p]!==values[0][p]&&(prepend=first);if(this._beziers="cubic"!==vars.type&&"quadratic"!==vars.type&&"soft"!==vars.type?bezierThrough(values,isNaN(vars.curviness)?1:vars.curviness,!1,"thruBasic"===vars.type,vars.correlate,prepend):_parseBezierData(values,vars.type,first),this._segCount=this._beziers[p].length,this._timeRes){var ld=_parseLengthData(this._beziers,this._timeRes);this._length=ld.length,this._lengths=ld.lengths,this._segments=ld.segments,this._l1=this._li=this._s1=this._si=0,this._l2=this._lengths[0],this._curSeg=this._segments[0],this._s2=this._curSeg[0],this._prec=1/this._curSeg.length}if(autoRotate=this._autoRotate)for(this._initialRotations=[],autoRotate[0]instanceof Array||(this._autoRotate=autoRotate=[autoRotate]),i=autoRotate.length;--i>-1;){for(j=0;j<3;j++)p=autoRotate[i][j],this._func[p]="function"==typeof target[p]&&target[p.indexOf("set")||"function"!=typeof target["get"+p.substr(3)]?p:"get"+p.substr(3)];p=autoRotate[i][2],this._initialRotations[i]=(this._func[p]?this._func[p].call(this._target):this._target[p])||0,this._overwriteProps.push(p)}return this._startRatio=tween.vars.runBackwards?1:0,!0},set:function(v){var curIndex,inv,i,p,b,t,val,l,lengths,curSeg,segments=this._segCount,func=this._func,target=this._target,notStart=v!==this._startRatio;if(this._timeRes){if(lengths=this._lengths,curSeg=this._curSeg,v*=this._length,i=this._li,v>this._l2&&i<segments-1){for(l=segments-1;i<l&&(this._l2=lengths[++i])<=v;);this._l1=lengths[i-1],this._li=i,this._curSeg=curSeg=this._segments[i],this._s2=curSeg[this._s1=this._si=0]}else if(v<this._l1&&i>0){for(;i>0&&(this._l1=lengths[--i])>=v;);0===i&&v<this._l1?this._l1=0:i++,this._l2=lengths[i],this._li=i,this._curSeg=curSeg=this._segments[i],this._s1=curSeg[(this._si=curSeg.length-1)-1]||0,this._s2=curSeg[this._si]}if(curIndex=i,v-=this._l1,i=this._si,v>this._s2&&i<curSeg.length-1){for(l=curSeg.length-1;i<l&&(this._s2=curSeg[++i])<=v;);this._s1=curSeg[i-1],this._si=i}else if(v<this._s1&&i>0){for(;i>0&&(this._s1=curSeg[--i])>=v;);0===i&&v<this._s1?this._s1=0:i++,this._s2=curSeg[i],this._si=i}t=(i+(v-this._s1)/(this._s2-this._s1))*this._prec||0}else curIndex=v<0?0:v>=1?segments-1:segments*v>>0,t=(v-curIndex*(1/segments))*segments;for(inv=1-t,i=this._props.length;--i>-1;)p=this._props[i],b=this._beziers[p][curIndex],val=(t*t*b.da+3*inv*(t*b.ca+inv*b.ba))*t+b.a,this._mod[p]&&(val=this._mod[p](val,target)),func[p]?target[p](val):target[p]=val;if(this._autoRotate){var b2,x1,y1,x2,y2,add,conv,ar=this._autoRotate;for(i=ar.length;--i>-1;)p=ar[i][2],add=ar[i][3]||0,conv=ar[i][4]===!0?1:_RAD2DEG,b=this._beziers[ar[i][0]],b2=this._beziers[ar[i][1]],b&&b2&&(b=b[curIndex],b2=b2[curIndex],x1=b.a+(b.b-b.a)*t,x2=b.b+(b.c-b.b)*t,x1+=(x2-x1)*t,x2+=(b.c+(b.d-b.c)*t-x2)*t,y1=b2.a+(b2.b-b2.a)*t,y2=b2.b+(b2.c-b2.b)*t,y1+=(y2-y1)*t,y2+=(b2.c+(b2.d-b2.c)*t-y2)*t,val=notStart?Math.atan2(y2-y1,x2-x1)*conv+add:this._initialRotations[i],this._mod[p]&&(val=this._mod[p](val,target)),func[p]?target[p](val):target[p]=val)}}}),p=BezierPlugin.prototype;BezierPlugin.bezierThrough=bezierThrough,BezierPlugin.cubicToQuadratic=cubicToQuadratic,BezierPlugin._autoCSS=!0,BezierPlugin.quadraticToCubic=function(a,b,c){return new Segment(a,(2*b+a)/3,(2*b+c)/3,c)},BezierPlugin._cssRegister=function(){var CSSPlugin=_globals.CSSPlugin;if(CSSPlugin){var _internals=CSSPlugin._internals,_parseToProxy=_internals._parseToProxy,_setPluginRatio=_internals._setPluginRatio,CSSPropTween=_internals.CSSPropTween;_internals._registerComplexSpecialProp("bezier",{parser:function(t,e,prop,cssp,pt,plugin){e instanceof Array&&(e={values:e}),plugin=new BezierPlugin;var i,p,data,values=e.values,l=values.length-1,pluginValues=[],v={};if(l<0)return pt;for(i=0;i<=l;i++)data=_parseToProxy(t,values[i],cssp,pt,plugin,l!==i),pluginValues[i]=data.end;for(p in e)v[p]=e[p];return v.values=pluginValues,pt=new CSSPropTween(t,"bezier",0,0,data.pt,2),pt.data=data,pt.plugin=plugin,pt.setRatio=_setPluginRatio,0===v.autoRotate&&(v.autoRotate=!0),!v.autoRotate||v.autoRotate instanceof Array||(i=v.autoRotate===!0?0:Number(v.autoRotate),v.autoRotate=null!=data.end.left?[["left","top","rotation",i,!1]]:null!=data.end.x&&[["x","y","rotation",i,!1]]),v.autoRotate&&(cssp._transform||cssp._enableTransforms(!1),data.autoRotate=cssp._target._gsTransform,data.proxy.rotation=data.autoRotate.rotation||0,cssp._overwriteProps.push("rotation")),plugin._onInitTween(data.proxy,v,cssp._tween),pt}})}},p._mod=function(lookup){for(var val,op=this._overwriteProps,i=op.length;--i>-1;)val=lookup[op[i]],val&&"function"==typeof val&&(this._mod[op[i]]=val)},p._kill=function(lookup){var p,i,a=this._props;for(p in this._beziers)if(p in lookup)for(delete this._beziers[p],delete this._func[p],i=a.length;--i>-1;)a[i]===p&&a.splice(i,1);if(a=this._autoRotate)for(i=a.length;--i>-1;)lookup[a[i][2]]&&a.splice(i,1);return this._super._kill.call(this,lookup)}}(),_gsScope._gsDefine("plugins.CSSPlugin",["plugins.TweenPlugin","TweenLite"],function(TweenPlugin,TweenLite){var _hasPriority,_suffixMap,_cs,_overwriteProps,CSSPlugin=function(){TweenPlugin.call(this,"css"),this._overwriteProps.length=0,this.setRatio=CSSPlugin.prototype.setRatio},_globals=_gsScope._gsDefine.globals,_specialProps={},p=CSSPlugin.prototype=new TweenPlugin("css");p.constructor=CSSPlugin,CSSPlugin.version="1.19.1",CSSPlugin.API=2,CSSPlugin.defaultTransformPerspective=0,CSSPlugin.defaultSkewType="compensated",CSSPlugin.defaultSmoothOrigin=!0,p="px",CSSPlugin.suffixMap={top:p,right:p,bottom:p,left:p,width:p,height:p,fontSize:p,padding:p,margin:p,perspective:p,lineHeight:""};var _autoRound,_reqSafariFix,_isSafari,_isFirefox,_isSafariLT6,_ieVers,_target,_index,_numExp=/(?:\-|\.|\b)(\d|\.|e\-)+/g,_relNumExp=/(?:\d|\-\d|\.\d|\-\.\d|\+=\d|\-=\d|\+=.\d|\-=\.\d)+/g,_valuesExp=/(?:\+=|\-=|\-|\b)[\d\-\.]+[a-zA-Z0-9]*(?:%|\b)/gi,_NaNExp=/(?![+-]?\d*\.?\d+|[+-]|e[+-]\d+)[^0-9]/g,_suffixExp=/(?:\d|\-|\+|=|#|\.)*/g,_opacityExp=/opacity *= *([^)]*)/i,_opacityValExp=/opacity:([^;]*)/i,_alphaFilterExp=/alpha\(opacity *=.+?\)/i,_rgbhslExp=/^(rgb|hsl)/,_capsExp=/([A-Z])/g,_camelExp=/-([a-z])/gi,_urlExp=/(^(?:url\(\"|url\())|(?:(\"\))$|\)$)/gi,_camelFunc=function(s,g){return g.toUpperCase()},_horizExp=/(?:Left|Right|Width)/i,_ieGetMatrixExp=/(M11|M12|M21|M22)=[\d\-\.e]+/gi,_ieSetMatrixExp=/progid\:DXImageTransform\.Microsoft\.Matrix\(.+?\)/i,_commasOutsideParenExp=/,(?=[^\)]*(?:\(|$))/gi,_complexExp=/[\s,\(]/i,_DEG2RAD=Math.PI/180,_RAD2DEG=180/Math.PI,_forcePT={},_dummyElement={style:{}},_doc=_gsScope.document||{createElement:function(){return _dummyElement}},_createElement=function(type,ns){return _doc.createElementNS?_doc.createElementNS(ns||"http://www.w3.org/1999/xhtml",type):_doc.createElement(type)},_tempDiv=_createElement("div"),_tempImg=_createElement("img"),_internals=CSSPlugin._internals={_specialProps:_specialProps},_agent=(_gsScope.navigator||{}).userAgent||"",_supportsOpacity=function(){var i=_agent.indexOf("Android"),a=_createElement("a");return _isSafari=_agent.indexOf("Safari")!==-1&&_agent.indexOf("Chrome")===-1&&(i===-1||parseFloat(_agent.substr(i+8,2))>3),_isSafariLT6=_isSafari&&parseFloat(_agent.substr(_agent.indexOf("Version/")+8,2))<6,_isFirefox=_agent.indexOf("Firefox")!==-1,(/MSIE ([0-9]{1,}[\.0-9]{0,})/.exec(_agent)||/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/.exec(_agent))&&(_ieVers=parseFloat(RegExp.$1)),!!a&&(a.style.cssText="top:1px;opacity:.55;",/^0.55/.test(a.style.opacity))}(),_getIEOpacity=function(v){return _opacityExp.test("string"==typeof v?v:(v.currentStyle?v.currentStyle.filter:v.style.filter)||"")?parseFloat(RegExp.$1)/100:1},_log=function(s){_gsScope.console&&console.log(s)},_prefixCSS="",_prefix="",_checkPropPrefix=function(p,e){e=e||_tempDiv;var a,i,s=e.style;if(void 0!==s[p])return p;for(p=p.charAt(0).toUpperCase()+p.substr(1),a=["O","Moz","ms","Ms","Webkit"],i=5;--i>-1&&void 0===s[a[i]+p];);return i>=0?(_prefix=3===i?"ms":a[i],_prefixCSS="-"+_prefix.toLowerCase()+"-",_prefix+p):null},_getComputedStyle=_doc.defaultView?_doc.defaultView.getComputedStyle:function(){},_getStyle=CSSPlugin.getStyle=function(t,p,cs,calc,dflt){var rv;return _supportsOpacity||"opacity"!==p?(!calc&&t.style[p]?rv=t.style[p]:(cs=cs||_getComputedStyle(t))?rv=cs[p]||cs.getPropertyValue(p)||cs.getPropertyValue(p.replace(_capsExp,"-$1").toLowerCase()):t.currentStyle&&(rv=t.currentStyle[p]),null==dflt||rv&&"none"!==rv&&"auto"!==rv&&"auto auto"!==rv?rv:dflt):_getIEOpacity(t)},_convertToPixels=_internals.convertToPixels=function(t,p,v,sfx,recurse){if("px"===sfx||!sfx)return v;if("auto"===sfx||!v)return 0;var pix,cache,time,horiz=_horizExp.test(p),node=t,style=_tempDiv.style,neg=v<0,precise=1===v;if(neg&&(v=-v),precise&&(v*=100),"%"===sfx&&p.indexOf("border")!==-1)pix=v/100*(horiz?t.clientWidth:t.clientHeight);else{if(style.cssText="border:0 solid red;position:"+_getStyle(t,"position")+";line-height:0;","%"!==sfx&&node.appendChild&&"v"!==sfx.charAt(0)&&"rem"!==sfx)style[horiz?"borderLeftWidth":"borderTopWidth"]=v+sfx;else{if(node=t.parentNode||_doc.body,cache=node._gsCache,time=TweenLite.ticker.frame,cache&&horiz&&cache.time===time)return cache.width*v/100;style[horiz?"width":"height"]=v+sfx}node.appendChild(_tempDiv),pix=parseFloat(_tempDiv[horiz?"offsetWidth":"offsetHeight"]),node.removeChild(_tempDiv),horiz&&"%"===sfx&&CSSPlugin.cacheWidths!==!1&&(cache=node._gsCache=node._gsCache||{},cache.time=time,cache.width=pix/v*100),0!==pix||recurse||(pix=_convertToPixels(t,p,v,sfx,!0))}return precise&&(pix/=100),neg?-pix:pix},_calculateOffset=_internals.calculateOffset=function(t,p,cs){if("absolute"!==_getStyle(t,"position",cs))return 0;var dim="left"===p?"Left":"Top",v=_getStyle(t,"margin"+dim,cs);return t["offset"+dim]-(_convertToPixels(t,p,parseFloat(v),v.replace(_suffixExp,""))||0)},_getAllStyles=function(t,cs){var i,tr,p,s={};if(cs=cs||_getComputedStyle(t,null))if(i=cs.length)for(;--i>-1;)p=cs[i],p.indexOf("-transform")!==-1&&_transformPropCSS!==p||(s[p.replace(_camelExp,_camelFunc)]=cs.getPropertyValue(p));else for(i in cs)i.indexOf("Transform")!==-1&&_transformProp!==i||(s[i]=cs[i]);else if(cs=t.currentStyle||t.style)for(i in cs)"string"==typeof i&&void 0===s[i]&&(s[i.replace(_camelExp,_camelFunc)]=cs[i]);return _supportsOpacity||(s.opacity=_getIEOpacity(t)),tr=_getTransform(t,cs,!1),s.rotation=tr.rotation,s.skewX=tr.skewX,s.scaleX=tr.scaleX,s.scaleY=tr.scaleY,s.x=tr.x,s.y=tr.y,_supports3D&&(s.z=tr.z,s.rotationX=tr.rotationX,s.rotationY=tr.rotationY,s.scaleZ=tr.scaleZ),s.filters&&delete s.filters,s},_cssDif=function(t,s1,s2,vars,forceLookup){var val,p,mpt,difs={},style=t.style;for(p in s2)"cssText"!==p&&"length"!==p&&isNaN(p)&&(s1[p]!==(val=s2[p])||forceLookup&&forceLookup[p])&&p.indexOf("Origin")===-1&&("number"!=typeof val&&"string"!=typeof val||(difs[p]="auto"!==val||"left"!==p&&"top"!==p?""!==val&&"auto"!==val&&"none"!==val||"string"!=typeof s1[p]||""===s1[p].replace(_NaNExp,"")?val:0:_calculateOffset(t,p),void 0!==style[p]&&(mpt=new MiniPropTween(style,p,style[p],mpt))));if(vars)for(p in vars)"className"!==p&&(difs[p]=vars[p]);return{difs:difs,firstMPT:mpt}},_dimensions={width:["Left","Right"],height:["Top","Bottom"]},_margins=["marginLeft","marginRight","marginTop","marginBottom"],_getDimension=function(t,p,cs){if("svg"===(t.nodeName+"").toLowerCase())return(cs||_getComputedStyle(t))[p]||0;if(t.getCTM&&_isSVG(t))return t.getBBox()[p]||0;var v=parseFloat("width"===p?t.offsetWidth:t.offsetHeight),a=_dimensions[p],i=a.length;for(cs=cs||_getComputedStyle(t,null);--i>-1;)v-=parseFloat(_getStyle(t,"padding"+a[i],cs,!0))||0,v-=parseFloat(_getStyle(t,"border"+a[i]+"Width",cs,!0))||0;return v},_parsePosition=function(v,recObj){if("contain"===v||"auto"===v||"auto auto"===v)return v+" ";null!=v&&""!==v||(v="0 0");var i,a=v.split(" "),x=v.indexOf("left")!==-1?"0%":v.indexOf("right")!==-1?"100%":a[0],y=v.indexOf("top")!==-1?"0%":v.indexOf("bottom")!==-1?"100%":a[1];if(a.length>3&&!recObj){for(a=v.split(", ").join(",").split(","),v=[],i=0;i<a.length;i++)v.push(_parsePosition(a[i]));return v.join(",")}return null==y?y="center"===x?"50%":"0":"center"===y&&(y="50%"),("center"===x||isNaN(parseFloat(x))&&(x+"").indexOf("=")===-1)&&(x="50%"),v=x+" "+y+(a.length>2?" "+a[2]:""),recObj&&(recObj.oxp=x.indexOf("%")!==-1,recObj.oyp=y.indexOf("%")!==-1,recObj.oxr="="===x.charAt(1),recObj.oyr="="===y.charAt(1),recObj.ox=parseFloat(x.replace(_NaNExp,"")),recObj.oy=parseFloat(y.replace(_NaNExp,"")),recObj.v=v),recObj||v},_parseChange=function(e,b){return"function"==typeof e&&(e=e(_index,_target)),"string"==typeof e&&"="===e.charAt(1)?parseInt(e.charAt(0)+"1",10)*parseFloat(e.substr(2)):parseFloat(e)-parseFloat(b)||0},_parseVal=function(v,d){return"function"==typeof v&&(v=v(_index,_target)),null==v?d:"string"==typeof v&&"="===v.charAt(1)?parseInt(v.charAt(0)+"1",10)*parseFloat(v.substr(2))+d:parseFloat(v)||0},_parseAngle=function(v,d,p,directionalEnd){var cap,split,dif,result,isRelative,min=1e-6;return"function"==typeof v&&(v=v(_index,_target)),null==v?result=d:"number"==typeof v?result=v:(cap=360,split=v.split("_"),isRelative="="===v.charAt(1),dif=(isRelative?parseInt(v.charAt(0)+"1",10)*parseFloat(split[0].substr(2)):parseFloat(split[0]))*(v.indexOf("rad")===-1?1:_RAD2DEG)-(isRelative?0:d),split.length&&(directionalEnd&&(directionalEnd[p]=d+dif),v.indexOf("short")!==-1&&(dif%=cap,dif!==dif%(cap/2)&&(dif=dif<0?dif+cap:dif-cap)),v.indexOf("_cw")!==-1&&dif<0?dif=(dif+9999999999*cap)%cap-(dif/cap|0)*cap:v.indexOf("ccw")!==-1&&dif>0&&(dif=(dif-9999999999*cap)%cap-(dif/cap|0)*cap)),result=d+dif),result<min&&result>-min&&(result=0),result},_colorLookup={aqua:[0,255,255],lime:[0,255,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,255],navy:[0,0,128],white:[255,255,255],fuchsia:[255,0,255],olive:[128,128,0],yellow:[255,255,0],orange:[255,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[255,0,0],pink:[255,192,203],cyan:[0,255,255],transparent:[255,255,255,0]},_hue=function(h,m1,m2){return h=h<0?h+1:h>1?h-1:h,255*(6*h<1?m1+(m2-m1)*h*6:h<.5?m2:3*h<2?m1+(m2-m1)*(2/3-h)*6:m1)+.5|0},_parseColor=CSSPlugin.parseColor=function(v,toHSL){var a,r,g,b,h,s,l,max,min,d,wasHSL;if(v)if("number"==typeof v)a=[v>>16,v>>8&255,255&v];else{if(","===v.charAt(v.length-1)&&(v=v.substr(0,v.length-1)),_colorLookup[v])a=_colorLookup[v];else if("#"===v.charAt(0))4===v.length&&(r=v.charAt(1),g=v.charAt(2),b=v.charAt(3),v="#"+r+r+g+g+b+b),v=parseInt(v.substr(1),16),a=[v>>16,v>>8&255,255&v];else if("hsl"===v.substr(0,3))if(a=wasHSL=v.match(_numExp),toHSL){if(v.indexOf("=")!==-1)return v.match(_relNumExp)}else h=Number(a[0])%360/360,s=Number(a[1])/100,l=Number(a[2])/100,g=l<=.5?l*(s+1):l+s-l*s,r=2*l-g,a.length>3&&(a[3]=Number(v[3])),a[0]=_hue(h+1/3,r,g),a[1]=_hue(h,r,g),a[2]=_hue(h-1/3,r,g);else a=v.match(_numExp)||_colorLookup.transparent;a[0]=Number(a[0]),a[1]=Number(a[1]),a[2]=Number(a[2]),a.length>3&&(a[3]=Number(a[3]))}else a=_colorLookup.black;return toHSL&&!wasHSL&&(r=a[0]/255,g=a[1]/255,b=a[2]/255,max=Math.max(r,g,b),min=Math.min(r,g,b),l=(max+min)/2,max===min?h=s=0:(d=max-min,s=l>.5?d/(2-max-min):d/(max+min),h=max===r?(g-b)/d+(g<b?6:0):max===g?(b-r)/d+2:(r-g)/d+4,h*=60),a[0]=h+.5|0,a[1]=100*s+.5|0,a[2]=100*l+.5|0),a},_formatColors=function(s,toHSL){var i,color,temp,colors=s.match(_colorExp)||[],charIndex=0,parsed=colors.length?"":s;for(i=0;i<colors.length;i++)color=colors[i],temp=s.substr(charIndex,s.indexOf(color,charIndex)-charIndex),charIndex+=temp.length+color.length,color=_parseColor(color,toHSL),3===color.length&&color.push(1),parsed+=temp+(toHSL?"hsla("+color[0]+","+color[1]+"%,"+color[2]+"%,"+color[3]:"rgba("+color.join(","))+")";return parsed+s.substr(charIndex)},_colorExp="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3}){1,2}\\b";for(p in _colorLookup)_colorExp+="|"+p+"\\b";_colorExp=new RegExp(_colorExp+")","gi"),CSSPlugin.colorStringFilter=function(a){var toHSL,combined=a[0]+a[1];_colorExp.test(combined)&&(toHSL=combined.indexOf("hsl(")!==-1||combined.indexOf("hsla(")!==-1,a[0]=_formatColors(a[0],toHSL),a[1]=_formatColors(a[1],toHSL)),_colorExp.lastIndex=0},TweenLite.defaultStringFilter||(TweenLite.defaultStringFilter=CSSPlugin.colorStringFilter);var _getFormatter=function(dflt,clr,collapsible,multi){if(null==dflt)return function(v){return v};var formatter,dColor=clr?(dflt.match(_colorExp)||[""])[0]:"",dVals=dflt.split(dColor).join("").match(_valuesExp)||[],pfx=dflt.substr(0,dflt.indexOf(dVals[0])),sfx=")"===dflt.charAt(dflt.length-1)?")":"",delim=dflt.indexOf(" ")!==-1?" ":",",numVals=dVals.length,dSfx=numVals>0?dVals[0].replace(_numExp,""):"";return numVals?formatter=clr?function(v){var color,vals,i,a;if("number"==typeof v)v+=dSfx;else if(multi&&_commasOutsideParenExp.test(v)){for(a=v.replace(_commasOutsideParenExp,"|").split("|"),i=0;i<a.length;i++)a[i]=formatter(a[i]);return a.join(",")}if(color=(v.match(_colorExp)||[dColor])[0],vals=v.split(color).join("").match(_valuesExp)||[],i=vals.length,numVals>i--)for(;++i<numVals;)vals[i]=collapsible?vals[(i-1)/2|0]:dVals[i];
return pfx+vals.join(delim)+delim+color+sfx+(v.indexOf("inset")!==-1?" inset":"")}:function(v){var vals,a,i;if("number"==typeof v)v+=dSfx;else if(multi&&_commasOutsideParenExp.test(v)){for(a=v.replace(_commasOutsideParenExp,"|").split("|"),i=0;i<a.length;i++)a[i]=formatter(a[i]);return a.join(",")}if(vals=v.match(_valuesExp)||[],i=vals.length,numVals>i--)for(;++i<numVals;)vals[i]=collapsible?vals[(i-1)/2|0]:dVals[i];return pfx+vals.join(delim)+sfx}:function(v){return v}},_getEdgeParser=function(props){return props=props.split(","),function(t,e,p,cssp,pt,plugin,vars){var i,a=(e+"").split(" ");for(vars={},i=0;i<4;i++)vars[props[i]]=a[i]=a[i]||a[(i-1)/2>>0];return cssp.parse(t,vars,pt,plugin)}},MiniPropTween=(_internals._setPluginRatio=function(v){this.plugin.setRatio(v);for(var val,pt,i,str,p,d=this.data,proxy=d.proxy,mpt=d.firstMPT,min=1e-6;mpt;)val=proxy[mpt.v],mpt.r?val=Math.round(val):val<min&&val>-min&&(val=0),mpt.t[mpt.p]=val,mpt=mpt._next;if(d.autoRotate&&(d.autoRotate.rotation=d.mod?d.mod(proxy.rotation,this.t):proxy.rotation),1===v||0===v)for(mpt=d.firstMPT,p=1===v?"e":"b";mpt;){if(pt=mpt.t,pt.type){if(1===pt.type){for(str=pt.xs0+pt.s+pt.xs1,i=1;i<pt.l;i++)str+=pt["xn"+i]+pt["xs"+(i+1)];pt[p]=str}}else pt[p]=pt.s+pt.xs0;mpt=mpt._next}},function(t,p,v,next,r){this.t=t,this.p=p,this.v=v,this.r=r,next&&(next._prev=this,this._next=next)}),CSSPropTween=(_internals._parseToProxy=function(t,vars,cssp,pt,plugin,shallow){var i,p,xp,mpt,firstPT,bpt=pt,start={},end={},transform=cssp._transform,oldForce=_forcePT;for(cssp._transform=null,_forcePT=vars,pt=firstPT=cssp.parse(t,vars,pt,plugin),_forcePT=oldForce,shallow&&(cssp._transform=transform,bpt&&(bpt._prev=null,bpt._prev&&(bpt._prev._next=null)));pt&&pt!==bpt;){if(pt.type<=1&&(p=pt.p,end[p]=pt.s+pt.c,start[p]=pt.s,shallow||(mpt=new MiniPropTween(pt,"s",p,mpt,pt.r),pt.c=0),1===pt.type))for(i=pt.l;--i>0;)xp="xn"+i,p=pt.p+"_"+xp,end[p]=pt.data[xp],start[p]=pt[xp],shallow||(mpt=new MiniPropTween(pt,xp,p,mpt,pt.rxp[xp]));pt=pt._next}return{proxy:start,end:end,firstMPT:mpt,pt:firstPT}},_internals.CSSPropTween=function(t,p,s,c,next,type,n,r,pr,b,e){this.t=t,this.p=p,this.s=s,this.c=c,this.n=n||p,t instanceof CSSPropTween||_overwriteProps.push(this.n),this.r=r,this.type=type||0,pr&&(this.pr=pr,_hasPriority=!0),this.b=void 0===b?s:b,this.e=void 0===e?s+c:e,next&&(this._next=next,next._prev=this)}),_addNonTweeningNumericPT=function(target,prop,start,end,next,overwriteProp){var pt=new CSSPropTween(target,prop,start,end-start,next,(-1),overwriteProp);return pt.b=start,pt.e=pt.xs0=end,pt},_parseComplex=CSSPlugin.parseComplex=function(t,p,b,e,clrs,dflt,pt,pr,plugin,setRatio){b=b||dflt||"","function"==typeof e&&(e=e(_index,_target)),pt=new CSSPropTween(t,p,0,0,pt,setRatio?2:1,null,(!1),pr,b,e),e+="",clrs&&_colorExp.test(e+b)&&(e=[b,e],CSSPlugin.colorStringFilter(e),b=e[0],e=e[1]);var i,xi,ni,bv,ev,bnums,enums,bn,hasAlpha,temp,cv,str,useHSL,ba=b.split(", ").join(",").split(" "),ea=e.split(", ").join(",").split(" "),l=ba.length,autoRound=_autoRound!==!1;for(e.indexOf(",")===-1&&b.indexOf(",")===-1||(ba=ba.join(" ").replace(_commasOutsideParenExp,", ").split(" "),ea=ea.join(" ").replace(_commasOutsideParenExp,", ").split(" "),l=ba.length),l!==ea.length&&(ba=(dflt||"").split(" "),l=ba.length),pt.plugin=plugin,pt.setRatio=setRatio,_colorExp.lastIndex=0,i=0;i<l;i++)if(bv=ba[i],ev=ea[i],bn=parseFloat(bv),bn||0===bn)pt.appendXtra("",bn,_parseChange(ev,bn),ev.replace(_relNumExp,""),autoRound&&ev.indexOf("px")!==-1,!0);else if(clrs&&_colorExp.test(bv))str=ev.indexOf(")")+1,str=")"+(str?ev.substr(str):""),useHSL=ev.indexOf("hsl")!==-1&&_supportsOpacity,bv=_parseColor(bv,useHSL),ev=_parseColor(ev,useHSL),hasAlpha=bv.length+ev.length>6,hasAlpha&&!_supportsOpacity&&0===ev[3]?(pt["xs"+pt.l]+=pt.l?" transparent":"transparent",pt.e=pt.e.split(ea[i]).join("transparent")):(_supportsOpacity||(hasAlpha=!1),useHSL?pt.appendXtra(hasAlpha?"hsla(":"hsl(",bv[0],_parseChange(ev[0],bv[0]),",",!1,!0).appendXtra("",bv[1],_parseChange(ev[1],bv[1]),"%,",!1).appendXtra("",bv[2],_parseChange(ev[2],bv[2]),hasAlpha?"%,":"%"+str,!1):pt.appendXtra(hasAlpha?"rgba(":"rgb(",bv[0],ev[0]-bv[0],",",!0,!0).appendXtra("",bv[1],ev[1]-bv[1],",",!0).appendXtra("",bv[2],ev[2]-bv[2],hasAlpha?",":str,!0),hasAlpha&&(bv=bv.length<4?1:bv[3],pt.appendXtra("",bv,(ev.length<4?1:ev[3])-bv,str,!1))),_colorExp.lastIndex=0;else if(bnums=bv.match(_numExp)){if(enums=ev.match(_relNumExp),!enums||enums.length!==bnums.length)return pt;for(ni=0,xi=0;xi<bnums.length;xi++)cv=bnums[xi],temp=bv.indexOf(cv,ni),pt.appendXtra(bv.substr(ni,temp-ni),Number(cv),_parseChange(enums[xi],cv),"",autoRound&&"px"===bv.substr(temp+cv.length,2),0===xi),ni=temp+cv.length;pt["xs"+pt.l]+=bv.substr(ni)}else pt["xs"+pt.l]+=pt.l||pt["xs"+pt.l]?" "+ev:ev;if(e.indexOf("=")!==-1&&pt.data){for(str=pt.xs0+pt.data.s,i=1;i<pt.l;i++)str+=pt["xs"+i]+pt.data["xn"+i];pt.e=str+pt["xs"+i]}return pt.l||(pt.type=-1,pt.xs0=pt.e),pt.xfirst||pt},i=9;for(p=CSSPropTween.prototype,p.l=p.pr=0;--i>0;)p["xn"+i]=0,p["xs"+i]="";p.xs0="",p._next=p._prev=p.xfirst=p.data=p.plugin=p.setRatio=p.rxp=null,p.appendXtra=function(pfx,s,c,sfx,r,pad){var pt=this,l=pt.l;return pt["xs"+l]+=pad&&(l||pt["xs"+l])?" "+pfx:pfx||"",c||0===l||pt.plugin?(pt.l++,pt.type=pt.setRatio?2:1,pt["xs"+pt.l]=sfx||"",l>0?(pt.data["xn"+l]=s+c,pt.rxp["xn"+l]=r,pt["xn"+l]=s,pt.plugin||(pt.xfirst=new CSSPropTween(pt,"xn"+l,s,c,pt.xfirst||pt,0,pt.n,r,pt.pr),pt.xfirst.xs0=0),pt):(pt.data={s:s+c},pt.rxp={},pt.s=s,pt.c=c,pt.r=r,pt)):(pt["xs"+l]+=s+(sfx||""),pt)};var SpecialProp=function(p,options){options=options||{},this.p=options.prefix?_checkPropPrefix(p)||p:p,_specialProps[p]=_specialProps[this.p]=this,this.format=options.formatter||_getFormatter(options.defaultValue,options.color,options.collapsible,options.multi),options.parser&&(this.parse=options.parser),this.clrs=options.color,this.multi=options.multi,this.keyword=options.keyword,this.dflt=options.defaultValue,this.pr=options.priority||0},_registerComplexSpecialProp=_internals._registerComplexSpecialProp=function(p,options,defaults){"object"!=typeof options&&(options={parser:defaults});var i,temp,a=p.split(","),d=options.defaultValue;for(defaults=defaults||[d],i=0;i<a.length;i++)options.prefix=0===i&&options.prefix,options.defaultValue=defaults[i]||d,temp=new SpecialProp(a[i],options)},_registerPluginProp=_internals._registerPluginProp=function(p){if(!_specialProps[p]){var pluginName=p.charAt(0).toUpperCase()+p.substr(1)+"Plugin";_registerComplexSpecialProp(p,{parser:function(t,e,p,cssp,pt,plugin,vars){var pluginClass=_globals.com.greensock.plugins[pluginName];return pluginClass?(pluginClass._cssRegister(),_specialProps[p].parse(t,e,p,cssp,pt,plugin,vars)):(_log("Error: "+pluginName+" js file not loaded."),pt)}})}};p=SpecialProp.prototype,p.parseComplex=function(t,b,e,pt,plugin,setRatio){var i,ba,ea,l,bi,ei,kwd=this.keyword;if(this.multi&&(_commasOutsideParenExp.test(e)||_commasOutsideParenExp.test(b)?(ba=b.replace(_commasOutsideParenExp,"|").split("|"),ea=e.replace(_commasOutsideParenExp,"|").split("|")):kwd&&(ba=[b],ea=[e])),ea){for(l=ea.length>ba.length?ea.length:ba.length,i=0;i<l;i++)b=ba[i]=ba[i]||this.dflt,e=ea[i]=ea[i]||this.dflt,kwd&&(bi=b.indexOf(kwd),ei=e.indexOf(kwd),bi!==ei&&(ei===-1?ba[i]=ba[i].split(kwd).join(""):bi===-1&&(ba[i]+=" "+kwd)));b=ba.join(", "),e=ea.join(", ")}return _parseComplex(t,this.p,b,e,this.clrs,this.dflt,pt,this.pr,plugin,setRatio)},p.parse=function(t,e,p,cssp,pt,plugin,vars){return this.parseComplex(t.style,this.format(_getStyle(t,this.p,_cs,!1,this.dflt)),this.format(e),pt,plugin)},CSSPlugin.registerSpecialProp=function(name,onInitTween,priority){_registerComplexSpecialProp(name,{parser:function(t,e,p,cssp,pt,plugin,vars){var rv=new CSSPropTween(t,p,0,0,pt,2,p,(!1),priority);return rv.plugin=plugin,rv.setRatio=onInitTween(t,e,cssp._tween,p),rv},priority:priority})},CSSPlugin.useSVGTransformAttr=!0;var _useSVGTransformAttr,_transformProps="scaleX,scaleY,scaleZ,x,y,z,skewX,skewY,rotation,rotationX,rotationY,perspective,xPercent,yPercent".split(","),_transformProp=_checkPropPrefix("transform"),_transformPropCSS=_prefixCSS+"transform",_transformOriginProp=_checkPropPrefix("transformOrigin"),_supports3D=null!==_checkPropPrefix("perspective"),Transform=_internals.Transform=function(){this.perspective=parseFloat(CSSPlugin.defaultTransformPerspective)||0,this.force3D=!(CSSPlugin.defaultForce3D===!1||!_supports3D)&&(CSSPlugin.defaultForce3D||"auto")},_SVGElement=_gsScope.SVGElement,_createSVG=function(type,container,attributes){var p,element=_doc.createElementNS("http://www.w3.org/2000/svg",type),reg=/([a-z])([A-Z])/g;for(p in attributes)element.setAttributeNS(null,p.replace(reg,"$1-$2").toLowerCase(),attributes[p]);return container.appendChild(element),element},_docElement=_doc.documentElement||{},_forceSVGTransformAttr=function(){var svg,rect,width,force=_ieVers||/Android/i.test(_agent)&&!_gsScope.chrome;return _doc.createElementNS&&!force&&(svg=_createSVG("svg",_docElement),rect=_createSVG("rect",svg,{width:100,height:50,x:100}),width=rect.getBoundingClientRect().width,rect.style[_transformOriginProp]="50% 50%",rect.style[_transformProp]="scaleX(0.5)",force=width===rect.getBoundingClientRect().width&&!(_isFirefox&&_supports3D),_docElement.removeChild(svg)),force}(),_parseSVGOrigin=function(e,local,decoratee,absolute,smoothOrigin,skipRecord){var v,x,y,xOrigin,yOrigin,a,b,c,d,tx,ty,determinant,xOriginOld,yOriginOld,tm=e._gsTransform,m=_getMatrix(e,!0);tm&&(xOriginOld=tm.xOrigin,yOriginOld=tm.yOrigin),(!absolute||(v=absolute.split(" ")).length<2)&&(b=e.getBBox(),0===b.x&&0===b.y&&b.width+b.height===0&&(b={x:parseFloat(e.hasAttribute("x")?e.getAttribute("x"):e.hasAttribute("cx")?e.getAttribute("cx"):0)||0,y:parseFloat(e.hasAttribute("y")?e.getAttribute("y"):e.hasAttribute("cy")?e.getAttribute("cy"):0)||0,width:0,height:0}),local=_parsePosition(local).split(" "),v=[(local[0].indexOf("%")!==-1?parseFloat(local[0])/100*b.width:parseFloat(local[0]))+b.x,(local[1].indexOf("%")!==-1?parseFloat(local[1])/100*b.height:parseFloat(local[1]))+b.y]),decoratee.xOrigin=xOrigin=parseFloat(v[0]),decoratee.yOrigin=yOrigin=parseFloat(v[1]),absolute&&m!==_identity2DMatrix&&(a=m[0],b=m[1],c=m[2],d=m[3],tx=m[4],ty=m[5],determinant=a*d-b*c,determinant&&(x=xOrigin*(d/determinant)+yOrigin*(-c/determinant)+(c*ty-d*tx)/determinant,y=xOrigin*(-b/determinant)+yOrigin*(a/determinant)-(a*ty-b*tx)/determinant,xOrigin=decoratee.xOrigin=v[0]=x,yOrigin=decoratee.yOrigin=v[1]=y)),tm&&(skipRecord&&(decoratee.xOffset=tm.xOffset,decoratee.yOffset=tm.yOffset,tm=decoratee),smoothOrigin||smoothOrigin!==!1&&CSSPlugin.defaultSmoothOrigin!==!1?(x=xOrigin-xOriginOld,y=yOrigin-yOriginOld,tm.xOffset+=x*m[0]+y*m[2]-x,tm.yOffset+=x*m[1]+y*m[3]-y):tm.xOffset=tm.yOffset=0),skipRecord||e.setAttribute("data-svg-origin",v.join(" "))},_getBBoxHack=function(swapIfPossible){var bbox,svg=_createElement("svg",this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),oldParent=this.parentNode,oldSibling=this.nextSibling,oldCSS=this.style.cssText;if(_docElement.appendChild(svg),svg.appendChild(this),this.style.display="block",swapIfPossible)try{bbox=this.getBBox(),this._originalGetBBox=this.getBBox,this.getBBox=_getBBoxHack}catch(e){}else this._originalGetBBox&&(bbox=this._originalGetBBox());return oldSibling?oldParent.insertBefore(this,oldSibling):oldParent.appendChild(this),_docElement.removeChild(svg),this.style.cssText=oldCSS,bbox},_getBBox=function(e){try{return e.getBBox()}catch(error){return _getBBoxHack.call(e,!0)}},_isSVG=function(e){return!(!(_SVGElement&&e.getCTM&&_getBBox(e))||e.parentNode&&!e.ownerSVGElement)},_identity2DMatrix=[1,0,0,1,0,0],_getMatrix=function(e,force2D){var isDefault,s,m,n,dec,none,tm=e._gsTransform||new Transform,rnd=1e5,style=e.style;if(_transformProp?s=_getStyle(e,_transformPropCSS,null,!0):e.currentStyle&&(s=e.currentStyle.filter.match(_ieGetMatrixExp),s=s&&4===s.length?[s[0].substr(4),Number(s[2].substr(4)),Number(s[1].substr(4)),s[3].substr(4),tm.x||0,tm.y||0].join(","):""),isDefault=!s||"none"===s||"matrix(1, 0, 0, 1, 0, 0)"===s,isDefault&&_transformProp&&((none="none"===_getComputedStyle(e).display)||!e.parentNode)&&(none&&(n=style.display,style.display="block"),e.parentNode||(dec=1,_docElement.appendChild(e)),s=_getStyle(e,_transformPropCSS,null,!0),isDefault=!s||"none"===s||"matrix(1, 0, 0, 1, 0, 0)"===s,n?style.display=n:none&&_removeProp(style,"display"),dec&&_docElement.removeChild(e)),(tm.svg||e.getCTM&&_isSVG(e))&&(isDefault&&(style[_transformProp]+"").indexOf("matrix")!==-1&&(s=style[_transformProp],isDefault=0),m=e.getAttribute("transform"),isDefault&&m&&(m.indexOf("matrix")!==-1?(s=m,isDefault=0):m.indexOf("translate")!==-1&&(s="matrix(1,0,0,1,"+m.match(/(?:\-|\b)[\d\-\.e]+\b/gi).join(",")+")",isDefault=0))),isDefault)return _identity2DMatrix;for(m=(s||"").match(_numExp)||[],i=m.length;--i>-1;)n=Number(m[i]),m[i]=(dec=n-(n|=0))?(dec*rnd+(dec<0?-.5:.5)|0)/rnd+n:n;return force2D&&m.length>6?[m[0],m[1],m[4],m[5],m[12],m[13]]:m},_getTransform=_internals.getTransform=function(t,cs,rec,parse){if(t._gsTransform&&rec&&!parse)return t._gsTransform;var m,i,scaleX,scaleY,rotation,skewX,tm=rec?t._gsTransform||new Transform:new Transform,invX=tm.scaleX<0,min=2e-5,rnd=1e5,zOrigin=_supports3D?parseFloat(_getStyle(t,_transformOriginProp,cs,!1,"0 0 0").split(" ")[2])||tm.zOrigin||0:0,defaultTransformPerspective=parseFloat(CSSPlugin.defaultTransformPerspective)||0;if(tm.svg=!(!t.getCTM||!_isSVG(t)),tm.svg&&(_parseSVGOrigin(t,_getStyle(t,_transformOriginProp,cs,!1,"50% 50%")+"",tm,t.getAttribute("data-svg-origin")),_useSVGTransformAttr=CSSPlugin.useSVGTransformAttr||_forceSVGTransformAttr),m=_getMatrix(t),m!==_identity2DMatrix){if(16===m.length){var t1,t2,t3,cos,sin,a11=m[0],a21=m[1],a31=m[2],a41=m[3],a12=m[4],a22=m[5],a32=m[6],a42=m[7],a13=m[8],a23=m[9],a33=m[10],a14=m[12],a24=m[13],a34=m[14],a43=m[11],angle=Math.atan2(a32,a33);tm.zOrigin&&(a34=-tm.zOrigin,a14=a13*a34-m[12],a24=a23*a34-m[13],a34=a33*a34+tm.zOrigin-m[14]),tm.rotationX=angle*_RAD2DEG,angle&&(cos=Math.cos(-angle),sin=Math.sin(-angle),t1=a12*cos+a13*sin,t2=a22*cos+a23*sin,t3=a32*cos+a33*sin,a13=a12*-sin+a13*cos,a23=a22*-sin+a23*cos,a33=a32*-sin+a33*cos,a43=a42*-sin+a43*cos,a12=t1,a22=t2,a32=t3),angle=Math.atan2(-a31,a33),tm.rotationY=angle*_RAD2DEG,angle&&(cos=Math.cos(-angle),sin=Math.sin(-angle),t1=a11*cos-a13*sin,t2=a21*cos-a23*sin,t3=a31*cos-a33*sin,a23=a21*sin+a23*cos,a33=a31*sin+a33*cos,a43=a41*sin+a43*cos,a11=t1,a21=t2,a31=t3),angle=Math.atan2(a21,a11),tm.rotation=angle*_RAD2DEG,angle&&(cos=Math.cos(-angle),sin=Math.sin(-angle),a11=a11*cos+a12*sin,t2=a21*cos+a22*sin,a22=a21*-sin+a22*cos,a32=a31*-sin+a32*cos,a21=t2),tm.rotationX&&Math.abs(tm.rotationX)+Math.abs(tm.rotation)>359.9&&(tm.rotationX=tm.rotation=0,tm.rotationY=180-tm.rotationY),tm.scaleX=(Math.sqrt(a11*a11+a21*a21)*rnd+.5|0)/rnd,tm.scaleY=(Math.sqrt(a22*a22+a23*a23)*rnd+.5|0)/rnd,tm.scaleZ=(Math.sqrt(a32*a32+a33*a33)*rnd+.5|0)/rnd,tm.rotationX||tm.rotationY?tm.skewX=0:(tm.skewX=a12||a22?Math.atan2(a12,a22)*_RAD2DEG+tm.rotation:tm.skewX||0,Math.abs(tm.skewX)>90&&Math.abs(tm.skewX)<270&&(invX?(tm.scaleX*=-1,tm.skewX+=tm.rotation<=0?180:-180,tm.rotation+=tm.rotation<=0?180:-180):(tm.scaleY*=-1,tm.skewX+=tm.skewX<=0?180:-180))),tm.perspective=a43?1/(a43<0?-a43:a43):0,tm.x=a14,tm.y=a24,tm.z=a34,tm.svg&&(tm.x-=tm.xOrigin-(tm.xOrigin*a11-tm.yOrigin*a12),tm.y-=tm.yOrigin-(tm.yOrigin*a21-tm.xOrigin*a22))}else if(!_supports3D||parse||!m.length||tm.x!==m[4]||tm.y!==m[5]||!tm.rotationX&&!tm.rotationY){var k=m.length>=6,a=k?m[0]:1,b=m[1]||0,c=m[2]||0,d=k?m[3]:1;tm.x=m[4]||0,tm.y=m[5]||0,scaleX=Math.sqrt(a*a+b*b),scaleY=Math.sqrt(d*d+c*c),rotation=a||b?Math.atan2(b,a)*_RAD2DEG:tm.rotation||0,skewX=c||d?Math.atan2(c,d)*_RAD2DEG+rotation:tm.skewX||0,Math.abs(skewX)>90&&Math.abs(skewX)<270&&(invX?(scaleX*=-1,skewX+=rotation<=0?180:-180,rotation+=rotation<=0?180:-180):(scaleY*=-1,skewX+=skewX<=0?180:-180)),tm.scaleX=scaleX,tm.scaleY=scaleY,tm.rotation=rotation,tm.skewX=skewX,_supports3D&&(tm.rotationX=tm.rotationY=tm.z=0,tm.perspective=defaultTransformPerspective,tm.scaleZ=1),tm.svg&&(tm.x-=tm.xOrigin-(tm.xOrigin*a+tm.yOrigin*c),tm.y-=tm.yOrigin-(tm.xOrigin*b+tm.yOrigin*d))}tm.zOrigin=zOrigin;for(i in tm)tm[i]<min&&tm[i]>-min&&(tm[i]=0)}return rec&&(t._gsTransform=tm,tm.svg&&(_useSVGTransformAttr&&t.style[_transformProp]?TweenLite.delayedCall(.001,function(){_removeProp(t.style,_transformProp)}):!_useSVGTransformAttr&&t.getAttribute("transform")&&TweenLite.delayedCall(.001,function(){t.removeAttribute("transform")}))),tm},_setIETransformRatio=function(v){var filters,val,t=this.data,ang=-t.rotation*_DEG2RAD,skew=ang+t.skewX*_DEG2RAD,rnd=1e5,a=(Math.cos(ang)*t.scaleX*rnd|0)/rnd,b=(Math.sin(ang)*t.scaleX*rnd|0)/rnd,c=(Math.sin(skew)*-t.scaleY*rnd|0)/rnd,d=(Math.cos(skew)*t.scaleY*rnd|0)/rnd,style=this.t.style,cs=this.t.currentStyle;if(cs){val=b,b=-c,c=-val,filters=cs.filter,style.filter="";var dx,dy,w=this.t.offsetWidth,h=this.t.offsetHeight,clip="absolute"!==cs.position,m="progid:DXImageTransform.Microsoft.Matrix(M11="+a+", M12="+b+", M21="+c+", M22="+d,ox=t.x+w*t.xPercent/100,oy=t.y+h*t.yPercent/100;if(null!=t.ox&&(dx=(t.oxp?w*t.ox*.01:t.ox)-w/2,dy=(t.oyp?h*t.oy*.01:t.oy)-h/2,ox+=dx-(dx*a+dy*b),oy+=dy-(dx*c+dy*d)),clip?(dx=w/2,dy=h/2,m+=", Dx="+(dx-(dx*a+dy*b)+ox)+", Dy="+(dy-(dx*c+dy*d)+oy)+")"):m+=", sizingMethod='auto expand')",filters.indexOf("DXImageTransform.Microsoft.Matrix(")!==-1?style.filter=filters.replace(_ieSetMatrixExp,m):style.filter=m+" "+filters,0!==v&&1!==v||1===a&&0===b&&0===c&&1===d&&(clip&&m.indexOf("Dx=0, Dy=0")===-1||_opacityExp.test(filters)&&100!==parseFloat(RegExp.$1)||filters.indexOf(filters.indexOf("Alpha"))===-1&&style.removeAttribute("filter")),!clip){var marg,prop,dif,mult=_ieVers<8?1:-1;for(dx=t.ieOffsetX||0,dy=t.ieOffsetY||0,t.ieOffsetX=Math.round((w-((a<0?-a:a)*w+(b<0?-b:b)*h))/2+ox),t.ieOffsetY=Math.round((h-((d<0?-d:d)*h+(c<0?-c:c)*w))/2+oy),i=0;i<4;i++)prop=_margins[i],marg=cs[prop],val=marg.indexOf("px")!==-1?parseFloat(marg):_convertToPixels(this.t,prop,parseFloat(marg),marg.replace(_suffixExp,""))||0,dif=val!==t[prop]?i<2?-t.ieOffsetX:-t.ieOffsetY:i<2?dx-t.ieOffsetX:dy-t.ieOffsetY,style[prop]=(t[prop]=Math.round(val-dif*(0===i||2===i?1:mult)))+"px"}}},_setTransformRatio=_internals.set3DTransformRatio=_internals.setTransformRatio=function(v){var t1,a11,a12,a13,a21,a22,a23,a31,a32,a33,a41,a42,a43,zOrigin,min,cos,sin,t2,transform,comma,zero,skew,rnd,t=this.data,style=this.t.style,angle=t.rotation,rotationX=t.rotationX,rotationY=t.rotationY,sx=t.scaleX,sy=t.scaleY,sz=t.scaleZ,x=t.x,y=t.y,z=t.z,isSVG=t.svg,perspective=t.perspective,force3D=t.force3D,skewY=t.skewY,skewX=t.skewX;if(skewY&&(skewX+=skewY,angle+=skewY),((1===v||0===v)&&"auto"===force3D&&(this.tween._totalTime===this.tween._totalDuration||!this.tween._totalTime)||!force3D)&&!z&&!perspective&&!rotationY&&!rotationX&&1===sz||_useSVGTransformAttr&&isSVG||!_supports3D)return void(angle||skewX||isSVG?(angle*=_DEG2RAD,skew=skewX*_DEG2RAD,rnd=1e5,a11=Math.cos(angle)*sx,a21=Math.sin(angle)*sx,a12=Math.sin(angle-skew)*-sy,a22=Math.cos(angle-skew)*sy,skew&&"simple"===t.skewType&&(t1=Math.tan(skew-skewY*_DEG2RAD),t1=Math.sqrt(1+t1*t1),a12*=t1,a22*=t1,skewY&&(t1=Math.tan(skewY*_DEG2RAD),t1=Math.sqrt(1+t1*t1),a11*=t1,a21*=t1)),isSVG&&(x+=t.xOrigin-(t.xOrigin*a11+t.yOrigin*a12)+t.xOffset,y+=t.yOrigin-(t.xOrigin*a21+t.yOrigin*a22)+t.yOffset,_useSVGTransformAttr&&(t.xPercent||t.yPercent)&&(min=this.t.getBBox(),x+=.01*t.xPercent*min.width,y+=.01*t.yPercent*min.height),min=1e-6,x<min&&x>-min&&(x=0),y<min&&y>-min&&(y=0)),transform=(a11*rnd|0)/rnd+","+(a21*rnd|0)/rnd+","+(a12*rnd|0)/rnd+","+(a22*rnd|0)/rnd+","+x+","+y+")",isSVG&&_useSVGTransformAttr?this.t.setAttribute("transform","matrix("+transform):style[_transformProp]=(t.xPercent||t.yPercent?"translate("+t.xPercent+"%,"+t.yPercent+"%) matrix(":"matrix(")+transform):style[_transformProp]=(t.xPercent||t.yPercent?"translate("+t.xPercent+"%,"+t.yPercent+"%) matrix(":"matrix(")+sx+",0,0,"+sy+","+x+","+y+")");if(_isFirefox&&(min=1e-4,sx<min&&sx>-min&&(sx=sz=2e-5),sy<min&&sy>-min&&(sy=sz=2e-5),!perspective||t.z||t.rotationX||t.rotationY||(perspective=0)),angle||skewX)angle*=_DEG2RAD,cos=a11=Math.cos(angle),sin=a21=Math.sin(angle),skewX&&(angle-=skewX*_DEG2RAD,cos=Math.cos(angle),sin=Math.sin(angle),"simple"===t.skewType&&(t1=Math.tan((skewX-skewY)*_DEG2RAD),t1=Math.sqrt(1+t1*t1),cos*=t1,sin*=t1,t.skewY&&(t1=Math.tan(skewY*_DEG2RAD),t1=Math.sqrt(1+t1*t1),a11*=t1,a21*=t1))),a12=-sin,a22=cos;else{if(!(rotationY||rotationX||1!==sz||perspective||isSVG))return void(style[_transformProp]=(t.xPercent||t.yPercent?"translate("+t.xPercent+"%,"+t.yPercent+"%) translate3d(":"translate3d(")+x+"px,"+y+"px,"+z+"px)"+(1!==sx||1!==sy?" scale("+sx+","+sy+")":""));a11=a22=1,a12=a21=0}a33=1,a13=a23=a31=a32=a41=a42=0,a43=perspective?-1/perspective:0,zOrigin=t.zOrigin,min=1e-6,comma=",",zero="0",angle=rotationY*_DEG2RAD,angle&&(cos=Math.cos(angle),sin=Math.sin(angle),a31=-sin,a41=a43*-sin,a13=a11*sin,a23=a21*sin,a33=cos,a43*=cos,a11*=cos,a21*=cos),angle=rotationX*_DEG2RAD,angle&&(cos=Math.cos(angle),sin=Math.sin(angle),t1=a12*cos+a13*sin,t2=a22*cos+a23*sin,a32=a33*sin,a42=a43*sin,a13=a12*-sin+a13*cos,a23=a22*-sin+a23*cos,a33*=cos,a43*=cos,a12=t1,a22=t2),1!==sz&&(a13*=sz,a23*=sz,a33*=sz,a43*=sz),1!==sy&&(a12*=sy,a22*=sy,a32*=sy,a42*=sy),1!==sx&&(a11*=sx,a21*=sx,a31*=sx,a41*=sx),(zOrigin||isSVG)&&(zOrigin&&(x+=a13*-zOrigin,y+=a23*-zOrigin,z+=a33*-zOrigin+zOrigin),isSVG&&(x+=t.xOrigin-(t.xOrigin*a11+t.yOrigin*a12)+t.xOffset,y+=t.yOrigin-(t.xOrigin*a21+t.yOrigin*a22)+t.yOffset),x<min&&x>-min&&(x=zero),y<min&&y>-min&&(y=zero),z<min&&z>-min&&(z=0)),transform=t.xPercent||t.yPercent?"translate("+t.xPercent+"%,"+t.yPercent+"%) matrix3d(":"matrix3d(",transform+=(a11<min&&a11>-min?zero:a11)+comma+(a21<min&&a21>-min?zero:a21)+comma+(a31<min&&a31>-min?zero:a31),transform+=comma+(a41<min&&a41>-min?zero:a41)+comma+(a12<min&&a12>-min?zero:a12)+comma+(a22<min&&a22>-min?zero:a22),rotationX||rotationY||1!==sz?(transform+=comma+(a32<min&&a32>-min?zero:a32)+comma+(a42<min&&a42>-min?zero:a42)+comma+(a13<min&&a13>-min?zero:a13),transform+=comma+(a23<min&&a23>-min?zero:a23)+comma+(a33<min&&a33>-min?zero:a33)+comma+(a43<min&&a43>-min?zero:a43)+comma):transform+=",0,0,0,0,1,0,",transform+=x+comma+y+comma+z+comma+(perspective?1+-z/perspective:1)+")",style[_transformProp]=transform};p=Transform.prototype,p.x=p.y=p.z=p.skewX=p.skewY=p.rotation=p.rotationX=p.rotationY=p.zOrigin=p.xPercent=p.yPercent=p.xOffset=p.yOffset=0,p.scaleX=p.scaleY=p.scaleZ=1,_registerComplexSpecialProp("transform,scale,scaleX,scaleY,scaleZ,x,y,z,rotation,rotationX,rotationY,rotationZ,skewX,skewY,shortRotation,shortRotationX,shortRotationY,shortRotationZ,transformOrigin,svgOrigin,transformPerspective,directionalRotation,parseTransform,force3D,skewType,xPercent,yPercent,smoothOrigin",{parser:function(t,e,parsingProp,cssp,pt,plugin,vars){if(cssp._lastParsedTransform===vars)return pt;cssp._lastParsedTransform=vars;var swapFunc,scaleFunc=vars.scale&&"function"==typeof vars.scale?vars.scale:0;"function"==typeof vars[parsingProp]&&(swapFunc=vars[parsingProp],vars[parsingProp]=e),scaleFunc&&(vars.scale=scaleFunc(_index,t));var m2,copy,has3D,hasChange,dr,x,y,matrix,p,originalGSTransform=t._gsTransform,style=t.style,min=1e-6,i=_transformProps.length,v=vars,endRotations={},transformOriginString="transformOrigin",m1=_getTransform(t,_cs,!0,v.parseTransform),orig=v.transform&&("function"==typeof v.transform?v.transform(_index,_target):v.transform);if(cssp._transform=m1,orig&&"string"==typeof orig&&_transformProp)copy=_tempDiv.style,copy[_transformProp]=orig,copy.display="block",copy.position="absolute",_doc.body.appendChild(_tempDiv),m2=_getTransform(_tempDiv,null,!1),m1.svg&&(x=m1.xOrigin,y=m1.yOrigin,m2.x-=m1.xOffset,m2.y-=m1.yOffset,(v.transformOrigin||v.svgOrigin)&&(orig={},_parseSVGOrigin(t,_parsePosition(v.transformOrigin),orig,v.svgOrigin,v.smoothOrigin,!0),x=orig.xOrigin,y=orig.yOrigin,m2.x-=orig.xOffset-m1.xOffset,m2.y-=orig.yOffset-m1.yOffset),(x||y)&&(matrix=_getMatrix(_tempDiv,!0),m2.x-=x-(x*matrix[0]+y*matrix[2]),m2.y-=y-(x*matrix[1]+y*matrix[3]))),_doc.body.removeChild(_tempDiv),m2.perspective||(m2.perspective=m1.perspective),null!=v.xPercent&&(m2.xPercent=_parseVal(v.xPercent,m1.xPercent)),null!=v.yPercent&&(m2.yPercent=_parseVal(v.yPercent,m1.yPercent));else if("object"==typeof v){if(m2={scaleX:_parseVal(null!=v.scaleX?v.scaleX:v.scale,m1.scaleX),scaleY:_parseVal(null!=v.scaleY?v.scaleY:v.scale,m1.scaleY),scaleZ:_parseVal(v.scaleZ,m1.scaleZ),x:_parseVal(v.x,m1.x),y:_parseVal(v.y,m1.y),z:_parseVal(v.z,m1.z),xPercent:_parseVal(v.xPercent,m1.xPercent),yPercent:_parseVal(v.yPercent,m1.yPercent),perspective:_parseVal(v.transformPerspective,m1.perspective)},dr=v.directionalRotation,null!=dr)if("object"==typeof dr)for(copy in dr)v[copy]=dr[copy];else v.rotation=dr;"string"==typeof v.x&&v.x.indexOf("%")!==-1&&(m2.x=0,m2.xPercent=_parseVal(v.x,m1.xPercent)),"string"==typeof v.y&&v.y.indexOf("%")!==-1&&(m2.y=0,m2.yPercent=_parseVal(v.y,m1.yPercent)),m2.rotation=_parseAngle("rotation"in v?v.rotation:"shortRotation"in v?v.shortRotation+"_short":"rotationZ"in v?v.rotationZ:m1.rotation,m1.rotation,"rotation",endRotations),_supports3D&&(m2.rotationX=_parseAngle("rotationX"in v?v.rotationX:"shortRotationX"in v?v.shortRotationX+"_short":m1.rotationX||0,m1.rotationX,"rotationX",endRotations),m2.rotationY=_parseAngle("rotationY"in v?v.rotationY:"shortRotationY"in v?v.shortRotationY+"_short":m1.rotationY||0,m1.rotationY,"rotationY",endRotations)),m2.skewX=_parseAngle(v.skewX,m1.skewX),m2.skewY=_parseAngle(v.skewY,m1.skewY)}for(_supports3D&&null!=v.force3D&&(m1.force3D=v.force3D,hasChange=!0),m1.skewType=v.skewType||m1.skewType||CSSPlugin.defaultSkewType,has3D=m1.force3D||m1.z||m1.rotationX||m1.rotationY||m2.z||m2.rotationX||m2.rotationY||m2.perspective,has3D||null==v.scale||(m2.scaleZ=1);--i>-1;)p=_transformProps[i],orig=m2[p]-m1[p],(orig>min||orig<-min||null!=v[p]||null!=_forcePT[p])&&(hasChange=!0,pt=new CSSPropTween(m1,p,m1[p],orig,pt),p in endRotations&&(pt.e=endRotations[p]),pt.xs0=0,pt.plugin=plugin,cssp._overwriteProps.push(pt.n));return orig=v.transformOrigin,m1.svg&&(orig||v.svgOrigin)&&(x=m1.xOffset,y=m1.yOffset,_parseSVGOrigin(t,_parsePosition(orig),m2,v.svgOrigin,v.smoothOrigin),pt=_addNonTweeningNumericPT(m1,"xOrigin",(originalGSTransform?m1:m2).xOrigin,m2.xOrigin,pt,transformOriginString),pt=_addNonTweeningNumericPT(m1,"yOrigin",(originalGSTransform?m1:m2).yOrigin,m2.yOrigin,pt,transformOriginString),x===m1.xOffset&&y===m1.yOffset||(pt=_addNonTweeningNumericPT(m1,"xOffset",originalGSTransform?x:m1.xOffset,m1.xOffset,pt,transformOriginString),pt=_addNonTweeningNumericPT(m1,"yOffset",originalGSTransform?y:m1.yOffset,m1.yOffset,pt,transformOriginString)),orig="0px 0px"),(orig||_supports3D&&has3D&&m1.zOrigin)&&(_transformProp?(hasChange=!0,p=_transformOriginProp,orig=(orig||_getStyle(t,p,_cs,!1,"50% 50%"))+"",pt=new CSSPropTween(style,p,0,0,pt,(-1),transformOriginString),pt.b=style[p],pt.plugin=plugin,_supports3D?(copy=m1.zOrigin,orig=orig.split(" "),m1.zOrigin=(orig.length>2&&(0===copy||"0px"!==orig[2])?parseFloat(orig[2]):copy)||0,pt.xs0=pt.e=orig[0]+" "+(orig[1]||"50%")+" 0px",pt=new CSSPropTween(m1,"zOrigin",0,0,pt,(-1),pt.n),pt.b=copy,pt.xs0=pt.e=m1.zOrigin):pt.xs0=pt.e=orig):_parsePosition(orig+"",m1)),hasChange&&(cssp._transformType=m1.svg&&_useSVGTransformAttr||!has3D&&3!==this._transformType?2:3),swapFunc&&(vars[parsingProp]=swapFunc),scaleFunc&&(vars.scale=scaleFunc),pt},prefix:!0}),_registerComplexSpecialProp("boxShadow",{defaultValue:"0px 0px 0px 0px #999",prefix:!0,color:!0,multi:!0,keyword:"inset"}),_registerComplexSpecialProp("borderRadius",{defaultValue:"0px",parser:function(t,e,p,cssp,pt,plugin){e=this.format(e);var ea1,i,es2,bs2,bs,es,bn,en,w,h,esfx,bsfx,rel,hn,vn,em,props=["borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius"],style=t.style;for(w=parseFloat(t.offsetWidth),h=parseFloat(t.offsetHeight),ea1=e.split(" "),i=0;i<props.length;i++)this.p.indexOf("border")&&(props[i]=_checkPropPrefix(props[i])),bs=bs2=_getStyle(t,props[i],_cs,!1,"0px"),bs.indexOf(" ")!==-1&&(bs2=bs.split(" "),bs=bs2[0],bs2=bs2[1]),es=es2=ea1[i],bn=parseFloat(bs),bsfx=bs.substr((bn+"").length),rel="="===es.charAt(1),rel?(en=parseInt(es.charAt(0)+"1",10),es=es.substr(2),en*=parseFloat(es),esfx=es.substr((en+"").length-(en<0?1:0))||""):(en=parseFloat(es),esfx=es.substr((en+"").length)),""===esfx&&(esfx=_suffixMap[p]||bsfx),esfx!==bsfx&&(hn=_convertToPixels(t,"borderLeft",bn,bsfx),vn=_convertToPixels(t,"borderTop",bn,bsfx),"%"===esfx?(bs=hn/w*100+"%",bs2=vn/h*100+"%"):"em"===esfx?(em=_convertToPixels(t,"borderLeft",1,"em"),bs=hn/em+"em",bs2=vn/em+"em"):(bs=hn+"px",bs2=vn+"px"),rel&&(es=parseFloat(bs)+en+esfx,es2=parseFloat(bs2)+en+esfx)),pt=_parseComplex(style,props[i],bs+" "+bs2,es+" "+es2,!1,"0px",pt);return pt},prefix:!0,formatter:_getFormatter("0px 0px 0px 0px",!1,!0)}),_registerComplexSpecialProp("borderBottomLeftRadius,borderBottomRightRadius,borderTopLeftRadius,borderTopRightRadius",{defaultValue:"0px",parser:function(t,e,p,cssp,pt,plugin){return _parseComplex(t.style,p,this.format(_getStyle(t,p,_cs,!1,"0px 0px")),this.format(e),!1,"0px",pt)},prefix:!0,formatter:_getFormatter("0px 0px",!1,!0)}),_registerComplexSpecialProp("backgroundPosition",{defaultValue:"0 0",parser:function(t,e,p,cssp,pt,plugin){var ba,ea,i,pct,overlap,src,bp="background-position",cs=_cs||_getComputedStyle(t,null),bs=this.format((cs?_ieVers?cs.getPropertyValue(bp+"-x")+" "+cs.getPropertyValue(bp+"-y"):cs.getPropertyValue(bp):t.currentStyle.backgroundPositionX+" "+t.currentStyle.backgroundPositionY)||"0 0"),es=this.format(e);if(bs.indexOf("%")!==-1!=(es.indexOf("%")!==-1)&&es.split(",").length<2&&(src=_getStyle(t,"backgroundImage").replace(_urlExp,""),src&&"none"!==src)){for(ba=bs.split(" "),ea=es.split(" "),_tempImg.setAttribute("src",src),i=2;--i>-1;)bs=ba[i],pct=bs.indexOf("%")!==-1,pct!==(ea[i].indexOf("%")!==-1)&&(overlap=0===i?t.offsetWidth-_tempImg.width:t.offsetHeight-_tempImg.height,ba[i]=pct?parseFloat(bs)/100*overlap+"px":parseFloat(bs)/overlap*100+"%");bs=ba.join(" ")}return this.parseComplex(t.style,bs,es,pt,plugin)},formatter:_parsePosition}),_registerComplexSpecialProp("backgroundSize",{defaultValue:"0 0",formatter:function(v){return v+="",_parsePosition(v.indexOf(" ")===-1?v+" "+v:v)}}),_registerComplexSpecialProp("perspective",{defaultValue:"0px",prefix:!0}),_registerComplexSpecialProp("perspectiveOrigin",{defaultValue:"50% 50%",prefix:!0}),_registerComplexSpecialProp("transformStyle",{prefix:!0}),_registerComplexSpecialProp("backfaceVisibility",{prefix:!0}),_registerComplexSpecialProp("userSelect",{prefix:!0}),_registerComplexSpecialProp("margin",{parser:_getEdgeParser("marginTop,marginRight,marginBottom,marginLeft")}),_registerComplexSpecialProp("padding",{parser:_getEdgeParser("paddingTop,paddingRight,paddingBottom,paddingLeft")}),_registerComplexSpecialProp("clip",{defaultValue:"rect(0px,0px,0px,0px)",parser:function(t,e,p,cssp,pt,plugin){var b,cs,delim;return _ieVers<9?(cs=t.currentStyle,delim=_ieVers<8?" ":",",b="rect("+cs.clipTop+delim+cs.clipRight+delim+cs.clipBottom+delim+cs.clipLeft+")",e=this.format(e).split(",").join(delim)):(b=this.format(_getStyle(t,this.p,_cs,!1,this.dflt)),e=this.format(e)),this.parseComplex(t.style,b,e,pt,plugin)}}),_registerComplexSpecialProp("textShadow",{defaultValue:"0px 0px 0px #999",color:!0,multi:!0}),_registerComplexSpecialProp("autoRound,strictUnits",{parser:function(t,e,p,cssp,pt){return pt}}),_registerComplexSpecialProp("border",{defaultValue:"0px solid #000",parser:function(t,e,p,cssp,pt,plugin){var bw=_getStyle(t,"borderTopWidth",_cs,!1,"0px"),end=this.format(e).split(" "),esfx=end[0].replace(_suffixExp,"");return"px"!==esfx&&(bw=parseFloat(bw)/_convertToPixels(t,"borderTopWidth",1,esfx)+esfx),this.parseComplex(t.style,this.format(bw+" "+_getStyle(t,"borderTopStyle",_cs,!1,"solid")+" "+_getStyle(t,"borderTopColor",_cs,!1,"#000")),end.join(" "),pt,plugin);
},color:!0,formatter:function(v){var a=v.split(" ");return a[0]+" "+(a[1]||"solid")+" "+(v.match(_colorExp)||["#000"])[0]}}),_registerComplexSpecialProp("borderWidth",{parser:_getEdgeParser("borderTopWidth,borderRightWidth,borderBottomWidth,borderLeftWidth")}),_registerComplexSpecialProp("float,cssFloat,styleFloat",{parser:function(t,e,p,cssp,pt,plugin){var s=t.style,prop="cssFloat"in s?"cssFloat":"styleFloat";return new CSSPropTween(s,prop,0,0,pt,(-1),p,(!1),0,s[prop],e)}});var _setIEOpacityRatio=function(v){var skip,t=this.t,filters=t.filter||_getStyle(this.data,"filter")||"",val=this.s+this.c*v|0;100===val&&(filters.indexOf("atrix(")===-1&&filters.indexOf("radient(")===-1&&filters.indexOf("oader(")===-1?(t.removeAttribute("filter"),skip=!_getStyle(this.data,"filter")):(t.filter=filters.replace(_alphaFilterExp,""),skip=!0)),skip||(this.xn1&&(t.filter=filters=filters||"alpha(opacity="+val+")"),filters.indexOf("pacity")===-1?0===val&&this.xn1||(t.filter=filters+" alpha(opacity="+val+")"):t.filter=filters.replace(_opacityExp,"opacity="+val))};_registerComplexSpecialProp("opacity,alpha,autoAlpha",{defaultValue:"1",parser:function(t,e,p,cssp,pt,plugin){var b=parseFloat(_getStyle(t,"opacity",_cs,!1,"1")),style=t.style,isAutoAlpha="autoAlpha"===p;return"string"==typeof e&&"="===e.charAt(1)&&(e=("-"===e.charAt(0)?-1:1)*parseFloat(e.substr(2))+b),isAutoAlpha&&1===b&&"hidden"===_getStyle(t,"visibility",_cs)&&0!==e&&(b=0),_supportsOpacity?pt=new CSSPropTween(style,"opacity",b,e-b,pt):(pt=new CSSPropTween(style,"opacity",100*b,100*(e-b),pt),pt.xn1=isAutoAlpha?1:0,style.zoom=1,pt.type=2,pt.b="alpha(opacity="+pt.s+")",pt.e="alpha(opacity="+(pt.s+pt.c)+")",pt.data=t,pt.plugin=plugin,pt.setRatio=_setIEOpacityRatio),isAutoAlpha&&(pt=new CSSPropTween(style,"visibility",0,0,pt,(-1),null,(!1),0,0!==b?"inherit":"hidden",0===e?"hidden":"inherit"),pt.xs0="inherit",cssp._overwriteProps.push(pt.n),cssp._overwriteProps.push(p)),pt}});var _removeProp=function(s,p){p&&(s.removeProperty?("ms"!==p.substr(0,2)&&"webkit"!==p.substr(0,6)||(p="-"+p),s.removeProperty(p.replace(_capsExp,"-$1").toLowerCase())):s.removeAttribute(p))},_setClassNameRatio=function(v){if(this.t._gsClassPT=this,1===v||0===v){this.t.setAttribute("class",0===v?this.b:this.e);for(var mpt=this.data,s=this.t.style;mpt;)mpt.v?s[mpt.p]=mpt.v:_removeProp(s,mpt.p),mpt=mpt._next;1===v&&this.t._gsClassPT===this&&(this.t._gsClassPT=null)}else this.t.getAttribute("class")!==this.e&&this.t.setAttribute("class",this.e)};_registerComplexSpecialProp("className",{parser:function(t,e,p,cssp,pt,plugin,vars){var difData,bs,cnpt,cnptLookup,mpt,b=t.getAttribute("class")||"",cssText=t.style.cssText;if(pt=cssp._classNamePT=new CSSPropTween(t,p,0,0,pt,2),pt.setRatio=_setClassNameRatio,pt.pr=-11,_hasPriority=!0,pt.b=b,bs=_getAllStyles(t,_cs),cnpt=t._gsClassPT){for(cnptLookup={},mpt=cnpt.data;mpt;)cnptLookup[mpt.p]=1,mpt=mpt._next;cnpt.setRatio(1)}return t._gsClassPT=pt,pt.e="="!==e.charAt(1)?e:b.replace(new RegExp("(?:\\s|^)"+e.substr(2)+"(?![\\w-])"),"")+("+"===e.charAt(0)?" "+e.substr(2):""),t.setAttribute("class",pt.e),difData=_cssDif(t,bs,_getAllStyles(t),vars,cnptLookup),t.setAttribute("class",b),pt.data=difData.firstMPT,t.style.cssText=cssText,pt=pt.xfirst=cssp.parse(t,difData.difs,pt,plugin)}});var _setClearPropsRatio=function(v){if((1===v||0===v)&&this.data._totalTime===this.data._totalDuration&&"isFromStart"!==this.data.data){var a,p,i,clearTransform,transform,s=this.t.style,transformParse=_specialProps.transform.parse;if("all"===this.e)s.cssText="",clearTransform=!0;else for(a=this.e.split(" ").join("").split(","),i=a.length;--i>-1;)p=a[i],_specialProps[p]&&(_specialProps[p].parse===transformParse?clearTransform=!0:p="transformOrigin"===p?_transformOriginProp:_specialProps[p].p),_removeProp(s,p);clearTransform&&(_removeProp(s,_transformProp),transform=this.t._gsTransform,transform&&(transform.svg&&(this.t.removeAttribute("data-svg-origin"),this.t.removeAttribute("transform")),delete this.t._gsTransform))}};for(_registerComplexSpecialProp("clearProps",{parser:function(t,e,p,cssp,pt){return pt=new CSSPropTween(t,p,0,0,pt,2),pt.setRatio=_setClearPropsRatio,pt.e=e,pt.pr=-10,pt.data=cssp._tween,_hasPriority=!0,pt}}),p="bezier,throwProps,physicsProps,physics2D".split(","),i=p.length;i--;)_registerPluginProp(p[i]);p=CSSPlugin.prototype,p._firstPT=p._lastParsedTransform=p._transform=null,p._onInitTween=function(target,vars,tween,index){if(!target.nodeType)return!1;this._target=_target=target,this._tween=tween,this._vars=vars,_index=index,_autoRound=vars.autoRound,_hasPriority=!1,_suffixMap=vars.suffixMap||CSSPlugin.suffixMap,_cs=_getComputedStyle(target,""),_overwriteProps=this._overwriteProps;var v,pt,pt2,first,last,next,zIndex,tpt,threeD,style=target.style;if(_reqSafariFix&&""===style.zIndex&&(v=_getStyle(target,"zIndex",_cs),"auto"!==v&&""!==v||this._addLazySet(style,"zIndex",0)),"string"==typeof vars&&(first=style.cssText,v=_getAllStyles(target,_cs),style.cssText=first+";"+vars,v=_cssDif(target,v,_getAllStyles(target)).difs,!_supportsOpacity&&_opacityValExp.test(vars)&&(v.opacity=parseFloat(RegExp.$1)),vars=v,style.cssText=first),vars.className?this._firstPT=pt=_specialProps.className.parse(target,vars.className,"className",this,null,null,vars):this._firstPT=pt=this.parse(target,vars,null),this._transformType){for(threeD=3===this._transformType,_transformProp?_isSafari&&(_reqSafariFix=!0,""===style.zIndex&&(zIndex=_getStyle(target,"zIndex",_cs),"auto"!==zIndex&&""!==zIndex||this._addLazySet(style,"zIndex",0)),_isSafariLT6&&this._addLazySet(style,"WebkitBackfaceVisibility",this._vars.WebkitBackfaceVisibility||(threeD?"visible":"hidden"))):style.zoom=1,pt2=pt;pt2&&pt2._next;)pt2=pt2._next;tpt=new CSSPropTween(target,"transform",0,0,null,2),this._linkCSSP(tpt,null,pt2),tpt.setRatio=_transformProp?_setTransformRatio:_setIETransformRatio,tpt.data=this._transform||_getTransform(target,_cs,!0),tpt.tween=tween,tpt.pr=-1,_overwriteProps.pop()}if(_hasPriority){for(;pt;){for(next=pt._next,pt2=first;pt2&&pt2.pr>pt.pr;)pt2=pt2._next;(pt._prev=pt2?pt2._prev:last)?pt._prev._next=pt:first=pt,(pt._next=pt2)?pt2._prev=pt:last=pt,pt=next}this._firstPT=first}return!0},p.parse=function(target,vars,pt,plugin){var p,sp,bn,en,bs,es,bsfx,esfx,isStr,rel,style=target.style;for(p in vars)es=vars[p],"function"==typeof es&&(es=es(_index,_target)),sp=_specialProps[p],sp?pt=sp.parse(target,es,p,this,pt,plugin,vars):(bs=_getStyle(target,p,_cs)+"",isStr="string"==typeof es,"color"===p||"fill"===p||"stroke"===p||p.indexOf("Color")!==-1||isStr&&_rgbhslExp.test(es)?(isStr||(es=_parseColor(es),es=(es.length>3?"rgba(":"rgb(")+es.join(",")+")"),pt=_parseComplex(style,p,bs,es,!0,"transparent",pt,0,plugin)):isStr&&_complexExp.test(es)?pt=_parseComplex(style,p,bs,es,!0,null,pt,0,plugin):(bn=parseFloat(bs),bsfx=bn||0===bn?bs.substr((bn+"").length):"",""!==bs&&"auto"!==bs||("width"===p||"height"===p?(bn=_getDimension(target,p,_cs),bsfx="px"):"left"===p||"top"===p?(bn=_calculateOffset(target,p,_cs),bsfx="px"):(bn="opacity"!==p?0:1,bsfx="")),rel=isStr&&"="===es.charAt(1),rel?(en=parseInt(es.charAt(0)+"1",10),es=es.substr(2),en*=parseFloat(es),esfx=es.replace(_suffixExp,"")):(en=parseFloat(es),esfx=isStr?es.replace(_suffixExp,""):""),""===esfx&&(esfx=p in _suffixMap?_suffixMap[p]:bsfx),es=en||0===en?(rel?en+bn:en)+esfx:vars[p],bsfx!==esfx&&""!==esfx&&(en||0===en)&&bn&&(bn=_convertToPixels(target,p,bn,bsfx),"%"===esfx?(bn/=_convertToPixels(target,p,100,"%")/100,vars.strictUnits!==!0&&(bs=bn+"%")):"em"===esfx||"rem"===esfx||"vw"===esfx||"vh"===esfx?bn/=_convertToPixels(target,p,1,esfx):"px"!==esfx&&(en=_convertToPixels(target,p,en,esfx),esfx="px"),rel&&(en||0===en)&&(es=en+bn+esfx)),rel&&(en+=bn),!bn&&0!==bn||!en&&0!==en?void 0!==style[p]&&(es||es+""!="NaN"&&null!=es)?(pt=new CSSPropTween(style,p,en||bn||0,0,pt,(-1),p,(!1),0,bs,es),pt.xs0="none"!==es||"display"!==p&&p.indexOf("Style")===-1?es:bs):_log("invalid "+p+" tween value: "+vars[p]):(pt=new CSSPropTween(style,p,bn,en-bn,pt,0,p,_autoRound!==!1&&("px"===esfx||"zIndex"===p),0,bs,es),pt.xs0=esfx))),plugin&&pt&&!pt.plugin&&(pt.plugin=plugin);return pt},p.setRatio=function(v){var val,str,i,pt=this._firstPT,min=1e-6;if(1!==v||this._tween._time!==this._tween._duration&&0!==this._tween._time)if(v||this._tween._time!==this._tween._duration&&0!==this._tween._time||this._tween._rawPrevTime===-1e-6)for(;pt;){if(val=pt.c*v+pt.s,pt.r?val=Math.round(val):val<min&&val>-min&&(val=0),pt.type)if(1===pt.type)if(i=pt.l,2===i)pt.t[pt.p]=pt.xs0+val+pt.xs1+pt.xn1+pt.xs2;else if(3===i)pt.t[pt.p]=pt.xs0+val+pt.xs1+pt.xn1+pt.xs2+pt.xn2+pt.xs3;else if(4===i)pt.t[pt.p]=pt.xs0+val+pt.xs1+pt.xn1+pt.xs2+pt.xn2+pt.xs3+pt.xn3+pt.xs4;else if(5===i)pt.t[pt.p]=pt.xs0+val+pt.xs1+pt.xn1+pt.xs2+pt.xn2+pt.xs3+pt.xn3+pt.xs4+pt.xn4+pt.xs5;else{for(str=pt.xs0+val+pt.xs1,i=1;i<pt.l;i++)str+=pt["xn"+i]+pt["xs"+(i+1)];pt.t[pt.p]=str}else pt.type===-1?pt.t[pt.p]=pt.xs0:pt.setRatio&&pt.setRatio(v);else pt.t[pt.p]=val+pt.xs0;pt=pt._next}else for(;pt;)2!==pt.type?pt.t[pt.p]=pt.b:pt.setRatio(v),pt=pt._next;else for(;pt;){if(2!==pt.type)if(pt.r&&pt.type!==-1)if(val=Math.round(pt.s+pt.c),pt.type){if(1===pt.type){for(i=pt.l,str=pt.xs0+val+pt.xs1,i=1;i<pt.l;i++)str+=pt["xn"+i]+pt["xs"+(i+1)];pt.t[pt.p]=str}}else pt.t[pt.p]=val+pt.xs0;else pt.t[pt.p]=pt.e;else pt.setRatio(v);pt=pt._next}},p._enableTransforms=function(threeD){this._transform=this._transform||_getTransform(this._target,_cs,!0),this._transformType=this._transform.svg&&_useSVGTransformAttr||!threeD&&3!==this._transformType?2:3};var lazySet=function(v){this.t[this.p]=this.e,this.data._linkCSSP(this,this._next,null,!0)};p._addLazySet=function(t,p,v){var pt=this._firstPT=new CSSPropTween(t,p,0,0,this._firstPT,2);pt.e=v,pt.setRatio=lazySet,pt.data=this},p._linkCSSP=function(pt,next,prev,remove){return pt&&(next&&(next._prev=pt),pt._next&&(pt._next._prev=pt._prev),pt._prev?pt._prev._next=pt._next:this._firstPT===pt&&(this._firstPT=pt._next,remove=!0),prev?prev._next=pt:remove||null!==this._firstPT||(this._firstPT=pt),pt._next=next,pt._prev=prev),pt},p._mod=function(lookup){for(var pt=this._firstPT;pt;)"function"==typeof lookup[pt.p]&&lookup[pt.p]===Math.round&&(pt.r=1),pt=pt._next},p._kill=function(lookup){var pt,p,xfirst,copy=lookup;if(lookup.autoAlpha||lookup.alpha){copy={};for(p in lookup)copy[p]=lookup[p];copy.opacity=1,copy.autoAlpha&&(copy.visibility=1)}for(lookup.className&&(pt=this._classNamePT)&&(xfirst=pt.xfirst,xfirst&&xfirst._prev?this._linkCSSP(xfirst._prev,pt._next,xfirst._prev._prev):xfirst===this._firstPT&&(this._firstPT=pt._next),pt._next&&this._linkCSSP(pt._next,pt._next._next,xfirst._prev),this._classNamePT=null),pt=this._firstPT;pt;)pt.plugin&&pt.plugin!==p&&pt.plugin._kill&&(pt.plugin._kill(lookup),p=pt.plugin),pt=pt._next;return TweenPlugin.prototype._kill.call(this,copy)};var _getChildStyles=function(e,props,targets){var children,i,child,type;if(e.slice)for(i=e.length;--i>-1;)_getChildStyles(e[i],props,targets);else for(children=e.childNodes,i=children.length;--i>-1;)child=children[i],type=child.type,child.style&&(props.push(_getAllStyles(child)),targets&&targets.push(child)),1!==type&&9!==type&&11!==type||!child.childNodes.length||_getChildStyles(child,props,targets)};return CSSPlugin.cascadeTo=function(target,duration,vars){var i,difs,p,from,tween=TweenLite.to(target,duration,vars),results=[tween],b=[],e=[],targets=[],_reservedProps=TweenLite._internals.reservedProps;for(target=tween._targets||tween.target,_getChildStyles(target,b,targets),tween.render(duration,!0,!0),_getChildStyles(target,e),tween.render(0,!0,!0),tween._enabled(!0),i=targets.length;--i>-1;)if(difs=_cssDif(targets[i],b[i],e[i]),difs.firstMPT){difs=difs.difs;for(p in vars)_reservedProps[p]&&(difs[p]=vars[p]);from={};for(p in difs)from[p]=b[i][p];results.push(TweenLite.fromTo(targets[i],duration,from,difs))}return results},TweenPlugin.activate([CSSPlugin]),CSSPlugin},!0),function(){var RoundPropsPlugin=_gsScope._gsDefine.plugin({propName:"roundProps",version:"1.6.0",priority:-1,API:2,init:function(target,value,tween){return this._tween=tween,!0}}),_roundLinkedList=function(node){for(;node;)node.f||node.blob||(node.m=Math.round),node=node._next},p=RoundPropsPlugin.prototype;p._onInitAllProps=function(){for(var prop,pt,next,tween=this._tween,rp=tween.vars.roundProps.join?tween.vars.roundProps:tween.vars.roundProps.split(","),i=rp.length,lookup={},rpt=tween._propLookup.roundProps;--i>-1;)lookup[rp[i]]=Math.round;for(i=rp.length;--i>-1;)for(prop=rp[i],pt=tween._firstPT;pt;)next=pt._next,pt.pg?pt.t._mod(lookup):pt.n===prop&&(2===pt.f&&pt.t?_roundLinkedList(pt.t._firstPT):(this._add(pt.t,prop,pt.s,pt.c),next&&(next._prev=pt._prev),pt._prev?pt._prev._next=next:tween._firstPT===pt&&(tween._firstPT=next),pt._next=pt._prev=null,tween._propLookup[prop]=rpt)),pt=next;return!1},p._add=function(target,p,s,c){this._addTween(target,p,s,s+c,p,Math.round),this._overwriteProps.push(p)}}(),function(){_gsScope._gsDefine.plugin({propName:"attr",API:2,version:"0.6.0",init:function(target,value,tween,index){var p,end;if("function"!=typeof target.setAttribute)return!1;for(p in value)end=value[p],"function"==typeof end&&(end=end(index,target)),this._addTween(target,"setAttribute",target.getAttribute(p)+"",end+"",p,!1,p),this._overwriteProps.push(p);return!0}})}(),_gsScope._gsDefine.plugin({propName:"directionalRotation",version:"0.3.0",API:2,init:function(target,value,tween,index){"object"!=typeof value&&(value={rotation:value}),this.finals={};var p,v,start,end,dif,split,cap=value.useRadians===!0?2*Math.PI:360,min=1e-6;for(p in value)"useRadians"!==p&&(end=value[p],"function"==typeof end&&(end=end(index,target)),split=(end+"").split("_"),v=split[0],start=parseFloat("function"!=typeof target[p]?target[p]:target[p.indexOf("set")||"function"!=typeof target["get"+p.substr(3)]?p:"get"+p.substr(3)]()),end=this.finals[p]="string"==typeof v&&"="===v.charAt(1)?start+parseInt(v.charAt(0)+"1",10)*Number(v.substr(2)):Number(v)||0,dif=end-start,split.length&&(v=split.join("_"),v.indexOf("short")!==-1&&(dif%=cap,dif!==dif%(cap/2)&&(dif=dif<0?dif+cap:dif-cap)),v.indexOf("_cw")!==-1&&dif<0?dif=(dif+9999999999*cap)%cap-(dif/cap|0)*cap:v.indexOf("ccw")!==-1&&dif>0&&(dif=(dif-9999999999*cap)%cap-(dif/cap|0)*cap)),(dif>min||dif<-min)&&(this._addTween(target,p,start,start+dif,p),this._overwriteProps.push(p)));return!0},set:function(ratio){var pt;if(1!==ratio)this._super.setRatio.call(this,ratio);else for(pt=this._firstPT;pt;)pt.f?pt.t[pt.p](this.finals[pt.p]):pt.t[pt.p]=this.finals[pt.p],pt=pt._next}})._autoCSS=!0,_gsScope._gsDefine("easing.Back",["easing.Ease"],function(Ease){var SteppedEase,RoughEase,_createElastic,w=_gsScope.GreenSockGlobals||_gsScope,gs=w.com.greensock,_2PI=2*Math.PI,_HALF_PI=Math.PI/2,_class=gs._class,_create=function(n,f){var C=_class("easing."+n,function(){},!0),p=C.prototype=new Ease;return p.constructor=C,p.getRatio=f,C},_easeReg=Ease.register||function(){},_wrap=function(name,EaseOut,EaseIn,EaseInOut,aliases){var C=_class("easing."+name,{easeOut:new EaseOut,easeIn:new EaseIn,easeInOut:new EaseInOut},!0);return _easeReg(C,name),C},EasePoint=function(time,value,next){this.t=time,this.v=value,next&&(this.next=next,next.prev=this,this.c=next.v-value,this.gap=next.t-time)},_createBack=function(n,f){var C=_class("easing."+n,function(overshoot){this._p1=overshoot||0===overshoot?overshoot:1.70158,this._p2=1.525*this._p1},!0),p=C.prototype=new Ease;return p.constructor=C,p.getRatio=f,p.config=function(overshoot){return new C(overshoot)},C},Back=_wrap("Back",_createBack("BackOut",function(p){return(p-=1)*p*((this._p1+1)*p+this._p1)+1}),_createBack("BackIn",function(p){return p*p*((this._p1+1)*p-this._p1)}),_createBack("BackInOut",function(p){return(p*=2)<1?.5*p*p*((this._p2+1)*p-this._p2):.5*((p-=2)*p*((this._p2+1)*p+this._p2)+2)})),SlowMo=_class("easing.SlowMo",function(linearRatio,power,yoyoMode){power=power||0===power?power:.7,null==linearRatio?linearRatio=.7:linearRatio>1&&(linearRatio=1),this._p=1!==linearRatio?power:0,this._p1=(1-linearRatio)/2,this._p2=linearRatio,this._p3=this._p1+this._p2,this._calcEnd=yoyoMode===!0},!0),p=SlowMo.prototype=new Ease;return p.constructor=SlowMo,p.getRatio=function(p){var r=p+(.5-p)*this._p;return p<this._p1?this._calcEnd?1-(p=1-p/this._p1)*p:r-(p=1-p/this._p1)*p*p*p*r:p>this._p3?this._calcEnd?1-(p=(p-this._p3)/this._p1)*p:r+(p-r)*(p=(p-this._p3)/this._p1)*p*p*p:this._calcEnd?1:r},SlowMo.ease=new SlowMo(.7,.7),p.config=SlowMo.config=function(linearRatio,power,yoyoMode){return new SlowMo(linearRatio,power,yoyoMode)},SteppedEase=_class("easing.SteppedEase",function(steps){steps=steps||1,this._p1=1/steps,this._p2=steps+1},!0),p=SteppedEase.prototype=new Ease,p.constructor=SteppedEase,p.getRatio=function(p){return p<0?p=0:p>=1&&(p=.999999999),(this._p2*p>>0)*this._p1},p.config=SteppedEase.config=function(steps){return new SteppedEase(steps)},RoughEase=_class("easing.RoughEase",function(vars){vars=vars||{};for(var x,y,bump,invX,obj,pnt,taper=vars.taper||"none",a=[],cnt=0,points=0|(vars.points||20),i=points,randomize=vars.randomize!==!1,clamp=vars.clamp===!0,template=vars.template instanceof Ease?vars.template:null,strength="number"==typeof vars.strength?.4*vars.strength:.4;--i>-1;)x=randomize?Math.random():1/points*i,y=template?template.getRatio(x):x,"none"===taper?bump=strength:"out"===taper?(invX=1-x,bump=invX*invX*strength):"in"===taper?bump=x*x*strength:x<.5?(invX=2*x,bump=invX*invX*.5*strength):(invX=2*(1-x),bump=invX*invX*.5*strength),randomize?y+=Math.random()*bump-.5*bump:i%2?y+=.5*bump:y-=.5*bump,clamp&&(y>1?y=1:y<0&&(y=0)),a[cnt++]={x:x,y:y};for(a.sort(function(a,b){return a.x-b.x}),pnt=new EasePoint(1,1,null),i=points;--i>-1;)obj=a[i],pnt=new EasePoint(obj.x,obj.y,pnt);this._prev=new EasePoint(0,0,0!==pnt.t?pnt:pnt.next)},!0),p=RoughEase.prototype=new Ease,p.constructor=RoughEase,p.getRatio=function(p){var pnt=this._prev;if(p>pnt.t){for(;pnt.next&&p>=pnt.t;)pnt=pnt.next;pnt=pnt.prev}else for(;pnt.prev&&p<=pnt.t;)pnt=pnt.prev;return this._prev=pnt,pnt.v+(p-pnt.t)/pnt.gap*pnt.c},p.config=function(vars){return new RoughEase(vars)},RoughEase.ease=new RoughEase,_wrap("Bounce",_create("BounceOut",function(p){return p<1/2.75?7.5625*p*p:p<2/2.75?7.5625*(p-=1.5/2.75)*p+.75:p<2.5/2.75?7.5625*(p-=2.25/2.75)*p+.9375:7.5625*(p-=2.625/2.75)*p+.984375}),_create("BounceIn",function(p){return(p=1-p)<1/2.75?1-7.5625*p*p:p<2/2.75?1-(7.5625*(p-=1.5/2.75)*p+.75):p<2.5/2.75?1-(7.5625*(p-=2.25/2.75)*p+.9375):1-(7.5625*(p-=2.625/2.75)*p+.984375)}),_create("BounceInOut",function(p){var invert=p<.5;return p=invert?1-2*p:2*p-1,p=p<1/2.75?7.5625*p*p:p<2/2.75?7.5625*(p-=1.5/2.75)*p+.75:p<2.5/2.75?7.5625*(p-=2.25/2.75)*p+.9375:7.5625*(p-=2.625/2.75)*p+.984375,invert?.5*(1-p):.5*p+.5})),_wrap("Circ",_create("CircOut",function(p){return Math.sqrt(1-(p-=1)*p)}),_create("CircIn",function(p){return-(Math.sqrt(1-p*p)-1)}),_create("CircInOut",function(p){return(p*=2)<1?-.5*(Math.sqrt(1-p*p)-1):.5*(Math.sqrt(1-(p-=2)*p)+1)})),_createElastic=function(n,f,def){var C=_class("easing."+n,function(amplitude,period){this._p1=amplitude>=1?amplitude:1,this._p2=(period||def)/(amplitude<1?amplitude:1),this._p3=this._p2/_2PI*(Math.asin(1/this._p1)||0),this._p2=_2PI/this._p2},!0),p=C.prototype=new Ease;return p.constructor=C,p.getRatio=f,p.config=function(amplitude,period){return new C(amplitude,period)},C},_wrap("Elastic",_createElastic("ElasticOut",function(p){return this._p1*Math.pow(2,-10*p)*Math.sin((p-this._p3)*this._p2)+1},.3),_createElastic("ElasticIn",function(p){return-(this._p1*Math.pow(2,10*(p-=1))*Math.sin((p-this._p3)*this._p2))},.3),_createElastic("ElasticInOut",function(p){return(p*=2)<1?-.5*(this._p1*Math.pow(2,10*(p-=1))*Math.sin((p-this._p3)*this._p2)):this._p1*Math.pow(2,-10*(p-=1))*Math.sin((p-this._p3)*this._p2)*.5+1},.45)),_wrap("Expo",_create("ExpoOut",function(p){return 1-Math.pow(2,-10*p)}),_create("ExpoIn",function(p){return Math.pow(2,10*(p-1))-.001}),_create("ExpoInOut",function(p){return(p*=2)<1?.5*Math.pow(2,10*(p-1)):.5*(2-Math.pow(2,-10*(p-1)))})),_wrap("Sine",_create("SineOut",function(p){return Math.sin(p*_HALF_PI)}),_create("SineIn",function(p){return-Math.cos(p*_HALF_PI)+1}),_create("SineInOut",function(p){return-.5*(Math.cos(Math.PI*p)-1)})),_class("easing.EaseLookup",{find:function(s){return Ease.map[s]}},!0),_easeReg(w.SlowMo,"SlowMo","ease,"),_easeReg(RoughEase,"RoughEase","ease,"),_easeReg(SteppedEase,"SteppedEase","ease,"),Back},!0)}),_gsScope._gsDefine&&_gsScope._gsQueue.pop()(),function(window,moduleName){"use strict";var _exports={},_doc=window.document,_globals=window.GreenSockGlobals=window.GreenSockGlobals||window;if(!_globals.TweenLite){var a,i,p,_ticker,_tickerActive,_namespace=function(ns){var i,a=ns.split("."),p=_globals;for(i=0;i<a.length;i++)p[a[i]]=p=p[a[i]]||{};return p},gs=_namespace("com.greensock"),_tinyNum=1e-10,_slice=function(a){var i,b=[],l=a.length;for(i=0;i!==l;b.push(a[i++]));return b},_emptyFunc=function(){},_isArray=function(){var toString=Object.prototype.toString,array=toString.call([]);return function(obj){return null!=obj&&(obj instanceof Array||"object"==typeof obj&&!!obj.push&&toString.call(obj)===array)}}(),_defLookup={},Definition=function(ns,dependencies,func,global){this.sc=_defLookup[ns]?_defLookup[ns].sc:[],_defLookup[ns]=this,this.gsClass=null,this.func=func;var _classes=[];this.check=function(init){for(var cur,a,n,cl,hasModule,i=dependencies.length,missing=i;--i>-1;)(cur=_defLookup[dependencies[i]]||new Definition(dependencies[i],[])).gsClass?(_classes[i]=cur.gsClass,missing--):init&&cur.sc.push(this);if(0===missing&&func){if(a=("com.greensock."+ns).split("."),n=a.pop(),cl=_namespace(a.join("."))[n]=this.gsClass=func.apply(func,_classes),global)if(_globals[n]=_exports[n]=cl,hasModule="undefined"!=typeof module&&module.exports,!hasModule&&"function"==typeof define&&define.amd)define((window.GreenSockAMDPath?window.GreenSockAMDPath+"/":"")+ns.split(".").pop(),[],function(){return cl});else if(hasModule)if(ns===moduleName){module.exports=_exports[moduleName]=cl;for(i in _exports)cl[i]=_exports[i]}else _exports[moduleName]&&(_exports[moduleName][n]=cl);for(i=0;i<this.sc.length;i++)this.sc[i].check()}},this.check(!0)},_gsDefine=window._gsDefine=function(ns,dependencies,func,global){return new Definition(ns,dependencies,func,global)},_class=gs._class=function(ns,func,global){return func=func||function(){},_gsDefine(ns,[],function(){return func},global),func};_gsDefine.globals=_globals;var _baseParams=[0,0,1,1],Ease=_class("easing.Ease",function(func,extraParams,type,power){this._func=func,this._type=type||0,this._power=power||0,this._params=extraParams?_baseParams.concat(extraParams):_baseParams},!0),_easeMap=Ease.map={},_easeReg=Ease.register=function(ease,names,types,create){for(var e,name,j,type,na=names.split(","),i=na.length,ta=(types||"easeIn,easeOut,easeInOut").split(",");--i>-1;)for(name=na[i],e=create?_class("easing."+name,null,!0):gs.easing[name]||{},j=ta.length;--j>-1;)type=ta[j],_easeMap[name+"."+type]=_easeMap[type+name]=e[type]=ease.getRatio?ease:ease[type]||new ease};for(p=Ease.prototype,p._calcEnd=!1,p.getRatio=function(p){if(this._func)return this._params[0]=p,this._func.apply(null,this._params);var t=this._type,pw=this._power,r=1===t?1-p:2===t?p:p<.5?2*p:2*(1-p);return 1===pw?r*=r:2===pw?r*=r*r:3===pw?r*=r*r*r:4===pw&&(r*=r*r*r*r),1===t?1-r:2===t?r:p<.5?r/2:1-r/2},a=["Linear","Quad","Cubic","Quart","Quint,Strong"],i=a.length;--i>-1;)p=a[i]+",Power"+i,_easeReg(new Ease(null,null,1,i),p,"easeOut",!0),_easeReg(new Ease(null,null,2,i),p,"easeIn"+(0===i?",easeNone":"")),_easeReg(new Ease(null,null,3,i),p,"easeInOut");_easeMap.linear=gs.easing.Linear.easeIn,_easeMap.swing=gs.easing.Quad.easeInOut;var EventDispatcher=_class("events.EventDispatcher",function(target){this._listeners={},this._eventTarget=target||this});p=EventDispatcher.prototype,p.addEventListener=function(type,callback,scope,useParam,priority){priority=priority||0;var listener,i,list=this._listeners[type],index=0;for(this!==_ticker||_tickerActive||_ticker.wake(),null==list&&(this._listeners[type]=list=[]),i=list.length;--i>-1;)listener=list[i],listener.c===callback&&listener.s===scope?list.splice(i,1):0===index&&listener.pr<priority&&(index=i+1);list.splice(index,0,{c:callback,s:scope,up:useParam,pr:priority})},p.removeEventListener=function(type,callback){var i,list=this._listeners[type];if(list)for(i=list.length;--i>-1;)if(list[i].c===callback)return void list.splice(i,1)},p.dispatchEvent=function(type){var i,t,listener,list=this._listeners[type];if(list)for(i=list.length,i>1&&(list=list.slice(0)),t=this._eventTarget;--i>-1;)listener=list[i],listener&&(listener.up?listener.c.call(listener.s||t,{type:type,target:t}):listener.c.call(listener.s||t))};var _reqAnimFrame=window.requestAnimationFrame,_cancelAnimFrame=window.cancelAnimationFrame,_getTime=Date.now||function(){return(new Date).getTime()},_lastUpdate=_getTime();for(a=["ms","moz","webkit","o"],i=a.length;--i>-1&&!_reqAnimFrame;)_reqAnimFrame=window[a[i]+"RequestAnimationFrame"],_cancelAnimFrame=window[a[i]+"CancelAnimationFrame"]||window[a[i]+"CancelRequestAnimationFrame"];_class("Ticker",function(fps,useRAF){var _fps,_req,_id,_gap,_nextTime,_self=this,_startTime=_getTime(),_useRAF=!(useRAF===!1||!_reqAnimFrame)&&"auto",_lagThreshold=500,_adjustedLag=33,_tickWord="tick",_tick=function(manual){var overlap,dispatch,elapsed=_getTime()-_lastUpdate;elapsed>_lagThreshold&&(_startTime+=elapsed-_adjustedLag),_lastUpdate+=elapsed,_self.time=(_lastUpdate-_startTime)/1e3,overlap=_self.time-_nextTime,(!_fps||overlap>0||manual===!0)&&(_self.frame++,_nextTime+=overlap+(overlap>=_gap?.004:_gap-overlap),dispatch=!0),manual!==!0&&(_id=_req(_tick)),dispatch&&_self.dispatchEvent(_tickWord)};EventDispatcher.call(_self),_self.time=_self.frame=0,_self.tick=function(){_tick(!0)},_self.lagSmoothing=function(threshold,adjustedLag){_lagThreshold=threshold||1/_tinyNum,_adjustedLag=Math.min(adjustedLag,_lagThreshold,0)},_self.sleep=function(){null!=_id&&(_useRAF&&_cancelAnimFrame?_cancelAnimFrame(_id):clearTimeout(_id),_req=_emptyFunc,_id=null,_self===_ticker&&(_tickerActive=!1))},_self.wake=function(seamless){null!==_id?_self.sleep():seamless?_startTime+=-_lastUpdate+(_lastUpdate=_getTime()):_self.frame>10&&(_lastUpdate=_getTime()-_lagThreshold+5),_req=0===_fps?_emptyFunc:_useRAF&&_reqAnimFrame?_reqAnimFrame:function(f){return setTimeout(f,1e3*(_nextTime-_self.time)+1|0)},_self===_ticker&&(_tickerActive=!0),_tick(2)},_self.fps=function(value){return arguments.length?(_fps=value,_gap=1/(_fps||60),_nextTime=this.time+_gap,void _self.wake()):_fps},_self.useRAF=function(value){return arguments.length?(_self.sleep(),_useRAF=value,void _self.fps(_fps)):_useRAF},_self.fps(fps),setTimeout(function(){"auto"===_useRAF&&_self.frame<5&&"hidden"!==_doc.visibilityState&&_self.useRAF(!1)},1500)}),p=gs.Ticker.prototype=new gs.events.EventDispatcher,p.constructor=gs.Ticker;var Animation=_class("core.Animation",function(duration,vars){if(this.vars=vars=vars||{},this._duration=this._totalDuration=duration||0,this._delay=Number(vars.delay)||0,this._timeScale=1,this._active=vars.immediateRender===!0,this.data=vars.data,this._reversed=vars.reversed===!0,_rootTimeline){_tickerActive||_ticker.wake();var tl=this.vars.useFrames?_rootFramesTimeline:_rootTimeline;tl.add(this,tl._time),this.vars.paused&&this.paused(!0)}});_ticker=Animation.ticker=new gs.Ticker,p=Animation.prototype,p._dirty=p._gc=p._initted=p._paused=!1,p._totalTime=p._time=0,p._rawPrevTime=-1,p._next=p._last=p._onUpdate=p._timeline=p.timeline=null,p._paused=!1;var _checkTimeout=function(){_tickerActive&&_getTime()-_lastUpdate>2e3&&_ticker.wake(),setTimeout(_checkTimeout,2e3)};_checkTimeout(),p.play=function(from,suppressEvents){return null!=from&&this.seek(from,suppressEvents),this.reversed(!1).paused(!1)},p.pause=function(atTime,suppressEvents){return null!=atTime&&this.seek(atTime,suppressEvents),this.paused(!0)},p.resume=function(from,suppressEvents){return null!=from&&this.seek(from,suppressEvents),this.paused(!1)},p.seek=function(time,suppressEvents){return this.totalTime(Number(time),suppressEvents!==!1)},p.restart=function(includeDelay,suppressEvents){return this.reversed(!1).paused(!1).totalTime(includeDelay?-this._delay:0,suppressEvents!==!1,!0)},p.reverse=function(from,suppressEvents){return null!=from&&this.seek(from||this.totalDuration(),suppressEvents),this.reversed(!0).paused(!1)},p.render=function(time,suppressEvents,force){},p.invalidate=function(){return this._time=this._totalTime=0,this._initted=this._gc=!1,this._rawPrevTime=-1,!this._gc&&this.timeline||this._enabled(!0),this},p.isActive=function(){var rawTime,tl=this._timeline,startTime=this._startTime;return!tl||!this._gc&&!this._paused&&tl.isActive()&&(rawTime=tl.rawTime(!0))>=startTime&&rawTime<startTime+this.totalDuration()/this._timeScale},p._enabled=function(enabled,ignoreTimeline){return _tickerActive||_ticker.wake(),this._gc=!enabled,this._active=this.isActive(),ignoreTimeline!==!0&&(enabled&&!this.timeline?this._timeline.add(this,this._startTime-this._delay):!enabled&&this.timeline&&this._timeline._remove(this,!0)),!1},p._kill=function(vars,target){return this._enabled(!1,!1)},p.kill=function(vars,target){return this._kill(vars,target),this},p._uncache=function(includeSelf){for(var tween=includeSelf?this:this.timeline;tween;)tween._dirty=!0,tween=tween.timeline;return this},p._swapSelfInParams=function(params){for(var i=params.length,copy=params.concat();--i>-1;)"{self}"===params[i]&&(copy[i]=this);return copy},p._callback=function(type){var v=this.vars,callback=v[type],params=v[type+"Params"],scope=v[type+"Scope"]||v.callbackScope||this,l=params?params.length:0;switch(l){case 0:callback.call(scope);break;case 1:callback.call(scope,params[0]);break;case 2:callback.call(scope,params[0],params[1]);break;default:callback.apply(scope,params)}},p.eventCallback=function(type,callback,params,scope){if("on"===(type||"").substr(0,2)){var v=this.vars;if(1===arguments.length)return v[type];null==callback?delete v[type]:(v[type]=callback,v[type+"Params"]=_isArray(params)&&params.join("").indexOf("{self}")!==-1?this._swapSelfInParams(params):params,v[type+"Scope"]=scope),"onUpdate"===type&&(this._onUpdate=callback)}return this},p.delay=function(value){return arguments.length?(this._timeline.smoothChildTiming&&this.startTime(this._startTime+value-this._delay),this._delay=value,this):this._delay},p.duration=function(value){return arguments.length?(this._duration=this._totalDuration=value,this._uncache(!0),this._timeline.smoothChildTiming&&this._time>0&&this._time<this._duration&&0!==value&&this.totalTime(this._totalTime*(value/this._duration),!0),this):(this._dirty=!1,this._duration)},p.totalDuration=function(value){return this._dirty=!1,arguments.length?this.duration(value):this._totalDuration},p.time=function(value,suppressEvents){return arguments.length?(this._dirty&&this.totalDuration(),this.totalTime(value>this._duration?this._duration:value,suppressEvents)):this._time},p.totalTime=function(time,suppressEvents,uncapped){if(_tickerActive||_ticker.wake(),!arguments.length)return this._totalTime;if(this._timeline){if(time<0&&!uncapped&&(time+=this.totalDuration()),this._timeline.smoothChildTiming){this._dirty&&this.totalDuration();var totalDuration=this._totalDuration,tl=this._timeline;if(time>totalDuration&&!uncapped&&(time=totalDuration),this._startTime=(this._paused?this._pauseTime:tl._time)-(this._reversed?totalDuration-time:time)/this._timeScale,tl._dirty||this._uncache(!1),tl._timeline)for(;tl._timeline;)tl._timeline._time!==(tl._startTime+tl._totalTime)/tl._timeScale&&tl.totalTime(tl._totalTime,!0),tl=tl._timeline}this._gc&&this._enabled(!0,!1),this._totalTime===time&&0!==this._duration||(_lazyTweens.length&&_lazyRender(),this.render(time,suppressEvents,!1),_lazyTweens.length&&_lazyRender())}return this},p.progress=p.totalProgress=function(value,suppressEvents){var duration=this.duration();return arguments.length?this.totalTime(duration*value,suppressEvents):duration?this._time/duration:this.ratio;
},p.startTime=function(value){return arguments.length?(value!==this._startTime&&(this._startTime=value,this.timeline&&this.timeline._sortChildren&&this.timeline.add(this,value-this._delay)),this):this._startTime},p.endTime=function(includeRepeats){return this._startTime+(0!=includeRepeats?this.totalDuration():this.duration())/this._timeScale},p.timeScale=function(value){if(!arguments.length)return this._timeScale;if(value=value||_tinyNum,this._timeline&&this._timeline.smoothChildTiming){var pauseTime=this._pauseTime,t=pauseTime||0===pauseTime?pauseTime:this._timeline.totalTime();this._startTime=t-(t-this._startTime)*this._timeScale/value}return this._timeScale=value,this._uncache(!1)},p.reversed=function(value){return arguments.length?(value!=this._reversed&&(this._reversed=value,this.totalTime(this._timeline&&!this._timeline.smoothChildTiming?this.totalDuration()-this._totalTime:this._totalTime,!0)),this):this._reversed},p.paused=function(value){if(!arguments.length)return this._paused;var raw,elapsed,tl=this._timeline;return value!=this._paused&&tl&&(_tickerActive||value||_ticker.wake(),raw=tl.rawTime(),elapsed=raw-this._pauseTime,!value&&tl.smoothChildTiming&&(this._startTime+=elapsed,this._uncache(!1)),this._pauseTime=value?raw:null,this._paused=value,this._active=this.isActive(),!value&&0!==elapsed&&this._initted&&this.duration()&&(raw=tl.smoothChildTiming?this._totalTime:(raw-this._startTime)/this._timeScale,this.render(raw,raw===this._totalTime,!0))),this._gc&&!value&&this._enabled(!0,!1),this};var SimpleTimeline=_class("core.SimpleTimeline",function(vars){Animation.call(this,0,vars),this.autoRemoveChildren=this.smoothChildTiming=!0});p=SimpleTimeline.prototype=new Animation,p.constructor=SimpleTimeline,p.kill()._gc=!1,p._first=p._last=p._recent=null,p._sortChildren=!1,p.add=p.insert=function(child,position,align,stagger){var prevTween,st;if(child._startTime=Number(position||0)+child._delay,child._paused&&this!==child._timeline&&(child._pauseTime=child._startTime+(this.rawTime()-child._startTime)/child._timeScale),child.timeline&&child.timeline._remove(child,!0),child.timeline=child._timeline=this,child._gc&&child._enabled(!0,!0),prevTween=this._last,this._sortChildren)for(st=child._startTime;prevTween&&prevTween._startTime>st;)prevTween=prevTween._prev;return prevTween?(child._next=prevTween._next,prevTween._next=child):(child._next=this._first,this._first=child),child._next?child._next._prev=child:this._last=child,child._prev=prevTween,this._recent=child,this._timeline&&this._uncache(!0),this},p._remove=function(tween,skipDisable){return tween.timeline===this&&(skipDisable||tween._enabled(!1,!0),tween._prev?tween._prev._next=tween._next:this._first===tween&&(this._first=tween._next),tween._next?tween._next._prev=tween._prev:this._last===tween&&(this._last=tween._prev),tween._next=tween._prev=tween.timeline=null,tween===this._recent&&(this._recent=this._last),this._timeline&&this._uncache(!0)),this},p.render=function(time,suppressEvents,force){var next,tween=this._first;for(this._totalTime=this._time=this._rawPrevTime=time;tween;)next=tween._next,(tween._active||time>=tween._startTime&&!tween._paused)&&(tween._reversed?tween.render((tween._dirty?tween.totalDuration():tween._totalDuration)-(time-tween._startTime)*tween._timeScale,suppressEvents,force):tween.render((time-tween._startTime)*tween._timeScale,suppressEvents,force)),tween=next},p.rawTime=function(){return _tickerActive||_ticker.wake(),this._totalTime};var TweenLite=_class("TweenLite",function(target,duration,vars){if(Animation.call(this,duration,vars),this.render=TweenLite.prototype.render,null==target)throw"Cannot tween a null target.";this.target=target="string"!=typeof target?target:TweenLite.selector(target)||target;var i,targ,targets,isSelector=target.jquery||target.length&&target!==window&&target[0]&&(target[0]===window||target[0].nodeType&&target[0].style&&!target.nodeType),overwrite=this.vars.overwrite;if(this._overwrite=overwrite=null==overwrite?_overwriteLookup[TweenLite.defaultOverwrite]:"number"==typeof overwrite?overwrite>>0:_overwriteLookup[overwrite],(isSelector||target instanceof Array||target.push&&_isArray(target))&&"number"!=typeof target[0])for(this._targets=targets=_slice(target),this._propLookup=[],this._siblings=[],i=0;i<targets.length;i++)targ=targets[i],targ?"string"!=typeof targ?targ.length&&targ!==window&&targ[0]&&(targ[0]===window||targ[0].nodeType&&targ[0].style&&!targ.nodeType)?(targets.splice(i--,1),this._targets=targets=targets.concat(_slice(targ))):(this._siblings[i]=_register(targ,this,!1),1===overwrite&&this._siblings[i].length>1&&_applyOverwrite(targ,this,null,1,this._siblings[i])):(targ=targets[i--]=TweenLite.selector(targ),"string"==typeof targ&&targets.splice(i+1,1)):targets.splice(i--,1);else this._propLookup={},this._siblings=_register(target,this,!1),1===overwrite&&this._siblings.length>1&&_applyOverwrite(target,this,null,1,this._siblings);(this.vars.immediateRender||0===duration&&0===this._delay&&this.vars.immediateRender!==!1)&&(this._time=-_tinyNum,this.render(Math.min(0,-this._delay)))},!0),_isSelector=function(v){return v&&v.length&&v!==window&&v[0]&&(v[0]===window||v[0].nodeType&&v[0].style&&!v.nodeType)},_autoCSS=function(vars,target){var p,css={};for(p in vars)_reservedProps[p]||p in target&&"transform"!==p&&"x"!==p&&"y"!==p&&"width"!==p&&"height"!==p&&"className"!==p&&"border"!==p||!(!_plugins[p]||_plugins[p]&&_plugins[p]._autoCSS)||(css[p]=vars[p],delete vars[p]);vars.css=css};p=TweenLite.prototype=new Animation,p.constructor=TweenLite,p.kill()._gc=!1,p.ratio=0,p._firstPT=p._targets=p._overwrittenProps=p._startAt=null,p._notifyPluginsOfEnabled=p._lazy=!1,TweenLite.version="1.19.1",TweenLite.defaultEase=p._ease=new Ease(null,null,1,1),TweenLite.defaultOverwrite="auto",TweenLite.ticker=_ticker,TweenLite.autoSleep=120,TweenLite.lagSmoothing=function(threshold,adjustedLag){_ticker.lagSmoothing(threshold,adjustedLag)},TweenLite.selector=window.$||window.jQuery||function(e){var selector=window.$||window.jQuery;return selector?(TweenLite.selector=selector,selector(e)):"undefined"==typeof _doc?e:_doc.querySelectorAll?_doc.querySelectorAll(e):_doc.getElementById("#"===e.charAt(0)?e.substr(1):e)};var _lazyTweens=[],_lazyLookup={},_numbersExp=/(?:(-|-=|\+=)?\d*\.?\d*(?:e[\-+]?\d+)?)[0-9]/gi,_setRatio=function(v){for(var val,pt=this._firstPT,min=1e-6;pt;)val=pt.blob?1===v?this.end:v?this.join(""):this.start:pt.c*v+pt.s,pt.m?val=pt.m(val,this._target||pt.t):val<min&&val>-min&&!pt.blob&&(val=0),pt.f?pt.fp?pt.t[pt.p](pt.fp,val):pt.t[pt.p](val):pt.t[pt.p]=val,pt=pt._next},_blobDif=function(start,end,filter,pt){var startNums,endNums,num,i,l,nonNumbers,currentNum,a=[],charIndex=0,s="",color=0;for(a.start=start,a.end=end,start=a[0]=start+"",end=a[1]=end+"",filter&&(filter(a),start=a[0],end=a[1]),a.length=0,startNums=start.match(_numbersExp)||[],endNums=end.match(_numbersExp)||[],pt&&(pt._next=null,pt.blob=1,a._firstPT=a._applyPT=pt),l=endNums.length,i=0;i<l;i++)currentNum=endNums[i],nonNumbers=end.substr(charIndex,end.indexOf(currentNum,charIndex)-charIndex),s+=nonNumbers||!i?nonNumbers:",",charIndex+=nonNumbers.length,color?color=(color+1)%5:"rgba("===nonNumbers.substr(-5)&&(color=1),currentNum===startNums[i]||startNums.length<=i?s+=currentNum:(s&&(a.push(s),s=""),num=parseFloat(startNums[i]),a.push(num),a._firstPT={_next:a._firstPT,t:a,p:a.length-1,s:num,c:("="===currentNum.charAt(1)?parseInt(currentNum.charAt(0)+"1",10)*parseFloat(currentNum.substr(2)):parseFloat(currentNum)-num)||0,f:0,m:color&&color<4?Math.round:0}),charIndex+=currentNum.length;return s+=end.substr(charIndex),s&&a.push(s),a.setRatio=_setRatio,a},_addPropTween=function(target,prop,start,end,overwriteProp,mod,funcParam,stringFilter,index){"function"==typeof end&&(end=end(index||0,target));var blob,type=typeof target[prop],getterName="function"!==type?"":prop.indexOf("set")||"function"!=typeof target["get"+prop.substr(3)]?prop:"get"+prop.substr(3),s="get"!==start?start:getterName?funcParam?target[getterName](funcParam):target[getterName]():target[prop],isRelative="string"==typeof end&&"="===end.charAt(1),pt={t:target,p:prop,s:s,f:"function"===type,pg:0,n:overwriteProp||prop,m:mod?"function"==typeof mod?mod:Math.round:0,pr:0,c:isRelative?parseInt(end.charAt(0)+"1",10)*parseFloat(end.substr(2)):parseFloat(end)-s||0};if(("number"!=typeof s||"number"!=typeof end&&!isRelative)&&(funcParam||isNaN(s)||!isRelative&&isNaN(end)||"boolean"==typeof s||"boolean"==typeof end?(pt.fp=funcParam,blob=_blobDif(s,isRelative?pt.s+pt.c:end,stringFilter||TweenLite.defaultStringFilter,pt),pt={t:blob,p:"setRatio",s:0,c:1,f:2,pg:0,n:overwriteProp||prop,pr:0,m:0}):(pt.s=parseFloat(s),isRelative||(pt.c=parseFloat(end)-pt.s||0))),pt.c)return(pt._next=this._firstPT)&&(pt._next._prev=pt),this._firstPT=pt,pt},_internals=TweenLite._internals={isArray:_isArray,isSelector:_isSelector,lazyTweens:_lazyTweens,blobDif:_blobDif},_plugins=TweenLite._plugins={},_tweenLookup=_internals.tweenLookup={},_tweenLookupNum=0,_reservedProps=_internals.reservedProps={ease:1,delay:1,overwrite:1,onComplete:1,onCompleteParams:1,onCompleteScope:1,useFrames:1,runBackwards:1,startAt:1,onUpdate:1,onUpdateParams:1,onUpdateScope:1,onStart:1,onStartParams:1,onStartScope:1,onReverseComplete:1,onReverseCompleteParams:1,onReverseCompleteScope:1,onRepeat:1,onRepeatParams:1,onRepeatScope:1,easeParams:1,yoyo:1,immediateRender:1,repeat:1,repeatDelay:1,data:1,paused:1,reversed:1,autoCSS:1,lazy:1,onOverwrite:1,callbackScope:1,stringFilter:1,id:1},_overwriteLookup={none:0,all:1,auto:2,concurrent:3,allOnStart:4,preexisting:5,true:1,false:0},_rootFramesTimeline=Animation._rootFramesTimeline=new SimpleTimeline,_rootTimeline=Animation._rootTimeline=new SimpleTimeline,_nextGCFrame=30,_lazyRender=_internals.lazyRender=function(){var tween,i=_lazyTweens.length;for(_lazyLookup={};--i>-1;)tween=_lazyTweens[i],tween&&tween._lazy!==!1&&(tween.render(tween._lazy[0],tween._lazy[1],!0),tween._lazy=!1);_lazyTweens.length=0};_rootTimeline._startTime=_ticker.time,_rootFramesTimeline._startTime=_ticker.frame,_rootTimeline._active=_rootFramesTimeline._active=!0,setTimeout(_lazyRender,1),Animation._updateRoot=TweenLite.render=function(){var i,a,p;if(_lazyTweens.length&&_lazyRender(),_rootTimeline.render((_ticker.time-_rootTimeline._startTime)*_rootTimeline._timeScale,!1,!1),_rootFramesTimeline.render((_ticker.frame-_rootFramesTimeline._startTime)*_rootFramesTimeline._timeScale,!1,!1),_lazyTweens.length&&_lazyRender(),_ticker.frame>=_nextGCFrame){_nextGCFrame=_ticker.frame+(parseInt(TweenLite.autoSleep,10)||120);for(p in _tweenLookup){for(a=_tweenLookup[p].tweens,i=a.length;--i>-1;)a[i]._gc&&a.splice(i,1);0===a.length&&delete _tweenLookup[p]}if(p=_rootTimeline._first,(!p||p._paused)&&TweenLite.autoSleep&&!_rootFramesTimeline._first&&1===_ticker._listeners.tick.length){for(;p&&p._paused;)p=p._next;p||_ticker.sleep()}}},_ticker.addEventListener("tick",Animation._updateRoot);var _register=function(target,tween,scrub){var a,i,id=target._gsTweenID;if(_tweenLookup[id||(target._gsTweenID=id="t"+_tweenLookupNum++)]||(_tweenLookup[id]={target:target,tweens:[]}),tween&&(a=_tweenLookup[id].tweens,a[i=a.length]=tween,scrub))for(;--i>-1;)a[i]===tween&&a.splice(i,1);return _tweenLookup[id].tweens},_onOverwrite=function(overwrittenTween,overwritingTween,target,killedProps){var r1,r2,func=overwrittenTween.vars.onOverwrite;return func&&(r1=func(overwrittenTween,overwritingTween,target,killedProps)),func=TweenLite.onOverwrite,func&&(r2=func(overwrittenTween,overwritingTween,target,killedProps)),r1!==!1&&r2!==!1},_applyOverwrite=function(target,tween,props,mode,siblings){var i,changed,curTween,l;if(1===mode||mode>=4){for(l=siblings.length,i=0;i<l;i++)if((curTween=siblings[i])!==tween)curTween._gc||curTween._kill(null,target,tween)&&(changed=!0);else if(5===mode)break;return changed}var globalStart,startTime=tween._startTime+_tinyNum,overlaps=[],oCount=0,zeroDur=0===tween._duration;for(i=siblings.length;--i>-1;)(curTween=siblings[i])===tween||curTween._gc||curTween._paused||(curTween._timeline!==tween._timeline?(globalStart=globalStart||_checkOverlap(tween,0,zeroDur),0===_checkOverlap(curTween,globalStart,zeroDur)&&(overlaps[oCount++]=curTween)):curTween._startTime<=startTime&&curTween._startTime+curTween.totalDuration()/curTween._timeScale>startTime&&((zeroDur||!curTween._initted)&&startTime-curTween._startTime<=2e-10||(overlaps[oCount++]=curTween)));for(i=oCount;--i>-1;)if(curTween=overlaps[i],2===mode&&curTween._kill(props,target,tween)&&(changed=!0),2!==mode||!curTween._firstPT&&curTween._initted){if(2!==mode&&!_onOverwrite(curTween,tween))continue;curTween._enabled(!1,!1)&&(changed=!0)}return changed},_checkOverlap=function(tween,reference,zeroDur){for(var tl=tween._timeline,ts=tl._timeScale,t=tween._startTime;tl._timeline;){if(t+=tl._startTime,ts*=tl._timeScale,tl._paused)return-100;tl=tl._timeline}return t/=ts,t>reference?t-reference:zeroDur&&t===reference||!tween._initted&&t-reference<2*_tinyNum?_tinyNum:(t+=tween.totalDuration()/tween._timeScale/ts)>reference+_tinyNum?0:t-reference-_tinyNum};p._init=function(){var i,initPlugins,pt,p,startVars,l,v=this.vars,op=this._overwrittenProps,dur=this._duration,immediate=!!v.immediateRender,ease=v.ease;if(v.startAt){this._startAt&&(this._startAt.render(-1,!0),this._startAt.kill()),startVars={};for(p in v.startAt)startVars[p]=v.startAt[p];if(startVars.overwrite=!1,startVars.immediateRender=!0,startVars.lazy=immediate&&v.lazy!==!1,startVars.startAt=startVars.delay=null,this._startAt=TweenLite.to(this.target,0,startVars),immediate)if(this._time>0)this._startAt=null;else if(0!==dur)return}else if(v.runBackwards&&0!==dur)if(this._startAt)this._startAt.render(-1,!0),this._startAt.kill(),this._startAt=null;else{0!==this._time&&(immediate=!1),pt={};for(p in v)_reservedProps[p]&&"autoCSS"!==p||(pt[p]=v[p]);if(pt.overwrite=0,pt.data="isFromStart",pt.lazy=immediate&&v.lazy!==!1,pt.immediateRender=immediate,this._startAt=TweenLite.to(this.target,0,pt),immediate){if(0===this._time)return}else this._startAt._init(),this._startAt._enabled(!1),this.vars.immediateRender&&(this._startAt=null)}if(this._ease=ease=ease?ease instanceof Ease?ease:"function"==typeof ease?new Ease(ease,v.easeParams):_easeMap[ease]||TweenLite.defaultEase:TweenLite.defaultEase,v.easeParams instanceof Array&&ease.config&&(this._ease=ease.config.apply(ease,v.easeParams)),this._easeType=this._ease._type,this._easePower=this._ease._power,this._firstPT=null,this._targets)for(l=this._targets.length,i=0;i<l;i++)this._initProps(this._targets[i],this._propLookup[i]={},this._siblings[i],op?op[i]:null,i)&&(initPlugins=!0);else initPlugins=this._initProps(this.target,this._propLookup,this._siblings,op,0);if(initPlugins&&TweenLite._onPluginEvent("_onInitAllProps",this),op&&(this._firstPT||"function"!=typeof this.target&&this._enabled(!1,!1)),v.runBackwards)for(pt=this._firstPT;pt;)pt.s+=pt.c,pt.c=-pt.c,pt=pt._next;this._onUpdate=v.onUpdate,this._initted=!0},p._initProps=function(target,propLookup,siblings,overwrittenProps,index){var p,i,initPlugins,plugin,pt,v;if(null==target)return!1;_lazyLookup[target._gsTweenID]&&_lazyRender(),this.vars.css||target.style&&target!==window&&target.nodeType&&_plugins.css&&this.vars.autoCSS!==!1&&_autoCSS(this.vars,target);for(p in this.vars)if(v=this.vars[p],_reservedProps[p])v&&(v instanceof Array||v.push&&_isArray(v))&&v.join("").indexOf("{self}")!==-1&&(this.vars[p]=v=this._swapSelfInParams(v,this));else if(_plugins[p]&&(plugin=new _plugins[p])._onInitTween(target,this.vars[p],this,index)){for(this._firstPT=pt={_next:this._firstPT,t:plugin,p:"setRatio",s:0,c:1,f:1,n:p,pg:1,pr:plugin._priority,m:0},i=plugin._overwriteProps.length;--i>-1;)propLookup[plugin._overwriteProps[i]]=this._firstPT;(plugin._priority||plugin._onInitAllProps)&&(initPlugins=!0),(plugin._onDisable||plugin._onEnable)&&(this._notifyPluginsOfEnabled=!0),pt._next&&(pt._next._prev=pt)}else propLookup[p]=_addPropTween.call(this,target,p,"get",v,p,0,null,this.vars.stringFilter,index);return overwrittenProps&&this._kill(overwrittenProps,target)?this._initProps(target,propLookup,siblings,overwrittenProps,index):this._overwrite>1&&this._firstPT&&siblings.length>1&&_applyOverwrite(target,this,propLookup,this._overwrite,siblings)?(this._kill(propLookup,target),this._initProps(target,propLookup,siblings,overwrittenProps,index)):(this._firstPT&&(this.vars.lazy!==!1&&this._duration||this.vars.lazy&&!this._duration)&&(_lazyLookup[target._gsTweenID]=!0),initPlugins)},p.render=function(time,suppressEvents,force){var isComplete,callback,pt,rawPrevTime,prevTime=this._time,duration=this._duration,prevRawPrevTime=this._rawPrevTime;if(time>=duration-1e-7&&time>=0)this._totalTime=this._time=duration,this.ratio=this._ease._calcEnd?this._ease.getRatio(1):1,this._reversed||(isComplete=!0,callback="onComplete",force=force||this._timeline.autoRemoveChildren),0===duration&&(this._initted||!this.vars.lazy||force)&&(this._startTime===this._timeline._duration&&(time=0),(prevRawPrevTime<0||time<=0&&time>=-1e-7||prevRawPrevTime===_tinyNum&&"isPause"!==this.data)&&prevRawPrevTime!==time&&(force=!0,prevRawPrevTime>_tinyNum&&(callback="onReverseComplete")),this._rawPrevTime=rawPrevTime=!suppressEvents||time||prevRawPrevTime===time?time:_tinyNum);else if(time<1e-7)this._totalTime=this._time=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0,(0!==prevTime||0===duration&&prevRawPrevTime>0)&&(callback="onReverseComplete",isComplete=this._reversed),time<0&&(this._active=!1,0===duration&&(this._initted||!this.vars.lazy||force)&&(prevRawPrevTime>=0&&(prevRawPrevTime!==_tinyNum||"isPause"!==this.data)&&(force=!0),this._rawPrevTime=rawPrevTime=!suppressEvents||time||prevRawPrevTime===time?time:_tinyNum)),this._initted||(force=!0);else if(this._totalTime=this._time=time,this._easeType){var r=time/duration,type=this._easeType,pow=this._easePower;(1===type||3===type&&r>=.5)&&(r=1-r),3===type&&(r*=2),1===pow?r*=r:2===pow?r*=r*r:3===pow?r*=r*r*r:4===pow&&(r*=r*r*r*r),1===type?this.ratio=1-r:2===type?this.ratio=r:time/duration<.5?this.ratio=r/2:this.ratio=1-r/2}else this.ratio=this._ease.getRatio(time/duration);if(this._time!==prevTime||force){if(!this._initted){if(this._init(),!this._initted||this._gc)return;if(!force&&this._firstPT&&(this.vars.lazy!==!1&&this._duration||this.vars.lazy&&!this._duration))return this._time=this._totalTime=prevTime,this._rawPrevTime=prevRawPrevTime,_lazyTweens.push(this),void(this._lazy=[time,suppressEvents]);this._time&&!isComplete?this.ratio=this._ease.getRatio(this._time/duration):isComplete&&this._ease._calcEnd&&(this.ratio=this._ease.getRatio(0===this._time?0:1))}for(this._lazy!==!1&&(this._lazy=!1),this._active||!this._paused&&this._time!==prevTime&&time>=0&&(this._active=!0),0===prevTime&&(this._startAt&&(time>=0?this._startAt.render(time,suppressEvents,force):callback||(callback="_dummyGS")),this.vars.onStart&&(0===this._time&&0!==duration||suppressEvents||this._callback("onStart"))),pt=this._firstPT;pt;)pt.f?pt.t[pt.p](pt.c*this.ratio+pt.s):pt.t[pt.p]=pt.c*this.ratio+pt.s,pt=pt._next;this._onUpdate&&(time<0&&this._startAt&&time!==-1e-4&&this._startAt.render(time,suppressEvents,force),suppressEvents||(this._time!==prevTime||isComplete||force)&&this._callback("onUpdate")),callback&&(this._gc&&!force||(time<0&&this._startAt&&!this._onUpdate&&time!==-1e-4&&this._startAt.render(time,suppressEvents,force),isComplete&&(this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!suppressEvents&&this.vars[callback]&&this._callback(callback),0===duration&&this._rawPrevTime===_tinyNum&&rawPrevTime!==_tinyNum&&(this._rawPrevTime=0)))}},p._kill=function(vars,target,overwritingTween){if("all"===vars&&(vars=null),null==vars&&(null==target||target===this.target))return this._lazy=!1,this._enabled(!1,!1);target="string"!=typeof target?target||this._targets||this.target:TweenLite.selector(target)||target;var i,overwrittenProps,p,pt,propLookup,changed,killProps,record,killed,simultaneousOverwrite=overwritingTween&&this._time&&overwritingTween._startTime===this._startTime&&this._timeline===overwritingTween._timeline;if((_isArray(target)||_isSelector(target))&&"number"!=typeof target[0])for(i=target.length;--i>-1;)this._kill(vars,target[i],overwritingTween)&&(changed=!0);else{if(this._targets){for(i=this._targets.length;--i>-1;)if(target===this._targets[i]){propLookup=this._propLookup[i]||{},this._overwrittenProps=this._overwrittenProps||[],overwrittenProps=this._overwrittenProps[i]=vars?this._overwrittenProps[i]||{}:"all";break}}else{if(target!==this.target)return!1;propLookup=this._propLookup,overwrittenProps=this._overwrittenProps=vars?this._overwrittenProps||{}:"all"}if(propLookup){if(killProps=vars||propLookup,record=vars!==overwrittenProps&&"all"!==overwrittenProps&&vars!==propLookup&&("object"!=typeof vars||!vars._tempKill),overwritingTween&&(TweenLite.onOverwrite||this.vars.onOverwrite)){for(p in killProps)propLookup[p]&&(killed||(killed=[]),killed.push(p));if((killed||!vars)&&!_onOverwrite(this,overwritingTween,target,killed))return!1}for(p in killProps)(pt=propLookup[p])&&(simultaneousOverwrite&&(pt.f?pt.t[pt.p](pt.s):pt.t[pt.p]=pt.s,changed=!0),pt.pg&&pt.t._kill(killProps)&&(changed=!0),pt.pg&&0!==pt.t._overwriteProps.length||(pt._prev?pt._prev._next=pt._next:pt===this._firstPT&&(this._firstPT=pt._next),pt._next&&(pt._next._prev=pt._prev),pt._next=pt._prev=null),delete propLookup[p]),record&&(overwrittenProps[p]=1);!this._firstPT&&this._initted&&this._enabled(!1,!1)}}return changed},p.invalidate=function(){return this._notifyPluginsOfEnabled&&TweenLite._onPluginEvent("_onDisable",this),this._firstPT=this._overwrittenProps=this._startAt=this._onUpdate=null,this._notifyPluginsOfEnabled=this._active=this._lazy=!1,this._propLookup=this._targets?{}:[],Animation.prototype.invalidate.call(this),this.vars.immediateRender&&(this._time=-_tinyNum,this.render(Math.min(0,-this._delay))),this},p._enabled=function(enabled,ignoreTimeline){if(_tickerActive||_ticker.wake(),enabled&&this._gc){var i,targets=this._targets;if(targets)for(i=targets.length;--i>-1;)this._siblings[i]=_register(targets[i],this,!0);else this._siblings=_register(this.target,this,!0)}return Animation.prototype._enabled.call(this,enabled,ignoreTimeline),!(!this._notifyPluginsOfEnabled||!this._firstPT)&&TweenLite._onPluginEvent(enabled?"_onEnable":"_onDisable",this)},TweenLite.to=function(target,duration,vars){return new TweenLite(target,duration,vars)},TweenLite.from=function(target,duration,vars){return vars.runBackwards=!0,vars.immediateRender=0!=vars.immediateRender,new TweenLite(target,duration,vars)},TweenLite.fromTo=function(target,duration,fromVars,toVars){return toVars.startAt=fromVars,toVars.immediateRender=0!=toVars.immediateRender&&0!=fromVars.immediateRender,new TweenLite(target,duration,toVars)},TweenLite.delayedCall=function(delay,callback,params,scope,useFrames){return new TweenLite(callback,0,{delay:delay,onComplete:callback,onCompleteParams:params,callbackScope:scope,onReverseComplete:callback,onReverseCompleteParams:params,immediateRender:!1,lazy:!1,useFrames:useFrames,overwrite:0})},TweenLite.set=function(target,vars){return new TweenLite(target,0,vars)},TweenLite.getTweensOf=function(target,onlyActive){if(null==target)return[];target="string"!=typeof target?target:TweenLite.selector(target)||target;var i,a,j,t;if((_isArray(target)||_isSelector(target))&&"number"!=typeof target[0]){for(i=target.length,a=[];--i>-1;)a=a.concat(TweenLite.getTweensOf(target[i],onlyActive));for(i=a.length;--i>-1;)for(t=a[i],j=i;--j>-1;)t===a[j]&&a.splice(i,1)}else for(a=_register(target).concat(),i=a.length;--i>-1;)(a[i]._gc||onlyActive&&!a[i].isActive())&&a.splice(i,1);return a},TweenLite.killTweensOf=TweenLite.killDelayedCallsTo=function(target,onlyActive,vars){"object"==typeof onlyActive&&(vars=onlyActive,onlyActive=!1);for(var a=TweenLite.getTweensOf(target,onlyActive),i=a.length;--i>-1;)a[i]._kill(vars,target)};var TweenPlugin=_class("plugins.TweenPlugin",function(props,priority){this._overwriteProps=(props||"").split(","),this._propName=this._overwriteProps[0],this._priority=priority||0,this._super=TweenPlugin.prototype},!0);if(p=TweenPlugin.prototype,TweenPlugin.version="1.19.0",TweenPlugin.API=2,p._firstPT=null,p._addTween=_addPropTween,p.setRatio=_setRatio,p._kill=function(lookup){var i,a=this._overwriteProps,pt=this._firstPT;if(null!=lookup[this._propName])this._overwriteProps=[];else for(i=a.length;--i>-1;)null!=lookup[a[i]]&&a.splice(i,1);for(;pt;)null!=lookup[pt.n]&&(pt._next&&(pt._next._prev=pt._prev),pt._prev?(pt._prev._next=pt._next,pt._prev=null):this._firstPT===pt&&(this._firstPT=pt._next)),pt=pt._next;return!1},p._mod=p._roundProps=function(lookup){for(var val,pt=this._firstPT;pt;)val=lookup[this._propName]||null!=pt.n&&lookup[pt.n.split(this._propName+"_").join("")],val&&"function"==typeof val&&(2===pt.f?pt.t._applyPT.m=val:pt.m=val),pt=pt._next},TweenLite._onPluginEvent=function(type,tween){var changed,pt2,first,last,next,pt=tween._firstPT;if("_onInitAllProps"===type){for(;pt;){for(next=pt._next,pt2=first;pt2&&pt2.pr>pt.pr;)pt2=pt2._next;(pt._prev=pt2?pt2._prev:last)?pt._prev._next=pt:first=pt,(pt._next=pt2)?pt2._prev=pt:last=pt,pt=next}pt=tween._firstPT=first}for(;pt;)pt.pg&&"function"==typeof pt.t[type]&&pt.t[type]()&&(changed=!0),pt=pt._next;return changed},TweenPlugin.activate=function(plugins){for(var i=plugins.length;--i>-1;)plugins[i].API===TweenPlugin.API&&(_plugins[(new plugins[i])._propName]=plugins[i]);return!0},_gsDefine.plugin=function(config){if(!(config&&config.propName&&config.init&&config.API))throw"illegal plugin definition.";var prop,propName=config.propName,priority=config.priority||0,overwriteProps=config.overwriteProps,map={init:"_onInitTween",set:"setRatio",kill:"_kill",round:"_mod",mod:"_mod",initAll:"_onInitAllProps"},Plugin=_class("plugins."+propName.charAt(0).toUpperCase()+propName.substr(1)+"Plugin",function(){TweenPlugin.call(this,propName,priority),this._overwriteProps=overwriteProps||[]},config.global===!0),p=Plugin.prototype=new TweenPlugin(propName);p.constructor=Plugin,Plugin.API=config.API;for(prop in map)"function"==typeof config[prop]&&(p[map[prop]]=config[prop]);return Plugin.version=config.version,TweenPlugin.activate([Plugin]),Plugin},a=window._gsQueue){for(i=0;i<a.length;i++)a[i]();for(p in _defLookup)_defLookup[p].func||window.console.log("GSAP encountered missing dependency: "+p)}_tickerActive=!1}}("undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window,"TweenMax")}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],102:[function(_dereq_,module,exports){!function(window,document,exportName,undefined){"use strict";function setTimeoutContext(fn,timeout,context){return setTimeout(bindFn(fn,context),timeout)}function invokeArrayArg(arg,fn,context){return!!Array.isArray(arg)&&(each(arg,context[fn],context),!0)}function each(obj,iterator,context){var i;if(obj)if(obj.forEach)obj.forEach(iterator,context);else if(obj.length!==undefined)for(i=0;i<obj.length;)iterator.call(context,obj[i],i,obj),i++;else for(i in obj)obj.hasOwnProperty(i)&&iterator.call(context,obj[i],i,obj)}function deprecate(method,name,message){var deprecationMessage="DEPRECATED METHOD: "+name+"\n"+message+" AT \n";return function(){var e=new Error("get-stack-trace"),stack=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",log=window.console&&(window.console.warn||window.console.log);return log&&log.call(window.console,deprecationMessage,stack),method.apply(this,arguments)}}function inherit(child,base,properties){var childP,baseP=base.prototype;childP=child.prototype=Object.create(baseP),childP.constructor=child,childP._super=baseP,properties&&assign(childP,properties)}function bindFn(fn,context){return function(){return fn.apply(context,arguments)}}function boolOrFn(val,args){return typeof val==TYPE_FUNCTION?val.apply(args?args[0]||undefined:undefined,args):val}function ifUndefined(val1,val2){return val1===undefined?val2:val1}function addEventListeners(target,types,handler){each(splitStr(types),function(type){target.addEventListener(type,handler,!1)})}function removeEventListeners(target,types,handler){each(splitStr(types),function(type){target.removeEventListener(type,handler,!1)})}function hasParent(node,parent){for(;node;){if(node==parent)return!0;node=node.parentNode}return!1}function inStr(str,find){return str.indexOf(find)>-1}function splitStr(str){return str.trim().split(/\s+/g)}function inArray(src,find,findByKey){if(src.indexOf&&!findByKey)return src.indexOf(find);for(var i=0;i<src.length;){if(findByKey&&src[i][findByKey]==find||!findByKey&&src[i]===find)return i;i++}return-1}function toArray(obj){return Array.prototype.slice.call(obj,0)}function uniqueArray(src,key,sort){for(var results=[],values=[],i=0;i<src.length;){var val=key?src[i][key]:src[i];inArray(values,val)<0&&results.push(src[i]),values[i]=val,i++}return sort&&(results=key?results.sort(function(a,b){return a[key]>b[key]}):results.sort()),results}function prefixed(obj,property){for(var prefix,prop,camelProp=property[0].toUpperCase()+property.slice(1),i=0;i<VENDOR_PREFIXES.length;){if(prefix=VENDOR_PREFIXES[i],prop=prefix?prefix+camelProp:property,prop in obj)return prop;i++}return undefined}function uniqueId(){return _uniqueId++}function getWindowForElement(element){var doc=element.ownerDocument||element;return doc.defaultView||doc.parentWindow||window}function Input(manager,callback){var self=this;this.manager=manager,this.callback=callback,this.element=manager.element,this.target=manager.options.inputTarget,this.domHandler=function(ev){boolOrFn(manager.options.enable,[manager])&&self.handler(ev)},this.init()}function createInputInstance(manager){var Type,inputClass=manager.options.inputClass;return new(Type=inputClass?inputClass:SUPPORT_POINTER_EVENTS?PointerEventInput:SUPPORT_ONLY_TOUCH?TouchInput:SUPPORT_TOUCH?TouchMouseInput:MouseInput)(manager,inputHandler)}function inputHandler(manager,eventType,input){var pointersLen=input.pointers.length,changedPointersLen=input.changedPointers.length,isFirst=eventType&INPUT_START&&pointersLen-changedPointersLen===0,isFinal=eventType&(INPUT_END|INPUT_CANCEL)&&pointersLen-changedPointersLen===0;input.isFirst=!!isFirst,input.isFinal=!!isFinal,isFirst&&(manager.session={}),input.eventType=eventType,computeInputData(manager,input),manager.emit("hammer.input",input),manager.recognize(input),manager.session.prevInput=input}function computeInputData(manager,input){var session=manager.session,pointers=input.pointers,pointersLength=pointers.length;session.firstInput||(session.firstInput=simpleCloneInputData(input)),pointersLength>1&&!session.firstMultiple?session.firstMultiple=simpleCloneInputData(input):1===pointersLength&&(session.firstMultiple=!1);var firstInput=session.firstInput,firstMultiple=session.firstMultiple,offsetCenter=firstMultiple?firstMultiple.center:firstInput.center,center=input.center=getCenter(pointers);input.timeStamp=now(),input.deltaTime=input.timeStamp-firstInput.timeStamp,input.angle=getAngle(offsetCenter,center),input.distance=getDistance(offsetCenter,center),computeDeltaXY(session,input),input.offsetDirection=getDirection(input.deltaX,input.deltaY);var overallVelocity=getVelocity(input.deltaTime,input.deltaX,input.deltaY);input.overallVelocityX=overallVelocity.x,input.overallVelocityY=overallVelocity.y,input.overallVelocity=abs(overallVelocity.x)>abs(overallVelocity.y)?overallVelocity.x:overallVelocity.y,input.scale=firstMultiple?getScale(firstMultiple.pointers,pointers):1,input.rotation=firstMultiple?getRotation(firstMultiple.pointers,pointers):0,input.maxPointers=session.prevInput?input.pointers.length>session.prevInput.maxPointers?input.pointers.length:session.prevInput.maxPointers:input.pointers.length,computeIntervalInputData(session,input);
var target=manager.element;hasParent(input.srcEvent.target,target)&&(target=input.srcEvent.target),input.target=target}function computeDeltaXY(session,input){var center=input.center,offset=session.offsetDelta||{},prevDelta=session.prevDelta||{},prevInput=session.prevInput||{};input.eventType!==INPUT_START&&prevInput.eventType!==INPUT_END||(prevDelta=session.prevDelta={x:prevInput.deltaX||0,y:prevInput.deltaY||0},offset=session.offsetDelta={x:center.x,y:center.y}),input.deltaX=prevDelta.x+(center.x-offset.x),input.deltaY=prevDelta.y+(center.y-offset.y)}function computeIntervalInputData(session,input){var velocity,velocityX,velocityY,direction,last=session.lastInterval||input,deltaTime=input.timeStamp-last.timeStamp;if(input.eventType!=INPUT_CANCEL&&(deltaTime>COMPUTE_INTERVAL||last.velocity===undefined)){var deltaX=input.deltaX-last.deltaX,deltaY=input.deltaY-last.deltaY,v=getVelocity(deltaTime,deltaX,deltaY);velocityX=v.x,velocityY=v.y,velocity=abs(v.x)>abs(v.y)?v.x:v.y,direction=getDirection(deltaX,deltaY),session.lastInterval=input}else velocity=last.velocity,velocityX=last.velocityX,velocityY=last.velocityY,direction=last.direction;input.velocity=velocity,input.velocityX=velocityX,input.velocityY=velocityY,input.direction=direction}function simpleCloneInputData(input){for(var pointers=[],i=0;i<input.pointers.length;)pointers[i]={clientX:round(input.pointers[i].clientX),clientY:round(input.pointers[i].clientY)},i++;return{timeStamp:now(),pointers:pointers,center:getCenter(pointers),deltaX:input.deltaX,deltaY:input.deltaY}}function getCenter(pointers){var pointersLength=pointers.length;if(1===pointersLength)return{x:round(pointers[0].clientX),y:round(pointers[0].clientY)};for(var x=0,y=0,i=0;i<pointersLength;)x+=pointers[i].clientX,y+=pointers[i].clientY,i++;return{x:round(x/pointersLength),y:round(y/pointersLength)}}function getVelocity(deltaTime,x,y){return{x:x/deltaTime||0,y:y/deltaTime||0}}function getDirection(x,y){return x===y?DIRECTION_NONE:abs(x)>=abs(y)?x<0?DIRECTION_LEFT:DIRECTION_RIGHT:y<0?DIRECTION_UP:DIRECTION_DOWN}function getDistance(p1,p2,props){props||(props=PROPS_XY);var x=p2[props[0]]-p1[props[0]],y=p2[props[1]]-p1[props[1]];return Math.sqrt(x*x+y*y)}function getAngle(p1,p2,props){props||(props=PROPS_XY);var x=p2[props[0]]-p1[props[0]],y=p2[props[1]]-p1[props[1]];return 180*Math.atan2(y,x)/Math.PI}function getRotation(start,end){return getAngle(end[1],end[0],PROPS_CLIENT_XY)+getAngle(start[1],start[0],PROPS_CLIENT_XY)}function getScale(start,end){return getDistance(end[0],end[1],PROPS_CLIENT_XY)/getDistance(start[0],start[1],PROPS_CLIENT_XY)}function MouseInput(){this.evEl=MOUSE_ELEMENT_EVENTS,this.evWin=MOUSE_WINDOW_EVENTS,this.pressed=!1,Input.apply(this,arguments)}function PointerEventInput(){this.evEl=POINTER_ELEMENT_EVENTS,this.evWin=POINTER_WINDOW_EVENTS,Input.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function SingleTouchInput(){this.evTarget=SINGLE_TOUCH_TARGET_EVENTS,this.evWin=SINGLE_TOUCH_WINDOW_EVENTS,this.started=!1,Input.apply(this,arguments)}function normalizeSingleTouches(ev,type){var all=toArray(ev.touches),changed=toArray(ev.changedTouches);return type&(INPUT_END|INPUT_CANCEL)&&(all=uniqueArray(all.concat(changed),"identifier",!0)),[all,changed]}function TouchInput(){this.evTarget=TOUCH_TARGET_EVENTS,this.targetIds={},Input.apply(this,arguments)}function getTouches(ev,type){var allTouches=toArray(ev.touches),targetIds=this.targetIds;if(type&(INPUT_START|INPUT_MOVE)&&1===allTouches.length)return targetIds[allTouches[0].identifier]=!0,[allTouches,allTouches];var i,targetTouches,changedTouches=toArray(ev.changedTouches),changedTargetTouches=[],target=this.target;if(targetTouches=allTouches.filter(function(touch){return hasParent(touch.target,target)}),type===INPUT_START)for(i=0;i<targetTouches.length;)targetIds[targetTouches[i].identifier]=!0,i++;for(i=0;i<changedTouches.length;)targetIds[changedTouches[i].identifier]&&changedTargetTouches.push(changedTouches[i]),type&(INPUT_END|INPUT_CANCEL)&&delete targetIds[changedTouches[i].identifier],i++;return changedTargetTouches.length?[uniqueArray(targetTouches.concat(changedTargetTouches),"identifier",!0),changedTargetTouches]:void 0}function TouchMouseInput(){Input.apply(this,arguments);var handler=bindFn(this.handler,this);this.touch=new TouchInput(this.manager,handler),this.mouse=new MouseInput(this.manager,handler),this.primaryTouch=null,this.lastTouches=[]}function recordTouches(eventType,eventData){eventType&INPUT_START?(this.primaryTouch=eventData.changedPointers[0].identifier,setLastTouch.call(this,eventData)):eventType&(INPUT_END|INPUT_CANCEL)&&setLastTouch.call(this,eventData)}function setLastTouch(eventData){var touch=eventData.changedPointers[0];if(touch.identifier===this.primaryTouch){var lastTouch={x:touch.clientX,y:touch.clientY};this.lastTouches.push(lastTouch);var lts=this.lastTouches,removeLastTouch=function(){var i=lts.indexOf(lastTouch);i>-1&&lts.splice(i,1)};setTimeout(removeLastTouch,DEDUP_TIMEOUT)}}function isSyntheticEvent(eventData){for(var x=eventData.srcEvent.clientX,y=eventData.srcEvent.clientY,i=0;i<this.lastTouches.length;i++){var t=this.lastTouches[i],dx=Math.abs(x-t.x),dy=Math.abs(y-t.y);if(dx<=DEDUP_DISTANCE&&dy<=DEDUP_DISTANCE)return!0}return!1}function TouchAction(manager,value){this.manager=manager,this.set(value)}function cleanTouchActions(actions){if(inStr(actions,TOUCH_ACTION_NONE))return TOUCH_ACTION_NONE;var hasPanX=inStr(actions,TOUCH_ACTION_PAN_X),hasPanY=inStr(actions,TOUCH_ACTION_PAN_Y);return hasPanX&&hasPanY?TOUCH_ACTION_NONE:hasPanX||hasPanY?hasPanX?TOUCH_ACTION_PAN_X:TOUCH_ACTION_PAN_Y:inStr(actions,TOUCH_ACTION_MANIPULATION)?TOUCH_ACTION_MANIPULATION:TOUCH_ACTION_AUTO}function getTouchActionProps(){if(!NATIVE_TOUCH_ACTION)return!1;var touchMap={},cssSupports=window.CSS&&window.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(val){touchMap[val]=!cssSupports||window.CSS.supports("touch-action",val)}),touchMap}function Recognizer(options){this.options=assign({},this.defaults,options||{}),this.id=uniqueId(),this.manager=null,this.options.enable=ifUndefined(this.options.enable,!0),this.state=STATE_POSSIBLE,this.simultaneous={},this.requireFail=[]}function stateStr(state){return state&STATE_CANCELLED?"cancel":state&STATE_ENDED?"end":state&STATE_CHANGED?"move":state&STATE_BEGAN?"start":""}function directionStr(direction){return direction==DIRECTION_DOWN?"down":direction==DIRECTION_UP?"up":direction==DIRECTION_LEFT?"left":direction==DIRECTION_RIGHT?"right":""}function getRecognizerByNameIfManager(otherRecognizer,recognizer){var manager=recognizer.manager;return manager?manager.get(otherRecognizer):otherRecognizer}function AttrRecognizer(){Recognizer.apply(this,arguments)}function PanRecognizer(){AttrRecognizer.apply(this,arguments),this.pX=null,this.pY=null}function PinchRecognizer(){AttrRecognizer.apply(this,arguments)}function PressRecognizer(){Recognizer.apply(this,arguments),this._timer=null,this._input=null}function RotateRecognizer(){AttrRecognizer.apply(this,arguments)}function SwipeRecognizer(){AttrRecognizer.apply(this,arguments)}function TapRecognizer(){Recognizer.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Hammer(element,options){return options=options||{},options.recognizers=ifUndefined(options.recognizers,Hammer.defaults.preset),new Manager(element,options)}function Manager(element,options){this.options=assign({},Hammer.defaults,options||{}),this.options.inputTarget=this.options.inputTarget||element,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=element,this.input=createInputInstance(this),this.touchAction=new TouchAction(this,this.options.touchAction),toggleCssProps(this,!0),each(this.options.recognizers,function(item){var recognizer=this.add(new item[0](item[1]));item[2]&&recognizer.recognizeWith(item[2]),item[3]&&recognizer.requireFailure(item[3])},this)}function toggleCssProps(manager,add){var element=manager.element;if(element.style){var prop;each(manager.options.cssProps,function(value,name){prop=prefixed(element.style,name),add?(manager.oldCssProps[prop]=element.style[prop],element.style[prop]=value):element.style[prop]=manager.oldCssProps[prop]||""}),add||(manager.oldCssProps={})}}function triggerDomEvent(event,data){var gestureEvent=document.createEvent("Event");gestureEvent.initEvent(event,!0,!0),gestureEvent.gesture=data,data.target.dispatchEvent(gestureEvent)}var assign,VENDOR_PREFIXES=["","webkit","Moz","MS","ms","o"],TEST_ELEMENT=document.createElement("div"),TYPE_FUNCTION="function",round=Math.round,abs=Math.abs,now=Date.now;assign="function"!=typeof Object.assign?function(target){if(target===undefined||null===target)throw new TypeError("Cannot convert undefined or null to object");for(var output=Object(target),index=1;index<arguments.length;index++){var source=arguments[index];if(source!==undefined&&null!==source)for(var nextKey in source)source.hasOwnProperty(nextKey)&&(output[nextKey]=source[nextKey])}return output}:Object.assign;var extend=deprecate(function(dest,src,merge){for(var keys=Object.keys(src),i=0;i<keys.length;)(!merge||merge&&dest[keys[i]]===undefined)&&(dest[keys[i]]=src[keys[i]]),i++;return dest},"extend","Use `assign`."),merge=deprecate(function(dest,src){return extend(dest,src,!0)},"merge","Use `assign`."),_uniqueId=1,MOBILE_REGEX=/mobile|tablet|ip(ad|hone|od)|android/i,SUPPORT_TOUCH="ontouchstart"in window,SUPPORT_POINTER_EVENTS=prefixed(window,"PointerEvent")!==undefined,SUPPORT_ONLY_TOUCH=SUPPORT_TOUCH&&MOBILE_REGEX.test(navigator.userAgent),INPUT_TYPE_TOUCH="touch",INPUT_TYPE_PEN="pen",INPUT_TYPE_MOUSE="mouse",INPUT_TYPE_KINECT="kinect",COMPUTE_INTERVAL=25,INPUT_START=1,INPUT_MOVE=2,INPUT_END=4,INPUT_CANCEL=8,DIRECTION_NONE=1,DIRECTION_LEFT=2,DIRECTION_RIGHT=4,DIRECTION_UP=8,DIRECTION_DOWN=16,DIRECTION_HORIZONTAL=DIRECTION_LEFT|DIRECTION_RIGHT,DIRECTION_VERTICAL=DIRECTION_UP|DIRECTION_DOWN,DIRECTION_ALL=DIRECTION_HORIZONTAL|DIRECTION_VERTICAL,PROPS_XY=["x","y"],PROPS_CLIENT_XY=["clientX","clientY"];Input.prototype={handler:function(){},init:function(){this.evEl&&addEventListeners(this.element,this.evEl,this.domHandler),this.evTarget&&addEventListeners(this.target,this.evTarget,this.domHandler),this.evWin&&addEventListeners(getWindowForElement(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&removeEventListeners(this.element,this.evEl,this.domHandler),this.evTarget&&removeEventListeners(this.target,this.evTarget,this.domHandler),this.evWin&&removeEventListeners(getWindowForElement(this.element),this.evWin,this.domHandler)}};var MOUSE_INPUT_MAP={mousedown:INPUT_START,mousemove:INPUT_MOVE,mouseup:INPUT_END},MOUSE_ELEMENT_EVENTS="mousedown",MOUSE_WINDOW_EVENTS="mousemove mouseup";inherit(MouseInput,Input,{handler:function(ev){var eventType=MOUSE_INPUT_MAP[ev.type];eventType&INPUT_START&&0===ev.button&&(this.pressed=!0),eventType&INPUT_MOVE&&1!==ev.which&&(eventType=INPUT_END),this.pressed&&(eventType&INPUT_END&&(this.pressed=!1),this.callback(this.manager,eventType,{pointers:[ev],changedPointers:[ev],pointerType:INPUT_TYPE_MOUSE,srcEvent:ev}))}});var POINTER_INPUT_MAP={pointerdown:INPUT_START,pointermove:INPUT_MOVE,pointerup:INPUT_END,pointercancel:INPUT_CANCEL,pointerout:INPUT_CANCEL},IE10_POINTER_TYPE_ENUM={2:INPUT_TYPE_TOUCH,3:INPUT_TYPE_PEN,4:INPUT_TYPE_MOUSE,5:INPUT_TYPE_KINECT},POINTER_ELEMENT_EVENTS="pointerdown",POINTER_WINDOW_EVENTS="pointermove pointerup pointercancel";window.MSPointerEvent&&!window.PointerEvent&&(POINTER_ELEMENT_EVENTS="MSPointerDown",POINTER_WINDOW_EVENTS="MSPointerMove MSPointerUp MSPointerCancel"),inherit(PointerEventInput,Input,{handler:function(ev){var store=this.store,removePointer=!1,eventTypeNormalized=ev.type.toLowerCase().replace("ms",""),eventType=POINTER_INPUT_MAP[eventTypeNormalized],pointerType=IE10_POINTER_TYPE_ENUM[ev.pointerType]||ev.pointerType,isTouch=pointerType==INPUT_TYPE_TOUCH,storeIndex=inArray(store,ev.pointerId,"pointerId");eventType&INPUT_START&&(0===ev.button||isTouch)?storeIndex<0&&(store.push(ev),storeIndex=store.length-1):eventType&(INPUT_END|INPUT_CANCEL)&&(removePointer=!0),storeIndex<0||(store[storeIndex]=ev,this.callback(this.manager,eventType,{pointers:store,changedPointers:[ev],pointerType:pointerType,srcEvent:ev}),removePointer&&store.splice(storeIndex,1))}});var SINGLE_TOUCH_INPUT_MAP={touchstart:INPUT_START,touchmove:INPUT_MOVE,touchend:INPUT_END,touchcancel:INPUT_CANCEL},SINGLE_TOUCH_TARGET_EVENTS="touchstart",SINGLE_TOUCH_WINDOW_EVENTS="touchstart touchmove touchend touchcancel";inherit(SingleTouchInput,Input,{handler:function(ev){var type=SINGLE_TOUCH_INPUT_MAP[ev.type];if(type===INPUT_START&&(this.started=!0),this.started){var touches=normalizeSingleTouches.call(this,ev,type);type&(INPUT_END|INPUT_CANCEL)&&touches[0].length-touches[1].length===0&&(this.started=!1),this.callback(this.manager,type,{pointers:touches[0],changedPointers:touches[1],pointerType:INPUT_TYPE_TOUCH,srcEvent:ev})}}});var TOUCH_INPUT_MAP={touchstart:INPUT_START,touchmove:INPUT_MOVE,touchend:INPUT_END,touchcancel:INPUT_CANCEL},TOUCH_TARGET_EVENTS="touchstart touchmove touchend touchcancel";inherit(TouchInput,Input,{handler:function(ev){var type=TOUCH_INPUT_MAP[ev.type],touches=getTouches.call(this,ev,type);touches&&this.callback(this.manager,type,{pointers:touches[0],changedPointers:touches[1],pointerType:INPUT_TYPE_TOUCH,srcEvent:ev})}});var DEDUP_TIMEOUT=2500,DEDUP_DISTANCE=25;inherit(TouchMouseInput,Input,{handler:function(manager,inputEvent,inputData){var isTouch=inputData.pointerType==INPUT_TYPE_TOUCH,isMouse=inputData.pointerType==INPUT_TYPE_MOUSE;if(!(isMouse&&inputData.sourceCapabilities&&inputData.sourceCapabilities.firesTouchEvents)){if(isTouch)recordTouches.call(this,inputEvent,inputData);else if(isMouse&&isSyntheticEvent.call(this,inputData))return;this.callback(manager,inputEvent,inputData)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var PREFIXED_TOUCH_ACTION=prefixed(TEST_ELEMENT.style,"touchAction"),NATIVE_TOUCH_ACTION=PREFIXED_TOUCH_ACTION!==undefined,TOUCH_ACTION_COMPUTE="compute",TOUCH_ACTION_AUTO="auto",TOUCH_ACTION_MANIPULATION="manipulation",TOUCH_ACTION_NONE="none",TOUCH_ACTION_PAN_X="pan-x",TOUCH_ACTION_PAN_Y="pan-y",TOUCH_ACTION_MAP=getTouchActionProps();TouchAction.prototype={set:function(value){value==TOUCH_ACTION_COMPUTE&&(value=this.compute()),NATIVE_TOUCH_ACTION&&this.manager.element.style&&TOUCH_ACTION_MAP[value]&&(this.manager.element.style[PREFIXED_TOUCH_ACTION]=value),this.actions=value.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var actions=[];return each(this.manager.recognizers,function(recognizer){boolOrFn(recognizer.options.enable,[recognizer])&&(actions=actions.concat(recognizer.getTouchAction()))}),cleanTouchActions(actions.join(" "))},preventDefaults:function(input){var srcEvent=input.srcEvent,direction=input.offsetDirection;if(this.manager.session.prevented)return void srcEvent.preventDefault();var actions=this.actions,hasNone=inStr(actions,TOUCH_ACTION_NONE)&&!TOUCH_ACTION_MAP[TOUCH_ACTION_NONE],hasPanY=inStr(actions,TOUCH_ACTION_PAN_Y)&&!TOUCH_ACTION_MAP[TOUCH_ACTION_PAN_Y],hasPanX=inStr(actions,TOUCH_ACTION_PAN_X)&&!TOUCH_ACTION_MAP[TOUCH_ACTION_PAN_X];if(hasNone){var isTapPointer=1===input.pointers.length,isTapMovement=input.distance<2,isTapTouchTime=input.deltaTime<250;if(isTapPointer&&isTapMovement&&isTapTouchTime)return}return hasPanX&&hasPanY?void 0:hasNone||hasPanY&&direction&DIRECTION_HORIZONTAL||hasPanX&&direction&DIRECTION_VERTICAL?this.preventSrc(srcEvent):void 0},preventSrc:function(srcEvent){this.manager.session.prevented=!0,srcEvent.preventDefault()}};var STATE_POSSIBLE=1,STATE_BEGAN=2,STATE_CHANGED=4,STATE_ENDED=8,STATE_RECOGNIZED=STATE_ENDED,STATE_CANCELLED=16,STATE_FAILED=32;Recognizer.prototype={defaults:{},set:function(options){return assign(this.options,options),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(otherRecognizer){if(invokeArrayArg(otherRecognizer,"recognizeWith",this))return this;var simultaneous=this.simultaneous;return otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this),simultaneous[otherRecognizer.id]||(simultaneous[otherRecognizer.id]=otherRecognizer,otherRecognizer.recognizeWith(this)),this},dropRecognizeWith:function(otherRecognizer){return invokeArrayArg(otherRecognizer,"dropRecognizeWith",this)?this:(otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this),delete this.simultaneous[otherRecognizer.id],this)},requireFailure:function(otherRecognizer){if(invokeArrayArg(otherRecognizer,"requireFailure",this))return this;var requireFail=this.requireFail;return otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this),inArray(requireFail,otherRecognizer)===-1&&(requireFail.push(otherRecognizer),otherRecognizer.requireFailure(this)),this},dropRequireFailure:function(otherRecognizer){if(invokeArrayArg(otherRecognizer,"dropRequireFailure",this))return this;otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this);var index=inArray(this.requireFail,otherRecognizer);return index>-1&&this.requireFail.splice(index,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(otherRecognizer){return!!this.simultaneous[otherRecognizer.id]},emit:function(input){function emit(event){self.manager.emit(event,input)}var self=this,state=this.state;state<STATE_ENDED&&emit(self.options.event+stateStr(state)),emit(self.options.event),input.additionalEvent&&emit(input.additionalEvent),state>=STATE_ENDED&&emit(self.options.event+stateStr(state))},tryEmit:function(input){return this.canEmit()?this.emit(input):void(this.state=STATE_FAILED)},canEmit:function(){for(var i=0;i<this.requireFail.length;){if(!(this.requireFail[i].state&(STATE_FAILED|STATE_POSSIBLE)))return!1;i++}return!0},recognize:function(inputData){var inputDataClone=assign({},inputData);return boolOrFn(this.options.enable,[this,inputDataClone])?(this.state&(STATE_RECOGNIZED|STATE_CANCELLED|STATE_FAILED)&&(this.state=STATE_POSSIBLE),this.state=this.process(inputDataClone),void(this.state&(STATE_BEGAN|STATE_CHANGED|STATE_ENDED|STATE_CANCELLED)&&this.tryEmit(inputDataClone))):(this.reset(),void(this.state=STATE_FAILED))},process:function(inputData){},getTouchAction:function(){},reset:function(){}},inherit(AttrRecognizer,Recognizer,{defaults:{pointers:1},attrTest:function(input){var optionPointers=this.options.pointers;return 0===optionPointers||input.pointers.length===optionPointers},process:function(input){var state=this.state,eventType=input.eventType,isRecognized=state&(STATE_BEGAN|STATE_CHANGED),isValid=this.attrTest(input);return isRecognized&&(eventType&INPUT_CANCEL||!isValid)?state|STATE_CANCELLED:isRecognized||isValid?eventType&INPUT_END?state|STATE_ENDED:state&STATE_BEGAN?state|STATE_CHANGED:STATE_BEGAN:STATE_FAILED}}),inherit(PanRecognizer,AttrRecognizer,{defaults:{event:"pan",threshold:10,pointers:1,direction:DIRECTION_ALL},getTouchAction:function(){var direction=this.options.direction,actions=[];return direction&DIRECTION_HORIZONTAL&&actions.push(TOUCH_ACTION_PAN_Y),direction&DIRECTION_VERTICAL&&actions.push(TOUCH_ACTION_PAN_X),actions},directionTest:function(input){var options=this.options,hasMoved=!0,distance=input.distance,direction=input.direction,x=input.deltaX,y=input.deltaY;return direction&options.direction||(options.direction&DIRECTION_HORIZONTAL?(direction=0===x?DIRECTION_NONE:x<0?DIRECTION_LEFT:DIRECTION_RIGHT,hasMoved=x!=this.pX,distance=Math.abs(input.deltaX)):(direction=0===y?DIRECTION_NONE:y<0?DIRECTION_UP:DIRECTION_DOWN,hasMoved=y!=this.pY,distance=Math.abs(input.deltaY))),input.direction=direction,hasMoved&&distance>options.threshold&&direction&options.direction},attrTest:function(input){return AttrRecognizer.prototype.attrTest.call(this,input)&&(this.state&STATE_BEGAN||!(this.state&STATE_BEGAN)&&this.directionTest(input))},emit:function(input){this.pX=input.deltaX,this.pY=input.deltaY;var direction=directionStr(input.direction);direction&&(input.additionalEvent=this.options.event+direction),this._super.emit.call(this,input)}}),inherit(PinchRecognizer,AttrRecognizer,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[TOUCH_ACTION_NONE]},attrTest:function(input){return this._super.attrTest.call(this,input)&&(Math.abs(input.scale-1)>this.options.threshold||this.state&STATE_BEGAN)},emit:function(input){if(1!==input.scale){var inOut=input.scale<1?"in":"out";input.additionalEvent=this.options.event+inOut}this._super.emit.call(this,input)}}),inherit(PressRecognizer,Recognizer,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[TOUCH_ACTION_AUTO]},process:function(input){var options=this.options,validPointers=input.pointers.length===options.pointers,validMovement=input.distance<options.threshold,validTime=input.deltaTime>options.time;if(this._input=input,!validMovement||!validPointers||input.eventType&(INPUT_END|INPUT_CANCEL)&&!validTime)this.reset();else if(input.eventType&INPUT_START)this.reset(),this._timer=setTimeoutContext(function(){this.state=STATE_RECOGNIZED,this.tryEmit()},options.time,this);else if(input.eventType&INPUT_END)return STATE_RECOGNIZED;return STATE_FAILED},reset:function(){clearTimeout(this._timer)},emit:function(input){this.state===STATE_RECOGNIZED&&(input&&input.eventType&INPUT_END?this.manager.emit(this.options.event+"up",input):(this._input.timeStamp=now(),this.manager.emit(this.options.event,this._input)))}}),inherit(RotateRecognizer,AttrRecognizer,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[TOUCH_ACTION_NONE]},attrTest:function(input){return this._super.attrTest.call(this,input)&&(Math.abs(input.rotation)>this.options.threshold||this.state&STATE_BEGAN)}}),inherit(SwipeRecognizer,AttrRecognizer,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:DIRECTION_HORIZONTAL|DIRECTION_VERTICAL,pointers:1},getTouchAction:function(){return PanRecognizer.prototype.getTouchAction.call(this)},attrTest:function(input){var velocity,direction=this.options.direction;return direction&(DIRECTION_HORIZONTAL|DIRECTION_VERTICAL)?velocity=input.overallVelocity:direction&DIRECTION_HORIZONTAL?velocity=input.overallVelocityX:direction&DIRECTION_VERTICAL&&(velocity=input.overallVelocityY),this._super.attrTest.call(this,input)&&direction&input.offsetDirection&&input.distance>this.options.threshold&&input.maxPointers==this.options.pointers&&abs(velocity)>this.options.velocity&&input.eventType&INPUT_END},emit:function(input){var direction=directionStr(input.offsetDirection);direction&&this.manager.emit(this.options.event+direction,input),this.manager.emit(this.options.event,input)}}),inherit(TapRecognizer,Recognizer,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[TOUCH_ACTION_MANIPULATION]},process:function(input){var options=this.options,validPointers=input.pointers.length===options.pointers,validMovement=input.distance<options.threshold,validTouchTime=input.deltaTime<options.time;if(this.reset(),input.eventType&INPUT_START&&0===this.count)return this.failTimeout();if(validMovement&&validTouchTime&&validPointers){if(input.eventType!=INPUT_END)return this.failTimeout();var validInterval=!this.pTime||input.timeStamp-this.pTime<options.interval,validMultiTap=!this.pCenter||getDistance(this.pCenter,input.center)<options.posThreshold;this.pTime=input.timeStamp,this.pCenter=input.center,validMultiTap&&validInterval?this.count+=1:this.count=1,this._input=input;var tapCount=this.count%options.taps;if(0===tapCount)return this.hasRequireFailures()?(this._timer=setTimeoutContext(function(){this.state=STATE_RECOGNIZED,this.tryEmit()},options.interval,this),STATE_BEGAN):STATE_RECOGNIZED}return STATE_FAILED},failTimeout:function(){return this._timer=setTimeoutContext(function(){this.state=STATE_FAILED},this.options.interval,this),STATE_FAILED},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==STATE_RECOGNIZED&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Hammer.VERSION="2.0.7",Hammer.defaults={domEvents:!1,touchAction:TOUCH_ACTION_COMPUTE,enable:!0,inputTarget:null,inputClass:null,preset:[[RotateRecognizer,{enable:!1}],[PinchRecognizer,{enable:!1},["rotate"]],[SwipeRecognizer,{direction:DIRECTION_HORIZONTAL}],[PanRecognizer,{direction:DIRECTION_HORIZONTAL},["swipe"]],[TapRecognizer],[TapRecognizer,{event:"doubletap",taps:2},["tap"]],[PressRecognizer]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var STOP=1,FORCED_STOP=2;Manager.prototype={set:function(options){return assign(this.options,options),options.touchAction&&this.touchAction.update(),options.inputTarget&&(this.input.destroy(),this.input.target=options.inputTarget,this.input.init()),this},stop:function(force){this.session.stopped=force?FORCED_STOP:STOP},recognize:function(inputData){var session=this.session;if(!session.stopped){this.touchAction.preventDefaults(inputData);var recognizer,recognizers=this.recognizers,curRecognizer=session.curRecognizer;(!curRecognizer||curRecognizer&&curRecognizer.state&STATE_RECOGNIZED)&&(curRecognizer=session.curRecognizer=null);for(var i=0;i<recognizers.length;)recognizer=recognizers[i],session.stopped===FORCED_STOP||curRecognizer&&recognizer!=curRecognizer&&!recognizer.canRecognizeWith(curRecognizer)?recognizer.reset():recognizer.recognize(inputData),!curRecognizer&&recognizer.state&(STATE_BEGAN|STATE_CHANGED|STATE_ENDED)&&(curRecognizer=session.curRecognizer=recognizer),i++}},get:function(recognizer){if(recognizer instanceof Recognizer)return recognizer;for(var recognizers=this.recognizers,i=0;i<recognizers.length;i++)if(recognizers[i].options.event==recognizer)return recognizers[i];return null},add:function(recognizer){if(invokeArrayArg(recognizer,"add",this))return this;var existing=this.get(recognizer.options.event);return existing&&this.remove(existing),this.recognizers.push(recognizer),recognizer.manager=this,this.touchAction.update(),recognizer},remove:function(recognizer){if(invokeArrayArg(recognizer,"remove",this))return this;if(recognizer=this.get(recognizer)){var recognizers=this.recognizers,index=inArray(recognizers,recognizer);index!==-1&&(recognizers.splice(index,1),this.touchAction.update())}return this},on:function(events,handler){if(events!==undefined&&handler!==undefined){var handlers=this.handlers;return each(splitStr(events),function(event){handlers[event]=handlers[event]||[],handlers[event].push(handler)}),this}},off:function(events,handler){if(events!==undefined){var handlers=this.handlers;return each(splitStr(events),function(event){handler?handlers[event]&&handlers[event].splice(inArray(handlers[event],handler),1):delete handlers[event]}),this}},emit:function(event,data){this.options.domEvents&&triggerDomEvent(event,data);var handlers=this.handlers[event]&&this.handlers[event].slice();if(handlers&&handlers.length){data.type=event,data.preventDefault=function(){data.srcEvent.preventDefault()};for(var i=0;i<handlers.length;)handlers[i](data),i++}},destroy:function(){this.element&&toggleCssProps(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},assign(Hammer,{INPUT_START:INPUT_START,INPUT_MOVE:INPUT_MOVE,INPUT_END:INPUT_END,INPUT_CANCEL:INPUT_CANCEL,STATE_POSSIBLE:STATE_POSSIBLE,STATE_BEGAN:STATE_BEGAN,STATE_CHANGED:STATE_CHANGED,STATE_ENDED:STATE_ENDED,STATE_RECOGNIZED:STATE_RECOGNIZED,STATE_CANCELLED:STATE_CANCELLED,STATE_FAILED:STATE_FAILED,DIRECTION_NONE:DIRECTION_NONE,DIRECTION_LEFT:DIRECTION_LEFT,DIRECTION_RIGHT:DIRECTION_RIGHT,DIRECTION_UP:DIRECTION_UP,DIRECTION_DOWN:DIRECTION_DOWN,DIRECTION_HORIZONTAL:DIRECTION_HORIZONTAL,DIRECTION_VERTICAL:DIRECTION_VERTICAL,DIRECTION_ALL:DIRECTION_ALL,Manager:Manager,Input:Input,TouchAction:TouchAction,TouchInput:TouchInput,MouseInput:MouseInput,PointerEventInput:PointerEventInput,TouchMouseInput:TouchMouseInput,SingleTouchInput:SingleTouchInput,Recognizer:Recognizer,AttrRecognizer:AttrRecognizer,Tap:TapRecognizer,Pan:PanRecognizer,Swipe:SwipeRecognizer,Pinch:PinchRecognizer,Rotate:RotateRecognizer,Press:PressRecognizer,on:addEventListeners,off:removeEventListeners,each:each,merge:merge,extend:extend,assign:assign,inherit:inherit,bindFn:bindFn,prefixed:prefixed});var freeGlobal="undefined"!=typeof window?window:"undefined"!=typeof self?self:{};freeGlobal.Hammer=Hammer,"function"==typeof define&&define.amd?define(function(){return Hammer}):"undefined"!=typeof module&&module.exports?module.exports=Hammer:window[exportName]=Hammer}(window,document,"Hammer")},{}],103:[function(_dereq_,module,exports){var hash=exports;hash.utils=_dereq_("./hash/utils"),hash.common=_dereq_("./hash/common"),hash.sha=_dereq_("./hash/sha"),hash.ripemd=_dereq_("./hash/ripemd"),hash.hmac=_dereq_("./hash/hmac"),hash.sha1=hash.sha.sha1,hash.sha256=hash.sha.sha256,hash.sha224=hash.sha.sha224,hash.sha384=hash.sha.sha384,hash.sha512=hash.sha.sha512,hash.ripemd160=hash.ripemd.ripemd160},{"./hash/common":104,"./hash/hmac":105,"./hash/ripemd":106,"./hash/sha":107,"./hash/utils":108}],104:[function(_dereq_,module,exports){function BlockHash(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}var hash=_dereq_("../hash"),utils=hash.utils,assert=utils.assert;exports.BlockHash=BlockHash,BlockHash.prototype.update=function(msg,enc){if(msg=utils.toArray(msg,enc),this.pending?this.pending=this.pending.concat(msg):this.pending=msg,this.pendingTotal+=msg.length,this.pending.length>=this._delta8){msg=this.pending;var r=msg.length%this._delta8;this.pending=msg.slice(msg.length-r,msg.length),0===this.pending.length&&(this.pending=null),msg=utils.join32(msg,0,msg.length-r,this.endian);for(var i=0;i<msg.length;i+=this._delta32)this._update(msg,i,i+this._delta32)}return this},BlockHash.prototype.digest=function(enc){return this.update(this._pad()),assert(null===this.pending),this._digest(enc)},BlockHash.prototype._pad=function(){var len=this.pendingTotal,bytes=this._delta8,k=bytes-(len+this.padLength)%bytes,res=new Array(k+this.padLength);res[0]=128;for(var i=1;i<k;i++)res[i]=0;if(len<<=3,"big"===this.endian){for(var t=8;t<this.padLength;t++)res[i++]=0;res[i++]=0,res[i++]=0,res[i++]=0,res[i++]=0,res[i++]=len>>>24&255,res[i++]=len>>>16&255,res[i++]=len>>>8&255,res[i++]=255&len}else{res[i++]=255&len,res[i++]=len>>>8&255,res[i++]=len>>>16&255,res[i++]=len>>>24&255,res[i++]=0,res[i++]=0,res[i++]=0,res[i++]=0;for(var t=8;t<this.padLength;t++)res[i++]=0}return res}},{"../hash":103}],105:[function(_dereq_,module,exports){function Hmac(hash,key,enc){return this instanceof Hmac?(this.Hash=hash,this.blockSize=hash.blockSize/8,this.outSize=hash.outSize/8,this.inner=null,this.outer=null,void this._init(utils.toArray(key,enc))):new Hmac(hash,key,enc)}var hash=_dereq_("../hash"),utils=hash.utils,assert=utils.assert;module.exports=Hmac,Hmac.prototype._init=function(key){key.length>this.blockSize&&(key=(new this.Hash).update(key).digest()),assert(key.length<=this.blockSize);for(var i=key.length;i<this.blockSize;i++)key.push(0);for(var i=0;i<key.length;i++)key[i]^=54;this.inner=(new this.Hash).update(key);for(var i=0;i<key.length;i++)key[i]^=106;this.outer=(new this.Hash).update(key)},Hmac.prototype.update=function(msg,enc){return this.inner.update(msg,enc),this},Hmac.prototype.digest=function(enc){return this.outer.update(this.inner.digest()),this.outer.digest(enc)}},{"../hash":103}],106:[function(_dereq_,module,exports){function RIPEMD160(){return this instanceof RIPEMD160?(BlockHash.call(this),
this.h=[1732584193,4023233417,2562383102,271733878,3285377520],void(this.endian="little")):new RIPEMD160}function f(j,x,y,z){return j<=15?x^y^z:j<=31?x&y|~x&z:j<=47?(x|~y)^z:j<=63?x&z|y&~z:x^(y|~z)}function K(j){return j<=15?0:j<=31?1518500249:j<=47?1859775393:j<=63?2400959708:2840853838}function Kh(j){return j<=15?1352829926:j<=31?1548603684:j<=47?1836072691:j<=63?2053994217:0}var hash=_dereq_("../hash"),utils=hash.utils,rotl32=utils.rotl32,sum32=utils.sum32,sum32_3=utils.sum32_3,sum32_4=utils.sum32_4,BlockHash=hash.common.BlockHash;utils.inherits(RIPEMD160,BlockHash),exports.ripemd160=RIPEMD160,RIPEMD160.blockSize=512,RIPEMD160.outSize=160,RIPEMD160.hmacStrength=192,RIPEMD160.padLength=64,RIPEMD160.prototype._update=function(msg,start){for(var A=this.h[0],B=this.h[1],C=this.h[2],D=this.h[3],E=this.h[4],Ah=A,Bh=B,Ch=C,Dh=D,Eh=E,j=0;j<80;j++){var T=sum32(rotl32(sum32_4(A,f(j,B,C,D),msg[r[j]+start],K(j)),s[j]),E);A=E,E=D,D=rotl32(C,10),C=B,B=T,T=sum32(rotl32(sum32_4(Ah,f(79-j,Bh,Ch,Dh),msg[rh[j]+start],Kh(j)),sh[j]),Eh),Ah=Eh,Eh=Dh,Dh=rotl32(Ch,10),Ch=Bh,Bh=T}T=sum32_3(this.h[1],C,Dh),this.h[1]=sum32_3(this.h[2],D,Eh),this.h[2]=sum32_3(this.h[3],E,Ah),this.h[3]=sum32_3(this.h[4],A,Bh),this.h[4]=sum32_3(this.h[0],B,Ch),this.h[0]=T},RIPEMD160.prototype._digest=function(enc){return"hex"===enc?utils.toHex32(this.h,"little"):utils.split32(this.h,"little")};var r=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],rh=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],s=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],sh=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},{"../hash":103}],107:[function(_dereq_,module,exports){function SHA256(){return this instanceof SHA256?(BlockHash.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=sha256_K,void(this.W=new Array(64))):new SHA256}function SHA224(){return this instanceof SHA224?(SHA256.call(this),void(this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])):new SHA224}function SHA512(){return this instanceof SHA512?(BlockHash.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=sha512_K,void(this.W=new Array(160))):new SHA512}function SHA384(){return this instanceof SHA384?(SHA512.call(this),void(this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428])):new SHA384}function SHA1(){return this instanceof SHA1?(BlockHash.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],void(this.W=new Array(80))):new SHA1}function ch32(x,y,z){return x&y^~x&z}function maj32(x,y,z){return x&y^x&z^y&z}function p32(x,y,z){return x^y^z}function s0_256(x){return rotr32(x,2)^rotr32(x,13)^rotr32(x,22)}function s1_256(x){return rotr32(x,6)^rotr32(x,11)^rotr32(x,25)}function g0_256(x){return rotr32(x,7)^rotr32(x,18)^x>>>3}function g1_256(x){return rotr32(x,17)^rotr32(x,19)^x>>>10}function ft_1(s,x,y,z){return 0===s?ch32(x,y,z):1===s||3===s?p32(x,y,z):2===s?maj32(x,y,z):void 0}function ch64_hi(xh,xl,yh,yl,zh,zl){var r=xh&yh^~xh&zh;return r<0&&(r+=4294967296),r}function ch64_lo(xh,xl,yh,yl,zh,zl){var r=xl&yl^~xl&zl;return r<0&&(r+=4294967296),r}function maj64_hi(xh,xl,yh,yl,zh,zl){var r=xh&yh^xh&zh^yh&zh;return r<0&&(r+=4294967296),r}function maj64_lo(xh,xl,yh,yl,zh,zl){var r=xl&yl^xl&zl^yl&zl;return r<0&&(r+=4294967296),r}function s0_512_hi(xh,xl){var c0_hi=rotr64_hi(xh,xl,28),c1_hi=rotr64_hi(xl,xh,2),c2_hi=rotr64_hi(xl,xh,7),r=c0_hi^c1_hi^c2_hi;return r<0&&(r+=4294967296),r}function s0_512_lo(xh,xl){var c0_lo=rotr64_lo(xh,xl,28),c1_lo=rotr64_lo(xl,xh,2),c2_lo=rotr64_lo(xl,xh,7),r=c0_lo^c1_lo^c2_lo;return r<0&&(r+=4294967296),r}function s1_512_hi(xh,xl){var c0_hi=rotr64_hi(xh,xl,14),c1_hi=rotr64_hi(xh,xl,18),c2_hi=rotr64_hi(xl,xh,9),r=c0_hi^c1_hi^c2_hi;return r<0&&(r+=4294967296),r}function s1_512_lo(xh,xl){var c0_lo=rotr64_lo(xh,xl,14),c1_lo=rotr64_lo(xh,xl,18),c2_lo=rotr64_lo(xl,xh,9),r=c0_lo^c1_lo^c2_lo;return r<0&&(r+=4294967296),r}function g0_512_hi(xh,xl){var c0_hi=rotr64_hi(xh,xl,1),c1_hi=rotr64_hi(xh,xl,8),c2_hi=shr64_hi(xh,xl,7),r=c0_hi^c1_hi^c2_hi;return r<0&&(r+=4294967296),r}function g0_512_lo(xh,xl){var c0_lo=rotr64_lo(xh,xl,1),c1_lo=rotr64_lo(xh,xl,8),c2_lo=shr64_lo(xh,xl,7),r=c0_lo^c1_lo^c2_lo;return r<0&&(r+=4294967296),r}function g1_512_hi(xh,xl){var c0_hi=rotr64_hi(xh,xl,19),c1_hi=rotr64_hi(xl,xh,29),c2_hi=shr64_hi(xh,xl,6),r=c0_hi^c1_hi^c2_hi;return r<0&&(r+=4294967296),r}function g1_512_lo(xh,xl){var c0_lo=rotr64_lo(xh,xl,19),c1_lo=rotr64_lo(xl,xh,29),c2_lo=shr64_lo(xh,xl,6),r=c0_lo^c1_lo^c2_lo;return r<0&&(r+=4294967296),r}var hash=_dereq_("../hash"),utils=hash.utils,assert=utils.assert,rotr32=utils.rotr32,rotl32=utils.rotl32,sum32=utils.sum32,sum32_4=utils.sum32_4,sum32_5=utils.sum32_5,rotr64_hi=utils.rotr64_hi,rotr64_lo=utils.rotr64_lo,shr64_hi=utils.shr64_hi,shr64_lo=utils.shr64_lo,sum64=utils.sum64,sum64_hi=utils.sum64_hi,sum64_lo=utils.sum64_lo,sum64_4_hi=utils.sum64_4_hi,sum64_4_lo=utils.sum64_4_lo,sum64_5_hi=utils.sum64_5_hi,sum64_5_lo=utils.sum64_5_lo,BlockHash=hash.common.BlockHash,sha256_K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],sha512_K=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],sha1_K=[1518500249,1859775393,2400959708,3395469782];utils.inherits(SHA256,BlockHash),exports.sha256=SHA256,SHA256.blockSize=512,SHA256.outSize=256,SHA256.hmacStrength=192,SHA256.padLength=64,SHA256.prototype._update=function(msg,start){for(var W=this.W,i=0;i<16;i++)W[i]=msg[start+i];for(;i<W.length;i++)W[i]=sum32_4(g1_256(W[i-2]),W[i-7],g0_256(W[i-15]),W[i-16]);var a=this.h[0],b=this.h[1],c=this.h[2],d=this.h[3],e=this.h[4],f=this.h[5],g=this.h[6],h=this.h[7];assert(this.k.length===W.length);for(var i=0;i<W.length;i++){var T1=sum32_5(h,s1_256(e),ch32(e,f,g),this.k[i],W[i]),T2=sum32(s0_256(a),maj32(a,b,c));h=g,g=f,f=e,e=sum32(d,T1),d=c,c=b,b=a,a=sum32(T1,T2)}this.h[0]=sum32(this.h[0],a),this.h[1]=sum32(this.h[1],b),this.h[2]=sum32(this.h[2],c),this.h[3]=sum32(this.h[3],d),this.h[4]=sum32(this.h[4],e),this.h[5]=sum32(this.h[5],f),this.h[6]=sum32(this.h[6],g),this.h[7]=sum32(this.h[7],h)},SHA256.prototype._digest=function(enc){return"hex"===enc?utils.toHex32(this.h,"big"):utils.split32(this.h,"big")},utils.inherits(SHA224,SHA256),exports.sha224=SHA224,SHA224.blockSize=512,SHA224.outSize=224,SHA224.hmacStrength=192,SHA224.padLength=64,SHA224.prototype._digest=function(enc){return"hex"===enc?utils.toHex32(this.h.slice(0,7),"big"):utils.split32(this.h.slice(0,7),"big")},utils.inherits(SHA512,BlockHash),exports.sha512=SHA512,SHA512.blockSize=1024,SHA512.outSize=512,SHA512.hmacStrength=192,SHA512.padLength=128,SHA512.prototype._prepareBlock=function(msg,start){for(var W=this.W,i=0;i<32;i++)W[i]=msg[start+i];for(;i<W.length;i+=2){var c0_hi=g1_512_hi(W[i-4],W[i-3]),c0_lo=g1_512_lo(W[i-4],W[i-3]),c1_hi=W[i-14],c1_lo=W[i-13],c2_hi=g0_512_hi(W[i-30],W[i-29]),c2_lo=g0_512_lo(W[i-30],W[i-29]),c3_hi=W[i-32],c3_lo=W[i-31];W[i]=sum64_4_hi(c0_hi,c0_lo,c1_hi,c1_lo,c2_hi,c2_lo,c3_hi,c3_lo),W[i+1]=sum64_4_lo(c0_hi,c0_lo,c1_hi,c1_lo,c2_hi,c2_lo,c3_hi,c3_lo)}},SHA512.prototype._update=function(msg,start){this._prepareBlock(msg,start);var W=this.W,ah=this.h[0],al=this.h[1],bh=this.h[2],bl=this.h[3],ch=this.h[4],cl=this.h[5],dh=this.h[6],dl=this.h[7],eh=this.h[8],el=this.h[9],fh=this.h[10],fl=this.h[11],gh=this.h[12],gl=this.h[13],hh=this.h[14],hl=this.h[15];assert(this.k.length===W.length);for(var i=0;i<W.length;i+=2){var c0_hi=hh,c0_lo=hl,c1_hi=s1_512_hi(eh,el),c1_lo=s1_512_lo(eh,el),c2_hi=ch64_hi(eh,el,fh,fl,gh,gl),c2_lo=ch64_lo(eh,el,fh,fl,gh,gl),c3_hi=this.k[i],c3_lo=this.k[i+1],c4_hi=W[i],c4_lo=W[i+1],T1_hi=sum64_5_hi(c0_hi,c0_lo,c1_hi,c1_lo,c2_hi,c2_lo,c3_hi,c3_lo,c4_hi,c4_lo),T1_lo=sum64_5_lo(c0_hi,c0_lo,c1_hi,c1_lo,c2_hi,c2_lo,c3_hi,c3_lo,c4_hi,c4_lo),c0_hi=s0_512_hi(ah,al),c0_lo=s0_512_lo(ah,al),c1_hi=maj64_hi(ah,al,bh,bl,ch,cl),c1_lo=maj64_lo(ah,al,bh,bl,ch,cl),T2_hi=sum64_hi(c0_hi,c0_lo,c1_hi,c1_lo),T2_lo=sum64_lo(c0_hi,c0_lo,c1_hi,c1_lo);hh=gh,hl=gl,gh=fh,gl=fl,fh=eh,fl=el,eh=sum64_hi(dh,dl,T1_hi,T1_lo),el=sum64_lo(dl,dl,T1_hi,T1_lo),dh=ch,dl=cl,ch=bh,cl=bl,bh=ah,bl=al,ah=sum64_hi(T1_hi,T1_lo,T2_hi,T2_lo),al=sum64_lo(T1_hi,T1_lo,T2_hi,T2_lo)}sum64(this.h,0,ah,al),sum64(this.h,2,bh,bl),sum64(this.h,4,ch,cl),sum64(this.h,6,dh,dl),sum64(this.h,8,eh,el),sum64(this.h,10,fh,fl),sum64(this.h,12,gh,gl),sum64(this.h,14,hh,hl)},SHA512.prototype._digest=function(enc){return"hex"===enc?utils.toHex32(this.h,"big"):utils.split32(this.h,"big")},utils.inherits(SHA384,SHA512),exports.sha384=SHA384,SHA384.blockSize=1024,SHA384.outSize=384,SHA384.hmacStrength=192,SHA384.padLength=128,SHA384.prototype._digest=function(enc){return"hex"===enc?utils.toHex32(this.h.slice(0,12),"big"):utils.split32(this.h.slice(0,12),"big")},utils.inherits(SHA1,BlockHash),exports.sha1=SHA1,SHA1.blockSize=512,SHA1.outSize=160,SHA1.hmacStrength=80,SHA1.padLength=64,SHA1.prototype._update=function(msg,start){for(var W=this.W,i=0;i<16;i++)W[i]=msg[start+i];for(;i<W.length;i++)W[i]=rotl32(W[i-3]^W[i-8]^W[i-14]^W[i-16],1);for(var a=this.h[0],b=this.h[1],c=this.h[2],d=this.h[3],e=this.h[4],i=0;i<W.length;i++){var s=~~(i/20),t=sum32_5(rotl32(a,5),ft_1(s,b,c,d),e,W[i],sha1_K[s]);e=d,d=c,c=rotl32(b,30),b=a,a=t}this.h[0]=sum32(this.h[0],a),this.h[1]=sum32(this.h[1],b),this.h[2]=sum32(this.h[2],c),this.h[3]=sum32(this.h[3],d),this.h[4]=sum32(this.h[4],e)},SHA1.prototype._digest=function(enc){return"hex"===enc?utils.toHex32(this.h,"big"):utils.split32(this.h,"big")}},{"../hash":103}],108:[function(_dereq_,module,exports){function toArray(msg,enc){if(Array.isArray(msg))return msg.slice();if(!msg)return[];var res=[];if("string"==typeof msg)if(enc){if("hex"===enc){msg=msg.replace(/[^a-z0-9]+/gi,""),msg.length%2!==0&&(msg="0"+msg);for(var i=0;i<msg.length;i+=2)res.push(parseInt(msg[i]+msg[i+1],16))}}else for(var i=0;i<msg.length;i++){var c=msg.charCodeAt(i),hi=c>>8,lo=255&c;hi?res.push(hi,lo):res.push(lo)}else for(var i=0;i<msg.length;i++)res[i]=0|msg[i];return res}function toHex(msg){for(var res="",i=0;i<msg.length;i++)res+=zero2(msg[i].toString(16));return res}function htonl(w){var res=w>>>24|w>>>8&65280|w<<8&16711680|(255&w)<<24;return res>>>0}function toHex32(msg,endian){for(var res="",i=0;i<msg.length;i++){var w=msg[i];"little"===endian&&(w=htonl(w)),res+=zero8(w.toString(16))}return res}function zero2(word){return 1===word.length?"0"+word:word}function zero8(word){return 7===word.length?"0"+word:6===word.length?"00"+word:5===word.length?"000"+word:4===word.length?"0000"+word:3===word.length?"00000"+word:2===word.length?"000000"+word:1===word.length?"0000000"+word:word}function join32(msg,start,end,endian){var len=end-start;assert(len%4===0);for(var res=new Array(len/4),i=0,k=start;i<res.length;i++,k+=4){var w;w="big"===endian?msg[k]<<24|msg[k+1]<<16|msg[k+2]<<8|msg[k+3]:msg[k+3]<<24|msg[k+2]<<16|msg[k+1]<<8|msg[k],res[i]=w>>>0}return res}function split32(msg,endian){for(var res=new Array(4*msg.length),i=0,k=0;i<msg.length;i++,k+=4){var m=msg[i];"big"===endian?(res[k]=m>>>24,res[k+1]=m>>>16&255,res[k+2]=m>>>8&255,res[k+3]=255&m):(res[k+3]=m>>>24,res[k+2]=m>>>16&255,res[k+1]=m>>>8&255,res[k]=255&m)}return res}function rotr32(w,b){return w>>>b|w<<32-b}function rotl32(w,b){return w<<b|w>>>32-b}function sum32(a,b){return a+b>>>0}function sum32_3(a,b,c){return a+b+c>>>0}function sum32_4(a,b,c,d){return a+b+c+d>>>0}function sum32_5(a,b,c,d,e){return a+b+c+d+e>>>0}function assert(cond,msg){if(!cond)throw new Error(msg||"Assertion failed")}function sum64(buf,pos,ah,al){var bh=buf[pos],bl=buf[pos+1],lo=al+bl>>>0,hi=(lo<al?1:0)+ah+bh;buf[pos]=hi>>>0,buf[pos+1]=lo}function sum64_hi(ah,al,bh,bl){var lo=al+bl>>>0,hi=(lo<al?1:0)+ah+bh;return hi>>>0}function sum64_lo(ah,al,bh,bl){var lo=al+bl;return lo>>>0}function sum64_4_hi(ah,al,bh,bl,ch,cl,dh,dl){var carry=0,lo=al;lo=lo+bl>>>0,carry+=lo<al?1:0,lo=lo+cl>>>0,carry+=lo<cl?1:0,lo=lo+dl>>>0,carry+=lo<dl?1:0;var hi=ah+bh+ch+dh+carry;return hi>>>0}function sum64_4_lo(ah,al,bh,bl,ch,cl,dh,dl){var lo=al+bl+cl+dl;return lo>>>0}function sum64_5_hi(ah,al,bh,bl,ch,cl,dh,dl,eh,el){var carry=0,lo=al;lo=lo+bl>>>0,carry+=lo<al?1:0,lo=lo+cl>>>0,carry+=lo<cl?1:0,lo=lo+dl>>>0,carry+=lo<dl?1:0,lo=lo+el>>>0,carry+=lo<el?1:0;var hi=ah+bh+ch+dh+eh+carry;return hi>>>0}function sum64_5_lo(ah,al,bh,bl,ch,cl,dh,dl,eh,el){var lo=al+bl+cl+dl+el;return lo>>>0}function rotr64_hi(ah,al,num){var r=al<<32-num|ah>>>num;return r>>>0}function rotr64_lo(ah,al,num){var r=ah<<32-num|al>>>num;return r>>>0}function shr64_hi(ah,al,num){return ah>>>num}function shr64_lo(ah,al,num){var r=ah<<32-num|al>>>num;return r>>>0}var utils=exports,inherits=_dereq_("inherits");utils.toArray=toArray,utils.toHex=toHex,utils.htonl=htonl,utils.toHex32=toHex32,utils.zero2=zero2,utils.zero8=zero8,utils.join32=join32,utils.split32=split32,utils.rotr32=rotr32,utils.rotl32=rotl32,utils.sum32=sum32,utils.sum32_3=sum32_3,utils.sum32_4=sum32_4,utils.sum32_5=sum32_5,utils.assert=assert,utils.inherits=inherits,exports.sum64=sum64,exports.sum64_hi=sum64_hi,exports.sum64_lo=sum64_lo,exports.sum64_4_hi=sum64_4_hi,exports.sum64_4_lo=sum64_4_lo,exports.sum64_5_hi=sum64_5_hi,exports.sum64_5_lo=sum64_5_lo,exports.rotr64_hi=rotr64_hi,exports.rotr64_lo=rotr64_lo,exports.shr64_hi=shr64_hi,exports.shr64_lo=shr64_lo},{inherits:112}],109:[function(_dereq_,module,exports){"use strict";function HmacDRBG(options){if(!(this instanceof HmacDRBG))return new HmacDRBG(options);this.hash=options.hash,this.predResist=!!options.predResist,this.outLen=this.hash.outSize,this.minEntropy=options.minEntropy||this.hash.hmacStrength,this.reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var entropy=utils.toArray(options.entropy,options.entropyEnc||"hex"),nonce=utils.toArray(options.nonce,options.nonceEnc||"hex"),pers=utils.toArray(options.pers,options.persEnc||"hex");assert(entropy.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(entropy,nonce,pers)}var hash=_dereq_("hash.js"),utils=_dereq_("minimalistic-crypto-utils"),assert=_dereq_("minimalistic-assert");module.exports=HmacDRBG,HmacDRBG.prototype._init=function(entropy,nonce,pers){var seed=entropy.concat(nonce).concat(pers);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var i=0;i<this.V.length;i++)this.K[i]=0,this.V[i]=1;this._update(seed),this.reseed=1,this.reseedInterval=281474976710656},HmacDRBG.prototype._hmac=function(){return new hash.hmac(this.hash,this.K)},HmacDRBG.prototype._update=function(seed){var kmac=this._hmac().update(this.V).update([0]);seed&&(kmac=kmac.update(seed)),this.K=kmac.digest(),this.V=this._hmac().update(this.V).digest(),seed&&(this.K=this._hmac().update(this.V).update([1]).update(seed).digest(),this.V=this._hmac().update(this.V).digest())},HmacDRBG.prototype.reseed=function(entropy,entropyEnc,add,addEnc){"string"!=typeof entropyEnc&&(addEnc=add,add=entropyEnc,entropyEnc=null),entropy=utils.toArray(entropy,entropyEnc),add=utils.toArray(add,addEnc),assert(entropy.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(entropy.concat(add||[])),this.reseed=1},HmacDRBG.prototype.generate=function(len,enc,add,addEnc){if(this.reseed>this.reseedInterval)throw new Error("Reseed is required");"string"!=typeof enc&&(addEnc=add,add=enc,enc=null),add&&(add=utils.toArray(add,addEnc||"hex"),this._update(add));for(var temp=[];temp.length<len;)this.V=this._hmac().update(this.V).digest(),temp=temp.concat(this.V);var res=temp.slice(0,len);return this._update(add),this.reseed++,utils.encode(res,enc)}},{"hash.js":103,"minimalistic-assert":117,"minimalistic-crypto-utils":118}],110:[function(_dereq_,module,exports){exports.read=function(buffer,offset,isLE,mLen,nBytes){var e,m,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,nBits=-7,i=isLE?nBytes-1:0,d=isLE?-1:1,s=buffer[offset+i];for(i+=d,e=s&(1<<-nBits)-1,s>>=-nBits,nBits+=eLen;nBits>0;e=256*e+buffer[offset+i],i+=d,nBits-=8);for(m=e&(1<<-nBits)-1,e>>=-nBits,nBits+=mLen;nBits>0;m=256*m+buffer[offset+i],i+=d,nBits-=8);if(0===e)e=1-eBias;else{if(e===eMax)return m?NaN:(s?-1:1)*(1/0);m+=Math.pow(2,mLen),e-=eBias}return(s?-1:1)*m*Math.pow(2,e-mLen)},exports.write=function(buffer,value,offset,isLE,mLen,nBytes){var e,m,c,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,rt=23===mLen?Math.pow(2,-24)-Math.pow(2,-77):0,i=isLE?0:nBytes-1,d=isLE?1:-1,s=value<0||0===value&&1/value<0?1:0;for(value=Math.abs(value),isNaN(value)||value===1/0?(m=isNaN(value)?1:0,e=eMax):(e=Math.floor(Math.log(value)/Math.LN2),value*(c=Math.pow(2,-e))<1&&(e--,c*=2),value+=e+eBias>=1?rt/c:rt*Math.pow(2,1-eBias),value*c>=2&&(e++,c/=2),e+eBias>=eMax?(m=0,e=eMax):e+eBias>=1?(m=(value*c-1)*Math.pow(2,mLen),e+=eBias):(m=value*Math.pow(2,eBias-1)*Math.pow(2,mLen),e=0));mLen>=8;buffer[offset+i]=255&m,i+=d,m/=256,mLen-=8);for(e=e<<mLen|m,eLen+=mLen;eLen>0;buffer[offset+i]=255&e,i+=d,e/=256,eLen-=8);buffer[offset+i-d]|=128*s}},{}],111:[function(_dereq_,module,exports){var indexOf=[].indexOf;module.exports=function(arr,obj){if(indexOf)return arr.indexOf(obj);for(var i=0;i<arr.length;++i)if(arr[i]===obj)return i;return-1}},{}],112:[function(_dereq_,module,exports){"function"==typeof Object.create?module.exports=function(ctor,superCtor){ctor.super_=superCtor,ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}})}:module.exports=function(ctor,superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype,ctor.prototype=new TempCtor,ctor.prototype.constructor=ctor}},{}],113:[function(_dereq_,module,exports){function isBuffer(obj){return!!obj.constructor&&"function"==typeof obj.constructor.isBuffer&&obj.constructor.isBuffer(obj)}function isSlowBuffer(obj){return"function"==typeof obj.readFloatLE&&"function"==typeof obj.slice&&isBuffer(obj.slice(0,0))}module.exports=function(obj){return null!=obj&&(isBuffer(obj)||isSlowBuffer(obj)||!!obj._isBuffer)}},{}],114:[function(_dereq_,module,exports){var toString={}.toString;module.exports=Array.isArray||function(arr){return"[object Array]"==toString.call(arr)}},{}],115:[function(_dereq_,module,exports){(function(global){"use strict";var _typeof2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};!function(f){if("object"===("undefined"==typeof exports?"undefined":_typeof2(exports))&&"undefined"!=typeof module)module.exports=f();else if("function"==typeof define&&define.amd)define([],f);else{var g;g="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,g.localforage=f()}}(function(){return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof _dereq_&&_dereq_;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof _dereq_&&_dereq_,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(_dereq_,module,exports){(function(global){function nextTick(){draining=!0;for(var i,oldQueue,len=queue.length;len;){for(oldQueue=queue,queue=[],i=-1;++i<len;)oldQueue[i]();len=queue.length}draining=!1}function immediate(task){1!==queue.push(task)||draining||scheduleDrain()}var scheduleDrain,Mutation=global.MutationObserver||global.WebKitMutationObserver;if(Mutation){var called=0,observer=new Mutation(nextTick),element=global.document.createTextNode("");observer.observe(element,{characterData:!0}),scheduleDrain=function(){element.data=called=++called%2}}else if(global.setImmediate||"undefined"==typeof global.MessageChannel)scheduleDrain="document"in global&&"onreadystatechange"in global.document.createElement("script")?function(){var scriptEl=global.document.createElement("script");scriptEl.onreadystatechange=function(){nextTick(),scriptEl.onreadystatechange=null,scriptEl.parentNode.removeChild(scriptEl),scriptEl=null},global.document.documentElement.appendChild(scriptEl)}:function(){setTimeout(nextTick,0)};else{var channel=new global.MessageChannel;channel.port1.onmessage=nextTick,scheduleDrain=function(){channel.port2.postMessage(0)}}var draining,queue=[];module.exports=immediate}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(_dereq_,module,exports){function INTERNAL(){}function Promise(resolver){if("function"!=typeof resolver)throw new TypeError("resolver must be a function");this.state=PENDING,this.queue=[],this.outcome=void 0,resolver!==INTERNAL&&safelyResolveThenable(this,resolver)}function QueueItem(promise,onFulfilled,onRejected){this.promise=promise,"function"==typeof onFulfilled&&(this.onFulfilled=onFulfilled,this.callFulfilled=this.otherCallFulfilled),"function"==typeof onRejected&&(this.onRejected=onRejected,this.callRejected=this.otherCallRejected)}function unwrap(promise,func,value){immediate(function(){var returnValue;try{returnValue=func(value)}catch(e){return handlers.reject(promise,e)}returnValue===promise?handlers.reject(promise,new TypeError("Cannot resolve promise with itself")):handlers.resolve(promise,returnValue)})}function getThen(obj){var then=obj&&obj.then;if(obj&&"object"===("undefined"==typeof obj?"undefined":_typeof2(obj))&&"function"==typeof then)return function(){then.apply(obj,arguments)}}function safelyResolveThenable(self,thenable){function onError(value){called||(called=!0,handlers.reject(self,value))}function onSuccess(value){called||(called=!0,handlers.resolve(self,value))}function tryToUnwrap(){thenable(onSuccess,onError)}var called=!1,result=tryCatch(tryToUnwrap);"error"===result.status&&onError(result.value)}function tryCatch(func,value){var out={};try{out.value=func(value),out.status="success"}catch(e){out.status="error",out.value=e}return out}function resolve(value){return value instanceof this?value:handlers.resolve(new this(INTERNAL),value)}function reject(reason){var promise=new this(INTERNAL);return handlers.reject(promise,reason)}function all(iterable){function allResolver(value,i){function resolveFromAll(outValue){values[i]=outValue,++resolved!==len||called||(called=!0,handlers.resolve(promise,values))}self.resolve(value).then(resolveFromAll,function(error){called||(called=!0,handlers.reject(promise,error))})}var self=this;if("[object Array]"!==Object.prototype.toString.call(iterable))return this.reject(new TypeError("must be an array"));var len=iterable.length,called=!1;if(!len)return this.resolve([]);for(var values=new Array(len),resolved=0,i=-1,promise=new this(INTERNAL);++i<len;)allResolver(iterable[i],i);return promise}function race(iterable){function resolver(value){self.resolve(value).then(function(response){called||(called=!0,handlers.resolve(promise,response))},function(error){called||(called=!0,handlers.reject(promise,error))})}var self=this;if("[object Array]"!==Object.prototype.toString.call(iterable))return this.reject(new TypeError("must be an array"));var len=iterable.length,called=!1;if(!len)return this.resolve([]);for(var i=-1,promise=new this(INTERNAL);++i<len;)resolver(iterable[i]);return promise}var immediate=_dereq_(1),handlers={},REJECTED=["REJECTED"],FULFILLED=["FULFILLED"],PENDING=["PENDING"];module.exports=exports=Promise,Promise.prototype.catch=function(onRejected){return this.then(null,onRejected)},Promise.prototype.then=function(onFulfilled,onRejected){if("function"!=typeof onFulfilled&&this.state===FULFILLED||"function"!=typeof onRejected&&this.state===REJECTED)return this;var promise=new this.constructor(INTERNAL);if(this.state!==PENDING){var resolver=this.state===FULFILLED?onFulfilled:onRejected;unwrap(promise,resolver,this.outcome)}else this.queue.push(new QueueItem(promise,onFulfilled,onRejected));return promise},QueueItem.prototype.callFulfilled=function(value){handlers.resolve(this.promise,value)},QueueItem.prototype.otherCallFulfilled=function(value){unwrap(this.promise,this.onFulfilled,value)},QueueItem.prototype.callRejected=function(value){handlers.reject(this.promise,value)},QueueItem.prototype.otherCallRejected=function(value){unwrap(this.promise,this.onRejected,value)},handlers.resolve=function(self,value){var result=tryCatch(getThen,value);if("error"===result.status)return handlers.reject(self,result.value);var thenable=result.value;if(thenable)safelyResolveThenable(self,thenable);else{self.state=FULFILLED,self.outcome=value;for(var i=-1,len=self.queue.length;++i<len;)self.queue[i].callFulfilled(value)}return self},handlers.reject=function(self,error){self.state=REJECTED,self.outcome=error;for(var i=-1,len=self.queue.length;++i<len;)self.queue[i].callRejected(error);return self},exports.resolve=resolve,exports.reject=reject,exports.all=all,exports.race=race},{1:1}],3:[function(_dereq_,module,exports){(function(global){"function"!=typeof global.Promise&&(global.Promise=_dereq_(2))}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(_dereq_,module,exports){function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function getIDB(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){}}function isIndexedDBValid(){try{if(!idb)return!1;var isSafari="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),hasFetch="function"==typeof fetch&&fetch.toString().indexOf("[native code")!==-1;return(!isSafari||hasFetch)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}function isWebSQLValid(){return"function"==typeof openDatabase}function isLocalStorageValid(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&localStorage.setItem}catch(e){return!1}}function createBlob(parts,properties){parts=parts||[],properties=properties||{};try{return new Blob(parts,properties)}catch(e){if("TypeError"!==e.name)throw e;for(var Builder="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,builder=new Builder,i=0;i<parts.length;i+=1)builder.append(parts[i]);return builder.getBlob(properties.type)}}function executeCallback(promise,callback){callback&&promise.then(function(result){callback(null,result)},function(error){callback(error)})}function executeTwoCallbacks(promise,callback,errorCallback){"function"==typeof callback&&promise.then(callback),"function"==typeof errorCallback&&promise.catch(errorCallback)}function _binStringToArrayBuffer(bin){for(var length=bin.length,buf=new ArrayBuffer(length),arr=new Uint8Array(buf),i=0;i<length;i++)arr[i]=bin.charCodeAt(i);return buf}function _checkBlobSupportWithoutCaching(idb){return new Promise$1(function(resolve){var txn=idb.transaction(DETECT_BLOB_SUPPORT_STORE,"readwrite"),blob=createBlob([""]);txn.objectStore(DETECT_BLOB_SUPPORT_STORE).put(blob,"key"),txn.onabort=function(e){e.preventDefault(),e.stopPropagation(),resolve(!1)},txn.oncomplete=function(){var matchedChrome=navigator.userAgent.match(/Chrome\/(\d+)/),matchedEdge=navigator.userAgent.match(/Edge\//);resolve(matchedEdge||!matchedChrome||parseInt(matchedChrome[1],10)>=43)}}).catch(function(){return!1})}function _checkBlobSupport(idb){return"boolean"==typeof supportsBlobs?Promise$1.resolve(supportsBlobs):_checkBlobSupportWithoutCaching(idb).then(function(value){return supportsBlobs=value})}function _deferReadiness(dbInfo){var dbContext=dbContexts[dbInfo.name],deferredOperation={};deferredOperation.promise=new Promise$1(function(resolve){deferredOperation.resolve=resolve}),dbContext.deferredOperations.push(deferredOperation),dbContext.dbReady?dbContext.dbReady=dbContext.dbReady.then(function(){return deferredOperation.promise}):dbContext.dbReady=deferredOperation.promise}function _advanceReadiness(dbInfo){var dbContext=dbContexts[dbInfo.name],deferredOperation=dbContext.deferredOperations.pop();deferredOperation&&deferredOperation.resolve()}function _getConnection(dbInfo,upgradeNeeded){return new Promise$1(function(resolve,reject){if(dbInfo.db){if(!upgradeNeeded)return resolve(dbInfo.db);_deferReadiness(dbInfo),dbInfo.db.close()}var dbArgs=[dbInfo.name];upgradeNeeded&&dbArgs.push(dbInfo.version);var openreq=idb.open.apply(idb,dbArgs);upgradeNeeded&&(openreq.onupgradeneeded=function(e){
var db=openreq.result;try{db.createObjectStore(dbInfo.storeName),e.oldVersion<=1&&db.createObjectStore(DETECT_BLOB_SUPPORT_STORE)}catch(ex){if("ConstraintError"!==ex.name)throw ex;console.warn('The database "'+dbInfo.name+'" has been upgraded from version '+e.oldVersion+" to version "+e.newVersion+', but the storage "'+dbInfo.storeName+'" already exists.')}}),openreq.onerror=function(e){e.preventDefault(),reject(openreq.error)},openreq.onsuccess=function(){resolve(openreq.result),_advanceReadiness(dbInfo)}})}function _getOriginalConnection(dbInfo){return _getConnection(dbInfo,!1)}function _getUpgradedConnection(dbInfo){return _getConnection(dbInfo,!0)}function _isUpgradeNeeded(dbInfo,defaultVersion){if(!dbInfo.db)return!0;var isNewStore=!dbInfo.db.objectStoreNames.contains(dbInfo.storeName),isDowngrade=dbInfo.version<dbInfo.db.version,isUpgrade=dbInfo.version>dbInfo.db.version;if(isDowngrade&&(dbInfo.version!==defaultVersion&&console.warn('The database "'+dbInfo.name+"\" can't be downgraded from version "+dbInfo.db.version+" to version "+dbInfo.version+"."),dbInfo.version=dbInfo.db.version),isUpgrade||isNewStore){if(isNewStore){var incVersion=dbInfo.db.version+1;incVersion>dbInfo.version&&(dbInfo.version=incVersion)}return!0}return!1}function _encodeBlob(blob){return new Promise$1(function(resolve,reject){var reader=new FileReader;reader.onerror=reject,reader.onloadend=function(e){var base64=btoa(e.target.result||"");resolve({__local_forage_encoded_blob:!0,data:base64,type:blob.type})},reader.readAsBinaryString(blob)})}function _decodeBlob(encodedBlob){var arrayBuff=_binStringToArrayBuffer(atob(encodedBlob.data));return createBlob([arrayBuff],{type:encodedBlob.type})}function _isEncodedBlob(value){return value&&value.__local_forage_encoded_blob}function _fullyReady(callback){var self=this,promise=self._initReady().then(function(){var dbContext=dbContexts[self._dbInfo.name];if(dbContext&&dbContext.dbReady)return dbContext.dbReady});return executeTwoCallbacks(promise,callback,callback),promise}function _initStorage(options){function ignoreErrors(){return Promise$1.resolve()}var self=this,dbInfo={db:null};if(options)for(var i in options)dbInfo[i]=options[i];dbContexts||(dbContexts={});var dbContext=dbContexts[dbInfo.name];dbContext||(dbContext={forages:[],db:null,dbReady:null,deferredOperations:[]},dbContexts[dbInfo.name]=dbContext),dbContext.forages.push(self),self._initReady||(self._initReady=self.ready,self.ready=_fullyReady);for(var initPromises=[],j=0;j<dbContext.forages.length;j++){var forage=dbContext.forages[j];forage!==self&&initPromises.push(forage._initReady().catch(ignoreErrors))}var forages=dbContext.forages.slice(0);return Promise$1.all(initPromises).then(function(){return dbInfo.db=dbContext.db,_getOriginalConnection(dbInfo)}).then(function(db){return dbInfo.db=db,_isUpgradeNeeded(dbInfo,self._defaultConfig.version)?_getUpgradedConnection(dbInfo):db}).then(function(db){dbInfo.db=dbContext.db=db,self._dbInfo=dbInfo;for(var k=0;k<forages.length;k++){var forage=forages[k];forage!==self&&(forage._dbInfo.db=dbInfo.db,forage._dbInfo.version=dbInfo.version)}})}function getItem(key,callback){var self=this;"string"!=typeof key&&(console.warn(key+" used as a key, but it is not a string."),key=String(key));var promise=new Promise$1(function(resolve,reject){self.ready().then(function(){var dbInfo=self._dbInfo,store=dbInfo.db.transaction(dbInfo.storeName,"readonly").objectStore(dbInfo.storeName),req=store.get(key);req.onsuccess=function(){var value=req.result;void 0===value&&(value=null),_isEncodedBlob(value)&&(value=_decodeBlob(value)),resolve(value)},req.onerror=function(){reject(req.error)}}).catch(reject)});return executeCallback(promise,callback),promise}function iterate(iterator,callback){var self=this,promise=new Promise$1(function(resolve,reject){self.ready().then(function(){var dbInfo=self._dbInfo,store=dbInfo.db.transaction(dbInfo.storeName,"readonly").objectStore(dbInfo.storeName),req=store.openCursor(),iterationNumber=1;req.onsuccess=function(){var cursor=req.result;if(cursor){var value=cursor.value;_isEncodedBlob(value)&&(value=_decodeBlob(value));var result=iterator(value,cursor.key,iterationNumber++);void 0!==result?resolve(result):cursor.continue()}else resolve()},req.onerror=function(){reject(req.error)}}).catch(reject)});return executeCallback(promise,callback),promise}function setItem(key,value,callback){var self=this;"string"!=typeof key&&(console.warn(key+" used as a key, but it is not a string."),key=String(key));var promise=new Promise$1(function(resolve,reject){var dbInfo;self.ready().then(function(){return dbInfo=self._dbInfo,"[object Blob]"===toString.call(value)?_checkBlobSupport(dbInfo.db).then(function(blobSupport){return blobSupport?value:_encodeBlob(value)}):value}).then(function(value){var transaction=dbInfo.db.transaction(dbInfo.storeName,"readwrite"),store=transaction.objectStore(dbInfo.storeName),req=store.put(value,key);null===value&&(value=void 0),transaction.oncomplete=function(){void 0===value&&(value=null),resolve(value)},transaction.onabort=transaction.onerror=function(){var err=req.error?req.error:req.transaction.error;reject(err)}}).catch(reject)});return executeCallback(promise,callback),promise}function removeItem(key,callback){var self=this;"string"!=typeof key&&(console.warn(key+" used as a key, but it is not a string."),key=String(key));var promise=new Promise$1(function(resolve,reject){self.ready().then(function(){var dbInfo=self._dbInfo,transaction=dbInfo.db.transaction(dbInfo.storeName,"readwrite"),store=transaction.objectStore(dbInfo.storeName),req=store.delete(key);transaction.oncomplete=function(){resolve()},transaction.onerror=function(){reject(req.error)},transaction.onabort=function(){var err=req.error?req.error:req.transaction.error;reject(err)}}).catch(reject)});return executeCallback(promise,callback),promise}function clear(callback){var self=this,promise=new Promise$1(function(resolve,reject){self.ready().then(function(){var dbInfo=self._dbInfo,transaction=dbInfo.db.transaction(dbInfo.storeName,"readwrite"),store=transaction.objectStore(dbInfo.storeName),req=store.clear();transaction.oncomplete=function(){resolve()},transaction.onabort=transaction.onerror=function(){var err=req.error?req.error:req.transaction.error;reject(err)}}).catch(reject)});return executeCallback(promise,callback),promise}function length(callback){var self=this,promise=new Promise$1(function(resolve,reject){self.ready().then(function(){var dbInfo=self._dbInfo,store=dbInfo.db.transaction(dbInfo.storeName,"readonly").objectStore(dbInfo.storeName),req=store.count();req.onsuccess=function(){resolve(req.result)},req.onerror=function(){reject(req.error)}}).catch(reject)});return executeCallback(promise,callback),promise}function key(n,callback){var self=this,promise=new Promise$1(function(resolve,reject){return n<0?void resolve(null):void self.ready().then(function(){var dbInfo=self._dbInfo,store=dbInfo.db.transaction(dbInfo.storeName,"readonly").objectStore(dbInfo.storeName),advanced=!1,req=store.openCursor();req.onsuccess=function(){var cursor=req.result;return cursor?void(0===n?resolve(cursor.key):advanced?resolve(cursor.key):(advanced=!0,cursor.advance(n))):void resolve(null)},req.onerror=function(){reject(req.error)}}).catch(reject)});return executeCallback(promise,callback),promise}function keys(callback){var self=this,promise=new Promise$1(function(resolve,reject){self.ready().then(function(){var dbInfo=self._dbInfo,store=dbInfo.db.transaction(dbInfo.storeName,"readonly").objectStore(dbInfo.storeName),req=store.openCursor(),keys=[];req.onsuccess=function(){var cursor=req.result;return cursor?(keys.push(cursor.key),void cursor.continue()):void resolve(keys)},req.onerror=function(){reject(req.error)}}).catch(reject)});return executeCallback(promise,callback),promise}function stringToBuffer(serializedString){var i,encoded1,encoded2,encoded3,encoded4,bufferLength=.75*serializedString.length,len=serializedString.length,p=0;"="===serializedString[serializedString.length-1]&&(bufferLength--,"="===serializedString[serializedString.length-2]&&bufferLength--);var buffer=new ArrayBuffer(bufferLength),bytes=new Uint8Array(buffer);for(i=0;i<len;i+=4)encoded1=BASE_CHARS.indexOf(serializedString[i]),encoded2=BASE_CHARS.indexOf(serializedString[i+1]),encoded3=BASE_CHARS.indexOf(serializedString[i+2]),encoded4=BASE_CHARS.indexOf(serializedString[i+3]),bytes[p++]=encoded1<<2|encoded2>>4,bytes[p++]=(15&encoded2)<<4|encoded3>>2,bytes[p++]=(3&encoded3)<<6|63&encoded4;return buffer}function bufferToString(buffer){var i,bytes=new Uint8Array(buffer),base64String="";for(i=0;i<bytes.length;i+=3)base64String+=BASE_CHARS[bytes[i]>>2],base64String+=BASE_CHARS[(3&bytes[i])<<4|bytes[i+1]>>4],base64String+=BASE_CHARS[(15&bytes[i+1])<<2|bytes[i+2]>>6],base64String+=BASE_CHARS[63&bytes[i+2]];return bytes.length%3===2?base64String=base64String.substring(0,base64String.length-1)+"=":bytes.length%3===1&&(base64String=base64String.substring(0,base64String.length-2)+"=="),base64String}function serialize(value,callback){var valueType="";if(value&&(valueType=toString$1.call(value)),value&&("[object ArrayBuffer]"===valueType||value.buffer&&"[object ArrayBuffer]"===toString$1.call(value.buffer))){var buffer,marker=SERIALIZED_MARKER;value instanceof ArrayBuffer?(buffer=value,marker+=TYPE_ARRAYBUFFER):(buffer=value.buffer,"[object Int8Array]"===valueType?marker+=TYPE_INT8ARRAY:"[object Uint8Array]"===valueType?marker+=TYPE_UINT8ARRAY:"[object Uint8ClampedArray]"===valueType?marker+=TYPE_UINT8CLAMPEDARRAY:"[object Int16Array]"===valueType?marker+=TYPE_INT16ARRAY:"[object Uint16Array]"===valueType?marker+=TYPE_UINT16ARRAY:"[object Int32Array]"===valueType?marker+=TYPE_INT32ARRAY:"[object Uint32Array]"===valueType?marker+=TYPE_UINT32ARRAY:"[object Float32Array]"===valueType?marker+=TYPE_FLOAT32ARRAY:"[object Float64Array]"===valueType?marker+=TYPE_FLOAT64ARRAY:callback(new Error("Failed to get type for BinaryArray"))),callback(marker+bufferToString(buffer))}else if("[object Blob]"===valueType){var fileReader=new FileReader;fileReader.onload=function(){var str=BLOB_TYPE_PREFIX+value.type+"~"+bufferToString(this.result);callback(SERIALIZED_MARKER+TYPE_BLOB+str)},fileReader.readAsArrayBuffer(value)}else try{callback(JSON.stringify(value))}catch(e){console.error("Couldn't convert value into a JSON string: ",value),callback(null,e)}}function deserialize(value){if(value.substring(0,SERIALIZED_MARKER_LENGTH)!==SERIALIZED_MARKER)return JSON.parse(value);var blobType,serializedString=value.substring(TYPE_SERIALIZED_MARKER_LENGTH),type=value.substring(SERIALIZED_MARKER_LENGTH,TYPE_SERIALIZED_MARKER_LENGTH);if(type===TYPE_BLOB&&BLOB_TYPE_PREFIX_REGEX.test(serializedString)){var matcher=serializedString.match(BLOB_TYPE_PREFIX_REGEX);blobType=matcher[1],serializedString=serializedString.substring(matcher[0].length)}var buffer=stringToBuffer(serializedString);switch(type){case TYPE_ARRAYBUFFER:return buffer;case TYPE_BLOB:return createBlob([buffer],{type:blobType});case TYPE_INT8ARRAY:return new Int8Array(buffer);case TYPE_UINT8ARRAY:return new Uint8Array(buffer);case TYPE_UINT8CLAMPEDARRAY:return new Uint8ClampedArray(buffer);case TYPE_INT16ARRAY:return new Int16Array(buffer);case TYPE_UINT16ARRAY:return new Uint16Array(buffer);case TYPE_INT32ARRAY:return new Int32Array(buffer);case TYPE_UINT32ARRAY:return new Uint32Array(buffer);case TYPE_FLOAT32ARRAY:return new Float32Array(buffer);case TYPE_FLOAT64ARRAY:return new Float64Array(buffer);default:throw new Error("Unkown type: "+type)}}function _initStorage$1(options){var self=this,dbInfo={db:null};if(options)for(var i in options)dbInfo[i]="string"!=typeof options[i]?options[i].toString():options[i];var dbInfoPromise=new Promise$1(function(resolve,reject){try{dbInfo.db=openDatabase(dbInfo.name,String(dbInfo.version),dbInfo.description,dbInfo.size)}catch(e){return reject(e)}dbInfo.db.transaction(function(t){t.executeSql("CREATE TABLE IF NOT EXISTS "+dbInfo.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],function(){self._dbInfo=dbInfo,resolve()},function(t,error){reject(error)})})});return dbInfo.serializer=localforageSerializer,dbInfoPromise}function getItem$1(key,callback){var self=this;"string"!=typeof key&&(console.warn(key+" used as a key, but it is not a string."),key=String(key));var promise=new Promise$1(function(resolve,reject){self.ready().then(function(){var dbInfo=self._dbInfo;dbInfo.db.transaction(function(t){t.executeSql("SELECT * FROM "+dbInfo.storeName+" WHERE key = ? LIMIT 1",[key],function(t,results){var result=results.rows.length?results.rows.item(0).value:null;result&&(result=dbInfo.serializer.deserialize(result)),resolve(result)},function(t,error){reject(error)})})}).catch(reject)});return executeCallback(promise,callback),promise}function iterate$1(iterator,callback){var self=this,promise=new Promise$1(function(resolve,reject){self.ready().then(function(){var dbInfo=self._dbInfo;dbInfo.db.transaction(function(t){t.executeSql("SELECT * FROM "+dbInfo.storeName,[],function(t,results){for(var rows=results.rows,length=rows.length,i=0;i<length;i++){var item=rows.item(i),result=item.value;if(result&&(result=dbInfo.serializer.deserialize(result)),result=iterator(result,item.key,i+1),void 0!==result)return void resolve(result)}resolve()},function(t,error){reject(error)})})}).catch(reject)});return executeCallback(promise,callback),promise}function _setItem(key,value,callback,retriesLeft){var self=this;"string"!=typeof key&&(console.warn(key+" used as a key, but it is not a string."),key=String(key));var promise=new Promise$1(function(resolve,reject){self.ready().then(function(){void 0===value&&(value=null);var originalValue=value,dbInfo=self._dbInfo;dbInfo.serializer.serialize(value,function(value,error){error?reject(error):dbInfo.db.transaction(function(t){t.executeSql("INSERT OR REPLACE INTO "+dbInfo.storeName+" (key, value) VALUES (?, ?)",[key,value],function(){resolve(originalValue)},function(t,error){reject(error)})},function(sqlError){if(sqlError.code===sqlError.QUOTA_ERR){if(retriesLeft>0)return void resolve(_setItem.apply(self,[key,originalValue,callback,retriesLeft-1]));reject(sqlError)}})})}).catch(reject)});return executeCallback(promise,callback),promise}function setItem$1(key,value,callback){return _setItem.apply(this,[key,value,callback,1])}function removeItem$1(key,callback){var self=this;"string"!=typeof key&&(console.warn(key+" used as a key, but it is not a string."),key=String(key));var promise=new Promise$1(function(resolve,reject){self.ready().then(function(){var dbInfo=self._dbInfo;dbInfo.db.transaction(function(t){t.executeSql("DELETE FROM "+dbInfo.storeName+" WHERE key = ?",[key],function(){resolve()},function(t,error){reject(error)})})}).catch(reject)});return executeCallback(promise,callback),promise}function clear$1(callback){var self=this,promise=new Promise$1(function(resolve,reject){self.ready().then(function(){var dbInfo=self._dbInfo;dbInfo.db.transaction(function(t){t.executeSql("DELETE FROM "+dbInfo.storeName,[],function(){resolve()},function(t,error){reject(error)})})}).catch(reject)});return executeCallback(promise,callback),promise}function length$1(callback){var self=this,promise=new Promise$1(function(resolve,reject){self.ready().then(function(){var dbInfo=self._dbInfo;dbInfo.db.transaction(function(t){t.executeSql("SELECT COUNT(key) as c FROM "+dbInfo.storeName,[],function(t,results){var result=results.rows.item(0).c;resolve(result)},function(t,error){reject(error)})})}).catch(reject)});return executeCallback(promise,callback),promise}function key$1(n,callback){var self=this,promise=new Promise$1(function(resolve,reject){self.ready().then(function(){var dbInfo=self._dbInfo;dbInfo.db.transaction(function(t){t.executeSql("SELECT key FROM "+dbInfo.storeName+" WHERE id = ? LIMIT 1",[n+1],function(t,results){var result=results.rows.length?results.rows.item(0).key:null;resolve(result)},function(t,error){reject(error)})})}).catch(reject)});return executeCallback(promise,callback),promise}function keys$1(callback){var self=this,promise=new Promise$1(function(resolve,reject){self.ready().then(function(){var dbInfo=self._dbInfo;dbInfo.db.transaction(function(t){t.executeSql("SELECT key FROM "+dbInfo.storeName,[],function(t,results){for(var keys=[],i=0;i<results.rows.length;i++)keys.push(results.rows.item(i).key);resolve(keys)},function(t,error){reject(error)})})}).catch(reject)});return executeCallback(promise,callback),promise}function _initStorage$2(options){var self=this,dbInfo={};if(options)for(var i in options)dbInfo[i]=options[i];return dbInfo.keyPrefix=dbInfo.name+"/",dbInfo.storeName!==self._defaultConfig.storeName&&(dbInfo.keyPrefix+=dbInfo.storeName+"/"),self._dbInfo=dbInfo,dbInfo.serializer=localforageSerializer,Promise$1.resolve()}function clear$2(callback){var self=this,promise=self.ready().then(function(){for(var keyPrefix=self._dbInfo.keyPrefix,i=localStorage.length-1;i>=0;i--){var key=localStorage.key(i);0===key.indexOf(keyPrefix)&&localStorage.removeItem(key)}});return executeCallback(promise,callback),promise}function getItem$2(key,callback){var self=this;"string"!=typeof key&&(console.warn(key+" used as a key, but it is not a string."),key=String(key));var promise=self.ready().then(function(){var dbInfo=self._dbInfo,result=localStorage.getItem(dbInfo.keyPrefix+key);return result&&(result=dbInfo.serializer.deserialize(result)),result});return executeCallback(promise,callback),promise}function iterate$2(iterator,callback){var self=this,promise=self.ready().then(function(){for(var dbInfo=self._dbInfo,keyPrefix=dbInfo.keyPrefix,keyPrefixLength=keyPrefix.length,length=localStorage.length,iterationNumber=1,i=0;i<length;i++){var key=localStorage.key(i);if(0===key.indexOf(keyPrefix)){var value=localStorage.getItem(key);if(value&&(value=dbInfo.serializer.deserialize(value)),value=iterator(value,key.substring(keyPrefixLength),iterationNumber++),void 0!==value)return value}}});return executeCallback(promise,callback),promise}function key$2(n,callback){var self=this,promise=self.ready().then(function(){var result,dbInfo=self._dbInfo;try{result=localStorage.key(n)}catch(error){result=null}return result&&(result=result.substring(dbInfo.keyPrefix.length)),result});return executeCallback(promise,callback),promise}function keys$2(callback){var self=this,promise=self.ready().then(function(){for(var dbInfo=self._dbInfo,length=localStorage.length,keys=[],i=0;i<length;i++)0===localStorage.key(i).indexOf(dbInfo.keyPrefix)&&keys.push(localStorage.key(i).substring(dbInfo.keyPrefix.length));return keys});return executeCallback(promise,callback),promise}function length$2(callback){var self=this,promise=self.keys().then(function(keys){return keys.length});return executeCallback(promise,callback),promise}function removeItem$2(key,callback){var self=this;"string"!=typeof key&&(console.warn(key+" used as a key, but it is not a string."),key=String(key));var promise=self.ready().then(function(){var dbInfo=self._dbInfo;localStorage.removeItem(dbInfo.keyPrefix+key)});return executeCallback(promise,callback),promise}function setItem$2(key,value,callback){var self=this;"string"!=typeof key&&(console.warn(key+" used as a key, but it is not a string."),key=String(key));var promise=self.ready().then(function(){void 0===value&&(value=null);var originalValue=value;return new Promise$1(function(resolve,reject){var dbInfo=self._dbInfo;dbInfo.serializer.serialize(value,function(value,error){if(error)reject(error);else try{localStorage.setItem(dbInfo.keyPrefix+key,value),resolve(originalValue)}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||reject(e),reject(e)}})})});return executeCallback(promise,callback),promise}function callWhenReady(localForageInstance,libraryMethod){localForageInstance[libraryMethod]=function(){var _args=arguments;return localForageInstance.ready().then(function(){return localForageInstance[libraryMethod].apply(localForageInstance,_args)})}}function extend(){for(var i=1;i<arguments.length;i++){var arg=arguments[i];if(arg)for(var key in arg)arg.hasOwnProperty(key)&&(isArray(arg[key])?arguments[0][key]=arg[key].slice():arguments[0][key]=arg[key])}return arguments[0]}function isLibraryDriver(driverName){for(var driver in DriverType)if(DriverType.hasOwnProperty(driver)&&DriverType[driver]===driverName)return!0;return!1}var _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(obj){return"undefined"==typeof obj?"undefined":_typeof2(obj)}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":"undefined"==typeof obj?"undefined":_typeof2(obj)},idb=getIDB();"undefined"==typeof Promise&&_dereq_(3);var supportsBlobs,dbContexts,Promise$1=Promise,DETECT_BLOB_SUPPORT_STORE="local-forage-detect-blob-support",toString=Object.prototype.toString,asyncStorage={_driver:"asyncStorage",_initStorage:_initStorage,iterate:iterate,getItem:getItem,setItem:setItem,removeItem:removeItem,clear:clear,length:length,key:key,keys:keys},BASE_CHARS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",BLOB_TYPE_PREFIX="~~local_forage_type~",BLOB_TYPE_PREFIX_REGEX=/^~~local_forage_type~([^~]+)~/,SERIALIZED_MARKER="__lfsc__:",SERIALIZED_MARKER_LENGTH=SERIALIZED_MARKER.length,TYPE_ARRAYBUFFER="arbf",TYPE_BLOB="blob",TYPE_INT8ARRAY="si08",TYPE_UINT8ARRAY="ui08",TYPE_UINT8CLAMPEDARRAY="uic8",TYPE_INT16ARRAY="si16",TYPE_INT32ARRAY="si32",TYPE_UINT16ARRAY="ur16",TYPE_UINT32ARRAY="ui32",TYPE_FLOAT32ARRAY="fl32",TYPE_FLOAT64ARRAY="fl64",TYPE_SERIALIZED_MARKER_LENGTH=SERIALIZED_MARKER_LENGTH+TYPE_ARRAYBUFFER.length,toString$1=Object.prototype.toString,localforageSerializer={serialize:serialize,deserialize:deserialize,stringToBuffer:stringToBuffer,bufferToString:bufferToString},webSQLStorage={_driver:"webSQLStorage",_initStorage:_initStorage$1,iterate:iterate$1,getItem:getItem$1,setItem:setItem$1,removeItem:removeItem$1,clear:clear$1,length:length$1,key:key$1,keys:keys$1},localStorageWrapper={_driver:"localStorageWrapper",_initStorage:_initStorage$2,iterate:iterate$2,getItem:getItem$2,setItem:setItem$2,removeItem:removeItem$2,clear:clear$2,length:length$2,key:key$2,keys:keys$2},CustomDrivers={},DriverType={INDEXEDDB:"asyncStorage",LOCALSTORAGE:"localStorageWrapper",WEBSQL:"webSQLStorage"},DefaultDriverOrder=[DriverType.INDEXEDDB,DriverType.WEBSQL,DriverType.LOCALSTORAGE],LibraryMethods=["clear","getItem","iterate","key","keys","length","removeItem","setItem"],DefaultConfig={description:"",driver:DefaultDriverOrder.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1},driverSupport={};driverSupport[DriverType.INDEXEDDB]=isIndexedDBValid(),driverSupport[DriverType.WEBSQL]=isWebSQLValid(),driverSupport[DriverType.LOCALSTORAGE]=isLocalStorageValid();var isArray=Array.isArray||function(arg){return"[object Array]"===Object.prototype.toString.call(arg)},LocalForage=function(){function LocalForage(options){_classCallCheck(this,LocalForage),this.INDEXEDDB=DriverType.INDEXEDDB,this.LOCALSTORAGE=DriverType.LOCALSTORAGE,this.WEBSQL=DriverType.WEBSQL,this._defaultConfig=extend({},DefaultConfig),this._config=extend({},this._defaultConfig,options),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return LocalForage.prototype.config=function(options){if("object"===("undefined"==typeof options?"undefined":_typeof(options))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var i in options){if("storeName"===i&&(options[i]=options[i].replace(/\W/g,"_")),"version"===i&&"number"!=typeof options[i])return new Error("Database version must be a number.");this._config[i]=options[i]}return!("driver"in options&&options.driver)||this.setDriver(this._config.driver)}return"string"==typeof options?this._config[options]:this._config},LocalForage.prototype.defineDriver=function(driverObject,callback,errorCallback){var promise=new Promise$1(function(resolve,reject){try{var driverName=driverObject._driver,complianceError=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver"),namingError=new Error("Custom driver name already in use: "+driverObject._driver);if(!driverObject._driver)return void reject(complianceError);if(isLibraryDriver(driverObject._driver))return void reject(namingError);for(var customDriverMethods=LibraryMethods.concat("_initStorage"),i=0;i<customDriverMethods.length;i++){var customDriverMethod=customDriverMethods[i];if(!customDriverMethod||!driverObject[customDriverMethod]||"function"!=typeof driverObject[customDriverMethod])return void reject(complianceError)}var supportPromise=Promise$1.resolve(!0);"_support"in driverObject&&(supportPromise=driverObject._support&&"function"==typeof driverObject._support?driverObject._support():Promise$1.resolve(!!driverObject._support)),supportPromise.then(function(supportResult){driverSupport[driverName]=supportResult,CustomDrivers[driverName]=driverObject,resolve()},reject)}catch(e){reject(e)}});return executeTwoCallbacks(promise,callback,errorCallback),promise},LocalForage.prototype.driver=function(){return this._driver||null},LocalForage.prototype.getDriver=function(driverName,callback,errorCallback){var self=this,getDriverPromise=Promise$1.resolve().then(function(){if(!isLibraryDriver(driverName)){if(CustomDrivers[driverName])return CustomDrivers[driverName];throw new Error("Driver not found.")}switch(driverName){case self.INDEXEDDB:return asyncStorage;case self.LOCALSTORAGE:return localStorageWrapper;case self.WEBSQL:return webSQLStorage}});return executeTwoCallbacks(getDriverPromise,callback,errorCallback),getDriverPromise},LocalForage.prototype.getSerializer=function(callback){var serializerPromise=Promise$1.resolve(localforageSerializer);return executeTwoCallbacks(serializerPromise,callback),serializerPromise},LocalForage.prototype.ready=function(callback){var self=this,promise=self._driverSet.then(function(){return null===self._ready&&(self._ready=self._initDriver()),self._ready});return executeTwoCallbacks(promise,callback,callback),promise},LocalForage.prototype.setDriver=function(drivers,callback,errorCallback){function setDriverToConfig(){self._config.driver=self.driver()}function extendSelfWithDriver(driver){return self._extend(driver),setDriverToConfig(),self._ready=self._initStorage(self._config),self._ready}function initDriver(supportedDrivers){return function(){function driverPromiseLoop(){for(;currentDriverIndex<supportedDrivers.length;){var driverName=supportedDrivers[currentDriverIndex];return currentDriverIndex++,self._dbInfo=null,self._ready=null,self.getDriver(driverName).then(extendSelfWithDriver).catch(driverPromiseLoop)}setDriverToConfig();var error=new Error("No available storage method found.");return self._driverSet=Promise$1.reject(error),self._driverSet}var currentDriverIndex=0;return driverPromiseLoop()}}var self=this;isArray(drivers)||(drivers=[drivers]);var supportedDrivers=this._getSupportedDrivers(drivers),oldDriverSetDone=null!==this._driverSet?this._driverSet.catch(function(){return Promise$1.resolve()}):Promise$1.resolve();return this._driverSet=oldDriverSetDone.then(function(){var driverName=supportedDrivers[0];return self._dbInfo=null,self._ready=null,self.getDriver(driverName).then(function(driver){self._driver=driver._driver,setDriverToConfig(),self._wrapLibraryMethodsWithReady(),self._initDriver=initDriver(supportedDrivers)})}).catch(function(){setDriverToConfig();var error=new Error("No available storage method found.");return self._driverSet=Promise$1.reject(error),self._driverSet}),executeTwoCallbacks(this._driverSet,callback,errorCallback),this._driverSet},LocalForage.prototype.supports=function(driverName){return!!driverSupport[driverName]},LocalForage.prototype._extend=function(libraryMethodsAndProperties){extend(this,libraryMethodsAndProperties)},LocalForage.prototype._getSupportedDrivers=function(drivers){for(var supportedDrivers=[],i=0,len=drivers.length;i<len;i++){var driverName=drivers[i];this.supports(driverName)&&supportedDrivers.push(driverName)}return supportedDrivers},LocalForage.prototype._wrapLibraryMethodsWithReady=function(){for(var i=0;i<LibraryMethods.length;i++)callWhenReady(this,LibraryMethods[i])},LocalForage.prototype.createInstance=function(options){return new LocalForage(options)},LocalForage}(),localforage_js=new LocalForage;module.exports=localforage_js},{3:3}]},{},[4])(4)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],116:[function(_dereq_,module,exports){function MillerRabin(rand){this.rand=rand||new brorand.Rand}var bn=_dereq_("bn.js"),brorand=_dereq_("brorand");module.exports=MillerRabin,MillerRabin.create=function(rand){return new MillerRabin(rand)},MillerRabin.prototype._rand=function(n){var len=n.bitLength(),buf=this.rand.generate(Math.ceil(len/8));buf[0]|=3;var mask=7&len;return 0!==mask&&(buf[buf.length-1]>>=7-mask),new bn(buf)},MillerRabin.prototype.test=function(n,k,cb){var len=n.bitLength(),red=bn.mont(n),rone=new bn(1).toRed(red);k||(k=Math.max(1,len/48|0));for(var n1=n.subn(1),n2=n1.subn(1),s=0;!n1.testn(s);s++);for(var d=n.shrn(s),rn1=n1.toRed(red),prime=!0;k>0;k--){var a=this._rand(n2);cb&&cb(a);var x=a.toRed(red).redPow(d);if(0!==x.cmp(rone)&&0!==x.cmp(rn1)){for(var i=1;i<s;i++){if(x=x.redSqr(),0===x.cmp(rone))return!1;if(0===x.cmp(rn1))break}if(i===s)return!1}}return prime},MillerRabin.prototype.getDivisor=function(n,k){var len=n.bitLength(),red=bn.mont(n),rone=new bn(1).toRed(red);k||(k=Math.max(1,len/48|0));for(var n1=n.subn(1),n2=n1.subn(1),s=0;!n1.testn(s);s++);for(var d=n.shrn(s),rn1=n1.toRed(red);k>0;k--){var a=this._rand(n2),g=n.gcd(a);if(0!==g.cmpn(1))return g;var x=a.toRed(red).redPow(d);if(0!==x.cmp(rone)&&0!==x.cmp(rn1)){for(var i=1;i<s;i++){if(x=x.redSqr(),0===x.cmp(rone))return x.fromRed().subn(1).gcd(n);if(0===x.cmp(rn1))break}if(i===s)return x=x.redSqr(),x.fromRed().subn(1).gcd(n)}}return!1}},{"bn.js":18,brorand:19}],117:[function(_dereq_,module,exports){function assert(val,msg){if(!val)throw new Error(msg||"Assertion failed")}module.exports=assert,assert.equal=function(l,r,msg){if(l!=r)throw new Error(msg||"Assertion failed: "+l+" != "+r)}},{}],118:[function(_dereq_,module,exports){"use strict";function toArray(msg,enc){if(Array.isArray(msg))return msg.slice();if(!msg)return[];var res=[];if("string"!=typeof msg){for(var i=0;i<msg.length;i++)res[i]=0|msg[i];return res}if("hex"===enc){msg=msg.replace(/[^a-z0-9]+/gi,""),msg.length%2!==0&&(msg="0"+msg);for(var i=0;i<msg.length;i+=2)res.push(parseInt(msg[i]+msg[i+1],16))}else for(var i=0;i<msg.length;i++){var c=msg.charCodeAt(i),hi=c>>8,lo=255&c;hi?res.push(hi,lo):res.push(lo)}return res}function zero2(word){return 1===word.length?"0"+word:word}function toHex(msg){for(var res="",i=0;i<msg.length;i++)res+=zero2(msg[i].toString(16));return res}var utils=exports;utils.toArray=toArray,utils.zero2=zero2,utils.toHex=toHex,utils.encode=function(arr,enc){return"hex"===enc?toHex(arr):arr}},{}],119:[function(_dereq_,module,exports){module.exports={"2.16.840.1.101.3.4.1.1":"aes-128-ecb","2.16.840.1.101.3.4.1.2":"aes-128-cbc","2.16.840.1.101.3.4.1.3":"aes-128-ofb","2.16.840.1.101.3.4.1.4":"aes-128-cfb","2.16.840.1.101.3.4.1.21":"aes-192-ecb","2.16.840.1.101.3.4.1.22":"aes-192-cbc","2.16.840.1.101.3.4.1.23":"aes-192-ofb","2.16.840.1.101.3.4.1.24":"aes-192-cfb","2.16.840.1.101.3.4.1.41":"aes-256-ecb","2.16.840.1.101.3.4.1.42":"aes-256-cbc","2.16.840.1.101.3.4.1.43":"aes-256-ofb","2.16.840.1.101.3.4.1.44":"aes-256-cfb"}},{}],120:[function(_dereq_,module,exports){"use strict";var asn1=_dereq_("asn1.js");exports.certificate=_dereq_("./certificate");var RSAPrivateKey=asn1.define("RSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("modulus").int(),this.key("publicExponent").int(),this.key("privateExponent").int(),this.key("prime1").int(),this.key("prime2").int(),this.key("exponent1").int(),this.key("exponent2").int(),this.key("coefficient").int());
});exports.RSAPrivateKey=RSAPrivateKey;var RSAPublicKey=asn1.define("RSAPublicKey",function(){this.seq().obj(this.key("modulus").int(),this.key("publicExponent").int())});exports.RSAPublicKey=RSAPublicKey;var PublicKey=asn1.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(AlgorithmIdentifier),this.key("subjectPublicKey").bitstr())});exports.PublicKey=PublicKey;var AlgorithmIdentifier=asn1.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("none").null_().optional(),this.key("curve").objid().optional(),this.key("params").seq().obj(this.key("p").int(),this.key("q").int(),this.key("g").int()).optional())}),PrivateKeyInfo=asn1.define("PrivateKeyInfo",function(){this.seq().obj(this.key("version").int(),this.key("algorithm").use(AlgorithmIdentifier),this.key("subjectPrivateKey").octstr())});exports.PrivateKey=PrivateKeyInfo;var EncryptedPrivateKeyInfo=asn1.define("EncryptedPrivateKeyInfo",function(){this.seq().obj(this.key("algorithm").seq().obj(this.key("id").objid(),this.key("decrypt").seq().obj(this.key("kde").seq().obj(this.key("id").objid(),this.key("kdeparams").seq().obj(this.key("salt").octstr(),this.key("iters").int())),this.key("cipher").seq().obj(this.key("algo").objid(),this.key("iv").octstr()))),this.key("subjectPrivateKey").octstr())});exports.EncryptedPrivateKey=EncryptedPrivateKeyInfo;var DSAPrivateKey=asn1.define("DSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("p").int(),this.key("q").int(),this.key("g").int(),this.key("pub_key").int(),this.key("priv_key").int())});exports.DSAPrivateKey=DSAPrivateKey,exports.DSAparam=asn1.define("DSAparam",function(){this.int()});var ECPrivateKey=asn1.define("ECPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").optional().explicit(0).use(ECParameters),this.key("publicKey").optional().explicit(1).bitstr())});exports.ECPrivateKey=ECPrivateKey;var ECParameters=asn1.define("ECParameters",function(){this.choice({namedCurve:this.objid()})});exports.signature=asn1.define("signature",function(){this.seq().obj(this.key("r").int(),this.key("s").int())})},{"./certificate":121,"asn1.js":1}],121:[function(_dereq_,module,exports){"use strict";var asn=_dereq_("asn1.js"),Time=asn.define("Time",function(){this.choice({utcTime:this.utctime(),generalTime:this.gentime()})}),AttributeTypeValue=asn.define("AttributeTypeValue",function(){this.seq().obj(this.key("type").objid(),this.key("value").any())}),AlgorithmIdentifier=asn.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("parameters").optional())}),SubjectPublicKeyInfo=asn.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(AlgorithmIdentifier),this.key("subjectPublicKey").bitstr())}),RelativeDistinguishedName=asn.define("RelativeDistinguishedName",function(){this.setof(AttributeTypeValue)}),RDNSequence=asn.define("RDNSequence",function(){this.seqof(RelativeDistinguishedName)}),Name=asn.define("Name",function(){this.choice({rdnSequence:this.use(RDNSequence)})}),Validity=asn.define("Validity",function(){this.seq().obj(this.key("notBefore").use(Time),this.key("notAfter").use(Time))}),Extension=asn.define("Extension",function(){this.seq().obj(this.key("extnID").objid(),this.key("critical").bool().def(!1),this.key("extnValue").octstr())}),TBSCertificate=asn.define("TBSCertificate",function(){this.seq().obj(this.key("version").explicit(0).int(),this.key("serialNumber").int(),this.key("signature").use(AlgorithmIdentifier),this.key("issuer").use(Name),this.key("validity").use(Validity),this.key("subject").use(Name),this.key("subjectPublicKeyInfo").use(SubjectPublicKeyInfo),this.key("issuerUniqueID").implicit(1).bitstr().optional(),this.key("subjectUniqueID").implicit(2).bitstr().optional(),this.key("extensions").explicit(3).seqof(Extension).optional())}),X509Certificate=asn.define("X509Certificate",function(){this.seq().obj(this.key("tbsCertificate").use(TBSCertificate),this.key("signatureAlgorithm").use(AlgorithmIdentifier),this.key("signatureValue").bitstr())});module.exports=X509Certificate},{"asn1.js":1}],122:[function(_dereq_,module,exports){(function(Buffer){var findProc=/Proc-Type: 4,ENCRYPTED\n\r?DEK-Info: AES-((?:128)|(?:192)|(?:256))-CBC,([0-9A-H]+)\n\r?\n\r?([0-9A-z\n\r\+\/\=]+)\n\r?/m,startRegex=/^-----BEGIN ((?:.* KEY)|CERTIFICATE)-----\n/m,fullRegex=/^-----BEGIN ((?:.* KEY)|CERTIFICATE)-----\n\r?([0-9A-z\n\r\+\/\=]+)\n\r?-----END \1-----$/m,evp=_dereq_("evp_bytestokey"),ciphers=_dereq_("browserify-aes");module.exports=function(okey,password){var decrypted,key=okey.toString(),match=key.match(findProc);if(match){var suite="aes"+match[1],iv=new Buffer(match[2],"hex"),cipherText=new Buffer(match[3].replace(/\r?\n/g,""),"base64"),cipherKey=evp(password,iv.slice(0,8),parseInt(match[1],10)).key,out=[],cipher=ciphers.createDecipheriv(suite,cipherKey,iv);out.push(cipher.update(cipherText)),out.push(cipher.final()),decrypted=Buffer.concat(out)}else{var match2=key.match(fullRegex);decrypted=new Buffer(match2[2].replace(/\r?\n/g,""),"base64")}var tag=key.match(startRegex)[1];return{tag:tag,data:decrypted}}}).call(this,_dereq_("buffer").Buffer)},{"browserify-aes":23,buffer:49,evp_bytestokey:100}],123:[function(_dereq_,module,exports){(function(Buffer){function parseKeys(buffer){var password;"object"!=typeof buffer||Buffer.isBuffer(buffer)||(password=buffer.passphrase,buffer=buffer.key),"string"==typeof buffer&&(buffer=new Buffer(buffer));var subtype,ndata,stripped=fixProc(buffer,password),type=stripped.tag,data=stripped.data;switch(type){case"CERTIFICATE":ndata=asn1.certificate.decode(data,"der").tbsCertificate.subjectPublicKeyInfo;case"PUBLIC KEY":switch(ndata||(ndata=asn1.PublicKey.decode(data,"der")),subtype=ndata.algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return asn1.RSAPublicKey.decode(ndata.subjectPublicKey.data,"der");case"1.2.840.10045.2.1":return ndata.subjectPrivateKey=ndata.subjectPublicKey,{type:"ec",data:ndata};case"1.2.840.10040.4.1":return ndata.algorithm.params.pub_key=asn1.DSAparam.decode(ndata.subjectPublicKey.data,"der"),{type:"dsa",data:ndata.algorithm.params};default:throw new Error("unknown key id "+subtype)}throw new Error("unknown key type "+type);case"ENCRYPTED PRIVATE KEY":data=asn1.EncryptedPrivateKey.decode(data,"der"),data=decrypt(data,password);case"PRIVATE KEY":switch(ndata=asn1.PrivateKey.decode(data,"der"),subtype=ndata.algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return asn1.RSAPrivateKey.decode(ndata.subjectPrivateKey,"der");case"1.2.840.10045.2.1":return{curve:ndata.algorithm.curve,privateKey:asn1.ECPrivateKey.decode(ndata.subjectPrivateKey,"der").privateKey};case"1.2.840.10040.4.1":return ndata.algorithm.params.priv_key=asn1.DSAparam.decode(ndata.subjectPrivateKey,"der"),{type:"dsa",params:ndata.algorithm.params};default:throw new Error("unknown key id "+subtype)}throw new Error("unknown key type "+type);case"RSA PUBLIC KEY":return asn1.RSAPublicKey.decode(data,"der");case"RSA PRIVATE KEY":return asn1.RSAPrivateKey.decode(data,"der");case"DSA PRIVATE KEY":return{type:"dsa",params:asn1.DSAPrivateKey.decode(data,"der")};case"EC PRIVATE KEY":return data=asn1.ECPrivateKey.decode(data,"der"),{curve:data.parameters.value,privateKey:data.privateKey};default:throw new Error("unknown key type "+type)}}function decrypt(data,password){var salt=data.algorithm.decrypt.kde.kdeparams.salt,iters=parseInt(data.algorithm.decrypt.kde.kdeparams.iters.toString(),10),algo=aesid[data.algorithm.decrypt.cipher.algo.join(".")],iv=data.algorithm.decrypt.cipher.iv,cipherText=data.subjectPrivateKey,keylen=parseInt(algo.split("-")[1],10)/8,key=compat.pbkdf2Sync(password,salt,iters,keylen),cipher=ciphers.createDecipheriv(algo,key,iv),out=[];return out.push(cipher.update(cipherText)),out.push(cipher.final()),Buffer.concat(out)}var asn1=_dereq_("./asn1"),aesid=_dereq_("./aesid.json"),fixProc=_dereq_("./fixProc"),ciphers=_dereq_("browserify-aes"),compat=_dereq_("pbkdf2");module.exports=parseKeys,parseKeys.signature=asn1.signature}).call(this,_dereq_("buffer").Buffer)},{"./aesid.json":119,"./asn1":120,"./fixProc":122,"browserify-aes":23,buffer:49,pbkdf2:124}],124:[function(_dereq_,module,exports){(function(process,Buffer){var createHmac=_dereq_("create-hmac"),checkParameters=_dereq_("./precondition");exports.pbkdf2=function(password,salt,iterations,keylen,digest,callback){if("function"==typeof digest&&(callback=digest,digest=void 0),checkParameters(iterations,keylen),"function"!=typeof callback)throw new Error("No callback provided to pbkdf2");setTimeout(function(){callback(null,exports.pbkdf2Sync(password,salt,iterations,keylen,digest))})};var defaultEncoding;if(process.browser)defaultEncoding="utf-8";else{var pVersionMajor=parseInt(process.version.split(".")[0].slice(1),10);defaultEncoding=pVersionMajor>=6?"utf-8":"binary"}exports.pbkdf2Sync=function(password,salt,iterations,keylen,digest){Buffer.isBuffer(password)||(password=new Buffer(password,defaultEncoding)),Buffer.isBuffer(salt)||(salt=new Buffer(salt,defaultEncoding)),checkParameters(iterations,keylen),digest=digest||"sha1";var hLen,l=1,DK=new Buffer(keylen),block1=new Buffer(salt.length+4);salt.copy(block1,0,0,salt.length);for(var r,T,i=1;i<=l;i++){block1.writeUInt32BE(i,salt.length);var U=createHmac(digest,password).update(block1).digest();hLen||(hLen=U.length,T=new Buffer(hLen),l=Math.ceil(keylen/hLen),r=keylen-(l-1)*hLen),U.copy(T,0,0,hLen);for(var j=1;j<iterations;j++){U=createHmac(digest,password).update(U).digest();for(var k=0;k<hLen;k++)T[k]^=U[k]}var destPos=(i-1)*hLen,len=i===l?r:hLen;T.copy(DK,destPos,0,len)}return DK}}).call(this,_dereq_("_process"),_dereq_("buffer").Buffer)},{"./precondition":125,_process:127,buffer:49,"create-hmac":56}],125:[function(_dereq_,module,exports){var MAX_ALLOC=Math.pow(2,30)-1;module.exports=function(iterations,keylen){if("number"!=typeof iterations)throw new TypeError("Iterations not a number");if(iterations<0)throw new TypeError("Bad iterations");if("number"!=typeof keylen)throw new TypeError("Key length not a number");if(keylen<0||keylen>MAX_ALLOC||keylen!==keylen)throw new TypeError("Bad key length")}},{}],126:[function(_dereq_,module,exports){(function(process){"use strict";function nextTick(fn,arg1,arg2,arg3){if("function"!=typeof fn)throw new TypeError('"callback" argument must be a function');var args,i,len=arguments.length;switch(len){case 0:case 1:return process.nextTick(fn);case 2:return process.nextTick(function(){fn.call(null,arg1)});case 3:return process.nextTick(function(){fn.call(null,arg1,arg2)});case 4:return process.nextTick(function(){fn.call(null,arg1,arg2,arg3)});default:for(args=new Array(len-1),i=0;i<args.length;)args[i++]=arguments[i];return process.nextTick(function(){fn.apply(null,args)})}}!process.version||0===process.version.indexOf("v0.")||0===process.version.indexOf("v1.")&&0!==process.version.indexOf("v1.8.")?module.exports=nextTick:module.exports=process.nextTick}).call(this,_dereq_("_process"))},{_process:127}],127:[function(_dereq_,module,exports){function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(fun){if(cachedSetTimeout===setTimeout)return setTimeout(fun,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(fun,0);try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}function runClearTimeout(marker){if(cachedClearTimeout===clearTimeout)return clearTimeout(marker);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(marker);try{return cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var timeout=runTimeout(cleanUpNextTick);draining=!0;for(var len=queue.length;len;){for(currentQueue=queue,queue=[];++queueIndex<len;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,len=queue.length}currentQueue=null,draining=!1,runClearTimeout(timeout)}}function Item(fun,array){this.fun=fun,this.array=array}function noop(){}var cachedSetTimeout,cachedClearTimeout,process=module.exports={};!function(){try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}}();var currentQueue,queue=[],draining=!1,queueIndex=-1;process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)args[i-1]=arguments[i];queue.push(new Item(fun,args)),1!==queue.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.binding=function(name){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(dir){throw new Error("process.chdir is not supported")},process.umask=function(){return 0}},{}],128:[function(_dereq_,module,exports){(function(global){"use strict";function doEval(self,__pseudoworker_script){(function(){eval(__pseudoworker_script)}).call(global)}function PseudoWorker(path){function executeEach(arr,fun){for(var i=-1;++i<arr.length;)arr[i]&&fun(arr[i])}function callErrorListener(err){return function(listener){listener({type:"error",error:err,message:err.message})}}function addEventListener(type,fun){"message"===type?messageListeners.push(fun):"error"===type&&errorListeners.push(fun)}function removeEventListener(type,fun){var listeners;if("message"===type)listeners=messageListeners;else{if("error"!==type)return;listeners=errorListeners}for(var i=-1;++i<listeners.length;){var listener=listeners[i];if(listener===fun){delete listeners[i];break}}}function postError(err){var callFun=callErrorListener(err);"function"==typeof api.onerror&&callFun(api.onerror),workerSelf&&"function"==typeof workerSelf.onerror&&callFun(workerSelf.onerror),executeEach(errorListeners,callFun),executeEach(workerErrorListeners,callFun)}function runPostMessage(msg){function callFun(listener){try{listener({data:msg})}catch(err){postError(err)}}workerSelf&&"function"==typeof workerSelf.onmessage&&callFun(workerSelf.onmessage),executeEach(workerMessageListeners,callFun)}function postMessage(msg){if("undefined"==typeof msg)throw new Error("postMessage() requires an argument");if(!terminated)return script?void runPostMessage(msg):void postMessageListeners.push(msg)}function terminate(){terminated=!0}function workerPostMessage(msg){function callFun(listener){listener({data:msg})}"function"==typeof api.onmessage&&callFun(api.onmessage),executeEach(messageListeners,callFun)}function workerAddEventListener(type,fun){"message"===type?workerMessageListeners.push(fun):"error"===type&&workerErrorListeners.push(fun)}var script,workerSelf,messageListeners=[],errorListeners=[],workerMessageListeners=[],workerErrorListeners=[],postMessageListeners=[],terminated=!1,api=this,xhr=new XMLHttpRequest;return xhr.open("GET",path),xhr.onreadystatechange=function(){if(4===xhr.readyState)if(xhr.status>=200&&xhr.status<400){script=xhr.responseText,workerSelf={postMessage:workerPostMessage,addEventListener:workerAddEventListener},doEval(workerSelf,script);var currentListeners=postMessageListeners;postMessageListeners=[];for(var i=0;i<currentListeners.length;i++)runPostMessage(currentListeners[i])}else postError(new Error("cannot find script "+path))},xhr.send(),api.postMessage=postMessage,api.addEventListener=addEventListener,api.removeEventListener=removeEventListener,api.terminate=terminate,api}module.exports=PseudoWorker}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],129:[function(_dereq_,module,exports){(function(global){"use strict";var PseudoWorker=_dereq_("./");"undefined"==typeof Worker&&(global.Worker=PseudoWorker),module.exports=PseudoWorker}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./":128}],130:[function(_dereq_,module,exports){exports.publicEncrypt=_dereq_("./publicEncrypt"),exports.privateDecrypt=_dereq_("./privateDecrypt"),exports.privateEncrypt=function(key,buf){return exports.publicEncrypt(key,buf,!0)},exports.publicDecrypt=function(key,buf){return exports.privateDecrypt(key,buf,!0)}},{"./privateDecrypt":132,"./publicEncrypt":133}],131:[function(_dereq_,module,exports){(function(Buffer){function i2ops(c){var out=new Buffer(4);return out.writeUInt32BE(c,0),out}var createHash=_dereq_("create-hash");module.exports=function(seed,len){for(var c,t=new Buffer(""),i=0;t.length<len;)c=i2ops(i++),t=Buffer.concat([t,createHash("sha1").update(seed).update(c).digest()]);return t.slice(0,len)}}).call(this,_dereq_("buffer").Buffer)},{buffer:49,"create-hash":53}],132:[function(_dereq_,module,exports){(function(Buffer){function oaep(key,msg){var k=(key.modulus,key.modulus.byteLength()),iHash=(msg.length,createHash("sha1").update(new Buffer("")).digest()),hLen=iHash.length;if(0!==msg[0])throw new Error("decryption error");var maskedSeed=msg.slice(1,hLen+1),maskedDb=msg.slice(hLen+1),seed=xor(maskedSeed,mgf(maskedDb,hLen)),db=xor(maskedDb,mgf(seed,k-hLen-1));if(compare(iHash,db.slice(0,hLen)))throw new Error("decryption error");for(var i=hLen;0===db[i];)i++;if(1!==db[i++])throw new Error("decryption error");return db.slice(i)}function pkcs1(key,msg,reverse){for(var p1=msg.slice(0,2),i=2,status=0;0!==msg[i++];)if(i>=msg.length){status++;break}var ps=msg.slice(2,i-1);msg.slice(i-1,i);if(("0002"!==p1.toString("hex")&&!reverse||"0001"!==p1.toString("hex")&&reverse)&&status++,ps.length<8&&status++,status)throw new Error("decryption error");return msg.slice(i)}function compare(a,b){a=new Buffer(a),b=new Buffer(b);var dif=0,len=a.length;a.length!==b.length&&(dif++,len=Math.min(a.length,b.length));for(var i=-1;++i<len;)dif+=a[i]^b[i];return dif}var parseKeys=_dereq_("parse-asn1"),mgf=_dereq_("./mgf"),xor=_dereq_("./xor"),bn=_dereq_("bn.js"),crt=_dereq_("browserify-rsa"),createHash=_dereq_("create-hash"),withPublic=_dereq_("./withPublic");module.exports=function(private_key,enc,reverse){var padding;padding=private_key.padding?private_key.padding:reverse?1:4;var key=parseKeys(private_key),k=key.modulus.byteLength();if(enc.length>k||new bn(enc).cmp(key.modulus)>=0)throw new Error("decryption error");var msg;msg=reverse?withPublic(new bn(enc),key):crt(enc,key);var zBuffer=new Buffer(k-msg.length);if(zBuffer.fill(0),msg=Buffer.concat([zBuffer,msg],k),4===padding)return oaep(key,msg);if(1===padding)return pkcs1(key,msg,reverse);if(3===padding)return msg;throw new Error("unknown padding")}}).call(this,_dereq_("buffer").Buffer)},{"./mgf":131,"./withPublic":134,"./xor":135,"bn.js":18,"browserify-rsa":39,buffer:49,"create-hash":53,"parse-asn1":123}],133:[function(_dereq_,module,exports){(function(Buffer){function oaep(key,msg){var k=key.modulus.byteLength(),mLen=msg.length,iHash=createHash("sha1").update(new Buffer("")).digest(),hLen=iHash.length,hLen2=2*hLen;if(mLen>k-hLen2-2)throw new Error("message too long");var ps=new Buffer(k-mLen-hLen2-2);ps.fill(0);var dblen=k-hLen-1,seed=randomBytes(hLen),maskedDb=xor(Buffer.concat([iHash,ps,new Buffer([1]),msg],dblen),mgf(seed,dblen)),maskedSeed=xor(seed,mgf(maskedDb,hLen));return new bn(Buffer.concat([new Buffer([0]),maskedSeed,maskedDb],k))}function pkcs1(key,msg,reverse){var mLen=msg.length,k=key.modulus.byteLength();if(mLen>k-11)throw new Error("message too long");var ps;return reverse?(ps=new Buffer(k-mLen-3),ps.fill(255)):ps=nonZero(k-mLen-3),new bn(Buffer.concat([new Buffer([0,reverse?1:2]),ps,new Buffer([0]),msg],k))}function nonZero(len,crypto){for(var num,out=new Buffer(len),i=0,cache=randomBytes(2*len),cur=0;i<len;)cur===cache.length&&(cache=randomBytes(2*len),cur=0),num=cache[cur++],num&&(out[i++]=num);return out}var parseKeys=_dereq_("parse-asn1"),randomBytes=_dereq_("randombytes"),createHash=_dereq_("create-hash"),mgf=_dereq_("./mgf"),xor=_dereq_("./xor"),bn=_dereq_("bn.js"),withPublic=_dereq_("./withPublic"),crt=_dereq_("browserify-rsa");module.exports=function(public_key,msg,reverse){var padding;padding=public_key.padding?public_key.padding:reverse?1:4;var paddedMsg,key=parseKeys(public_key);if(4===padding)paddedMsg=oaep(key,msg);else if(1===padding)paddedMsg=pkcs1(key,msg,reverse);else{if(3!==padding)throw new Error("unknown padding");if(paddedMsg=new bn(msg),paddedMsg.cmp(key.modulus)>=0)throw new Error("data too long for modulus")}return reverse?crt(paddedMsg,key):withPublic(paddedMsg,key)}}).call(this,_dereq_("buffer").Buffer)},{"./mgf":131,"./withPublic":134,"./xor":135,"bn.js":18,"browserify-rsa":39,buffer:49,"create-hash":53,"parse-asn1":123,randombytes:136}],134:[function(_dereq_,module,exports){(function(Buffer){function withPublic(paddedMsg,key){return new Buffer(paddedMsg.toRed(bn.mont(key.modulus)).redPow(new bn(key.publicExponent)).fromRed().toArray())}var bn=_dereq_("bn.js");module.exports=withPublic}).call(this,_dereq_("buffer").Buffer)},{"bn.js":18,buffer:49}],135:[function(_dereq_,module,exports){module.exports=function(a,b){for(var len=a.length,i=-1;++i<len;)a[i]^=b[i];return a}},{}],136:[function(_dereq_,module,exports){(function(process,global,Buffer){"use strict";function oldBrowser(){throw new Error("secure random number generation not supported by this browser\nuse chrome, FireFox or Internet Explorer 11")}function randomBytes(size,cb){if(size>65536)throw new Error("requested too many random bytes");var rawBytes=new global.Uint8Array(size);size>0&&crypto.getRandomValues(rawBytes);var bytes=new Buffer(rawBytes.buffer);return"function"==typeof cb?process.nextTick(function(){cb(null,bytes)}):bytes}var crypto=global.crypto||global.msCrypto;crypto&&crypto.getRandomValues?module.exports=randomBytes:module.exports=oldBrowser}).call(this,_dereq_("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},_dereq_("buffer").Buffer)},{_process:127,buffer:49}],137:[function(_dereq_,module,exports){module.exports=_dereq_("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":138}],138:[function(_dereq_,module,exports){"use strict";function Duplex(options){return this instanceof Duplex?(Readable.call(this,options),Writable.call(this,options),options&&options.readable===!1&&(this.readable=!1),options&&options.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,options&&options.allowHalfOpen===!1&&(this.allowHalfOpen=!1),void this.once("end",onend)):new Duplex(options)}function onend(){this.allowHalfOpen||this._writableState.ended||processNextTick(onEndNT,this)}function onEndNT(self){self.end()}var objectKeys=Object.keys||function(obj){var keys=[];for(var key in obj)keys.push(key);return keys};module.exports=Duplex;var processNextTick=_dereq_("process-nextick-args"),util=_dereq_("core-util-is");util.inherits=_dereq_("inherits");var Readable=_dereq_("./_stream_readable"),Writable=_dereq_("./_stream_writable");util.inherits(Duplex,Readable);for(var keys=objectKeys(Writable.prototype),v=0;v<keys.length;v++){var method=keys[v];Duplex.prototype[method]||(Duplex.prototype[method]=Writable.prototype[method])}},{"./_stream_readable":140,"./_stream_writable":142,"core-util-is":51,inherits:112,"process-nextick-args":126}],139:[function(_dereq_,module,exports){"use strict";function PassThrough(options){return this instanceof PassThrough?void Transform.call(this,options):new PassThrough(options)}module.exports=PassThrough;var Transform=_dereq_("./_stream_transform"),util=_dereq_("core-util-is");util.inherits=_dereq_("inherits"),util.inherits(PassThrough,Transform),PassThrough.prototype._transform=function(chunk,encoding,cb){cb(null,chunk)}},{"./_stream_transform":141,"core-util-is":51,inherits:112}],140:[function(_dereq_,module,exports){(function(process){"use strict";function prependListener(emitter,event,fn){return"function"==typeof emitter.prependListener?emitter.prependListener(event,fn):void(emitter._events&&emitter._events[event]?isArray(emitter._events[event])?emitter._events[event].unshift(fn):emitter._events[event]=[fn,emitter._events[event]]:emitter.on(event,fn))}function ReadableState(options,stream){Duplex=Duplex||_dereq_("./_stream_duplex"),options=options||{},this.objectMode=!!options.objectMode,stream instanceof Duplex&&(this.objectMode=this.objectMode||!!options.readableObjectMode);var hwm=options.highWaterMark,defaultHwm=this.objectMode?16:16384;this.highWaterMark=hwm||0===hwm?hwm:defaultHwm,this.highWaterMark=~~this.highWaterMark,this.buffer=new BufferList,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=options.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,options.encoding&&(StringDecoder||(StringDecoder=_dereq_("string_decoder/").StringDecoder),this.decoder=new StringDecoder(options.encoding),this.encoding=options.encoding)}function Readable(options){return Duplex=Duplex||_dereq_("./_stream_duplex"),this instanceof Readable?(this._readableState=new ReadableState(options,this),this.readable=!0,options&&"function"==typeof options.read&&(this._read=options.read),void Stream.call(this)):new Readable(options)}function readableAddChunk(stream,state,chunk,encoding,addToFront){var er=chunkInvalid(state,chunk);if(er)stream.emit("error",er);else if(null===chunk)state.reading=!1,onEofChunk(stream,state);else if(state.objectMode||chunk&&chunk.length>0)if(state.ended&&!addToFront){var e=new Error("stream.push() after EOF");stream.emit("error",e)}else if(state.endEmitted&&addToFront){var _e=new Error("stream.unshift() after end event");stream.emit("error",_e)}else{var skipAdd;!state.decoder||addToFront||encoding||(chunk=state.decoder.write(chunk),skipAdd=!state.objectMode&&0===chunk.length),addToFront||(state.reading=!1),skipAdd||(state.flowing&&0===state.length&&!state.sync?(stream.emit("data",chunk),stream.read(0)):(state.length+=state.objectMode?1:chunk.length,addToFront?state.buffer.unshift(chunk):state.buffer.push(chunk),state.needReadable&&emitReadable(stream))),maybeReadMore(stream,state)}else addToFront||(state.reading=!1);return needMoreData(state)}function needMoreData(state){return!state.ended&&(state.needReadable||state.length<state.highWaterMark||0===state.length)}function computeNewHighWaterMark(n){return n>=MAX_HWM?n=MAX_HWM:(n--,n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,n|=n>>>16,n++),n}function howMuchToRead(n,state){return n<=0||0===state.length&&state.ended?0:state.objectMode?1:n!==n?state.flowing&&state.length?state.buffer.head.data.length:state.length:(n>state.highWaterMark&&(state.highWaterMark=computeNewHighWaterMark(n)),n<=state.length?n:state.ended?state.length:(state.needReadable=!0,0))}function chunkInvalid(state,chunk){var er=null;return Buffer.isBuffer(chunk)||"string"==typeof chunk||null===chunk||void 0===chunk||state.objectMode||(er=new TypeError("Invalid non-string/buffer chunk")),er}function onEofChunk(stream,state){if(!state.ended){if(state.decoder){var chunk=state.decoder.end();chunk&&chunk.length&&(state.buffer.push(chunk),state.length+=state.objectMode?1:chunk.length)}state.ended=!0,emitReadable(stream)}}function emitReadable(stream){var state=stream._readableState;state.needReadable=!1,state.emittedReadable||(debug("emitReadable",state.flowing),state.emittedReadable=!0,state.sync?processNextTick(emitReadable_,stream):emitReadable_(stream))}function emitReadable_(stream){debug("emit readable"),stream.emit("readable"),flow(stream)}function maybeReadMore(stream,state){state.readingMore||(state.readingMore=!0,processNextTick(maybeReadMore_,stream,state))}function maybeReadMore_(stream,state){for(var len=state.length;!state.reading&&!state.flowing&&!state.ended&&state.length<state.highWaterMark&&(debug("maybeReadMore read 0"),stream.read(0),len!==state.length);)len=state.length;state.readingMore=!1}function pipeOnDrain(src){return function(){var state=src._readableState;debug("pipeOnDrain",state.awaitDrain),state.awaitDrain&&state.awaitDrain--,0===state.awaitDrain&&EElistenerCount(src,"data")&&(state.flowing=!0,flow(src))}}function nReadingNextTick(self){debug("readable nexttick read 0"),self.read(0)}function resume(stream,state){state.resumeScheduled||(state.resumeScheduled=!0,processNextTick(resume_,stream,state))}function resume_(stream,state){state.reading||(debug("resume read 0"),stream.read(0)),state.resumeScheduled=!1,state.awaitDrain=0,stream.emit("resume"),flow(stream),state.flowing&&!state.reading&&stream.read(0)}function flow(stream){var state=stream._readableState;for(debug("flow",state.flowing);state.flowing&&null!==stream.read(););}function fromList(n,state){if(0===state.length)return null;var ret;return state.objectMode?ret=state.buffer.shift():!n||n>=state.length?(ret=state.decoder?state.buffer.join(""):1===state.buffer.length?state.buffer.head.data:state.buffer.concat(state.length),state.buffer.clear()):ret=fromListPartial(n,state.buffer,state.decoder),ret}function fromListPartial(n,list,hasStrings){var ret;return n<list.head.data.length?(ret=list.head.data.slice(0,n),list.head.data=list.head.data.slice(n)):ret=n===list.head.data.length?list.shift():hasStrings?copyFromBufferString(n,list):copyFromBuffer(n,list),ret}function copyFromBufferString(n,list){var p=list.head,c=1,ret=p.data;for(n-=ret.length;p=p.next;){var str=p.data,nb=n>str.length?str.length:n;if(ret+=nb===str.length?str:str.slice(0,n),n-=nb,0===n){nb===str.length?(++c,p.next?list.head=p.next:list.head=list.tail=null):(list.head=p,p.data=str.slice(nb));break}++c}return list.length-=c,ret}function copyFromBuffer(n,list){var ret=bufferShim.allocUnsafe(n),p=list.head,c=1;for(p.data.copy(ret),n-=p.data.length;p=p.next;){var buf=p.data,nb=n>buf.length?buf.length:n;if(buf.copy(ret,ret.length-n,0,nb),n-=nb,0===n){nb===buf.length?(++c,p.next?list.head=p.next:list.head=list.tail=null):(list.head=p,p.data=buf.slice(nb));break}++c}return list.length-=c,ret}function endReadable(stream){var state=stream._readableState;if(state.length>0)throw new Error('"endReadable()" called on non-empty stream');state.endEmitted||(state.ended=!0,processNextTick(endReadableNT,state,stream))}function endReadableNT(state,stream){state.endEmitted||0!==state.length||(state.endEmitted=!0,stream.readable=!1,stream.emit("end"))}function forEach(xs,f){for(var i=0,l=xs.length;i<l;i++)f(xs[i],i)}function indexOf(xs,x){for(var i=0,l=xs.length;i<l;i++)if(xs[i]===x)return i;return-1}module.exports=Readable;var Duplex,processNextTick=_dereq_("process-nextick-args"),isArray=_dereq_("isarray");Readable.ReadableState=ReadableState;var Stream,EElistenerCount=(_dereq_("events").EventEmitter,function(emitter,type){return emitter.listeners(type).length});!function(){try{Stream=_dereq_("stream")}catch(_){}finally{Stream||(Stream=_dereq_("events").EventEmitter)}}();var Buffer=_dereq_("buffer").Buffer,bufferShim=_dereq_("buffer-shims"),util=_dereq_("core-util-is");util.inherits=_dereq_("inherits");var debugUtil=_dereq_("util"),debug=void 0;debug=debugUtil&&debugUtil.debuglog?debugUtil.debuglog("stream"):function(){};
var StringDecoder,BufferList=_dereq_("./internal/streams/BufferList");util.inherits(Readable,Stream),Readable.prototype.push=function(chunk,encoding){var state=this._readableState;return state.objectMode||"string"!=typeof chunk||(encoding=encoding||state.defaultEncoding,encoding!==state.encoding&&(chunk=bufferShim.from(chunk,encoding),encoding="")),readableAddChunk(this,state,chunk,encoding,!1)},Readable.prototype.unshift=function(chunk){var state=this._readableState;return readableAddChunk(this,state,chunk,"",!0)},Readable.prototype.isPaused=function(){return this._readableState.flowing===!1},Readable.prototype.setEncoding=function(enc){return StringDecoder||(StringDecoder=_dereq_("string_decoder/").StringDecoder),this._readableState.decoder=new StringDecoder(enc),this._readableState.encoding=enc,this};var MAX_HWM=8388608;Readable.prototype.read=function(n){debug("read",n),n=parseInt(n,10);var state=this._readableState,nOrig=n;if(0!==n&&(state.emittedReadable=!1),0===n&&state.needReadable&&(state.length>=state.highWaterMark||state.ended))return debug("read: emitReadable",state.length,state.ended),0===state.length&&state.ended?endReadable(this):emitReadable(this),null;if(n=howMuchToRead(n,state),0===n&&state.ended)return 0===state.length&&endReadable(this),null;var doRead=state.needReadable;debug("need readable",doRead),(0===state.length||state.length-n<state.highWaterMark)&&(doRead=!0,debug("length less than watermark",doRead)),state.ended||state.reading?(doRead=!1,debug("reading or ended",doRead)):doRead&&(debug("do read"),state.reading=!0,state.sync=!0,0===state.length&&(state.needReadable=!0),this._read(state.highWaterMark),state.sync=!1,state.reading||(n=howMuchToRead(nOrig,state)));var ret;return ret=n>0?fromList(n,state):null,null===ret?(state.needReadable=!0,n=0):state.length-=n,0===state.length&&(state.ended||(state.needReadable=!0),nOrig!==n&&state.ended&&endReadable(this)),null!==ret&&this.emit("data",ret),ret},Readable.prototype._read=function(n){this.emit("error",new Error("_read() is not implemented"))},Readable.prototype.pipe=function(dest,pipeOpts){function onunpipe(readable){debug("onunpipe"),readable===src&&cleanup()}function onend(){debug("onend"),dest.end()}function cleanup(){debug("cleanup"),dest.removeListener("close",onclose),dest.removeListener("finish",onfinish),dest.removeListener("drain",ondrain),dest.removeListener("error",onerror),dest.removeListener("unpipe",onunpipe),src.removeListener("end",onend),src.removeListener("end",cleanup),src.removeListener("data",ondata),cleanedUp=!0,!state.awaitDrain||dest._writableState&&!dest._writableState.needDrain||ondrain()}function ondata(chunk){debug("ondata"),increasedAwaitDrain=!1;var ret=dest.write(chunk);!1!==ret||increasedAwaitDrain||((1===state.pipesCount&&state.pipes===dest||state.pipesCount>1&&indexOf(state.pipes,dest)!==-1)&&!cleanedUp&&(debug("false write response, pause",src._readableState.awaitDrain),src._readableState.awaitDrain++,increasedAwaitDrain=!0),src.pause())}function onerror(er){debug("onerror",er),unpipe(),dest.removeListener("error",onerror),0===EElistenerCount(dest,"error")&&dest.emit("error",er)}function onclose(){dest.removeListener("finish",onfinish),unpipe()}function onfinish(){debug("onfinish"),dest.removeListener("close",onclose),unpipe()}function unpipe(){debug("unpipe"),src.unpipe(dest)}var src=this,state=this._readableState;switch(state.pipesCount){case 0:state.pipes=dest;break;case 1:state.pipes=[state.pipes,dest];break;default:state.pipes.push(dest)}state.pipesCount+=1,debug("pipe count=%d opts=%j",state.pipesCount,pipeOpts);var doEnd=(!pipeOpts||pipeOpts.end!==!1)&&dest!==process.stdout&&dest!==process.stderr,endFn=doEnd?onend:cleanup;state.endEmitted?processNextTick(endFn):src.once("end",endFn),dest.on("unpipe",onunpipe);var ondrain=pipeOnDrain(src);dest.on("drain",ondrain);var cleanedUp=!1,increasedAwaitDrain=!1;return src.on("data",ondata),prependListener(dest,"error",onerror),dest.once("close",onclose),dest.once("finish",onfinish),dest.emit("pipe",src),state.flowing||(debug("pipe resume"),src.resume()),dest},Readable.prototype.unpipe=function(dest){var state=this._readableState;if(0===state.pipesCount)return this;if(1===state.pipesCount)return dest&&dest!==state.pipes?this:(dest||(dest=state.pipes),state.pipes=null,state.pipesCount=0,state.flowing=!1,dest&&dest.emit("unpipe",this),this);if(!dest){var dests=state.pipes,len=state.pipesCount;state.pipes=null,state.pipesCount=0,state.flowing=!1;for(var i=0;i<len;i++)dests[i].emit("unpipe",this);return this}var index=indexOf(state.pipes,dest);return index===-1?this:(state.pipes.splice(index,1),state.pipesCount-=1,1===state.pipesCount&&(state.pipes=state.pipes[0]),dest.emit("unpipe",this),this)},Readable.prototype.on=function(ev,fn){var res=Stream.prototype.on.call(this,ev,fn);if("data"===ev)this._readableState.flowing!==!1&&this.resume();else if("readable"===ev){var state=this._readableState;state.endEmitted||state.readableListening||(state.readableListening=state.needReadable=!0,state.emittedReadable=!1,state.reading?state.length&&emitReadable(this,state):processNextTick(nReadingNextTick,this))}return res},Readable.prototype.addListener=Readable.prototype.on,Readable.prototype.resume=function(){var state=this._readableState;return state.flowing||(debug("resume"),state.flowing=!0,resume(this,state)),this},Readable.prototype.pause=function(){return debug("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(debug("pause"),this._readableState.flowing=!1,this.emit("pause")),this},Readable.prototype.wrap=function(stream){var state=this._readableState,paused=!1,self=this;stream.on("end",function(){if(debug("wrapped end"),state.decoder&&!state.ended){var chunk=state.decoder.end();chunk&&chunk.length&&self.push(chunk)}self.push(null)}),stream.on("data",function(chunk){if(debug("wrapped data"),state.decoder&&(chunk=state.decoder.write(chunk)),(!state.objectMode||null!==chunk&&void 0!==chunk)&&(state.objectMode||chunk&&chunk.length)){var ret=self.push(chunk);ret||(paused=!0,stream.pause())}});for(var i in stream)void 0===this[i]&&"function"==typeof stream[i]&&(this[i]=function(method){return function(){return stream[method].apply(stream,arguments)}}(i));var events=["error","close","destroy","pause","resume"];return forEach(events,function(ev){stream.on(ev,self.emit.bind(self,ev))}),self._read=function(n){debug("wrapped _read",n),paused&&(paused=!1,stream.resume())},self},Readable._fromList=fromList}).call(this,_dereq_("_process"))},{"./_stream_duplex":138,"./internal/streams/BufferList":143,_process:127,buffer:49,"buffer-shims":47,"core-util-is":51,events:99,inherits:112,isarray:114,"process-nextick-args":126,"string_decoder/":158,util:20}],141:[function(_dereq_,module,exports){"use strict";function TransformState(stream){this.afterTransform=function(er,data){return afterTransform(stream,er,data)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function afterTransform(stream,er,data){var ts=stream._transformState;ts.transforming=!1;var cb=ts.writecb;if(!cb)return stream.emit("error",new Error("no writecb in Transform class"));ts.writechunk=null,ts.writecb=null,null!==data&&void 0!==data&&stream.push(data),cb(er);var rs=stream._readableState;rs.reading=!1,(rs.needReadable||rs.length<rs.highWaterMark)&&stream._read(rs.highWaterMark)}function Transform(options){if(!(this instanceof Transform))return new Transform(options);Duplex.call(this,options),this._transformState=new TransformState(this);var stream=this;this._readableState.needReadable=!0,this._readableState.sync=!1,options&&("function"==typeof options.transform&&(this._transform=options.transform),"function"==typeof options.flush&&(this._flush=options.flush)),this.once("prefinish",function(){"function"==typeof this._flush?this._flush(function(er,data){done(stream,er,data)}):done(stream)})}function done(stream,er,data){if(er)return stream.emit("error",er);null!==data&&void 0!==data&&stream.push(data);var ws=stream._writableState,ts=stream._transformState;if(ws.length)throw new Error("Calling transform done when ws.length != 0");if(ts.transforming)throw new Error("Calling transform done when still transforming");return stream.push(null)}module.exports=Transform;var Duplex=_dereq_("./_stream_duplex"),util=_dereq_("core-util-is");util.inherits=_dereq_("inherits"),util.inherits(Transform,Duplex),Transform.prototype.push=function(chunk,encoding){return this._transformState.needTransform=!1,Duplex.prototype.push.call(this,chunk,encoding)},Transform.prototype._transform=function(chunk,encoding,cb){throw new Error("_transform() is not implemented")},Transform.prototype._write=function(chunk,encoding,cb){var ts=this._transformState;if(ts.writecb=cb,ts.writechunk=chunk,ts.writeencoding=encoding,!ts.transforming){var rs=this._readableState;(ts.needTransform||rs.needReadable||rs.length<rs.highWaterMark)&&this._read(rs.highWaterMark)}},Transform.prototype._read=function(n){var ts=this._transformState;null!==ts.writechunk&&ts.writecb&&!ts.transforming?(ts.transforming=!0,this._transform(ts.writechunk,ts.writeencoding,ts.afterTransform)):ts.needTransform=!0}},{"./_stream_duplex":138,"core-util-is":51,inherits:112}],142:[function(_dereq_,module,exports){(function(process){"use strict";function nop(){}function WriteReq(chunk,encoding,cb){this.chunk=chunk,this.encoding=encoding,this.callback=cb,this.next=null}function WritableState(options,stream){Duplex=Duplex||_dereq_("./_stream_duplex"),options=options||{},this.objectMode=!!options.objectMode,stream instanceof Duplex&&(this.objectMode=this.objectMode||!!options.writableObjectMode);var hwm=options.highWaterMark,defaultHwm=this.objectMode?16:16384;this.highWaterMark=hwm||0===hwm?hwm:defaultHwm,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var noDecode=options.decodeStrings===!1;this.decodeStrings=!noDecode,this.defaultEncoding=options.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(er){onwrite(stream,er)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new CorkedRequest(this)}function Writable(options){return Duplex=Duplex||_dereq_("./_stream_duplex"),realHasInstance.call(Writable,this)||this instanceof Duplex?(this._writableState=new WritableState(options,this),this.writable=!0,options&&("function"==typeof options.write&&(this._write=options.write),"function"==typeof options.writev&&(this._writev=options.writev)),void Stream.call(this)):new Writable(options)}function writeAfterEnd(stream,cb){var er=new Error("write after end");stream.emit("error",er),processNextTick(cb,er)}function validChunk(stream,state,chunk,cb){var valid=!0,er=!1;return null===chunk?er=new TypeError("May not write null values to stream"):"string"==typeof chunk||void 0===chunk||state.objectMode||(er=new TypeError("Invalid non-string/buffer chunk")),er&&(stream.emit("error",er),processNextTick(cb,er),valid=!1),valid}function decodeChunk(state,chunk,encoding){return state.objectMode||state.decodeStrings===!1||"string"!=typeof chunk||(chunk=bufferShim.from(chunk,encoding)),chunk}function writeOrBuffer(stream,state,isBuf,chunk,encoding,cb){isBuf||(chunk=decodeChunk(state,chunk,encoding),Buffer.isBuffer(chunk)&&(encoding="buffer"));var len=state.objectMode?1:chunk.length;state.length+=len;var ret=state.length<state.highWaterMark;if(ret||(state.needDrain=!0),state.writing||state.corked){var last=state.lastBufferedRequest;state.lastBufferedRequest=new WriteReq(chunk,encoding,cb),last?last.next=state.lastBufferedRequest:state.bufferedRequest=state.lastBufferedRequest,state.bufferedRequestCount+=1}else doWrite(stream,state,!1,len,chunk,encoding,cb);return ret}function doWrite(stream,state,writev,len,chunk,encoding,cb){state.writelen=len,state.writecb=cb,state.writing=!0,state.sync=!0,writev?stream._writev(chunk,state.onwrite):stream._write(chunk,encoding,state.onwrite),state.sync=!1}function onwriteError(stream,state,sync,er,cb){--state.pendingcb,sync?processNextTick(cb,er):cb(er),stream._writableState.errorEmitted=!0,stream.emit("error",er)}function onwriteStateUpdate(state){state.writing=!1,state.writecb=null,state.length-=state.writelen,state.writelen=0}function onwrite(stream,er){var state=stream._writableState,sync=state.sync,cb=state.writecb;if(onwriteStateUpdate(state),er)onwriteError(stream,state,sync,er,cb);else{var finished=needFinish(state);finished||state.corked||state.bufferProcessing||!state.bufferedRequest||clearBuffer(stream,state),sync?asyncWrite(afterWrite,stream,state,finished,cb):afterWrite(stream,state,finished,cb)}}function afterWrite(stream,state,finished,cb){finished||onwriteDrain(stream,state),state.pendingcb--,cb(),finishMaybe(stream,state)}function onwriteDrain(stream,state){0===state.length&&state.needDrain&&(state.needDrain=!1,stream.emit("drain"))}function clearBuffer(stream,state){state.bufferProcessing=!0;var entry=state.bufferedRequest;if(stream._writev&&entry&&entry.next){var l=state.bufferedRequestCount,buffer=new Array(l),holder=state.corkedRequestsFree;holder.entry=entry;for(var count=0;entry;)buffer[count]=entry,entry=entry.next,count+=1;doWrite(stream,state,!0,state.length,buffer,"",holder.finish),state.pendingcb++,state.lastBufferedRequest=null,holder.next?(state.corkedRequestsFree=holder.next,holder.next=null):state.corkedRequestsFree=new CorkedRequest(state)}else{for(;entry;){var chunk=entry.chunk,encoding=entry.encoding,cb=entry.callback,len=state.objectMode?1:chunk.length;if(doWrite(stream,state,!1,len,chunk,encoding,cb),entry=entry.next,state.writing)break}null===entry&&(state.lastBufferedRequest=null)}state.bufferedRequestCount=0,state.bufferedRequest=entry,state.bufferProcessing=!1}function needFinish(state){return state.ending&&0===state.length&&null===state.bufferedRequest&&!state.finished&&!state.writing}function prefinish(stream,state){state.prefinished||(state.prefinished=!0,stream.emit("prefinish"))}function finishMaybe(stream,state){var need=needFinish(state);return need&&(0===state.pendingcb?(prefinish(stream,state),state.finished=!0,stream.emit("finish")):prefinish(stream,state)),need}function endWritable(stream,state,cb){state.ending=!0,finishMaybe(stream,state),cb&&(state.finished?processNextTick(cb):stream.once("finish",cb)),state.ended=!0,stream.writable=!1}function CorkedRequest(state){var _this=this;this.next=null,this.entry=null,this.finish=function(err){var entry=_this.entry;for(_this.entry=null;entry;){var cb=entry.callback;state.pendingcb--,cb(err),entry=entry.next}state.corkedRequestsFree?state.corkedRequestsFree.next=_this:state.corkedRequestsFree=_this}}module.exports=Writable;var Duplex,processNextTick=_dereq_("process-nextick-args"),asyncWrite=!process.browser&&["v0.10","v0.9."].indexOf(process.version.slice(0,5))>-1?setImmediate:processNextTick;Writable.WritableState=WritableState;var util=_dereq_("core-util-is");util.inherits=_dereq_("inherits");var Stream,internalUtil={deprecate:_dereq_("util-deprecate")};!function(){try{Stream=_dereq_("stream")}catch(_){}finally{Stream||(Stream=_dereq_("events").EventEmitter)}}();var Buffer=_dereq_("buffer").Buffer,bufferShim=_dereq_("buffer-shims");util.inherits(Writable,Stream),WritableState.prototype.getBuffer=function(){for(var current=this.bufferedRequest,out=[];current;)out.push(current),current=current.next;return out},function(){try{Object.defineProperty(WritableState.prototype,"buffer",{get:internalUtil.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")})}catch(_){}}();var realHasInstance;"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(realHasInstance=Function.prototype[Symbol.hasInstance],Object.defineProperty(Writable,Symbol.hasInstance,{value:function(object){return!!realHasInstance.call(this,object)||object&&object._writableState instanceof WritableState}})):realHasInstance=function(object){return object instanceof this},Writable.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},Writable.prototype.write=function(chunk,encoding,cb){var state=this._writableState,ret=!1,isBuf=Buffer.isBuffer(chunk);return"function"==typeof encoding&&(cb=encoding,encoding=null),isBuf?encoding="buffer":encoding||(encoding=state.defaultEncoding),"function"!=typeof cb&&(cb=nop),state.ended?writeAfterEnd(this,cb):(isBuf||validChunk(this,state,chunk,cb))&&(state.pendingcb++,ret=writeOrBuffer(this,state,isBuf,chunk,encoding,cb)),ret},Writable.prototype.cork=function(){var state=this._writableState;state.corked++},Writable.prototype.uncork=function(){var state=this._writableState;state.corked&&(state.corked--,state.writing||state.corked||state.finished||state.bufferProcessing||!state.bufferedRequest||clearBuffer(this,state))},Writable.prototype.setDefaultEncoding=function(encoding){if("string"==typeof encoding&&(encoding=encoding.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((encoding+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+encoding);return this._writableState.defaultEncoding=encoding,this},Writable.prototype._write=function(chunk,encoding,cb){cb(new Error("_write() is not implemented"))},Writable.prototype._writev=null,Writable.prototype.end=function(chunk,encoding,cb){var state=this._writableState;"function"==typeof chunk?(cb=chunk,chunk=null,encoding=null):"function"==typeof encoding&&(cb=encoding,encoding=null),null!==chunk&&void 0!==chunk&&this.write(chunk,encoding),state.corked&&(state.corked=1,this.uncork()),state.ending||state.finished||endWritable(this,state,cb)}}).call(this,_dereq_("_process"))},{"./_stream_duplex":138,_process:127,buffer:49,"buffer-shims":47,"core-util-is":51,events:99,inherits:112,"process-nextick-args":126,"util-deprecate":160}],143:[function(_dereq_,module,exports){"use strict";function BufferList(){this.head=null,this.tail=null,this.length=0}var bufferShim=(_dereq_("buffer").Buffer,_dereq_("buffer-shims"));module.exports=BufferList,BufferList.prototype.push=function(v){var entry={data:v,next:null};this.length>0?this.tail.next=entry:this.head=entry,this.tail=entry,++this.length},BufferList.prototype.unshift=function(v){var entry={data:v,next:this.head};0===this.length&&(this.tail=entry),this.head=entry,++this.length},BufferList.prototype.shift=function(){if(0!==this.length){var ret=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,ret}},BufferList.prototype.clear=function(){this.head=this.tail=null,this.length=0},BufferList.prototype.join=function(s){if(0===this.length)return"";for(var p=this.head,ret=""+p.data;p=p.next;)ret+=s+p.data;return ret},BufferList.prototype.concat=function(n){if(0===this.length)return bufferShim.alloc(0);if(1===this.length)return this.head.data;for(var ret=bufferShim.allocUnsafe(n>>>0),p=this.head,i=0;p;)p.data.copy(ret,i),i+=p.data.length,p=p.next;return ret}},{buffer:49,"buffer-shims":47}],144:[function(_dereq_,module,exports){module.exports=_dereq_("./lib/_stream_passthrough.js")},{"./lib/_stream_passthrough.js":139}],145:[function(_dereq_,module,exports){(function(process){var Stream=function(){try{return _dereq_("stream")}catch(_){}}();exports=module.exports=_dereq_("./lib/_stream_readable.js"),exports.Stream=Stream||exports,exports.Readable=exports,exports.Writable=_dereq_("./lib/_stream_writable.js"),exports.Duplex=_dereq_("./lib/_stream_duplex.js"),exports.Transform=_dereq_("./lib/_stream_transform.js"),exports.PassThrough=_dereq_("./lib/_stream_passthrough.js"),!process.browser&&"disable"===process.env.READABLE_STREAM&&Stream&&(module.exports=Stream)}).call(this,_dereq_("_process"))},{"./lib/_stream_duplex.js":138,"./lib/_stream_passthrough.js":139,"./lib/_stream_readable.js":140,"./lib/_stream_transform.js":141,"./lib/_stream_writable.js":142,_process:127}],146:[function(_dereq_,module,exports){module.exports=_dereq_("./lib/_stream_transform.js")},{"./lib/_stream_transform.js":141}],147:[function(_dereq_,module,exports){module.exports=_dereq_("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":142}],148:[function(_dereq_,module,exports){(function(Buffer){function bytesToWords(bytes){for(var words=[],i=0,b=0;i<bytes.length;i++,b+=8)words[b>>>5]|=bytes[i]<<24-b%32;return words}function wordsToBytes(words){for(var bytes=[],b=0;b<32*words.length;b+=8)bytes.push(words[b>>>5]>>>24-b%32&255);return bytes}function processBlock(H,M,offset){for(var i=0;i<16;i++){var offset_i=offset+i,M_offset_i=M[offset_i];M[offset_i]=16711935&(M_offset_i<<8|M_offset_i>>>24)|4278255360&(M_offset_i<<24|M_offset_i>>>8)}var al,bl,cl,dl,el,ar,br,cr,dr,er;ar=al=H[0],br=bl=H[1],cr=cl=H[2],dr=dl=H[3],er=el=H[4];var t;for(i=0;i<80;i+=1)t=al+M[offset+zl[i]]|0,t+=i<16?f1(bl,cl,dl)+hl[0]:i<32?f2(bl,cl,dl)+hl[1]:i<48?f3(bl,cl,dl)+hl[2]:i<64?f4(bl,cl,dl)+hl[3]:f5(bl,cl,dl)+hl[4],t=0|t,t=rotl(t,sl[i]),t=t+el|0,al=el,el=dl,dl=rotl(cl,10),cl=bl,bl=t,t=ar+M[offset+zr[i]]|0,t+=i<16?f5(br,cr,dr)+hr[0]:i<32?f4(br,cr,dr)+hr[1]:i<48?f3(br,cr,dr)+hr[2]:i<64?f2(br,cr,dr)+hr[3]:f1(br,cr,dr)+hr[4],t=0|t,t=rotl(t,sr[i]),t=t+er|0,ar=er,er=dr,dr=rotl(cr,10),cr=br,br=t;t=H[1]+cl+dr|0,H[1]=H[2]+dl+er|0,H[2]=H[3]+el+ar|0,H[3]=H[4]+al+br|0,H[4]=H[0]+bl+cr|0,H[0]=t}function f1(x,y,z){return x^y^z}function f2(x,y,z){return x&y|~x&z}function f3(x,y,z){return(x|~y)^z}function f4(x,y,z){return x&z|y&~z}function f5(x,y,z){return x^(y|~z)}function rotl(x,n){return x<<n|x>>>32-n}function ripemd160(message){var H=[1732584193,4023233417,2562383102,271733878,3285377520];"string"==typeof message&&(message=new Buffer(message,"utf8"));var m=bytesToWords(message),nBitsLeft=8*message.length,nBitsTotal=8*message.length;m[nBitsLeft>>>5]|=128<<24-nBitsLeft%32,m[(nBitsLeft+64>>>9<<4)+14]=16711935&(nBitsTotal<<8|nBitsTotal>>>24)|4278255360&(nBitsTotal<<24|nBitsTotal>>>8);for(var i=0;i<m.length;i+=16)processBlock(H,m,i);for(i=0;i<5;i++){var H_i=H[i];H[i]=16711935&(H_i<<8|H_i>>>24)|4278255360&(H_i<<24|H_i>>>8)}var digestbytes=wordsToBytes(H);return new Buffer(digestbytes)}var zl=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],zr=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],sl=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],sr=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],hl=[0,1518500249,1859775393,2400959708,2840853838],hr=[1352829926,1548603684,1836072691,2053994217,0];module.exports=ripemd160}).call(this,_dereq_("buffer").Buffer)},{buffer:49}],149:[function(_dereq_,module,exports){(function(Buffer){function Hash(blockSize,finalSize){this._block=new Buffer(blockSize),this._finalSize=finalSize,this._blockSize=blockSize,this._len=0,this._s=0}Hash.prototype.update=function(data,enc){"string"==typeof data&&(enc=enc||"utf8",data=new Buffer(data,enc));for(var l=this._len+=data.length,s=this._s||0,f=0,buffer=this._block;s<l;){for(var t=Math.min(data.length,f+this._blockSize-s%this._blockSize),ch=t-f,i=0;i<ch;i++)buffer[s%this._blockSize+i]=data[i+f];s+=ch,f+=ch,s%this._blockSize===0&&this._update(buffer)}return this._s=s,this},Hash.prototype.digest=function(enc){var l=8*this._len;this._block[this._len%this._blockSize]=128,this._block.fill(0,this._len%this._blockSize+1),l%(8*this._blockSize)>=8*this._finalSize&&(this._update(this._block),this._block.fill(0)),this._block.writeInt32BE(l,this._blockSize-4);var hash=this._update(this._block)||this._hash();return enc?hash.toString(enc):hash},Hash.prototype._update=function(){throw new Error("_update must be implemented by subclass")},module.exports=Hash}).call(this,_dereq_("buffer").Buffer)},{buffer:49}],150:[function(_dereq_,module,exports){var exports=module.exports=function(algorithm){algorithm=algorithm.toLowerCase();var Algorithm=exports[algorithm];if(!Algorithm)throw new Error(algorithm+" is not supported (we accept pull requests)");return new Algorithm};exports.sha=_dereq_("./sha"),exports.sha1=_dereq_("./sha1"),exports.sha224=_dereq_("./sha224"),exports.sha256=_dereq_("./sha256"),exports.sha384=_dereq_("./sha384"),exports.sha512=_dereq_("./sha512")},{"./sha":151,"./sha1":152,"./sha224":153,"./sha256":154,"./sha384":155,"./sha512":156}],151:[function(_dereq_,module,exports){(function(Buffer){function Sha(){this.init(),this._w=W,Hash.call(this,64,56)}function rotl5(num){return num<<5|num>>>27}function rotl30(num){return num<<30|num>>>2}function ft(s,b,c,d){return 0===s?b&c|~b&d:2===s?b&c|b&d|c&d:b^c^d}var inherits=_dereq_("inherits"),Hash=_dereq_("./hash"),K=[1518500249,1859775393,-1894007588,-899497514],W=new Array(80);inherits(Sha,Hash),Sha.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},Sha.prototype._update=function(M){for(var W=this._w,a=0|this._a,b=0|this._b,c=0|this._c,d=0|this._d,e=0|this._e,i=0;i<16;++i)W[i]=M.readInt32BE(4*i);for(;i<80;++i)W[i]=W[i-3]^W[i-8]^W[i-14]^W[i-16];for(var j=0;j<80;++j){var s=~~(j/20),t=rotl5(a)+ft(s,b,c,d)+e+W[j]+K[s]|0;e=d,d=c,c=rotl30(b),b=a,a=t}this._a=a+this._a|0,this._b=b+this._b|0,this._c=c+this._c|0,this._d=d+this._d|0,this._e=e+this._e|0},Sha.prototype._hash=function(){var H=new Buffer(20);return H.writeInt32BE(0|this._a,0),H.writeInt32BE(0|this._b,4),H.writeInt32BE(0|this._c,8),H.writeInt32BE(0|this._d,12),H.writeInt32BE(0|this._e,16),H},module.exports=Sha}).call(this,_dereq_("buffer").Buffer)},{"./hash":149,buffer:49,inherits:112}],152:[function(_dereq_,module,exports){(function(Buffer){function Sha1(){this.init(),this._w=W,Hash.call(this,64,56)}function rotl1(num){return num<<1|num>>>31}function rotl5(num){return num<<5|num>>>27}function rotl30(num){return num<<30|num>>>2}function ft(s,b,c,d){return 0===s?b&c|~b&d:2===s?b&c|b&d|c&d:b^c^d}var inherits=_dereq_("inherits"),Hash=_dereq_("./hash"),K=[1518500249,1859775393,-1894007588,-899497514],W=new Array(80);inherits(Sha1,Hash),Sha1.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},Sha1.prototype._update=function(M){for(var W=this._w,a=0|this._a,b=0|this._b,c=0|this._c,d=0|this._d,e=0|this._e,i=0;i<16;++i)W[i]=M.readInt32BE(4*i);for(;i<80;++i)W[i]=rotl1(W[i-3]^W[i-8]^W[i-14]^W[i-16]);for(var j=0;j<80;++j){var s=~~(j/20),t=rotl5(a)+ft(s,b,c,d)+e+W[j]+K[s]|0;e=d,d=c,c=rotl30(b),b=a,a=t}this._a=a+this._a|0,this._b=b+this._b|0,this._c=c+this._c|0,this._d=d+this._d|0,this._e=e+this._e|0},Sha1.prototype._hash=function(){var H=new Buffer(20);return H.writeInt32BE(0|this._a,0),H.writeInt32BE(0|this._b,4),H.writeInt32BE(0|this._c,8),H.writeInt32BE(0|this._d,12),H.writeInt32BE(0|this._e,16),H},module.exports=Sha1}).call(this,_dereq_("buffer").Buffer)},{"./hash":149,buffer:49,inherits:112}],153:[function(_dereq_,module,exports){(function(Buffer){function Sha224(){this.init(),this._w=W,Hash.call(this,64,56)}var inherits=_dereq_("inherits"),Sha256=_dereq_("./sha256"),Hash=_dereq_("./hash"),W=new Array(64);inherits(Sha224,Sha256),Sha224.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},Sha224.prototype._hash=function(){var H=new Buffer(28);return H.writeInt32BE(this._a,0),H.writeInt32BE(this._b,4),H.writeInt32BE(this._c,8),H.writeInt32BE(this._d,12),H.writeInt32BE(this._e,16),H.writeInt32BE(this._f,20),H.writeInt32BE(this._g,24),H},module.exports=Sha224}).call(this,_dereq_("buffer").Buffer)},{"./hash":149,"./sha256":154,buffer:49,inherits:112}],154:[function(_dereq_,module,exports){(function(Buffer){function Sha256(){this.init(),this._w=W,Hash.call(this,64,56)}function ch(x,y,z){return z^x&(y^z)}function maj(x,y,z){return x&y|z&(x|y)}function sigma0(x){return(x>>>2|x<<30)^(x>>>13|x<<19)^(x>>>22|x<<10)}function sigma1(x){return(x>>>6|x<<26)^(x>>>11|x<<21)^(x>>>25|x<<7)}function gamma0(x){return(x>>>7|x<<25)^(x>>>18|x<<14)^x>>>3}function gamma1(x){return(x>>>17|x<<15)^(x>>>19|x<<13)^x>>>10}var inherits=_dereq_("inherits"),Hash=_dereq_("./hash"),K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],W=new Array(64);inherits(Sha256,Hash),Sha256.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},Sha256.prototype._update=function(M){for(var W=this._w,a=0|this._a,b=0|this._b,c=0|this._c,d=0|this._d,e=0|this._e,f=0|this._f,g=0|this._g,h=0|this._h,i=0;i<16;++i)W[i]=M.readInt32BE(4*i);for(;i<64;++i)W[i]=gamma1(W[i-2])+W[i-7]+gamma0(W[i-15])+W[i-16]|0;for(var j=0;j<64;++j){var T1=h+sigma1(e)+ch(e,f,g)+K[j]+W[j]|0,T2=sigma0(a)+maj(a,b,c)|0;h=g,g=f,f=e,e=d+T1|0,d=c,c=b,b=a,a=T1+T2|0}this._a=a+this._a|0,this._b=b+this._b|0,this._c=c+this._c|0,this._d=d+this._d|0,this._e=e+this._e|0,this._f=f+this._f|0,this._g=g+this._g|0,this._h=h+this._h|0},Sha256.prototype._hash=function(){var H=new Buffer(32);return H.writeInt32BE(this._a,0),H.writeInt32BE(this._b,4),H.writeInt32BE(this._c,8),H.writeInt32BE(this._d,12),H.writeInt32BE(this._e,16),H.writeInt32BE(this._f,20),H.writeInt32BE(this._g,24),H.writeInt32BE(this._h,28),H},module.exports=Sha256}).call(this,_dereq_("buffer").Buffer)},{"./hash":149,buffer:49,inherits:112}],155:[function(_dereq_,module,exports){(function(Buffer){function Sha384(){this.init(),this._w=W,Hash.call(this,128,112)}var inherits=_dereq_("inherits"),SHA512=_dereq_("./sha512"),Hash=_dereq_("./hash"),W=new Array(160);inherits(Sha384,SHA512),Sha384.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},Sha384.prototype._hash=function(){function writeInt64BE(h,l,offset){H.writeInt32BE(h,offset),H.writeInt32BE(l,offset+4)}var H=new Buffer(48);return writeInt64BE(this._ah,this._al,0),writeInt64BE(this._bh,this._bl,8),writeInt64BE(this._ch,this._cl,16),writeInt64BE(this._dh,this._dl,24),writeInt64BE(this._eh,this._el,32),writeInt64BE(this._fh,this._fl,40),H},module.exports=Sha384}).call(this,_dereq_("buffer").Buffer)},{"./hash":149,"./sha512":156,buffer:49,inherits:112}],156:[function(_dereq_,module,exports){(function(Buffer){function Sha512(){this.init(),this._w=W,Hash.call(this,128,112)}function Ch(x,y,z){return z^x&(y^z)}function maj(x,y,z){return x&y|z&(x|y);
}function sigma0(x,xl){return(x>>>28|xl<<4)^(xl>>>2|x<<30)^(xl>>>7|x<<25)}function sigma1(x,xl){return(x>>>14|xl<<18)^(x>>>18|xl<<14)^(xl>>>9|x<<23)}function Gamma0(x,xl){return(x>>>1|xl<<31)^(x>>>8|xl<<24)^x>>>7}function Gamma0l(x,xl){return(x>>>1|xl<<31)^(x>>>8|xl<<24)^(x>>>7|xl<<25)}function Gamma1(x,xl){return(x>>>19|xl<<13)^(xl>>>29|x<<3)^x>>>6}function Gamma1l(x,xl){return(x>>>19|xl<<13)^(xl>>>29|x<<3)^(x>>>6|xl<<26)}function getCarry(a,b){return a>>>0<b>>>0?1:0}var inherits=_dereq_("inherits"),Hash=_dereq_("./hash"),K=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],W=new Array(160);inherits(Sha512,Hash),Sha512.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},Sha512.prototype._update=function(M){for(var W=this._w,ah=0|this._ah,bh=0|this._bh,ch=0|this._ch,dh=0|this._dh,eh=0|this._eh,fh=0|this._fh,gh=0|this._gh,hh=0|this._hh,al=0|this._al,bl=0|this._bl,cl=0|this._cl,dl=0|this._dl,el=0|this._el,fl=0|this._fl,gl=0|this._gl,hl=0|this._hl,i=0;i<32;i+=2)W[i]=M.readInt32BE(4*i),W[i+1]=M.readInt32BE(4*i+4);for(;i<160;i+=2){var xh=W[i-30],xl=W[i-30+1],gamma0=Gamma0(xh,xl),gamma0l=Gamma0l(xl,xh);xh=W[i-4],xl=W[i-4+1];var gamma1=Gamma1(xh,xl),gamma1l=Gamma1l(xl,xh),Wi7h=W[i-14],Wi7l=W[i-14+1],Wi16h=W[i-32],Wi16l=W[i-32+1],Wil=gamma0l+Wi7l|0,Wih=gamma0+Wi7h+getCarry(Wil,gamma0l)|0;Wil=Wil+gamma1l|0,Wih=Wih+gamma1+getCarry(Wil,gamma1l)|0,Wil=Wil+Wi16l|0,Wih=Wih+Wi16h+getCarry(Wil,Wi16l)|0,W[i]=Wih,W[i+1]=Wil}for(var j=0;j<160;j+=2){Wih=W[j],Wil=W[j+1];var majh=maj(ah,bh,ch),majl=maj(al,bl,cl),sigma0h=sigma0(ah,al),sigma0l=sigma0(al,ah),sigma1h=sigma1(eh,el),sigma1l=sigma1(el,eh),Kih=K[j],Kil=K[j+1],chh=Ch(eh,fh,gh),chl=Ch(el,fl,gl),t1l=hl+sigma1l|0,t1h=hh+sigma1h+getCarry(t1l,hl)|0;t1l=t1l+chl|0,t1h=t1h+chh+getCarry(t1l,chl)|0,t1l=t1l+Kil|0,t1h=t1h+Kih+getCarry(t1l,Kil)|0,t1l=t1l+Wil|0,t1h=t1h+Wih+getCarry(t1l,Wil)|0;var t2l=sigma0l+majl|0,t2h=sigma0h+majh+getCarry(t2l,sigma0l)|0;hh=gh,hl=gl,gh=fh,gl=fl,fh=eh,fl=el,el=dl+t1l|0,eh=dh+t1h+getCarry(el,dl)|0,dh=ch,dl=cl,ch=bh,cl=bl,bh=ah,bl=al,al=t1l+t2l|0,ah=t1h+t2h+getCarry(al,t1l)|0}this._al=this._al+al|0,this._bl=this._bl+bl|0,this._cl=this._cl+cl|0,this._dl=this._dl+dl|0,this._el=this._el+el|0,this._fl=this._fl+fl|0,this._gl=this._gl+gl|0,this._hl=this._hl+hl|0,this._ah=this._ah+ah+getCarry(this._al,al)|0,this._bh=this._bh+bh+getCarry(this._bl,bl)|0,this._ch=this._ch+ch+getCarry(this._cl,cl)|0,this._dh=this._dh+dh+getCarry(this._dl,dl)|0,this._eh=this._eh+eh+getCarry(this._el,el)|0,this._fh=this._fh+fh+getCarry(this._fl,fl)|0,this._gh=this._gh+gh+getCarry(this._gl,gl)|0,this._hh=this._hh+hh+getCarry(this._hl,hl)|0},Sha512.prototype._hash=function(){function writeInt64BE(h,l,offset){H.writeInt32BE(h,offset),H.writeInt32BE(l,offset+4)}var H=new Buffer(64);return writeInt64BE(this._ah,this._al,0),writeInt64BE(this._bh,this._bl,8),writeInt64BE(this._ch,this._cl,16),writeInt64BE(this._dh,this._dl,24),writeInt64BE(this._eh,this._el,32),writeInt64BE(this._fh,this._fl,40),writeInt64BE(this._gh,this._gl,48),writeInt64BE(this._hh,this._hl,56),H},module.exports=Sha512}).call(this,_dereq_("buffer").Buffer)},{"./hash":149,buffer:49,inherits:112}],157:[function(_dereq_,module,exports){function Stream(){EE.call(this)}module.exports=Stream;var EE=_dereq_("events").EventEmitter,inherits=_dereq_("inherits");inherits(Stream,EE),Stream.Readable=_dereq_("readable-stream/readable.js"),Stream.Writable=_dereq_("readable-stream/writable.js"),Stream.Duplex=_dereq_("readable-stream/duplex.js"),Stream.Transform=_dereq_("readable-stream/transform.js"),Stream.PassThrough=_dereq_("readable-stream/passthrough.js"),Stream.Stream=Stream,Stream.prototype.pipe=function(dest,options){function ondata(chunk){dest.writable&&!1===dest.write(chunk)&&source.pause&&source.pause()}function ondrain(){source.readable&&source.resume&&source.resume()}function onend(){didOnEnd||(didOnEnd=!0,dest.end())}function onclose(){didOnEnd||(didOnEnd=!0,"function"==typeof dest.destroy&&dest.destroy())}function onerror(er){if(cleanup(),0===EE.listenerCount(this,"error"))throw er}function cleanup(){source.removeListener("data",ondata),dest.removeListener("drain",ondrain),source.removeListener("end",onend),source.removeListener("close",onclose),source.removeListener("error",onerror),dest.removeListener("error",onerror),source.removeListener("end",cleanup),source.removeListener("close",cleanup),dest.removeListener("close",cleanup)}var source=this;source.on("data",ondata),dest.on("drain",ondrain),dest._isStdio||options&&options.end===!1||(source.on("end",onend),source.on("close",onclose));var didOnEnd=!1;return source.on("error",onerror),dest.on("error",onerror),source.on("end",cleanup),source.on("close",cleanup),dest.on("close",cleanup),dest.emit("pipe",source),dest}},{events:99,inherits:112,"readable-stream/duplex.js":137,"readable-stream/passthrough.js":144,"readable-stream/readable.js":145,"readable-stream/transform.js":146,"readable-stream/writable.js":147}],158:[function(_dereq_,module,exports){function assertEncoding(encoding){if(encoding&&!isBufferEncoding(encoding))throw new Error("Unknown encoding: "+encoding)}function passThroughWrite(buffer){return buffer.toString(this.encoding)}function utf16DetectIncompleteChar(buffer){this.charReceived=buffer.length%2,this.charLength=this.charReceived?2:0}function base64DetectIncompleteChar(buffer){this.charReceived=buffer.length%3,this.charLength=this.charReceived?3:0}var Buffer=_dereq_("buffer").Buffer,isBufferEncoding=Buffer.isEncoding||function(encoding){switch(encoding&&encoding.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},StringDecoder=exports.StringDecoder=function(encoding){switch(this.encoding=(encoding||"utf8").toLowerCase().replace(/[-_]/,""),assertEncoding(encoding),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=utf16DetectIncompleteChar;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=base64DetectIncompleteChar;break;default:return void(this.write=passThroughWrite)}this.charBuffer=new Buffer(6),this.charReceived=0,this.charLength=0};StringDecoder.prototype.write=function(buffer){for(var charStr="";this.charLength;){var available=buffer.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:buffer.length;if(buffer.copy(this.charBuffer,this.charReceived,0,available),this.charReceived+=available,this.charReceived<this.charLength)return"";buffer=buffer.slice(available,buffer.length),charStr=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var charCode=charStr.charCodeAt(charStr.length-1);if(!(charCode>=55296&&charCode<=56319)){if(this.charReceived=this.charLength=0,0===buffer.length)return charStr;break}this.charLength+=this.surrogateSize,charStr=""}this.detectIncompleteChar(buffer);var end=buffer.length;this.charLength&&(buffer.copy(this.charBuffer,0,buffer.length-this.charReceived,end),end-=this.charReceived),charStr+=buffer.toString(this.encoding,0,end);var end=charStr.length-1,charCode=charStr.charCodeAt(end);if(charCode>=55296&&charCode<=56319){var size=this.surrogateSize;return this.charLength+=size,this.charReceived+=size,this.charBuffer.copy(this.charBuffer,size,0,size),buffer.copy(this.charBuffer,0,0,size),charStr.substring(0,end)}return charStr},StringDecoder.prototype.detectIncompleteChar=function(buffer){for(var i=buffer.length>=3?3:buffer.length;i>0;i--){var c=buffer[buffer.length-i];if(1==i&&c>>5==6){this.charLength=2;break}if(i<=2&&c>>4==14){this.charLength=3;break}if(i<=3&&c>>3==30){this.charLength=4;break}}this.charReceived=i},StringDecoder.prototype.end=function(buffer){var res="";if(buffer&&buffer.length&&(res=this.write(buffer)),this.charReceived){var cr=this.charReceived,buf=this.charBuffer,enc=this.encoding;res+=buf.slice(0,cr).toString(enc)}return res}},{buffer:49}],159:[function(_dereq_,module,exports){!function(Math){function tinycolor(color,opts){if(color=color?color:"",opts=opts||{},color instanceof tinycolor)return color;if(!(this instanceof tinycolor))return new tinycolor(color,opts);var rgb=inputToRGB(color);this._originalInput=color,this._r=rgb.r,this._g=rgb.g,this._b=rgb.b,this._a=rgb.a,this._roundA=mathRound(100*this._a)/100,this._format=opts.format||rgb.format,this._gradientType=opts.gradientType,this._r<1&&(this._r=mathRound(this._r)),this._g<1&&(this._g=mathRound(this._g)),this._b<1&&(this._b=mathRound(this._b)),this._ok=rgb.ok,this._tc_id=tinyCounter++}function inputToRGB(color){var rgb={r:0,g:0,b:0},a=1,s=null,v=null,l=null,ok=!1,format=!1;return"string"==typeof color&&(color=stringInputToObject(color)),"object"==typeof color&&(isValidCSSUnit(color.r)&&isValidCSSUnit(color.g)&&isValidCSSUnit(color.b)?(rgb=rgbToRgb(color.r,color.g,color.b),ok=!0,format="%"===String(color.r).substr(-1)?"prgb":"rgb"):isValidCSSUnit(color.h)&&isValidCSSUnit(color.s)&&isValidCSSUnit(color.v)?(s=convertToPercentage(color.s),v=convertToPercentage(color.v),rgb=hsvToRgb(color.h,s,v),ok=!0,format="hsv"):isValidCSSUnit(color.h)&&isValidCSSUnit(color.s)&&isValidCSSUnit(color.l)&&(s=convertToPercentage(color.s),l=convertToPercentage(color.l),rgb=hslToRgb(color.h,s,l),ok=!0,format="hsl"),color.hasOwnProperty("a")&&(a=color.a)),a=boundAlpha(a),{ok:ok,format:color.format||format,r:mathMin(255,mathMax(rgb.r,0)),g:mathMin(255,mathMax(rgb.g,0)),b:mathMin(255,mathMax(rgb.b,0)),a:a}}function rgbToRgb(r,g,b){return{r:255*bound01(r,255),g:255*bound01(g,255),b:255*bound01(b,255)}}function rgbToHsl(r,g,b){r=bound01(r,255),g=bound01(g,255),b=bound01(b,255);var h,s,max=mathMax(r,g,b),min=mathMin(r,g,b),l=(max+min)/2;if(max==min)h=s=0;else{var d=max-min;switch(s=l>.5?d/(2-max-min):d/(max+min),max){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4}h/=6}return{h:h,s:s,l:l}}function hslToRgb(h,s,l){function hue2rgb(p,q,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?p+6*(q-p)*t:t<.5?q:t<2/3?p+(q-p)*(2/3-t)*6:p}var r,g,b;if(h=bound01(h,360),s=bound01(s,100),l=bound01(l,100),0===s)r=g=b=l;else{var q=l<.5?l*(1+s):l+s-l*s,p=2*l-q;r=hue2rgb(p,q,h+1/3),g=hue2rgb(p,q,h),b=hue2rgb(p,q,h-1/3)}return{r:255*r,g:255*g,b:255*b}}function rgbToHsv(r,g,b){r=bound01(r,255),g=bound01(g,255),b=bound01(b,255);var h,s,max=mathMax(r,g,b),min=mathMin(r,g,b),v=max,d=max-min;if(s=0===max?0:d/max,max==min)h=0;else{switch(max){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4}h/=6}return{h:h,s:s,v:v}}function hsvToRgb(h,s,v){h=6*bound01(h,360),s=bound01(s,100),v=bound01(v,100);var i=Math.floor(h),f=h-i,p=v*(1-s),q=v*(1-f*s),t=v*(1-(1-f)*s),mod=i%6,r=[v,q,p,p,t,v][mod],g=[t,v,v,q,p,p][mod],b=[p,p,t,v,v,q][mod];return{r:255*r,g:255*g,b:255*b}}function rgbToHex(r,g,b,allow3Char){var hex=[pad2(mathRound(r).toString(16)),pad2(mathRound(g).toString(16)),pad2(mathRound(b).toString(16))];return allow3Char&&hex[0].charAt(0)==hex[0].charAt(1)&&hex[1].charAt(0)==hex[1].charAt(1)&&hex[2].charAt(0)==hex[2].charAt(1)?hex[0].charAt(0)+hex[1].charAt(0)+hex[2].charAt(0):hex.join("")}function rgbaToHex(r,g,b,a,allow4Char){var hex=[pad2(mathRound(r).toString(16)),pad2(mathRound(g).toString(16)),pad2(mathRound(b).toString(16)),pad2(convertDecimalToHex(a))];return allow4Char&&hex[0].charAt(0)==hex[0].charAt(1)&&hex[1].charAt(0)==hex[1].charAt(1)&&hex[2].charAt(0)==hex[2].charAt(1)&&hex[3].charAt(0)==hex[3].charAt(1)?hex[0].charAt(0)+hex[1].charAt(0)+hex[2].charAt(0)+hex[3].charAt(0):hex.join("")}function rgbaToArgbHex(r,g,b,a){var hex=[pad2(convertDecimalToHex(a)),pad2(mathRound(r).toString(16)),pad2(mathRound(g).toString(16)),pad2(mathRound(b).toString(16))];return hex.join("")}function desaturate(color,amount){amount=0===amount?0:amount||10;var hsl=tinycolor(color).toHsl();return hsl.s-=amount/100,hsl.s=clamp01(hsl.s),tinycolor(hsl)}function saturate(color,amount){amount=0===amount?0:amount||10;var hsl=tinycolor(color).toHsl();return hsl.s+=amount/100,hsl.s=clamp01(hsl.s),tinycolor(hsl)}function greyscale(color){return tinycolor(color).desaturate(100)}function lighten(color,amount){amount=0===amount?0:amount||10;var hsl=tinycolor(color).toHsl();return hsl.l+=amount/100,hsl.l=clamp01(hsl.l),tinycolor(hsl)}function brighten(color,amount){amount=0===amount?0:amount||10;var rgb=tinycolor(color).toRgb();return rgb.r=mathMax(0,mathMin(255,rgb.r-mathRound(255*-(amount/100)))),rgb.g=mathMax(0,mathMin(255,rgb.g-mathRound(255*-(amount/100)))),rgb.b=mathMax(0,mathMin(255,rgb.b-mathRound(255*-(amount/100)))),tinycolor(rgb)}function darken(color,amount){amount=0===amount?0:amount||10;var hsl=tinycolor(color).toHsl();return hsl.l-=amount/100,hsl.l=clamp01(hsl.l),tinycolor(hsl)}function spin(color,amount){var hsl=tinycolor(color).toHsl(),hue=(hsl.h+amount)%360;return hsl.h=hue<0?360+hue:hue,tinycolor(hsl)}function complement(color){var hsl=tinycolor(color).toHsl();return hsl.h=(hsl.h+180)%360,tinycolor(hsl)}function triad(color){var hsl=tinycolor(color).toHsl(),h=hsl.h;return[tinycolor(color),tinycolor({h:(h+120)%360,s:hsl.s,l:hsl.l}),tinycolor({h:(h+240)%360,s:hsl.s,l:hsl.l})]}function tetrad(color){var hsl=tinycolor(color).toHsl(),h=hsl.h;return[tinycolor(color),tinycolor({h:(h+90)%360,s:hsl.s,l:hsl.l}),tinycolor({h:(h+180)%360,s:hsl.s,l:hsl.l}),tinycolor({h:(h+270)%360,s:hsl.s,l:hsl.l})]}function splitcomplement(color){var hsl=tinycolor(color).toHsl(),h=hsl.h;return[tinycolor(color),tinycolor({h:(h+72)%360,s:hsl.s,l:hsl.l}),tinycolor({h:(h+216)%360,s:hsl.s,l:hsl.l})]}function analogous(color,results,slices){results=results||6,slices=slices||30;var hsl=tinycolor(color).toHsl(),part=360/slices,ret=[tinycolor(color)];for(hsl.h=(hsl.h-(part*results>>1)+720)%360;--results;)hsl.h=(hsl.h+part)%360,ret.push(tinycolor(hsl));return ret}function monochromatic(color,results){results=results||6;for(var hsv=tinycolor(color).toHsv(),h=hsv.h,s=hsv.s,v=hsv.v,ret=[],modification=1/results;results--;)ret.push(tinycolor({h:h,s:s,v:v})),v=(v+modification)%1;return ret}function flip(o){var flipped={};for(var i in o)o.hasOwnProperty(i)&&(flipped[o[i]]=i);return flipped}function boundAlpha(a){return a=parseFloat(a),(isNaN(a)||a<0||a>1)&&(a=1),a}function bound01(n,max){isOnePointZero(n)&&(n="100%");var processPercent=isPercentage(n);return n=mathMin(max,mathMax(0,parseFloat(n))),processPercent&&(n=parseInt(n*max,10)/100),Math.abs(n-max)<1e-6?1:n%max/parseFloat(max)}function clamp01(val){return mathMin(1,mathMax(0,val))}function parseIntFromHex(val){return parseInt(val,16)}function isOnePointZero(n){return"string"==typeof n&&n.indexOf(".")!=-1&&1===parseFloat(n)}function isPercentage(n){return"string"==typeof n&&n.indexOf("%")!=-1}function pad2(c){return 1==c.length?"0"+c:""+c}function convertToPercentage(n){return n<=1&&(n=100*n+"%"),n}function convertDecimalToHex(d){return Math.round(255*parseFloat(d)).toString(16)}function convertHexToDecimal(h){return parseIntFromHex(h)/255}function isValidCSSUnit(color){return!!matchers.CSS_UNIT.exec(color)}function stringInputToObject(color){color=color.replace(trimLeft,"").replace(trimRight,"").toLowerCase();var named=!1;if(names[color])color=names[color],named=!0;else if("transparent"==color)return{r:0,g:0,b:0,a:0,format:"name"};var match;return(match=matchers.rgb.exec(color))?{r:match[1],g:match[2],b:match[3]}:(match=matchers.rgba.exec(color))?{r:match[1],g:match[2],b:match[3],a:match[4]}:(match=matchers.hsl.exec(color))?{h:match[1],s:match[2],l:match[3]}:(match=matchers.hsla.exec(color))?{h:match[1],s:match[2],l:match[3],a:match[4]}:(match=matchers.hsv.exec(color))?{h:match[1],s:match[2],v:match[3]}:(match=matchers.hsva.exec(color))?{h:match[1],s:match[2],v:match[3],a:match[4]}:(match=matchers.hex8.exec(color))?{r:parseIntFromHex(match[1]),g:parseIntFromHex(match[2]),b:parseIntFromHex(match[3]),a:convertHexToDecimal(match[4]),format:named?"name":"hex8"}:(match=matchers.hex6.exec(color))?{r:parseIntFromHex(match[1]),g:parseIntFromHex(match[2]),b:parseIntFromHex(match[3]),format:named?"name":"hex"}:(match=matchers.hex4.exec(color))?{r:parseIntFromHex(match[1]+""+match[1]),g:parseIntFromHex(match[2]+""+match[2]),b:parseIntFromHex(match[3]+""+match[3]),a:convertHexToDecimal(match[4]+""+match[4]),format:named?"name":"hex8"}:!!(match=matchers.hex3.exec(color))&&{r:parseIntFromHex(match[1]+""+match[1]),g:parseIntFromHex(match[2]+""+match[2]),b:parseIntFromHex(match[3]+""+match[3]),format:named?"name":"hex"}}function validateWCAG2Parms(parms){var level,size;return parms=parms||{level:"AA",size:"small"},level=(parms.level||"AA").toUpperCase(),size=(parms.size||"small").toLowerCase(),"AA"!==level&&"AAA"!==level&&(level="AA"),"small"!==size&&"large"!==size&&(size="small"),{level:level,size:size}}var trimLeft=/^\s+/,trimRight=/\s+$/,tinyCounter=0,mathRound=Math.round,mathMin=Math.min,mathMax=Math.max,mathRandom=Math.random;tinycolor.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var rgb=this.toRgb();return(299*rgb.r+587*rgb.g+114*rgb.b)/1e3},getLuminance:function(){var RsRGB,GsRGB,BsRGB,R,G,B,rgb=this.toRgb();return RsRGB=rgb.r/255,GsRGB=rgb.g/255,BsRGB=rgb.b/255,R=RsRGB<=.03928?RsRGB/12.92:Math.pow((RsRGB+.055)/1.055,2.4),G=GsRGB<=.03928?GsRGB/12.92:Math.pow((GsRGB+.055)/1.055,2.4),B=BsRGB<=.03928?BsRGB/12.92:Math.pow((BsRGB+.055)/1.055,2.4),.2126*R+.7152*G+.0722*B},setAlpha:function(value){return this._a=boundAlpha(value),this._roundA=mathRound(100*this._a)/100,this},toHsv:function(){var hsv=rgbToHsv(this._r,this._g,this._b);return{h:360*hsv.h,s:hsv.s,v:hsv.v,a:this._a}},toHsvString:function(){var hsv=rgbToHsv(this._r,this._g,this._b),h=mathRound(360*hsv.h),s=mathRound(100*hsv.s),v=mathRound(100*hsv.v);return 1==this._a?"hsv("+h+", "+s+"%, "+v+"%)":"hsva("+h+", "+s+"%, "+v+"%, "+this._roundA+")"},toHsl:function(){var hsl=rgbToHsl(this._r,this._g,this._b);return{h:360*hsl.h,s:hsl.s,l:hsl.l,a:this._a}},toHslString:function(){var hsl=rgbToHsl(this._r,this._g,this._b),h=mathRound(360*hsl.h),s=mathRound(100*hsl.s),l=mathRound(100*hsl.l);return 1==this._a?"hsl("+h+", "+s+"%, "+l+"%)":"hsla("+h+", "+s+"%, "+l+"%, "+this._roundA+")"},toHex:function(allow3Char){return rgbToHex(this._r,this._g,this._b,allow3Char)},toHexString:function(allow3Char){return"#"+this.toHex(allow3Char)},toHex8:function(allow4Char){return rgbaToHex(this._r,this._g,this._b,this._a,allow4Char)},toHex8String:function(allow4Char){return"#"+this.toHex8(allow4Char)},toRgb:function(){return{r:mathRound(this._r),g:mathRound(this._g),b:mathRound(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+mathRound(this._r)+", "+mathRound(this._g)+", "+mathRound(this._b)+")":"rgba("+mathRound(this._r)+", "+mathRound(this._g)+", "+mathRound(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:mathRound(100*bound01(this._r,255))+"%",g:mathRound(100*bound01(this._g,255))+"%",b:mathRound(100*bound01(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+mathRound(100*bound01(this._r,255))+"%, "+mathRound(100*bound01(this._g,255))+"%, "+mathRound(100*bound01(this._b,255))+"%)":"rgba("+mathRound(100*bound01(this._r,255))+"%, "+mathRound(100*bound01(this._g,255))+"%, "+mathRound(100*bound01(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(hexNames[rgbToHex(this._r,this._g,this._b,!0)]||!1)},toFilter:function(secondColor){var hex8String="#"+rgbaToArgbHex(this._r,this._g,this._b,this._a),secondHex8String=hex8String,gradientType=this._gradientType?"GradientType = 1, ":"";if(secondColor){var s=tinycolor(secondColor);secondHex8String="#"+rgbaToArgbHex(s._r,s._g,s._b,s._a)}return"progid:DXImageTransform.Microsoft.gradient("+gradientType+"startColorstr="+hex8String+",endColorstr="+secondHex8String+")"},toString:function(format){var formatSet=!!format;format=format||this._format;var formattedString=!1,hasAlpha=this._a<1&&this._a>=0,needsAlphaFormat=!formatSet&&hasAlpha&&("hex"===format||"hex6"===format||"hex3"===format||"hex4"===format||"hex8"===format||"name"===format);return needsAlphaFormat?"name"===format&&0===this._a?this.toName():this.toRgbString():("rgb"===format&&(formattedString=this.toRgbString()),"prgb"===format&&(formattedString=this.toPercentageRgbString()),"hex"!==format&&"hex6"!==format||(formattedString=this.toHexString()),"hex3"===format&&(formattedString=this.toHexString(!0)),"hex4"===format&&(formattedString=this.toHex8String(!0)),"hex8"===format&&(formattedString=this.toHex8String()),"name"===format&&(formattedString=this.toName()),"hsl"===format&&(formattedString=this.toHslString()),"hsv"===format&&(formattedString=this.toHsvString()),formattedString||this.toHexString())},clone:function(){return tinycolor(this.toString())},_applyModification:function(fn,args){var color=fn.apply(null,[this].concat([].slice.call(args)));return this._r=color._r,this._g=color._g,this._b=color._b,this.setAlpha(color._a),this},lighten:function(){return this._applyModification(lighten,arguments)},brighten:function(){return this._applyModification(brighten,arguments)},darken:function(){return this._applyModification(darken,arguments)},desaturate:function(){return this._applyModification(desaturate,arguments)},saturate:function(){return this._applyModification(saturate,arguments)},greyscale:function(){return this._applyModification(greyscale,arguments)},spin:function(){return this._applyModification(spin,arguments)},_applyCombination:function(fn,args){return fn.apply(null,[this].concat([].slice.call(args)))},analogous:function(){return this._applyCombination(analogous,arguments)},complement:function(){return this._applyCombination(complement,arguments)},monochromatic:function(){return this._applyCombination(monochromatic,arguments)},splitcomplement:function(){return this._applyCombination(splitcomplement,arguments)},triad:function(){return this._applyCombination(triad,arguments)},tetrad:function(){return this._applyCombination(tetrad,arguments)}},tinycolor.fromRatio=function(color,opts){if("object"==typeof color){var newColor={};for(var i in color)color.hasOwnProperty(i)&&("a"===i?newColor[i]=color[i]:newColor[i]=convertToPercentage(color[i]));color=newColor}return tinycolor(color,opts)},tinycolor.equals=function(color1,color2){return!(!color1||!color2)&&tinycolor(color1).toRgbString()==tinycolor(color2).toRgbString()},tinycolor.random=function(){return tinycolor.fromRatio({r:mathRandom(),g:mathRandom(),b:mathRandom()})},tinycolor.mix=function(color1,color2,amount){amount=0===amount?0:amount||50;var rgb1=tinycolor(color1).toRgb(),rgb2=tinycolor(color2).toRgb(),p=amount/100,rgba={r:(rgb2.r-rgb1.r)*p+rgb1.r,g:(rgb2.g-rgb1.g)*p+rgb1.g,b:(rgb2.b-rgb1.b)*p+rgb1.b,a:(rgb2.a-rgb1.a)*p+rgb1.a};return tinycolor(rgba)},tinycolor.readability=function(color1,color2){var c1=tinycolor(color1),c2=tinycolor(color2);return(Math.max(c1.getLuminance(),c2.getLuminance())+.05)/(Math.min(c1.getLuminance(),c2.getLuminance())+.05)},tinycolor.isReadable=function(color1,color2,wcag2){var wcag2Parms,out,readability=tinycolor.readability(color1,color2);switch(out=!1,wcag2Parms=validateWCAG2Parms(wcag2),wcag2Parms.level+wcag2Parms.size){case"AAsmall":case"AAAlarge":out=readability>=4.5;break;case"AAlarge":out=readability>=3;break;case"AAAsmall":out=readability>=7}return out},tinycolor.mostReadable=function(baseColor,colorList,args){var readability,includeFallbackColors,level,size,bestColor=null,bestScore=0;args=args||{},includeFallbackColors=args.includeFallbackColors,level=args.level,size=args.size;for(var i=0;i<colorList.length;i++)readability=tinycolor.readability(baseColor,colorList[i]),readability>bestScore&&(bestScore=readability,bestColor=tinycolor(colorList[i]));return tinycolor.isReadable(baseColor,bestColor,{level:level,size:size})||!includeFallbackColors?bestColor:(args.includeFallbackColors=!1,tinycolor.mostReadable(baseColor,["#fff","#000"],args))};var names=tinycolor.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},hexNames=tinycolor.hexNames=flip(names),matchers=function(){var CSS_INTEGER="[-\\+]?\\d+%?",CSS_NUMBER="[-\\+]?\\d*\\.\\d+%?",CSS_UNIT="(?:"+CSS_NUMBER+")|(?:"+CSS_INTEGER+")",PERMISSIVE_MATCH3="[\\s|\\(]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")\\s*\\)?",PERMISSIVE_MATCH4="[\\s|\\(]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")\\s*\\)?";return{CSS_UNIT:new RegExp(CSS_UNIT),rgb:new RegExp("rgb"+PERMISSIVE_MATCH3),rgba:new RegExp("rgba"+PERMISSIVE_MATCH4),hsl:new RegExp("hsl"+PERMISSIVE_MATCH3),hsla:new RegExp("hsla"+PERMISSIVE_MATCH4),hsv:new RegExp("hsv"+PERMISSIVE_MATCH3),hsva:new RegExp("hsva"+PERMISSIVE_MATCH4),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();"undefined"!=typeof module&&module.exports?module.exports=tinycolor:"function"==typeof define&&define.amd?define(function(){return tinycolor}):window.tinycolor=tinycolor}(Math)},{}],160:[function(_dereq_,module,exports){(function(global){function deprecate(fn,msg){function deprecated(){if(!warned){if(config("throwDeprecation"))throw new Error(msg);config("traceDeprecation")?console.trace(msg):console.warn(msg),warned=!0}return fn.apply(this,arguments)}if(config("noDeprecation"))return fn;var warned=!1;return deprecated}function config(name){try{if(!global.localStorage)return!1}catch(_){return!1}var val=global.localStorage[name];return null!=val&&"true"===String(val).toLowerCase()}module.exports=deprecate}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],161:[function(_dereq_,module,exports){(function(global){(function(){function baseCompareAscending(value,other){if(value!==other){var valIsNull=null===value,valIsUndef=value===undefined,valIsReflexive=value===value,othIsNull=null===other,othIsUndef=other===undefined,othIsReflexive=other===other;if(value>other&&!othIsNull||!valIsReflexive||valIsNull&&!othIsUndef&&othIsReflexive||valIsUndef&&othIsReflexive)return 1;if(value<other&&!valIsNull||!othIsReflexive||othIsNull&&!valIsUndef&&valIsReflexive||othIsUndef&&valIsReflexive)return-1}return 0}function baseFindIndex(array,predicate,fromRight){for(var length=array.length,index=fromRight?length:-1;fromRight?index--:++index<length;)if(predicate(array[index],index,array))return index;return-1}function baseIndexOf(array,value,fromIndex){if(value!==value)return indexOfNaN(array,fromIndex);for(var index=fromIndex-1,length=array.length;++index<length;)if(array[index]===value)return index;return-1}function baseIsFunction(value){return"function"==typeof value||!1}function baseToString(value){return null==value?"":value+""}function charsLeftIndex(string,chars){for(var index=-1,length=string.length;++index<length&&chars.indexOf(string.charAt(index))>-1;);return index}function charsRightIndex(string,chars){for(var index=string.length;index--&&chars.indexOf(string.charAt(index))>-1;);return index;
}function compareAscending(object,other){return baseCompareAscending(object.criteria,other.criteria)||object.index-other.index}function compareMultiple(object,other,orders){for(var index=-1,objCriteria=object.criteria,othCriteria=other.criteria,length=objCriteria.length,ordersLength=orders.length;++index<length;){var result=baseCompareAscending(objCriteria[index],othCriteria[index]);if(result){if(index>=ordersLength)return result;var order=orders[index];return result*("asc"===order||order===!0?1:-1)}}return object.index-other.index}function deburrLetter(letter){return deburredLetters[letter]}function escapeHtmlChar(chr){return htmlEscapes[chr]}function escapeRegExpChar(chr,leadingChar,whitespaceChar){return leadingChar?chr=regexpEscapes[chr]:whitespaceChar&&(chr=stringEscapes[chr]),"\\"+chr}function escapeStringChar(chr){return"\\"+stringEscapes[chr]}function indexOfNaN(array,fromIndex,fromRight){for(var length=array.length,index=fromIndex+(fromRight?0:-1);fromRight?index--:++index<length;){var other=array[index];if(other!==other)return index}return-1}function isObjectLike(value){return!!value&&"object"==typeof value}function isSpace(charCode){return charCode<=160&&charCode>=9&&charCode<=13||32==charCode||160==charCode||5760==charCode||6158==charCode||charCode>=8192&&(charCode<=8202||8232==charCode||8233==charCode||8239==charCode||8287==charCode||12288==charCode||65279==charCode)}function replaceHolders(array,placeholder){for(var index=-1,length=array.length,resIndex=-1,result=[];++index<length;)array[index]===placeholder&&(array[index]=PLACEHOLDER,result[++resIndex]=index);return result}function sortedUniq(array,iteratee){for(var seen,index=-1,length=array.length,resIndex=-1,result=[];++index<length;){var value=array[index],computed=iteratee?iteratee(value,index,array):value;index&&seen===computed||(seen=computed,result[++resIndex]=value)}return result}function trimmedLeftIndex(string){for(var index=-1,length=string.length;++index<length&&isSpace(string.charCodeAt(index)););return index}function trimmedRightIndex(string){for(var index=string.length;index--&&isSpace(string.charCodeAt(index)););return index}function unescapeHtmlChar(chr){return htmlUnescapes[chr]}function runInContext(context){function lodash(value){if(isObjectLike(value)&&!isArray(value)&&!(value instanceof LazyWrapper)){if(value instanceof LodashWrapper)return value;if(hasOwnProperty.call(value,"__chain__")&&hasOwnProperty.call(value,"__wrapped__"))return wrapperClone(value)}return new LodashWrapper(value)}function baseLodash(){}function LodashWrapper(value,chainAll,actions){this.__wrapped__=value,this.__actions__=actions||[],this.__chain__=!!chainAll}function LazyWrapper(value){this.__wrapped__=value,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=POSITIVE_INFINITY,this.__views__=[]}function lazyClone(){var result=new LazyWrapper(this.__wrapped__);return result.__actions__=arrayCopy(this.__actions__),result.__dir__=this.__dir__,result.__filtered__=this.__filtered__,result.__iteratees__=arrayCopy(this.__iteratees__),result.__takeCount__=this.__takeCount__,result.__views__=arrayCopy(this.__views__),result}function lazyReverse(){if(this.__filtered__){var result=new LazyWrapper(this);result.__dir__=-1,result.__filtered__=!0}else result=this.clone(),result.__dir__*=-1;return result}function lazyValue(){var array=this.__wrapped__.value(),dir=this.__dir__,isArr=isArray(array),isRight=dir<0,arrLength=isArr?array.length:0,view=getView(0,arrLength,this.__views__),start=view.start,end=view.end,length=end-start,index=isRight?end:start-1,iteratees=this.__iteratees__,iterLength=iteratees.length,resIndex=0,takeCount=nativeMin(length,this.__takeCount__);if(!isArr||arrLength<LARGE_ARRAY_SIZE||arrLength==length&&takeCount==length)return baseWrapperValue(isRight&&isArr?array.reverse():array,this.__actions__);var result=[];outer:for(;length--&&resIndex<takeCount;){index+=dir;for(var iterIndex=-1,value=array[index];++iterIndex<iterLength;){var data=iteratees[iterIndex],iteratee=data.iteratee,type=data.type,computed=iteratee(value);if(type==LAZY_MAP_FLAG)value=computed;else if(!computed){if(type==LAZY_FILTER_FLAG)continue outer;break outer}}result[resIndex++]=value}return result}function MapCache(){this.__data__={}}function mapDelete(key){return this.has(key)&&delete this.__data__[key]}function mapGet(key){return"__proto__"==key?undefined:this.__data__[key]}function mapHas(key){return"__proto__"!=key&&hasOwnProperty.call(this.__data__,key)}function mapSet(key,value){return"__proto__"!=key&&(this.__data__[key]=value),this}function SetCache(values){var length=values?values.length:0;for(this.data={hash:nativeCreate(null),set:new Set};length--;)this.push(values[length])}function cacheIndexOf(cache,value){var data=cache.data,result="string"==typeof value||isObject(value)?data.set.has(value):data.hash[value];return result?0:-1}function cachePush(value){var data=this.data;"string"==typeof value||isObject(value)?data.set.add(value):data.hash[value]=!0}function arrayConcat(array,other){for(var index=-1,length=array.length,othIndex=-1,othLength=other.length,result=Array(length+othLength);++index<length;)result[index]=array[index];for(;++othIndex<othLength;)result[index++]=other[othIndex];return result}function arrayCopy(source,array){var index=-1,length=source.length;for(array||(array=Array(length));++index<length;)array[index]=source[index];return array}function arrayEach(array,iteratee){for(var index=-1,length=array.length;++index<length&&iteratee(array[index],index,array)!==!1;);return array}function arrayEachRight(array,iteratee){for(var length=array.length;length--&&iteratee(array[length],length,array)!==!1;);return array}function arrayEvery(array,predicate){for(var index=-1,length=array.length;++index<length;)if(!predicate(array[index],index,array))return!1;return!0}function arrayExtremum(array,iteratee,comparator,exValue){for(var index=-1,length=array.length,computed=exValue,result=computed;++index<length;){var value=array[index],current=+iteratee(value);comparator(current,computed)&&(computed=current,result=value)}return result}function arrayFilter(array,predicate){for(var index=-1,length=array.length,resIndex=-1,result=[];++index<length;){var value=array[index];predicate(value,index,array)&&(result[++resIndex]=value)}return result}function arrayMap(array,iteratee){for(var index=-1,length=array.length,result=Array(length);++index<length;)result[index]=iteratee(array[index],index,array);return result}function arrayPush(array,values){for(var index=-1,length=values.length,offset=array.length;++index<length;)array[offset+index]=values[index];return array}function arrayReduce(array,iteratee,accumulator,initFromArray){var index=-1,length=array.length;for(initFromArray&&length&&(accumulator=array[++index]);++index<length;)accumulator=iteratee(accumulator,array[index],index,array);return accumulator}function arrayReduceRight(array,iteratee,accumulator,initFromArray){var length=array.length;for(initFromArray&&length&&(accumulator=array[--length]);length--;)accumulator=iteratee(accumulator,array[length],length,array);return accumulator}function arraySome(array,predicate){for(var index=-1,length=array.length;++index<length;)if(predicate(array[index],index,array))return!0;return!1}function arraySum(array,iteratee){for(var length=array.length,result=0;length--;)result+=+iteratee(array[length])||0;return result}function assignDefaults(objectValue,sourceValue){return objectValue===undefined?sourceValue:objectValue}function assignOwnDefaults(objectValue,sourceValue,key,object){return objectValue!==undefined&&hasOwnProperty.call(object,key)?objectValue:sourceValue}function assignWith(object,source,customizer){for(var index=-1,props=keys(source),length=props.length;++index<length;){var key=props[index],value=object[key],result=customizer(value,source[key],key,object,source);(result===result?result===value:value!==value)&&(value!==undefined||key in object)||(object[key]=result)}return object}function baseAssign(object,source){return null==source?object:baseCopy(source,keys(source),object)}function baseAt(collection,props){for(var index=-1,isNil=null==collection,isArr=!isNil&&isArrayLike(collection),length=isArr?collection.length:0,propsLength=props.length,result=Array(propsLength);++index<propsLength;){var key=props[index];isArr?result[index]=isIndex(key,length)?collection[key]:undefined:result[index]=isNil?undefined:collection[key]}return result}function baseCopy(source,props,object){object||(object={});for(var index=-1,length=props.length;++index<length;){var key=props[index];object[key]=source[key]}return object}function baseCallback(func,thisArg,argCount){var type=typeof func;return"function"==type?thisArg===undefined?func:bindCallback(func,thisArg,argCount):null==func?identity:"object"==type?baseMatches(func):thisArg===undefined?property(func):baseMatchesProperty(func,thisArg)}function baseClone(value,isDeep,customizer,key,object,stackA,stackB){var result;if(customizer&&(result=object?customizer(value,key,object):customizer(value)),result!==undefined)return result;if(!isObject(value))return value;var isArr=isArray(value);if(isArr){if(result=initCloneArray(value),!isDeep)return arrayCopy(value,result)}else{var tag=objToString.call(value),isFunc=tag==funcTag;if(tag!=objectTag&&tag!=argsTag&&(!isFunc||object))return cloneableTags[tag]?initCloneByTag(value,tag,isDeep):object?value:{};if(result=initCloneObject(isFunc?{}:value),!isDeep)return baseAssign(result,value)}stackA||(stackA=[]),stackB||(stackB=[]);for(var length=stackA.length;length--;)if(stackA[length]==value)return stackB[length];return stackA.push(value),stackB.push(result),(isArr?arrayEach:baseForOwn)(value,function(subValue,key){result[key]=baseClone(subValue,isDeep,customizer,key,value,stackA,stackB)}),result}function baseDelay(func,wait,args){if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);return setTimeout(function(){func.apply(undefined,args)},wait)}function baseDifference(array,values){var length=array?array.length:0,result=[];if(!length)return result;var index=-1,indexOf=getIndexOf(),isCommon=indexOf==baseIndexOf,cache=isCommon&&values.length>=LARGE_ARRAY_SIZE?createCache(values):null,valuesLength=values.length;cache&&(indexOf=cacheIndexOf,isCommon=!1,values=cache);outer:for(;++index<length;){var value=array[index];if(isCommon&&value===value){for(var valuesIndex=valuesLength;valuesIndex--;)if(values[valuesIndex]===value)continue outer;result.push(value)}else indexOf(values,value,0)<0&&result.push(value)}return result}function baseEvery(collection,predicate){var result=!0;return baseEach(collection,function(value,index,collection){return result=!!predicate(value,index,collection)}),result}function baseExtremum(collection,iteratee,comparator,exValue){var computed=exValue,result=computed;return baseEach(collection,function(value,index,collection){var current=+iteratee(value,index,collection);(comparator(current,computed)||current===exValue&&current===result)&&(computed=current,result=value)}),result}function baseFill(array,value,start,end){var length=array.length;for(start=null==start?0:+start||0,start<0&&(start=-start>length?0:length+start),end=end===undefined||end>length?length:+end||0,end<0&&(end+=length),length=start>end?0:end>>>0,start>>>=0;start<length;)array[start++]=value;return array}function baseFilter(collection,predicate){var result=[];return baseEach(collection,function(value,index,collection){predicate(value,index,collection)&&result.push(value)}),result}function baseFind(collection,predicate,eachFunc,retKey){var result;return eachFunc(collection,function(value,key,collection){if(predicate(value,key,collection))return result=retKey?key:value,!1}),result}function baseFlatten(array,isDeep,isStrict,result){result||(result=[]);for(var index=-1,length=array.length;++index<length;){var value=array[index];isObjectLike(value)&&isArrayLike(value)&&(isStrict||isArray(value)||isArguments(value))?isDeep?baseFlatten(value,isDeep,isStrict,result):arrayPush(result,value):isStrict||(result[result.length]=value)}return result}function baseForIn(object,iteratee){return baseFor(object,iteratee,keysIn)}function baseForOwn(object,iteratee){return baseFor(object,iteratee,keys)}function baseForOwnRight(object,iteratee){return baseForRight(object,iteratee,keys)}function baseFunctions(object,props){for(var index=-1,length=props.length,resIndex=-1,result=[];++index<length;){var key=props[index];isFunction(object[key])&&(result[++resIndex]=key)}return result}function baseGet(object,path,pathKey){if(null!=object){pathKey!==undefined&&pathKey in toObject(object)&&(path=[pathKey]);for(var index=0,length=path.length;null!=object&&index<length;)object=object[path[index++]];return index&&index==length?object:undefined}}function baseIsEqual(value,other,customizer,isLoose,stackA,stackB){return value===other||(null==value||null==other||!isObject(value)&&!isObjectLike(other)?value!==value&&other!==other:baseIsEqualDeep(value,other,baseIsEqual,customizer,isLoose,stackA,stackB))}function baseIsEqualDeep(object,other,equalFunc,customizer,isLoose,stackA,stackB){var objIsArr=isArray(object),othIsArr=isArray(other),objTag=arrayTag,othTag=arrayTag;objIsArr||(objTag=objToString.call(object),objTag==argsTag?objTag=objectTag:objTag!=objectTag&&(objIsArr=isTypedArray(object))),othIsArr||(othTag=objToString.call(other),othTag==argsTag?othTag=objectTag:othTag!=objectTag&&(othIsArr=isTypedArray(other)));var objIsObj=objTag==objectTag,othIsObj=othTag==objectTag,isSameTag=objTag==othTag;if(isSameTag&&!objIsArr&&!objIsObj)return equalByTag(object,other,objTag);if(!isLoose){var objIsWrapped=objIsObj&&hasOwnProperty.call(object,"__wrapped__"),othIsWrapped=othIsObj&&hasOwnProperty.call(other,"__wrapped__");if(objIsWrapped||othIsWrapped)return equalFunc(objIsWrapped?object.value():object,othIsWrapped?other.value():other,customizer,isLoose,stackA,stackB)}if(!isSameTag)return!1;stackA||(stackA=[]),stackB||(stackB=[]);for(var length=stackA.length;length--;)if(stackA[length]==object)return stackB[length]==other;stackA.push(object),stackB.push(other);var result=(objIsArr?equalArrays:equalObjects)(object,other,equalFunc,customizer,isLoose,stackA,stackB);return stackA.pop(),stackB.pop(),result}function baseIsMatch(object,matchData,customizer){var index=matchData.length,length=index,noCustomizer=!customizer;if(null==object)return!length;for(object=toObject(object);index--;){var data=matchData[index];if(noCustomizer&&data[2]?data[1]!==object[data[0]]:!(data[0]in object))return!1}for(;++index<length;){data=matchData[index];var key=data[0],objValue=object[key],srcValue=data[1];if(noCustomizer&&data[2]){if(objValue===undefined&&!(key in object))return!1}else{var result=customizer?customizer(objValue,srcValue,key):undefined;if(!(result===undefined?baseIsEqual(srcValue,objValue,customizer,!0):result))return!1}}return!0}function baseMap(collection,iteratee){var index=-1,result=isArrayLike(collection)?Array(collection.length):[];return baseEach(collection,function(value,key,collection){result[++index]=iteratee(value,key,collection)}),result}function baseMatches(source){var matchData=getMatchData(source);if(1==matchData.length&&matchData[0][2]){var key=matchData[0][0],value=matchData[0][1];return function(object){return null!=object&&(object[key]===value&&(value!==undefined||key in toObject(object)))}}return function(object){return baseIsMatch(object,matchData)}}function baseMatchesProperty(path,srcValue){var isArr=isArray(path),isCommon=isKey(path)&&isStrictComparable(srcValue),pathKey=path+"";return path=toPath(path),function(object){if(null==object)return!1;var key=pathKey;if(object=toObject(object),(isArr||!isCommon)&&!(key in object)){if(object=1==path.length?object:baseGet(object,baseSlice(path,0,-1)),null==object)return!1;key=last(path),object=toObject(object)}return object[key]===srcValue?srcValue!==undefined||key in object:baseIsEqual(srcValue,object[key],undefined,!0)}}function baseMerge(object,source,customizer,stackA,stackB){if(!isObject(object))return object;var isSrcArr=isArrayLike(source)&&(isArray(source)||isTypedArray(source)),props=isSrcArr?undefined:keys(source);return arrayEach(props||source,function(srcValue,key){if(props&&(key=srcValue,srcValue=source[key]),isObjectLike(srcValue))stackA||(stackA=[]),stackB||(stackB=[]),baseMergeDeep(object,source,key,baseMerge,customizer,stackA,stackB);else{var value=object[key],result=customizer?customizer(value,srcValue,key,object,source):undefined,isCommon=result===undefined;isCommon&&(result=srcValue),result===undefined&&(!isSrcArr||key in object)||!isCommon&&(result===result?result===value:value!==value)||(object[key]=result)}}),object}function baseMergeDeep(object,source,key,mergeFunc,customizer,stackA,stackB){for(var length=stackA.length,srcValue=source[key];length--;)if(stackA[length]==srcValue)return void(object[key]=stackB[length]);var value=object[key],result=customizer?customizer(value,srcValue,key,object,source):undefined,isCommon=result===undefined;isCommon&&(result=srcValue,isArrayLike(srcValue)&&(isArray(srcValue)||isTypedArray(srcValue))?result=isArray(value)?value:isArrayLike(value)?arrayCopy(value):[]:isPlainObject(srcValue)||isArguments(srcValue)?result=isArguments(value)?toPlainObject(value):isPlainObject(value)?value:{}:isCommon=!1),stackA.push(srcValue),stackB.push(result),isCommon?object[key]=mergeFunc(result,srcValue,customizer,stackA,stackB):(result===result?result!==value:value===value)&&(object[key]=result)}function baseProperty(key){return function(object){return null==object?undefined:object[key]}}function basePropertyDeep(path){var pathKey=path+"";return path=toPath(path),function(object){return baseGet(object,path,pathKey)}}function basePullAt(array,indexes){for(var length=array?indexes.length:0;length--;){var index=indexes[length];if(index!=previous&&isIndex(index)){var previous=index;splice.call(array,index,1)}}return array}function baseRandom(min,max){return min+nativeFloor(nativeRandom()*(max-min+1))}function baseReduce(collection,iteratee,accumulator,initFromCollection,eachFunc){return eachFunc(collection,function(value,index,collection){accumulator=initFromCollection?(initFromCollection=!1,value):iteratee(accumulator,value,index,collection)}),accumulator}function baseSlice(array,start,end){var index=-1,length=array.length;start=null==start?0:+start||0,start<0&&(start=-start>length?0:length+start),end=end===undefined||end>length?length:+end||0,end<0&&(end+=length),length=start>end?0:end-start>>>0,start>>>=0;for(var result=Array(length);++index<length;)result[index]=array[index+start];return result}function baseSome(collection,predicate){var result;return baseEach(collection,function(value,index,collection){return result=predicate(value,index,collection),!result}),!!result}function baseSortBy(array,comparer){var length=array.length;for(array.sort(comparer);length--;)array[length]=array[length].value;return array}function baseSortByOrder(collection,iteratees,orders){var callback=getCallback(),index=-1;iteratees=arrayMap(iteratees,function(iteratee){return callback(iteratee)});var result=baseMap(collection,function(value){var criteria=arrayMap(iteratees,function(iteratee){return iteratee(value)});return{criteria:criteria,index:++index,value:value}});return baseSortBy(result,function(object,other){return compareMultiple(object,other,orders)})}function baseSum(collection,iteratee){var result=0;return baseEach(collection,function(value,index,collection){result+=+iteratee(value,index,collection)||0}),result}function baseUniq(array,iteratee){var index=-1,indexOf=getIndexOf(),length=array.length,isCommon=indexOf==baseIndexOf,isLarge=isCommon&&length>=LARGE_ARRAY_SIZE,seen=isLarge?createCache():null,result=[];seen?(indexOf=cacheIndexOf,isCommon=!1):(isLarge=!1,seen=iteratee?[]:result);outer:for(;++index<length;){var value=array[index],computed=iteratee?iteratee(value,index,array):value;if(isCommon&&value===value){for(var seenIndex=seen.length;seenIndex--;)if(seen[seenIndex]===computed)continue outer;iteratee&&seen.push(computed),result.push(value)}else indexOf(seen,computed,0)<0&&((iteratee||isLarge)&&seen.push(computed),result.push(value))}return result}function baseValues(object,props){for(var index=-1,length=props.length,result=Array(length);++index<length;)result[index]=object[props[index]];return result}function baseWhile(array,predicate,isDrop,fromRight){for(var length=array.length,index=fromRight?length:-1;(fromRight?index--:++index<length)&&predicate(array[index],index,array););return isDrop?baseSlice(array,fromRight?0:index,fromRight?index+1:length):baseSlice(array,fromRight?index+1:0,fromRight?length:index)}function baseWrapperValue(value,actions){var result=value;result instanceof LazyWrapper&&(result=result.value());for(var index=-1,length=actions.length;++index<length;){var action=actions[index];result=action.func.apply(action.thisArg,arrayPush([result],action.args))}return result}function binaryIndex(array,value,retHighest){var low=0,high=array?array.length:low;if("number"==typeof value&&value===value&&high<=HALF_MAX_ARRAY_LENGTH){for(;low<high;){var mid=low+high>>>1,computed=array[mid];(retHighest?computed<=value:computed<value)&&null!==computed?low=mid+1:high=mid}return high}return binaryIndexBy(array,value,identity,retHighest)}function binaryIndexBy(array,value,iteratee,retHighest){value=iteratee(value);for(var low=0,high=array?array.length:0,valIsNaN=value!==value,valIsNull=null===value,valIsUndef=value===undefined;low<high;){var mid=nativeFloor((low+high)/2),computed=iteratee(array[mid]),isDef=computed!==undefined,isReflexive=computed===computed;if(valIsNaN)var setLow=isReflexive||retHighest;else setLow=valIsNull?isReflexive&&isDef&&(retHighest||null!=computed):valIsUndef?isReflexive&&(retHighest||isDef):null!=computed&&(retHighest?computed<=value:computed<value);setLow?low=mid+1:high=mid}return nativeMin(high,MAX_ARRAY_INDEX)}function bindCallback(func,thisArg,argCount){if("function"!=typeof func)return identity;if(thisArg===undefined)return func;switch(argCount){case 1:return function(value){return func.call(thisArg,value)};case 3:return function(value,index,collection){return func.call(thisArg,value,index,collection)};case 4:return function(accumulator,value,index,collection){return func.call(thisArg,accumulator,value,index,collection)};case 5:return function(value,other,key,object,source){return func.call(thisArg,value,other,key,object,source)}}return function(){return func.apply(thisArg,arguments)}}function bufferClone(buffer){var result=new ArrayBuffer(buffer.byteLength),view=new Uint8Array(result);return view.set(new Uint8Array(buffer)),result}function composeArgs(args,partials,holders){for(var holdersLength=holders.length,argsIndex=-1,argsLength=nativeMax(args.length-holdersLength,0),leftIndex=-1,leftLength=partials.length,result=Array(leftLength+argsLength);++leftIndex<leftLength;)result[leftIndex]=partials[leftIndex];for(;++argsIndex<holdersLength;)result[holders[argsIndex]]=args[argsIndex];for(;argsLength--;)result[leftIndex++]=args[argsIndex++];return result}function composeArgsRight(args,partials,holders){for(var holdersIndex=-1,holdersLength=holders.length,argsIndex=-1,argsLength=nativeMax(args.length-holdersLength,0),rightIndex=-1,rightLength=partials.length,result=Array(argsLength+rightLength);++argsIndex<argsLength;)result[argsIndex]=args[argsIndex];for(var offset=argsIndex;++rightIndex<rightLength;)result[offset+rightIndex]=partials[rightIndex];for(;++holdersIndex<holdersLength;)result[offset+holders[holdersIndex]]=args[argsIndex++];return result}function createAggregator(setter,initializer){return function(collection,iteratee,thisArg){var result=initializer?initializer():{};if(iteratee=getCallback(iteratee,thisArg,3),isArray(collection))for(var index=-1,length=collection.length;++index<length;){var value=collection[index];setter(result,value,iteratee(value,index,collection),collection)}else baseEach(collection,function(value,key,collection){setter(result,value,iteratee(value,key,collection),collection)});return result}}function createAssigner(assigner){return restParam(function(object,sources){var index=-1,length=null==object?0:sources.length,customizer=length>2?sources[length-2]:undefined,guard=length>2?sources[2]:undefined,thisArg=length>1?sources[length-1]:undefined;for("function"==typeof customizer?(customizer=bindCallback(customizer,thisArg,5),length-=2):(customizer="function"==typeof thisArg?thisArg:undefined,length-=customizer?1:0),guard&&isIterateeCall(sources[0],sources[1],guard)&&(customizer=length<3?undefined:customizer,length=1);++index<length;){var source=sources[index];source&&assigner(object,source,customizer)}return object})}function createBaseEach(eachFunc,fromRight){return function(collection,iteratee){var length=collection?getLength(collection):0;if(!isLength(length))return eachFunc(collection,iteratee);for(var index=fromRight?length:-1,iterable=toObject(collection);(fromRight?index--:++index<length)&&iteratee(iterable[index],index,iterable)!==!1;);return collection}}function createBaseFor(fromRight){return function(object,iteratee,keysFunc){for(var iterable=toObject(object),props=keysFunc(object),length=props.length,index=fromRight?length:-1;fromRight?index--:++index<length;){var key=props[index];if(iteratee(iterable[key],key,iterable)===!1)break}return object}}function createBindWrapper(func,thisArg){function wrapper(){var fn=this&&this!==root&&this instanceof wrapper?Ctor:func;return fn.apply(thisArg,arguments)}var Ctor=createCtorWrapper(func);return wrapper}function createCache(values){return nativeCreate&&Set?new SetCache(values):null}function createCompounder(callback){return function(string){for(var index=-1,array=words(deburr(string)),length=array.length,result="";++index<length;)result=callback(result,array[index],index);return result}}function createCtorWrapper(Ctor){return function(){var args=arguments;switch(args.length){case 0:return new Ctor;case 1:return new Ctor(args[0]);case 2:return new Ctor(args[0],args[1]);case 3:return new Ctor(args[0],args[1],args[2]);case 4:return new Ctor(args[0],args[1],args[2],args[3]);case 5:return new Ctor(args[0],args[1],args[2],args[3],args[4]);case 6:return new Ctor(args[0],args[1],args[2],args[3],args[4],args[5]);case 7:return new Ctor(args[0],args[1],args[2],args[3],args[4],args[5],args[6])}var thisBinding=baseCreate(Ctor.prototype),result=Ctor.apply(thisBinding,args);return isObject(result)?result:thisBinding}}function createCurry(flag){function curryFunc(func,arity,guard){guard&&isIterateeCall(func,arity,guard)&&(arity=undefined);var result=createWrapper(func,flag,undefined,undefined,undefined,undefined,undefined,arity);return result.placeholder=curryFunc.placeholder,result}return curryFunc}function createDefaults(assigner,customizer){return restParam(function(args){var object=args[0];return null==object?object:(args.push(customizer),assigner.apply(undefined,args))})}function createExtremum(comparator,exValue){return function(collection,iteratee,thisArg){if(thisArg&&isIterateeCall(collection,iteratee,thisArg)&&(iteratee=undefined),iteratee=getCallback(iteratee,thisArg,3),1==iteratee.length){collection=isArray(collection)?collection:toIterable(collection);var result=arrayExtremum(collection,iteratee,comparator,exValue);if(!collection.length||result!==exValue)return result}return baseExtremum(collection,iteratee,comparator,exValue)}}function createFind(eachFunc,fromRight){return function(collection,predicate,thisArg){if(predicate=getCallback(predicate,thisArg,3),isArray(collection)){var index=baseFindIndex(collection,predicate,fromRight);return index>-1?collection[index]:undefined}return baseFind(collection,predicate,eachFunc)}}function createFindIndex(fromRight){return function(array,predicate,thisArg){return array&&array.length?(predicate=getCallback(predicate,thisArg,3),baseFindIndex(array,predicate,fromRight)):-1}}function createFindKey(objectFunc){return function(object,predicate,thisArg){return predicate=getCallback(predicate,thisArg,3),baseFind(object,predicate,objectFunc,!0)}}function createFlow(fromRight){return function(){for(var wrapper,length=arguments.length,index=fromRight?length:-1,leftIndex=0,funcs=Array(length);fromRight?index--:++index<length;){var func=funcs[leftIndex++]=arguments[index];if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);!wrapper&&LodashWrapper.prototype.thru&&"wrapper"==getFuncName(func)&&(wrapper=new LodashWrapper([],(!0)))}for(index=wrapper?-1:length;++index<length;){func=funcs[index];var funcName=getFuncName(func),data="wrapper"==funcName?getData(func):undefined;wrapper=data&&isLaziable(data[0])&&data[1]==(ARY_FLAG|CURRY_FLAG|PARTIAL_FLAG|REARG_FLAG)&&!data[4].length&&1==data[9]?wrapper[getFuncName(data[0])].apply(wrapper,data[3]):1==func.length&&isLaziable(func)?wrapper[funcName]():wrapper.thru(func)}return function(){var args=arguments,value=args[0];if(wrapper&&1==args.length&&isArray(value)&&value.length>=LARGE_ARRAY_SIZE)return wrapper.plant(value).value();for(var index=0,result=length?funcs[index].apply(this,args):value;++index<length;)result=funcs[index].call(this,result);return result}}}function createForEach(arrayFunc,eachFunc){return function(collection,iteratee,thisArg){return"function"==typeof iteratee&&thisArg===undefined&&isArray(collection)?arrayFunc(collection,iteratee):eachFunc(collection,bindCallback(iteratee,thisArg,3))}}function createForIn(objectFunc){return function(object,iteratee,thisArg){return"function"==typeof iteratee&&thisArg===undefined||(iteratee=bindCallback(iteratee,thisArg,3)),objectFunc(object,iteratee,keysIn)}}function createForOwn(objectFunc){return function(object,iteratee,thisArg){return"function"==typeof iteratee&&thisArg===undefined||(iteratee=bindCallback(iteratee,thisArg,3)),objectFunc(object,iteratee)}}function createObjectMapper(isMapKeys){return function(object,iteratee,thisArg){var result={};return iteratee=getCallback(iteratee,thisArg,3),baseForOwn(object,function(value,key,object){var mapped=iteratee(value,key,object);key=isMapKeys?mapped:key,value=isMapKeys?value:mapped,result[key]=value}),result}}function createPadDir(fromRight){return function(string,length,chars){return string=baseToString(string),(fromRight?string:"")+createPadding(string,length,chars)+(fromRight?"":string)}}function createPartial(flag){var partialFunc=restParam(function(func,partials){var holders=replaceHolders(partials,partialFunc.placeholder);return createWrapper(func,flag,undefined,partials,holders)});return partialFunc}function createReduce(arrayFunc,eachFunc){return function(collection,iteratee,accumulator,thisArg){var initFromArray=arguments.length<3;return"function"==typeof iteratee&&thisArg===undefined&&isArray(collection)?arrayFunc(collection,iteratee,accumulator,initFromArray):baseReduce(collection,getCallback(iteratee,thisArg,4),accumulator,initFromArray,eachFunc)}}function createHybridWrapper(func,bitmask,thisArg,partials,holders,partialsRight,holdersRight,argPos,ary,arity){function wrapper(){for(var length=arguments.length,index=length,args=Array(length);index--;)args[index]=arguments[index];if(partials&&(args=composeArgs(args,partials,holders)),partialsRight&&(args=composeArgsRight(args,partialsRight,holdersRight)),isCurry||isCurryRight){var placeholder=wrapper.placeholder,argsHolders=replaceHolders(args,placeholder);if(length-=argsHolders.length,length<arity){var newArgPos=argPos?arrayCopy(argPos):undefined,newArity=nativeMax(arity-length,0),newsHolders=isCurry?argsHolders:undefined,newHoldersRight=isCurry?undefined:argsHolders,newPartials=isCurry?args:undefined,newPartialsRight=isCurry?undefined:args;bitmask|=isCurry?PARTIAL_FLAG:PARTIAL_RIGHT_FLAG,bitmask&=~(isCurry?PARTIAL_RIGHT_FLAG:PARTIAL_FLAG),isCurryBound||(bitmask&=~(BIND_FLAG|BIND_KEY_FLAG));var newData=[func,bitmask,thisArg,newPartials,newsHolders,newPartialsRight,newHoldersRight,newArgPos,ary,newArity],result=createHybridWrapper.apply(undefined,newData);
return isLaziable(func)&&setData(result,newData),result.placeholder=placeholder,result}}var thisBinding=isBind?thisArg:this,fn=isBindKey?thisBinding[func]:func;return argPos&&(args=reorder(args,argPos)),isAry&&ary<args.length&&(args.length=ary),this&&this!==root&&this instanceof wrapper&&(fn=Ctor||createCtorWrapper(func)),fn.apply(thisBinding,args)}var isAry=bitmask&ARY_FLAG,isBind=bitmask&BIND_FLAG,isBindKey=bitmask&BIND_KEY_FLAG,isCurry=bitmask&CURRY_FLAG,isCurryBound=bitmask&CURRY_BOUND_FLAG,isCurryRight=bitmask&CURRY_RIGHT_FLAG,Ctor=isBindKey?undefined:createCtorWrapper(func);return wrapper}function createPadding(string,length,chars){var strLength=string.length;if(length=+length,strLength>=length||!nativeIsFinite(length))return"";var padLength=length-strLength;return chars=null==chars?" ":chars+"",repeat(chars,nativeCeil(padLength/chars.length)).slice(0,padLength)}function createPartialWrapper(func,bitmask,thisArg,partials){function wrapper(){for(var argsIndex=-1,argsLength=arguments.length,leftIndex=-1,leftLength=partials.length,args=Array(leftLength+argsLength);++leftIndex<leftLength;)args[leftIndex]=partials[leftIndex];for(;argsLength--;)args[leftIndex++]=arguments[++argsIndex];var fn=this&&this!==root&&this instanceof wrapper?Ctor:func;return fn.apply(isBind?thisArg:this,args)}var isBind=bitmask&BIND_FLAG,Ctor=createCtorWrapper(func);return wrapper}function createRound(methodName){var func=Math[methodName];return function(number,precision){return precision=precision===undefined?0:+precision||0,precision?(precision=pow(10,precision),func(number*precision)/precision):func(number)}}function createSortedIndex(retHighest){return function(array,value,iteratee,thisArg){var callback=getCallback(iteratee);return null==iteratee&&callback===baseCallback?binaryIndex(array,value,retHighest):binaryIndexBy(array,value,callback(iteratee,thisArg,1),retHighest)}}function createWrapper(func,bitmask,thisArg,partials,holders,argPos,ary,arity){var isBindKey=bitmask&BIND_KEY_FLAG;if(!isBindKey&&"function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);var length=partials?partials.length:0;if(length||(bitmask&=~(PARTIAL_FLAG|PARTIAL_RIGHT_FLAG),partials=holders=undefined),length-=holders?holders.length:0,bitmask&PARTIAL_RIGHT_FLAG){var partialsRight=partials,holdersRight=holders;partials=holders=undefined}var data=isBindKey?undefined:getData(func),newData=[func,bitmask,thisArg,partials,holders,partialsRight,holdersRight,argPos,ary,arity];if(data&&(mergeData(newData,data),bitmask=newData[1],arity=newData[9]),newData[9]=null==arity?isBindKey?0:func.length:nativeMax(arity-length,0)||0,bitmask==BIND_FLAG)var result=createBindWrapper(newData[0],newData[2]);else result=bitmask!=PARTIAL_FLAG&&bitmask!=(BIND_FLAG|PARTIAL_FLAG)||newData[4].length?createHybridWrapper.apply(undefined,newData):createPartialWrapper.apply(undefined,newData);var setter=data?baseSetData:setData;return setter(result,newData)}function equalArrays(array,other,equalFunc,customizer,isLoose,stackA,stackB){var index=-1,arrLength=array.length,othLength=other.length;if(arrLength!=othLength&&!(isLoose&&othLength>arrLength))return!1;for(;++index<arrLength;){var arrValue=array[index],othValue=other[index],result=customizer?customizer(isLoose?othValue:arrValue,isLoose?arrValue:othValue,index):undefined;if(result!==undefined){if(result)continue;return!1}if(isLoose){if(!arraySome(other,function(othValue){return arrValue===othValue||equalFunc(arrValue,othValue,customizer,isLoose,stackA,stackB)}))return!1}else if(arrValue!==othValue&&!equalFunc(arrValue,othValue,customizer,isLoose,stackA,stackB))return!1}return!0}function equalByTag(object,other,tag){switch(tag){case boolTag:case dateTag:return+object==+other;case errorTag:return object.name==other.name&&object.message==other.message;case numberTag:return object!=+object?other!=+other:object==+other;case regexpTag:case stringTag:return object==other+""}return!1}function equalObjects(object,other,equalFunc,customizer,isLoose,stackA,stackB){var objProps=keys(object),objLength=objProps.length,othProps=keys(other),othLength=othProps.length;if(objLength!=othLength&&!isLoose)return!1;for(var index=objLength;index--;){var key=objProps[index];if(!(isLoose?key in other:hasOwnProperty.call(other,key)))return!1}for(var skipCtor=isLoose;++index<objLength;){key=objProps[index];var objValue=object[key],othValue=other[key],result=customizer?customizer(isLoose?othValue:objValue,isLoose?objValue:othValue,key):undefined;if(!(result===undefined?equalFunc(objValue,othValue,customizer,isLoose,stackA,stackB):result))return!1;skipCtor||(skipCtor="constructor"==key)}if(!skipCtor){var objCtor=object.constructor,othCtor=other.constructor;if(objCtor!=othCtor&&"constructor"in object&&"constructor"in other&&!("function"==typeof objCtor&&objCtor instanceof objCtor&&"function"==typeof othCtor&&othCtor instanceof othCtor))return!1}return!0}function getCallback(func,thisArg,argCount){var result=lodash.callback||callback;return result=result===callback?baseCallback:result,argCount?result(func,thisArg,argCount):result}function getFuncName(func){for(var result=func.name,array=realNames[result],length=array?array.length:0;length--;){var data=array[length],otherFunc=data.func;if(null==otherFunc||otherFunc==func)return data.name}return result}function getIndexOf(collection,target,fromIndex){var result=lodash.indexOf||indexOf;return result=result===indexOf?baseIndexOf:result,collection?result(collection,target,fromIndex):result}function getMatchData(object){for(var result=pairs(object),length=result.length;length--;)result[length][2]=isStrictComparable(result[length][1]);return result}function getNative(object,key){var value=null==object?undefined:object[key];return isNative(value)?value:undefined}function getView(start,end,transforms){for(var index=-1,length=transforms.length;++index<length;){var data=transforms[index],size=data.size;switch(data.type){case"drop":start+=size;break;case"dropRight":end-=size;break;case"take":end=nativeMin(end,start+size);break;case"takeRight":start=nativeMax(start,end-size)}}return{start:start,end:end}}function initCloneArray(array){var length=array.length,result=new array.constructor(length);return length&&"string"==typeof array[0]&&hasOwnProperty.call(array,"index")&&(result.index=array.index,result.input=array.input),result}function initCloneObject(object){var Ctor=object.constructor;return"function"==typeof Ctor&&Ctor instanceof Ctor||(Ctor=Object),new Ctor}function initCloneByTag(object,tag,isDeep){var Ctor=object.constructor;switch(tag){case arrayBufferTag:return bufferClone(object);case boolTag:case dateTag:return new Ctor((+object));case float32Tag:case float64Tag:case int8Tag:case int16Tag:case int32Tag:case uint8Tag:case uint8ClampedTag:case uint16Tag:case uint32Tag:var buffer=object.buffer;return new Ctor(isDeep?bufferClone(buffer):buffer,object.byteOffset,object.length);case numberTag:case stringTag:return new Ctor(object);case regexpTag:var result=new Ctor(object.source,reFlags.exec(object));result.lastIndex=object.lastIndex}return result}function invokePath(object,path,args){null==object||isKey(path,object)||(path=toPath(path),object=1==path.length?object:baseGet(object,baseSlice(path,0,-1)),path=last(path));var func=null==object?object:object[path];return null==func?undefined:func.apply(object,args)}function isArrayLike(value){return null!=value&&isLength(getLength(value))}function isIndex(value,length){return value="number"==typeof value||reIsUint.test(value)?+value:-1,length=null==length?MAX_SAFE_INTEGER:length,value>-1&&value%1==0&&value<length}function isIterateeCall(value,index,object){if(!isObject(object))return!1;var type=typeof index;if("number"==type?isArrayLike(object)&&isIndex(index,object.length):"string"==type&&index in object){var other=object[index];return value===value?value===other:other!==other}return!1}function isKey(value,object){var type=typeof value;if("string"==type&&reIsPlainProp.test(value)||"number"==type)return!0;if(isArray(value))return!1;var result=!reIsDeepProp.test(value);return result||null!=object&&value in toObject(object)}function isLaziable(func){var funcName=getFuncName(func);if(!(funcName in LazyWrapper.prototype))return!1;var other=lodash[funcName];if(func===other)return!0;var data=getData(other);return!!data&&func===data[0]}function isLength(value){return"number"==typeof value&&value>-1&&value%1==0&&value<=MAX_SAFE_INTEGER}function isStrictComparable(value){return value===value&&!isObject(value)}function mergeData(data,source){var bitmask=data[1],srcBitmask=source[1],newBitmask=bitmask|srcBitmask,isCommon=newBitmask<ARY_FLAG,isCombo=srcBitmask==ARY_FLAG&&bitmask==CURRY_FLAG||srcBitmask==ARY_FLAG&&bitmask==REARG_FLAG&&data[7].length<=source[8]||srcBitmask==(ARY_FLAG|REARG_FLAG)&&bitmask==CURRY_FLAG;if(!isCommon&&!isCombo)return data;srcBitmask&BIND_FLAG&&(data[2]=source[2],newBitmask|=bitmask&BIND_FLAG?0:CURRY_BOUND_FLAG);var value=source[3];if(value){var partials=data[3];data[3]=partials?composeArgs(partials,value,source[4]):arrayCopy(value),data[4]=partials?replaceHolders(data[3],PLACEHOLDER):arrayCopy(source[4])}return value=source[5],value&&(partials=data[5],data[5]=partials?composeArgsRight(partials,value,source[6]):arrayCopy(value),data[6]=partials?replaceHolders(data[5],PLACEHOLDER):arrayCopy(source[6])),value=source[7],value&&(data[7]=arrayCopy(value)),srcBitmask&ARY_FLAG&&(data[8]=null==data[8]?source[8]:nativeMin(data[8],source[8])),null==data[9]&&(data[9]=source[9]),data[0]=source[0],data[1]=newBitmask,data}function mergeDefaults(objectValue,sourceValue){return objectValue===undefined?sourceValue:merge(objectValue,sourceValue,mergeDefaults)}function pickByArray(object,props){object=toObject(object);for(var index=-1,length=props.length,result={};++index<length;){var key=props[index];key in object&&(result[key]=object[key])}return result}function pickByCallback(object,predicate){var result={};return baseForIn(object,function(value,key,object){predicate(value,key,object)&&(result[key]=value)}),result}function reorder(array,indexes){for(var arrLength=array.length,length=nativeMin(indexes.length,arrLength),oldArray=arrayCopy(array);length--;){var index=indexes[length];array[length]=isIndex(index,arrLength)?oldArray[index]:undefined}return array}function shimKeys(object){for(var props=keysIn(object),propsLength=props.length,length=propsLength&&object.length,allowIndexes=!!length&&isLength(length)&&(isArray(object)||isArguments(object)),index=-1,result=[];++index<propsLength;){var key=props[index];(allowIndexes&&isIndex(key,length)||hasOwnProperty.call(object,key))&&result.push(key)}return result}function toIterable(value){return null==value?[]:isArrayLike(value)?isObject(value)?value:Object(value):values(value)}function toObject(value){return isObject(value)?value:Object(value)}function toPath(value){if(isArray(value))return value;var result=[];return baseToString(value).replace(rePropName,function(match,number,quote,string){result.push(quote?string.replace(reEscapeChar,"$1"):number||match)}),result}function wrapperClone(wrapper){return wrapper instanceof LazyWrapper?wrapper.clone():new LodashWrapper(wrapper.__wrapped__,wrapper.__chain__,arrayCopy(wrapper.__actions__))}function chunk(array,size,guard){size=(guard?isIterateeCall(array,size,guard):null==size)?1:nativeMax(nativeFloor(size)||1,1);for(var index=0,length=array?array.length:0,resIndex=-1,result=Array(nativeCeil(length/size));index<length;)result[++resIndex]=baseSlice(array,index,index+=size);return result}function compact(array){for(var index=-1,length=array?array.length:0,resIndex=-1,result=[];++index<length;){var value=array[index];value&&(result[++resIndex]=value)}return result}function drop(array,n,guard){var length=array?array.length:0;return length?((guard?isIterateeCall(array,n,guard):null==n)&&(n=1),baseSlice(array,n<0?0:n)):[]}function dropRight(array,n,guard){var length=array?array.length:0;return length?((guard?isIterateeCall(array,n,guard):null==n)&&(n=1),n=length-(+n||0),baseSlice(array,0,n<0?0:n)):[]}function dropRightWhile(array,predicate,thisArg){return array&&array.length?baseWhile(array,getCallback(predicate,thisArg,3),!0,!0):[]}function dropWhile(array,predicate,thisArg){return array&&array.length?baseWhile(array,getCallback(predicate,thisArg,3),!0):[]}function fill(array,value,start,end){var length=array?array.length:0;return length?(start&&"number"!=typeof start&&isIterateeCall(array,value,start)&&(start=0,end=length),baseFill(array,value,start,end)):[]}function first(array){return array?array[0]:undefined}function flatten(array,isDeep,guard){var length=array?array.length:0;return guard&&isIterateeCall(array,isDeep,guard)&&(isDeep=!1),length?baseFlatten(array,isDeep):[]}function flattenDeep(array){var length=array?array.length:0;return length?baseFlatten(array,!0):[]}function indexOf(array,value,fromIndex){var length=array?array.length:0;if(!length)return-1;if("number"==typeof fromIndex)fromIndex=fromIndex<0?nativeMax(length+fromIndex,0):fromIndex;else if(fromIndex){var index=binaryIndex(array,value);return index<length&&(value===value?value===array[index]:array[index]!==array[index])?index:-1}return baseIndexOf(array,value,fromIndex||0)}function initial(array){return dropRight(array,1)}function last(array){var length=array?array.length:0;return length?array[length-1]:undefined}function lastIndexOf(array,value,fromIndex){var length=array?array.length:0;if(!length)return-1;var index=length;if("number"==typeof fromIndex)index=(fromIndex<0?nativeMax(length+fromIndex,0):nativeMin(fromIndex||0,length-1))+1;else if(fromIndex){index=binaryIndex(array,value,!0)-1;var other=array[index];return(value===value?value===other:other!==other)?index:-1}if(value!==value)return indexOfNaN(array,index,!0);for(;index--;)if(array[index]===value)return index;return-1}function pull(){var args=arguments,array=args[0];if(!array||!array.length)return array;for(var index=0,indexOf=getIndexOf(),length=args.length;++index<length;)for(var fromIndex=0,value=args[index];(fromIndex=indexOf(array,value,fromIndex))>-1;)splice.call(array,fromIndex,1);return array}function remove(array,predicate,thisArg){var result=[];if(!array||!array.length)return result;var index=-1,indexes=[],length=array.length;for(predicate=getCallback(predicate,thisArg,3);++index<length;){var value=array[index];predicate(value,index,array)&&(result.push(value),indexes.push(index))}return basePullAt(array,indexes),result}function rest(array){return drop(array,1)}function slice(array,start,end){var length=array?array.length:0;return length?(end&&"number"!=typeof end&&isIterateeCall(array,start,end)&&(start=0,end=length),baseSlice(array,start,end)):[]}function take(array,n,guard){var length=array?array.length:0;return length?((guard?isIterateeCall(array,n,guard):null==n)&&(n=1),baseSlice(array,0,n<0?0:n)):[]}function takeRight(array,n,guard){var length=array?array.length:0;return length?((guard?isIterateeCall(array,n,guard):null==n)&&(n=1),n=length-(+n||0),baseSlice(array,n<0?0:n)):[]}function takeRightWhile(array,predicate,thisArg){return array&&array.length?baseWhile(array,getCallback(predicate,thisArg,3),!1,!0):[]}function takeWhile(array,predicate,thisArg){return array&&array.length?baseWhile(array,getCallback(predicate,thisArg,3)):[]}function uniq(array,isSorted,iteratee,thisArg){var length=array?array.length:0;if(!length)return[];null!=isSorted&&"boolean"!=typeof isSorted&&(thisArg=iteratee,iteratee=isIterateeCall(array,isSorted,thisArg)?undefined:isSorted,isSorted=!1);var callback=getCallback();return null==iteratee&&callback===baseCallback||(iteratee=callback(iteratee,thisArg,3)),isSorted&&getIndexOf()==baseIndexOf?sortedUniq(array,iteratee):baseUniq(array,iteratee)}function unzip(array){if(!array||!array.length)return[];var index=-1,length=0;array=arrayFilter(array,function(group){if(isArrayLike(group))return length=nativeMax(group.length,length),!0});for(var result=Array(length);++index<length;)result[index]=arrayMap(array,baseProperty(index));return result}function unzipWith(array,iteratee,thisArg){var length=array?array.length:0;if(!length)return[];var result=unzip(array);return null==iteratee?result:(iteratee=bindCallback(iteratee,thisArg,4),arrayMap(result,function(group){return arrayReduce(group,iteratee,undefined,!0)}))}function xor(){for(var index=-1,length=arguments.length;++index<length;){var array=arguments[index];if(isArrayLike(array))var result=result?arrayPush(baseDifference(result,array),baseDifference(array,result)):array}return result?baseUniq(result):[]}function zipObject(props,values){var index=-1,length=props?props.length:0,result={};for(!length||values||isArray(props[0])||(values=[]);++index<length;){var key=props[index];values?result[key]=values[index]:key&&(result[key[0]]=key[1])}return result}function chain(value){var result=lodash(value);return result.__chain__=!0,result}function tap(value,interceptor,thisArg){return interceptor.call(thisArg,value),value}function thru(value,interceptor,thisArg){return interceptor.call(thisArg,value)}function wrapperChain(){return chain(this)}function wrapperCommit(){return new LodashWrapper(this.value(),this.__chain__)}function wrapperPlant(value){for(var result,parent=this;parent instanceof baseLodash;){var clone=wrapperClone(parent);result?previous.__wrapped__=clone:result=clone;var previous=clone;parent=parent.__wrapped__}return previous.__wrapped__=value,result}function wrapperReverse(){var value=this.__wrapped__,interceptor=function(value){return wrapped&&wrapped.__dir__<0?value:value.reverse()};if(value instanceof LazyWrapper){var wrapped=value;return this.__actions__.length&&(wrapped=new LazyWrapper(this)),wrapped=wrapped.reverse(),wrapped.__actions__.push({func:thru,args:[interceptor],thisArg:undefined}),new LodashWrapper(wrapped,this.__chain__)}return this.thru(interceptor)}function wrapperToString(){return this.value()+""}function wrapperValue(){return baseWrapperValue(this.__wrapped__,this.__actions__)}function every(collection,predicate,thisArg){var func=isArray(collection)?arrayEvery:baseEvery;return thisArg&&isIterateeCall(collection,predicate,thisArg)&&(predicate=undefined),"function"==typeof predicate&&thisArg===undefined||(predicate=getCallback(predicate,thisArg,3)),func(collection,predicate)}function filter(collection,predicate,thisArg){var func=isArray(collection)?arrayFilter:baseFilter;return predicate=getCallback(predicate,thisArg,3),func(collection,predicate)}function findWhere(collection,source){return find(collection,baseMatches(source))}function includes(collection,target,fromIndex,guard){var length=collection?getLength(collection):0;return isLength(length)||(collection=values(collection),length=collection.length),fromIndex="number"!=typeof fromIndex||guard&&isIterateeCall(target,fromIndex,guard)?0:fromIndex<0?nativeMax(length+fromIndex,0):fromIndex||0,"string"==typeof collection||!isArray(collection)&&isString(collection)?fromIndex<=length&&collection.indexOf(target,fromIndex)>-1:!!length&&getIndexOf(collection,target,fromIndex)>-1}function map(collection,iteratee,thisArg){var func=isArray(collection)?arrayMap:baseMap;return iteratee=getCallback(iteratee,thisArg,3),func(collection,iteratee)}function pluck(collection,path){return map(collection,property(path))}function reject(collection,predicate,thisArg){var func=isArray(collection)?arrayFilter:baseFilter;return predicate=getCallback(predicate,thisArg,3),func(collection,function(value,index,collection){return!predicate(value,index,collection)})}function sample(collection,n,guard){if(guard?isIterateeCall(collection,n,guard):null==n){collection=toIterable(collection);var length=collection.length;return length>0?collection[baseRandom(0,length-1)]:undefined}var index=-1,result=toArray(collection),length=result.length,lastIndex=length-1;for(n=nativeMin(n<0?0:+n||0,length);++index<n;){var rand=baseRandom(index,lastIndex),value=result[rand];result[rand]=result[index],result[index]=value}return result.length=n,result}function shuffle(collection){return sample(collection,POSITIVE_INFINITY)}function size(collection){var length=collection?getLength(collection):0;return isLength(length)?length:keys(collection).length}function some(collection,predicate,thisArg){var func=isArray(collection)?arraySome:baseSome;return thisArg&&isIterateeCall(collection,predicate,thisArg)&&(predicate=undefined),"function"==typeof predicate&&thisArg===undefined||(predicate=getCallback(predicate,thisArg,3)),func(collection,predicate)}function sortBy(collection,iteratee,thisArg){if(null==collection)return[];thisArg&&isIterateeCall(collection,iteratee,thisArg)&&(iteratee=undefined);var index=-1;iteratee=getCallback(iteratee,thisArg,3);var result=baseMap(collection,function(value,key,collection){return{criteria:iteratee(value,key,collection),index:++index,value:value}});return baseSortBy(result,compareAscending)}function sortByOrder(collection,iteratees,orders,guard){return null==collection?[]:(guard&&isIterateeCall(iteratees,orders,guard)&&(orders=undefined),isArray(iteratees)||(iteratees=null==iteratees?[]:[iteratees]),isArray(orders)||(orders=null==orders?[]:[orders]),baseSortByOrder(collection,iteratees,orders))}function where(collection,source){return filter(collection,baseMatches(source))}function after(n,func){if("function"!=typeof func){if("function"!=typeof n)throw new TypeError(FUNC_ERROR_TEXT);var temp=n;n=func,func=temp}return n=nativeIsFinite(n=+n)?n:0,function(){if(--n<1)return func.apply(this,arguments)}}function ary(func,n,guard){return guard&&isIterateeCall(func,n,guard)&&(n=undefined),n=func&&null==n?func.length:nativeMax(+n||0,0),createWrapper(func,ARY_FLAG,undefined,undefined,undefined,undefined,n)}function before(n,func){var result;if("function"!=typeof func){if("function"!=typeof n)throw new TypeError(FUNC_ERROR_TEXT);var temp=n;n=func,func=temp}return function(){return--n>0&&(result=func.apply(this,arguments)),n<=1&&(func=undefined),result}}function debounce(func,wait,options){function cancel(){timeoutId&&clearTimeout(timeoutId),maxTimeoutId&&clearTimeout(maxTimeoutId),lastCalled=0,maxTimeoutId=timeoutId=trailingCall=undefined}function complete(isCalled,id){id&&clearTimeout(id),maxTimeoutId=timeoutId=trailingCall=undefined,isCalled&&(lastCalled=now(),result=func.apply(thisArg,args),timeoutId||maxTimeoutId||(args=thisArg=undefined))}function delayed(){var remaining=wait-(now()-stamp);remaining<=0||remaining>wait?complete(trailingCall,maxTimeoutId):timeoutId=setTimeout(delayed,remaining)}function maxDelayed(){complete(trailing,timeoutId)}function debounced(){if(args=arguments,stamp=now(),thisArg=this,trailingCall=trailing&&(timeoutId||!leading),maxWait===!1)var leadingCall=leading&&!timeoutId;else{maxTimeoutId||leading||(lastCalled=stamp);var remaining=maxWait-(stamp-lastCalled),isCalled=remaining<=0||remaining>maxWait;isCalled?(maxTimeoutId&&(maxTimeoutId=clearTimeout(maxTimeoutId)),lastCalled=stamp,result=func.apply(thisArg,args)):maxTimeoutId||(maxTimeoutId=setTimeout(maxDelayed,remaining))}return isCalled&&timeoutId?timeoutId=clearTimeout(timeoutId):timeoutId||wait===maxWait||(timeoutId=setTimeout(delayed,wait)),leadingCall&&(isCalled=!0,result=func.apply(thisArg,args)),!isCalled||timeoutId||maxTimeoutId||(args=thisArg=undefined),result}var args,maxTimeoutId,result,stamp,thisArg,timeoutId,trailingCall,lastCalled=0,maxWait=!1,trailing=!0;if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);if(wait=wait<0?0:+wait||0,options===!0){var leading=!0;trailing=!1}else isObject(options)&&(leading=!!options.leading,maxWait="maxWait"in options&&nativeMax(+options.maxWait||0,wait),trailing="trailing"in options?!!options.trailing:trailing);return debounced.cancel=cancel,debounced}function memoize(func,resolver){if("function"!=typeof func||resolver&&"function"!=typeof resolver)throw new TypeError(FUNC_ERROR_TEXT);var memoized=function(){var args=arguments,key=resolver?resolver.apply(this,args):args[0],cache=memoized.cache;if(cache.has(key))return cache.get(key);var result=func.apply(this,args);return memoized.cache=cache.set(key,result),result};return memoized.cache=new memoize.Cache,memoized}function negate(predicate){if("function"!=typeof predicate)throw new TypeError(FUNC_ERROR_TEXT);return function(){return!predicate.apply(this,arguments)}}function once(func){return before(2,func)}function restParam(func,start){if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);return start=nativeMax(start===undefined?func.length-1:+start||0,0),function(){for(var args=arguments,index=-1,length=nativeMax(args.length-start,0),rest=Array(length);++index<length;)rest[index]=args[start+index];switch(start){case 0:return func.call(this,rest);case 1:return func.call(this,args[0],rest);case 2:return func.call(this,args[0],args[1],rest)}var otherArgs=Array(start+1);for(index=-1;++index<start;)otherArgs[index]=args[index];return otherArgs[start]=rest,func.apply(this,otherArgs)}}function spread(func){if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);return function(array){return func.apply(this,array)}}function throttle(func,wait,options){var leading=!0,trailing=!0;if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);return options===!1?leading=!1:isObject(options)&&(leading="leading"in options?!!options.leading:leading,trailing="trailing"in options?!!options.trailing:trailing),debounce(func,wait,{leading:leading,maxWait:+wait,trailing:trailing})}function wrap(value,wrapper){return wrapper=null==wrapper?identity:wrapper,createWrapper(wrapper,PARTIAL_FLAG,undefined,[value],[])}function clone(value,isDeep,customizer,thisArg){return isDeep&&"boolean"!=typeof isDeep&&isIterateeCall(value,isDeep,customizer)?isDeep=!1:"function"==typeof isDeep&&(thisArg=customizer,customizer=isDeep,isDeep=!1),"function"==typeof customizer?baseClone(value,isDeep,bindCallback(customizer,thisArg,1)):baseClone(value,isDeep)}function cloneDeep(value,customizer,thisArg){return"function"==typeof customizer?baseClone(value,!0,bindCallback(customizer,thisArg,1)):baseClone(value,!0)}function gt(value,other){return value>other}function gte(value,other){return value>=other}function isArguments(value){return isObjectLike(value)&&isArrayLike(value)&&hasOwnProperty.call(value,"callee")&&!propertyIsEnumerable.call(value,"callee")}function isBoolean(value){return value===!0||value===!1||isObjectLike(value)&&objToString.call(value)==boolTag}function isDate(value){return isObjectLike(value)&&objToString.call(value)==dateTag}function isElement(value){return!!value&&1===value.nodeType&&isObjectLike(value)&&!isPlainObject(value)}function isEmpty(value){return null==value||(isArrayLike(value)&&(isArray(value)||isString(value)||isArguments(value)||isObjectLike(value)&&isFunction(value.splice))?!value.length:!keys(value).length)}function isEqual(value,other,customizer,thisArg){customizer="function"==typeof customizer?bindCallback(customizer,thisArg,3):undefined;var result=customizer?customizer(value,other):undefined;return result===undefined?baseIsEqual(value,other,customizer):!!result}function isError(value){return isObjectLike(value)&&"string"==typeof value.message&&objToString.call(value)==errorTag}function isFinite(value){return"number"==typeof value&&nativeIsFinite(value)}function isFunction(value){return isObject(value)&&objToString.call(value)==funcTag}function isObject(value){var type=typeof value;return!!value&&("object"==type||"function"==type)}function isMatch(object,source,customizer,thisArg){return customizer="function"==typeof customizer?bindCallback(customizer,thisArg,3):undefined,baseIsMatch(object,getMatchData(source),customizer)}function isNaN(value){return isNumber(value)&&value!=+value}function isNative(value){return null!=value&&(isFunction(value)?reIsNative.test(fnToString.call(value)):isObjectLike(value)&&reIsHostCtor.test(value))}function isNull(value){return null===value}function isNumber(value){return"number"==typeof value||isObjectLike(value)&&objToString.call(value)==numberTag}function isPlainObject(value){var Ctor;if(!isObjectLike(value)||objToString.call(value)!=objectTag||isArguments(value)||!hasOwnProperty.call(value,"constructor")&&(Ctor=value.constructor,"function"==typeof Ctor&&!(Ctor instanceof Ctor)))return!1;var result;return baseForIn(value,function(subValue,key){result=key}),result===undefined||hasOwnProperty.call(value,result)}function isRegExp(value){return isObject(value)&&objToString.call(value)==regexpTag}function isString(value){return"string"==typeof value||isObjectLike(value)&&objToString.call(value)==stringTag}function isTypedArray(value){return isObjectLike(value)&&isLength(value.length)&&!!typedArrayTags[objToString.call(value)]}function isUndefined(value){return value===undefined}function lt(value,other){return value<other}function lte(value,other){return value<=other}function toArray(value){var length=value?getLength(value):0;return isLength(length)?length?arrayCopy(value):[]:values(value)}function toPlainObject(value){return baseCopy(value,keysIn(value))}function create(prototype,properties,guard){var result=baseCreate(prototype);return guard&&isIterateeCall(prototype,properties,guard)&&(properties=undefined),properties?baseAssign(result,properties):result}function functions(object){return baseFunctions(object,keysIn(object))}function get(object,path,defaultValue){var result=null==object?undefined:baseGet(object,toPath(path),path+"");return result===undefined?defaultValue:result}function has(object,path){if(null==object)return!1;var result=hasOwnProperty.call(object,path);if(!result&&!isKey(path)){if(path=toPath(path),object=1==path.length?object:baseGet(object,baseSlice(path,0,-1)),null==object)return!1;path=last(path),result=hasOwnProperty.call(object,path)}return result||isLength(object.length)&&isIndex(path,object.length)&&(isArray(object)||isArguments(object))}function invert(object,multiValue,guard){guard&&isIterateeCall(object,multiValue,guard)&&(multiValue=undefined);for(var index=-1,props=keys(object),length=props.length,result={};++index<length;){var key=props[index],value=object[key];multiValue?hasOwnProperty.call(result,value)?result[value].push(key):result[value]=[key]:result[value]=key}return result}function keysIn(object){if(null==object)return[];isObject(object)||(object=Object(object));var length=object.length;length=length&&isLength(length)&&(isArray(object)||isArguments(object))&&length||0;for(var Ctor=object.constructor,index=-1,isProto="function"==typeof Ctor&&Ctor.prototype===object,result=Array(length),skipIndexes=length>0;++index<length;)result[index]=index+"";for(var key in object)skipIndexes&&isIndex(key,length)||"constructor"==key&&(isProto||!hasOwnProperty.call(object,key))||result.push(key);return result}function pairs(object){object=toObject(object);for(var index=-1,props=keys(object),length=props.length,result=Array(length);++index<length;){var key=props[index];result[index]=[key,object[key]]}return result}function result(object,path,defaultValue){var result=null==object?undefined:object[path];return result===undefined&&(null==object||isKey(path,object)||(path=toPath(path),object=1==path.length?object:baseGet(object,baseSlice(path,0,-1)),result=null==object?undefined:object[last(path)]),result=result===undefined?defaultValue:result),isFunction(result)?result.call(object):result}function set(object,path,value){if(null==object)return object;var pathKey=path+"";path=null!=object[pathKey]||isKey(path,object)?[pathKey]:toPath(path);for(var index=-1,length=path.length,lastIndex=length-1,nested=object;null!=nested&&++index<length;){var key=path[index];isObject(nested)&&(index==lastIndex?nested[key]=value:null==nested[key]&&(nested[key]=isIndex(path[index+1])?[]:{})),nested=nested[key]}return object}function transform(object,iteratee,accumulator,thisArg){var isArr=isArray(object)||isTypedArray(object);if(iteratee=getCallback(iteratee,thisArg,4),null==accumulator)if(isArr||isObject(object)){var Ctor=object.constructor;accumulator=isArr?isArray(object)?new Ctor:[]:baseCreate(isFunction(Ctor)?Ctor.prototype:undefined);
}else accumulator={};return(isArr?arrayEach:baseForOwn)(object,function(value,index,object){return iteratee(accumulator,value,index,object)}),accumulator}function values(object){return baseValues(object,keys(object))}function valuesIn(object){return baseValues(object,keysIn(object))}function inRange(value,start,end){return start=+start||0,end===undefined?(end=start,start=0):end=+end||0,value>=nativeMin(start,end)&&value<nativeMax(start,end)}function random(min,max,floating){floating&&isIterateeCall(min,max,floating)&&(max=floating=undefined);var noMin=null==min,noMax=null==max;if(null==floating&&(noMax&&"boolean"==typeof min?(floating=min,min=1):"boolean"==typeof max&&(floating=max,noMax=!0)),noMin&&noMax&&(max=1,noMax=!1),min=+min||0,noMax?(max=min,min=0):max=+max||0,floating||min%1||max%1){var rand=nativeRandom();return nativeMin(min+rand*(max-min+parseFloat("1e-"+((rand+"").length-1))),max)}return baseRandom(min,max)}function capitalize(string){return string=baseToString(string),string&&string.charAt(0).toUpperCase()+string.slice(1)}function deburr(string){return string=baseToString(string),string&&string.replace(reLatin1,deburrLetter).replace(reComboMark,"")}function endsWith(string,target,position){string=baseToString(string),target+="";var length=string.length;return position=position===undefined?length:nativeMin(position<0?0:+position||0,length),position-=target.length,position>=0&&string.indexOf(target,position)==position}function escape(string){return string=baseToString(string),string&&reHasUnescapedHtml.test(string)?string.replace(reUnescapedHtml,escapeHtmlChar):string}function escapeRegExp(string){return string=baseToString(string),string&&reHasRegExpChars.test(string)?string.replace(reRegExpChars,escapeRegExpChar):string||"(?:)"}function pad(string,length,chars){string=baseToString(string),length=+length;var strLength=string.length;if(strLength>=length||!nativeIsFinite(length))return string;var mid=(length-strLength)/2,leftLength=nativeFloor(mid),rightLength=nativeCeil(mid);return chars=createPadding("",rightLength,chars),chars.slice(0,leftLength)+string+chars}function parseInt(string,radix,guard){return(guard?isIterateeCall(string,radix,guard):null==radix)?radix=0:radix&&(radix=+radix),string=trim(string),nativeParseInt(string,radix||(reHasHexPrefix.test(string)?16:10))}function repeat(string,n){var result="";if(string=baseToString(string),n=+n,n<1||!string||!nativeIsFinite(n))return result;do n%2&&(result+=string),n=nativeFloor(n/2),string+=string;while(n);return result}function startsWith(string,target,position){return string=baseToString(string),position=null==position?0:nativeMin(position<0?0:+position||0,string.length),string.lastIndexOf(target,position)==position}function template(string,options,otherOptions){var settings=lodash.templateSettings;otherOptions&&isIterateeCall(string,options,otherOptions)&&(options=otherOptions=undefined),string=baseToString(string),options=assignWith(baseAssign({},otherOptions||options),settings,assignOwnDefaults);var isEscaping,isEvaluating,imports=assignWith(baseAssign({},options.imports),settings.imports,assignOwnDefaults),importsKeys=keys(imports),importsValues=baseValues(imports,importsKeys),index=0,interpolate=options.interpolate||reNoMatch,source="__p += '",reDelimiters=RegExp((options.escape||reNoMatch).source+"|"+interpolate.source+"|"+(interpolate===reInterpolate?reEsTemplate:reNoMatch).source+"|"+(options.evaluate||reNoMatch).source+"|$","g"),sourceURL="//# sourceURL="+("sourceURL"in options?options.sourceURL:"lodash.templateSources["+ ++templateCounter+"]")+"\n";string.replace(reDelimiters,function(match,escapeValue,interpolateValue,esTemplateValue,evaluateValue,offset){return interpolateValue||(interpolateValue=esTemplateValue),source+=string.slice(index,offset).replace(reUnescapedString,escapeStringChar),escapeValue&&(isEscaping=!0,source+="' +\n__e("+escapeValue+") +\n'"),evaluateValue&&(isEvaluating=!0,source+="';\n"+evaluateValue+";\n__p += '"),interpolateValue&&(source+="' +\n((__t = ("+interpolateValue+")) == null ? '' : __t) +\n'"),index=offset+match.length,match}),source+="';\n";var variable=options.variable;variable||(source="with (obj) {\n"+source+"\n}\n"),source=(isEvaluating?source.replace(reEmptyStringLeading,""):source).replace(reEmptyStringMiddle,"$1").replace(reEmptyStringTrailing,"$1;"),source="function("+(variable||"obj")+") {\n"+(variable?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(isEscaping?", __e = _.escape":"")+(isEvaluating?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+source+"return __p\n}";var result=attempt(function(){return Function(importsKeys,sourceURL+"return "+source).apply(undefined,importsValues)});if(result.source=source,isError(result))throw result;return result}function trim(string,chars,guard){var value=string;return(string=baseToString(string))?(guard?isIterateeCall(value,chars,guard):null==chars)?string.slice(trimmedLeftIndex(string),trimmedRightIndex(string)+1):(chars+="",string.slice(charsLeftIndex(string,chars),charsRightIndex(string,chars)+1)):string}function trimLeft(string,chars,guard){var value=string;return string=baseToString(string),string?(guard?isIterateeCall(value,chars,guard):null==chars)?string.slice(trimmedLeftIndex(string)):string.slice(charsLeftIndex(string,chars+"")):string}function trimRight(string,chars,guard){var value=string;return string=baseToString(string),string?(guard?isIterateeCall(value,chars,guard):null==chars)?string.slice(0,trimmedRightIndex(string)+1):string.slice(0,charsRightIndex(string,chars+"")+1):string}function trunc(string,options,guard){guard&&isIterateeCall(string,options,guard)&&(options=undefined);var length=DEFAULT_TRUNC_LENGTH,omission=DEFAULT_TRUNC_OMISSION;if(null!=options)if(isObject(options)){var separator="separator"in options?options.separator:separator;length="length"in options?+options.length||0:length,omission="omission"in options?baseToString(options.omission):omission}else length=+options||0;if(string=baseToString(string),length>=string.length)return string;var end=length-omission.length;if(end<1)return omission;var result=string.slice(0,end);if(null==separator)return result+omission;if(isRegExp(separator)){if(string.slice(end).search(separator)){var match,newEnd,substring=string.slice(0,end);for(separator.global||(separator=RegExp(separator.source,(reFlags.exec(separator)||"")+"g")),separator.lastIndex=0;match=separator.exec(substring);)newEnd=match.index;result=result.slice(0,null==newEnd?end:newEnd)}}else if(string.indexOf(separator,end)!=end){var index=result.lastIndexOf(separator);index>-1&&(result=result.slice(0,index))}return result+omission}function unescape(string){return string=baseToString(string),string&&reHasEscapedHtml.test(string)?string.replace(reEscapedHtml,unescapeHtmlChar):string}function words(string,pattern,guard){return guard&&isIterateeCall(string,pattern,guard)&&(pattern=undefined),string=baseToString(string),string.match(pattern||reWords)||[]}function callback(func,thisArg,guard){return guard&&isIterateeCall(func,thisArg,guard)&&(thisArg=undefined),isObjectLike(func)?matches(func):baseCallback(func,thisArg)}function constant(value){return function(){return value}}function identity(value){return value}function matches(source){return baseMatches(baseClone(source,!0))}function matchesProperty(path,srcValue){return baseMatchesProperty(path,baseClone(srcValue,!0))}function mixin(object,source,options){if(null==options){var isObj=isObject(source),props=isObj?keys(source):undefined,methodNames=props&&props.length?baseFunctions(source,props):undefined;(methodNames?methodNames.length:isObj)||(methodNames=!1,options=source,source=object,object=this)}methodNames||(methodNames=baseFunctions(source,keys(source)));var chain=!0,index=-1,isFunc=isFunction(object),length=methodNames.length;options===!1?chain=!1:isObject(options)&&"chain"in options&&(chain=options.chain);for(;++index<length;){var methodName=methodNames[index],func=source[methodName];object[methodName]=func,isFunc&&(object.prototype[methodName]=function(func){return function(){var chainAll=this.__chain__;if(chain||chainAll){var result=object(this.__wrapped__),actions=result.__actions__=arrayCopy(this.__actions__);return actions.push({func:func,args:arguments,thisArg:object}),result.__chain__=chainAll,result}return func.apply(object,arrayPush([this.value()],arguments))}}(func))}return object}function noConflict(){return root._=oldDash,this}function noop(){}function property(path){return isKey(path)?baseProperty(path):basePropertyDeep(path)}function propertyOf(object){return function(path){return baseGet(object,toPath(path),path+"")}}function range(start,end,step){step&&isIterateeCall(start,end,step)&&(end=step=undefined),start=+start||0,step=null==step?1:+step||0,null==end?(end=start,start=0):end=+end||0;for(var index=-1,length=nativeMax(nativeCeil((end-start)/(step||1)),0),result=Array(length);++index<length;)result[index]=start,start+=step;return result}function times(n,iteratee,thisArg){if(n=nativeFloor(n),n<1||!nativeIsFinite(n))return[];var index=-1,result=Array(nativeMin(n,MAX_ARRAY_LENGTH));for(iteratee=bindCallback(iteratee,thisArg,1);++index<n;)index<MAX_ARRAY_LENGTH?result[index]=iteratee(index):iteratee(index);return result}function uniqueId(prefix){var id=++idCounter;return baseToString(prefix)+id}function add(augend,addend){return(+augend||0)+(+addend||0)}function sum(collection,iteratee,thisArg){return thisArg&&isIterateeCall(collection,iteratee,thisArg)&&(iteratee=undefined),iteratee=getCallback(iteratee,thisArg,3),1==iteratee.length?arraySum(isArray(collection)?collection:toIterable(collection),iteratee):baseSum(collection,iteratee)}context=context?_.defaults(root.Object(),context,_.pick(root,contextProps)):root;var Array=context.Array,Date=context.Date,Error=context.Error,Function=context.Function,Math=context.Math,Number=context.Number,Object=context.Object,RegExp=context.RegExp,String=context.String,TypeError=context.TypeError,arrayProto=Array.prototype,objectProto=Object.prototype,stringProto=String.prototype,fnToString=Function.prototype.toString,hasOwnProperty=objectProto.hasOwnProperty,idCounter=0,objToString=objectProto.toString,oldDash=root._,reIsNative=RegExp("^"+fnToString.call(hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ArrayBuffer=context.ArrayBuffer,clearTimeout=context.clearTimeout,parseFloat=context.parseFloat,pow=Math.pow,propertyIsEnumerable=objectProto.propertyIsEnumerable,Set=getNative(context,"Set"),setTimeout=context.setTimeout,splice=arrayProto.splice,Uint8Array=context.Uint8Array,WeakMap=getNative(context,"WeakMap"),nativeCeil=Math.ceil,nativeCreate=getNative(Object,"create"),nativeFloor=Math.floor,nativeIsArray=getNative(Array,"isArray"),nativeIsFinite=context.isFinite,nativeKeys=getNative(Object,"keys"),nativeMax=Math.max,nativeMin=Math.min,nativeNow=getNative(Date,"now"),nativeParseInt=context.parseInt,nativeRandom=Math.random,NEGATIVE_INFINITY=Number.NEGATIVE_INFINITY,POSITIVE_INFINITY=Number.POSITIVE_INFINITY,MAX_ARRAY_LENGTH=4294967295,MAX_ARRAY_INDEX=MAX_ARRAY_LENGTH-1,HALF_MAX_ARRAY_LENGTH=MAX_ARRAY_LENGTH>>>1,MAX_SAFE_INTEGER=9007199254740991,metaMap=WeakMap&&new WeakMap,realNames={};lodash.support={};lodash.templateSettings={escape:reEscape,evaluate:reEvaluate,interpolate:reInterpolate,variable:"",imports:{_:lodash}};var baseCreate=function(){function object(){}return function(prototype){if(isObject(prototype)){object.prototype=prototype;var result=new object;object.prototype=undefined}return result||{}}}(),baseEach=createBaseEach(baseForOwn),baseEachRight=createBaseEach(baseForOwnRight,!0),baseFor=createBaseFor(),baseForRight=createBaseFor(!0),baseSetData=metaMap?function(func,data){return metaMap.set(func,data),func}:identity,getData=metaMap?function(func){return metaMap.get(func)}:noop,getLength=baseProperty("length"),setData=function(){var count=0,lastCalled=0;return function(key,value){var stamp=now(),remaining=HOT_SPAN-(stamp-lastCalled);if(lastCalled=stamp,remaining>0){if(++count>=HOT_COUNT)return key}else count=0;return baseSetData(key,value)}}(),difference=restParam(function(array,values){return isObjectLike(array)&&isArrayLike(array)?baseDifference(array,baseFlatten(values,!1,!0)):[]}),findIndex=createFindIndex(),findLastIndex=createFindIndex(!0),intersection=restParam(function(arrays){for(var othLength=arrays.length,othIndex=othLength,caches=Array(length),indexOf=getIndexOf(),isCommon=indexOf==baseIndexOf,result=[];othIndex--;){var value=arrays[othIndex]=isArrayLike(value=arrays[othIndex])?value:[];caches[othIndex]=isCommon&&value.length>=120?createCache(othIndex&&value):null}var array=arrays[0],index=-1,length=array?array.length:0,seen=caches[0];outer:for(;++index<length;)if(value=array[index],(seen?cacheIndexOf(seen,value):indexOf(result,value,0))<0){for(var othIndex=othLength;--othIndex;){var cache=caches[othIndex];if((cache?cacheIndexOf(cache,value):indexOf(arrays[othIndex],value,0))<0)continue outer}seen&&seen.push(value),result.push(value)}return result}),pullAt=restParam(function(array,indexes){indexes=baseFlatten(indexes);var result=baseAt(array,indexes);return basePullAt(array,indexes.sort(baseCompareAscending)),result}),sortedIndex=createSortedIndex(),sortedLastIndex=createSortedIndex(!0),union=restParam(function(arrays){return baseUniq(baseFlatten(arrays,!1,!0))}),without=restParam(function(array,values){return isArrayLike(array)?baseDifference(array,values):[]}),zip=restParam(unzip),zipWith=restParam(function(arrays){var length=arrays.length,iteratee=length>2?arrays[length-2]:undefined,thisArg=length>1?arrays[length-1]:undefined;return length>2&&"function"==typeof iteratee?length-=2:(iteratee=length>1&&"function"==typeof thisArg?(--length,thisArg):undefined,thisArg=undefined),arrays.length=length,unzipWith(arrays,iteratee,thisArg)}),wrapperConcat=restParam(function(values){return values=baseFlatten(values),this.thru(function(array){return arrayConcat(isArray(array)?array:[toObject(array)],values)})}),at=restParam(function(collection,props){return baseAt(collection,baseFlatten(props))}),countBy=createAggregator(function(result,value,key){hasOwnProperty.call(result,key)?++result[key]:result[key]=1}),find=createFind(baseEach),findLast=createFind(baseEachRight,!0),forEach=createForEach(arrayEach,baseEach),forEachRight=createForEach(arrayEachRight,baseEachRight),groupBy=createAggregator(function(result,value,key){hasOwnProperty.call(result,key)?result[key].push(value):result[key]=[value]}),indexBy=createAggregator(function(result,value,key){result[key]=value}),invoke=restParam(function(collection,path,args){var index=-1,isFunc="function"==typeof path,isProp=isKey(path),result=isArrayLike(collection)?Array(collection.length):[];return baseEach(collection,function(value){var func=isFunc?path:isProp&&null!=value?value[path]:undefined;result[++index]=func?func.apply(value,args):invokePath(value,path,args)}),result}),partition=createAggregator(function(result,value,key){result[key?0:1].push(value)},function(){return[[],[]]}),reduce=createReduce(arrayReduce,baseEach),reduceRight=createReduce(arrayReduceRight,baseEachRight),sortByAll=restParam(function(collection,iteratees){if(null==collection)return[];var guard=iteratees[2];return guard&&isIterateeCall(iteratees[0],iteratees[1],guard)&&(iteratees.length=1),baseSortByOrder(collection,baseFlatten(iteratees),[])}),now=nativeNow||function(){return(new Date).getTime()},bind=restParam(function(func,thisArg,partials){var bitmask=BIND_FLAG;if(partials.length){var holders=replaceHolders(partials,bind.placeholder);bitmask|=PARTIAL_FLAG}return createWrapper(func,bitmask,thisArg,partials,holders)}),bindAll=restParam(function(object,methodNames){methodNames=methodNames.length?baseFlatten(methodNames):functions(object);for(var index=-1,length=methodNames.length;++index<length;){var key=methodNames[index];object[key]=createWrapper(object[key],BIND_FLAG,object)}return object}),bindKey=restParam(function(object,key,partials){var bitmask=BIND_FLAG|BIND_KEY_FLAG;if(partials.length){var holders=replaceHolders(partials,bindKey.placeholder);bitmask|=PARTIAL_FLAG}return createWrapper(key,bitmask,object,partials,holders)}),curry=createCurry(CURRY_FLAG),curryRight=createCurry(CURRY_RIGHT_FLAG),defer=restParam(function(func,args){return baseDelay(func,1,args)}),delay=restParam(function(func,wait,args){return baseDelay(func,wait,args)}),flow=createFlow(),flowRight=createFlow(!0),modArgs=restParam(function(func,transforms){if(transforms=baseFlatten(transforms),"function"!=typeof func||!arrayEvery(transforms,baseIsFunction))throw new TypeError(FUNC_ERROR_TEXT);var length=transforms.length;return restParam(function(args){for(var index=nativeMin(args.length,length);index--;)args[index]=transforms[index](args[index]);return func.apply(this,args)})}),partial=createPartial(PARTIAL_FLAG),partialRight=createPartial(PARTIAL_RIGHT_FLAG),rearg=restParam(function(func,indexes){return createWrapper(func,REARG_FLAG,undefined,undefined,undefined,baseFlatten(indexes))}),isArray=nativeIsArray||function(value){return isObjectLike(value)&&isLength(value.length)&&objToString.call(value)==arrayTag},merge=createAssigner(baseMerge),assign=createAssigner(function(object,source,customizer){return customizer?assignWith(object,source,customizer):baseAssign(object,source)}),defaults=createDefaults(assign,assignDefaults),defaultsDeep=createDefaults(merge,mergeDefaults),findKey=createFindKey(baseForOwn),findLastKey=createFindKey(baseForOwnRight),forIn=createForIn(baseFor),forInRight=createForIn(baseForRight),forOwn=createForOwn(baseForOwn),forOwnRight=createForOwn(baseForOwnRight),keys=nativeKeys?function(object){var Ctor=null==object?undefined:object.constructor;return"function"==typeof Ctor&&Ctor.prototype===object||"function"!=typeof object&&isArrayLike(object)?shimKeys(object):isObject(object)?nativeKeys(object):[]}:shimKeys,mapKeys=createObjectMapper(!0),mapValues=createObjectMapper(),omit=restParam(function(object,props){if(null==object)return{};if("function"!=typeof props[0]){var props=arrayMap(baseFlatten(props),String);return pickByArray(object,baseDifference(keysIn(object),props))}var predicate=bindCallback(props[0],props[1],3);return pickByCallback(object,function(value,key,object){return!predicate(value,key,object)})}),pick=restParam(function(object,props){return null==object?{}:"function"==typeof props[0]?pickByCallback(object,bindCallback(props[0],props[1],3)):pickByArray(object,baseFlatten(props))}),camelCase=createCompounder(function(result,word,index){return word=word.toLowerCase(),result+(index?word.charAt(0).toUpperCase()+word.slice(1):word)}),kebabCase=createCompounder(function(result,word,index){return result+(index?"-":"")+word.toLowerCase()}),padLeft=createPadDir(),padRight=createPadDir(!0),snakeCase=createCompounder(function(result,word,index){return result+(index?"_":"")+word.toLowerCase()}),startCase=createCompounder(function(result,word,index){return result+(index?" ":"")+(word.charAt(0).toUpperCase()+word.slice(1))}),attempt=restParam(function(func,args){try{return func.apply(undefined,args)}catch(e){return isError(e)?e:new Error(e)}}),method=restParam(function(path,args){return function(object){return invokePath(object,path,args)}}),methodOf=restParam(function(object,args){return function(path){return invokePath(object,path,args)}}),ceil=createRound("ceil"),floor=createRound("floor"),max=createExtremum(gt,NEGATIVE_INFINITY),min=createExtremum(lt,POSITIVE_INFINITY),round=createRound("round");return lodash.prototype=baseLodash.prototype,LodashWrapper.prototype=baseCreate(baseLodash.prototype),LodashWrapper.prototype.constructor=LodashWrapper,LazyWrapper.prototype=baseCreate(baseLodash.prototype),LazyWrapper.prototype.constructor=LazyWrapper,MapCache.prototype.delete=mapDelete,MapCache.prototype.get=mapGet,MapCache.prototype.has=mapHas,MapCache.prototype.set=mapSet,SetCache.prototype.push=cachePush,memoize.Cache=MapCache,lodash.after=after,lodash.ary=ary,lodash.assign=assign,lodash.at=at,lodash.before=before,lodash.bind=bind,lodash.bindAll=bindAll,lodash.bindKey=bindKey,lodash.callback=callback,lodash.chain=chain,lodash.chunk=chunk,lodash.compact=compact,lodash.constant=constant,lodash.countBy=countBy,lodash.create=create,lodash.curry=curry,lodash.curryRight=curryRight,lodash.debounce=debounce,lodash.defaults=defaults,lodash.defaultsDeep=defaultsDeep,lodash.defer=defer,lodash.delay=delay,lodash.difference=difference,lodash.drop=drop,lodash.dropRight=dropRight,lodash.dropRightWhile=dropRightWhile,lodash.dropWhile=dropWhile,lodash.fill=fill,lodash.filter=filter,lodash.flatten=flatten,lodash.flattenDeep=flattenDeep,lodash.flow=flow,lodash.flowRight=flowRight,lodash.forEach=forEach,lodash.forEachRight=forEachRight,lodash.forIn=forIn,lodash.forInRight=forInRight,lodash.forOwn=forOwn,lodash.forOwnRight=forOwnRight,lodash.functions=functions,lodash.groupBy=groupBy,lodash.indexBy=indexBy,lodash.initial=initial,lodash.intersection=intersection,lodash.invert=invert,lodash.invoke=invoke,lodash.keys=keys,lodash.keysIn=keysIn,lodash.map=map,lodash.mapKeys=mapKeys,lodash.mapValues=mapValues,lodash.matches=matches,lodash.matchesProperty=matchesProperty,lodash.memoize=memoize,lodash.merge=merge,lodash.method=method,lodash.methodOf=methodOf,lodash.mixin=mixin,lodash.modArgs=modArgs,lodash.negate=negate,lodash.omit=omit,lodash.once=once,lodash.pairs=pairs,lodash.partial=partial,lodash.partialRight=partialRight,lodash.partition=partition,lodash.pick=pick,lodash.pluck=pluck,lodash.property=property,lodash.propertyOf=propertyOf,lodash.pull=pull,lodash.pullAt=pullAt,lodash.range=range,lodash.rearg=rearg,lodash.reject=reject,lodash.remove=remove,lodash.rest=rest,lodash.restParam=restParam,lodash.set=set,lodash.shuffle=shuffle,lodash.slice=slice,lodash.sortBy=sortBy,lodash.sortByAll=sortByAll,lodash.sortByOrder=sortByOrder,lodash.spread=spread,lodash.take=take,lodash.takeRight=takeRight,lodash.takeRightWhile=takeRightWhile,lodash.takeWhile=takeWhile,lodash.tap=tap,lodash.throttle=throttle,lodash.thru=thru,lodash.times=times,lodash.toArray=toArray,lodash.toPlainObject=toPlainObject,lodash.transform=transform,lodash.union=union,lodash.uniq=uniq,lodash.unzip=unzip,lodash.unzipWith=unzipWith,lodash.values=values,lodash.valuesIn=valuesIn,lodash.where=where,lodash.without=without,lodash.wrap=wrap,lodash.xor=xor,lodash.zip=zip,lodash.zipObject=zipObject,lodash.zipWith=zipWith,lodash.backflow=flowRight,lodash.collect=map,lodash.compose=flowRight,lodash.each=forEach,lodash.eachRight=forEachRight,lodash.extend=assign,lodash.iteratee=callback,lodash.methods=functions,lodash.object=zipObject,lodash.select=filter,lodash.tail=rest,lodash.unique=uniq,mixin(lodash,lodash),lodash.add=add,lodash.attempt=attempt,lodash.camelCase=camelCase,lodash.capitalize=capitalize,lodash.ceil=ceil,lodash.clone=clone,lodash.cloneDeep=cloneDeep,lodash.deburr=deburr,lodash.endsWith=endsWith,lodash.escape=escape,lodash.escapeRegExp=escapeRegExp,lodash.every=every,lodash.find=find,lodash.findIndex=findIndex,lodash.findKey=findKey,lodash.findLast=findLast,lodash.findLastIndex=findLastIndex,lodash.findLastKey=findLastKey,lodash.findWhere=findWhere,lodash.first=first,lodash.floor=floor,lodash.get=get,lodash.gt=gt,lodash.gte=gte,lodash.has=has,lodash.identity=identity,lodash.includes=includes,lodash.indexOf=indexOf,lodash.inRange=inRange,lodash.isArguments=isArguments,lodash.isArray=isArray,lodash.isBoolean=isBoolean,lodash.isDate=isDate,lodash.isElement=isElement,lodash.isEmpty=isEmpty,lodash.isEqual=isEqual,lodash.isError=isError,lodash.isFinite=isFinite,lodash.isFunction=isFunction,lodash.isMatch=isMatch,lodash.isNaN=isNaN,lodash.isNative=isNative,lodash.isNull=isNull,lodash.isNumber=isNumber,lodash.isObject=isObject,lodash.isPlainObject=isPlainObject,lodash.isRegExp=isRegExp,lodash.isString=isString,lodash.isTypedArray=isTypedArray,lodash.isUndefined=isUndefined,lodash.kebabCase=kebabCase,lodash.last=last,lodash.lastIndexOf=lastIndexOf,lodash.lt=lt,lodash.lte=lte,lodash.max=max,lodash.min=min,lodash.noConflict=noConflict,lodash.noop=noop,lodash.now=now,lodash.pad=pad,lodash.padLeft=padLeft,lodash.padRight=padRight,lodash.parseInt=parseInt,lodash.random=random,lodash.reduce=reduce,lodash.reduceRight=reduceRight,lodash.repeat=repeat,lodash.result=result,lodash.round=round,lodash.runInContext=runInContext,lodash.size=size,lodash.snakeCase=snakeCase,lodash.some=some,lodash.sortedIndex=sortedIndex,lodash.sortedLastIndex=sortedLastIndex,lodash.startCase=startCase,lodash.startsWith=startsWith,lodash.sum=sum,lodash.template=template,lodash.trim=trim,lodash.trimLeft=trimLeft,lodash.trimRight=trimRight,lodash.trunc=trunc,lodash.unescape=unescape,lodash.uniqueId=uniqueId,lodash.words=words,lodash.all=every,lodash.any=some,lodash.contains=includes,lodash.eq=isEqual,lodash.detect=find,lodash.foldl=reduce,lodash.foldr=reduceRight,lodash.head=first,lodash.include=includes,lodash.inject=reduce,mixin(lodash,function(){var source={};return baseForOwn(lodash,function(func,methodName){lodash.prototype[methodName]||(source[methodName]=func)}),source}(),!1),lodash.sample=sample,lodash.prototype.sample=function(n){return this.__chain__||null!=n?this.thru(function(value){return sample(value,n)}):sample(this.value())},lodash.VERSION=VERSION,arrayEach(["bind","bindKey","curry","curryRight","partial","partialRight"],function(methodName){lodash[methodName].placeholder=lodash}),arrayEach(["drop","take"],function(methodName,index){LazyWrapper.prototype[methodName]=function(n){var filtered=this.__filtered__;if(filtered&&!index)return new LazyWrapper(this);n=null==n?1:nativeMax(nativeFloor(n)||0,0);var result=this.clone();return filtered?result.__takeCount__=nativeMin(result.__takeCount__,n):result.__views__.push({size:n,type:methodName+(result.__dir__<0?"Right":"")}),result},LazyWrapper.prototype[methodName+"Right"]=function(n){return this.reverse()[methodName](n).reverse()}}),arrayEach(["filter","map","takeWhile"],function(methodName,index){var type=index+1,isFilter=type!=LAZY_MAP_FLAG;LazyWrapper.prototype[methodName]=function(iteratee,thisArg){var result=this.clone();return result.__iteratees__.push({iteratee:getCallback(iteratee,thisArg,1),type:type}),result.__filtered__=result.__filtered__||isFilter,result}}),arrayEach(["first","last"],function(methodName,index){var takeName="take"+(index?"Right":"");LazyWrapper.prototype[methodName]=function(){return this[takeName](1).value()[0]}}),arrayEach(["initial","rest"],function(methodName,index){var dropName="drop"+(index?"":"Right");LazyWrapper.prototype[methodName]=function(){return this.__filtered__?new LazyWrapper(this):this[dropName](1)}}),arrayEach(["pluck","where"],function(methodName,index){var operationName=index?"filter":"map",createCallback=index?baseMatches:property;LazyWrapper.prototype[methodName]=function(value){return this[operationName](createCallback(value))}}),LazyWrapper.prototype.compact=function(){return this.filter(identity)},LazyWrapper.prototype.reject=function(predicate,thisArg){return predicate=getCallback(predicate,thisArg,1),this.filter(function(value){return!predicate(value)})},LazyWrapper.prototype.slice=function(start,end){start=null==start?0:+start||0;var result=this;return result.__filtered__&&(start>0||end<0)?new LazyWrapper(result):(start<0?result=result.takeRight(-start):start&&(result=result.drop(start)),end!==undefined&&(end=+end||0,result=end<0?result.dropRight(-end):result.take(end-start)),result)},LazyWrapper.prototype.takeRightWhile=function(predicate,thisArg){return this.reverse().takeWhile(predicate,thisArg).reverse()},LazyWrapper.prototype.toArray=function(){return this.take(POSITIVE_INFINITY)},baseForOwn(LazyWrapper.prototype,function(func,methodName){var checkIteratee=/^(?:filter|map|reject)|While$/.test(methodName),retUnwrapped=/^(?:first|last)$/.test(methodName),lodashFunc=lodash[retUnwrapped?"take"+("last"==methodName?"Right":""):methodName];lodashFunc&&(lodash.prototype[methodName]=function(){var args=retUnwrapped?[1]:arguments,chainAll=this.__chain__,value=this.__wrapped__,isHybrid=!!this.__actions__.length,isLazy=value instanceof LazyWrapper,iteratee=args[0],useLazy=isLazy||isArray(value);useLazy&&checkIteratee&&"function"==typeof iteratee&&1!=iteratee.length&&(isLazy=useLazy=!1);var interceptor=function(value){return retUnwrapped&&chainAll?lodashFunc(value,1)[0]:lodashFunc.apply(undefined,arrayPush([value],args))},action={func:thru,args:[interceptor],thisArg:undefined},onlyLazy=isLazy&&!isHybrid;if(retUnwrapped&&!chainAll)return onlyLazy?(value=value.clone(),value.__actions__.push(action),func.call(value)):lodashFunc.call(undefined,this.value())[0];if(!retUnwrapped&&useLazy){value=onlyLazy?value:new LazyWrapper(this);var result=func.apply(value,args);return result.__actions__.push(action),new LodashWrapper(result,chainAll)}return this.thru(interceptor)})}),arrayEach(["join","pop","push","replace","shift","sort","splice","split","unshift"],function(methodName){var func=(/^(?:replace|split)$/.test(methodName)?stringProto:arrayProto)[methodName],chainName=/^(?:push|sort|unshift)$/.test(methodName)?"tap":"thru",retUnwrapped=/^(?:join|pop|replace|shift)$/.test(methodName);lodash.prototype[methodName]=function(){var args=arguments;return retUnwrapped&&!this.__chain__?func.apply(this.value(),args):this[chainName](function(value){return func.apply(value,args)})}}),baseForOwn(LazyWrapper.prototype,function(func,methodName){var lodashFunc=lodash[methodName];if(lodashFunc){var key=lodashFunc.name,names=realNames[key]||(realNames[key]=[]);names.push({name:methodName,func:lodashFunc})}}),realNames[createHybridWrapper(undefined,BIND_KEY_FLAG).name]=[{name:"wrapper",func:undefined}],LazyWrapper.prototype.clone=lazyClone,LazyWrapper.prototype.reverse=lazyReverse,LazyWrapper.prototype.value=lazyValue,lodash.prototype.chain=wrapperChain,lodash.prototype.commit=wrapperCommit,lodash.prototype.concat=wrapperConcat,lodash.prototype.plant=wrapperPlant,lodash.prototype.reverse=wrapperReverse,lodash.prototype.toString=wrapperToString,lodash.prototype.run=lodash.prototype.toJSON=lodash.prototype.valueOf=lodash.prototype.value=wrapperValue,lodash.prototype.collect=lodash.prototype.map,lodash.prototype.head=lodash.prototype.first,lodash.prototype.select=lodash.prototype.filter,lodash.prototype.tail=lodash.prototype.rest,lodash}var undefined,VERSION="3.10.1",BIND_FLAG=1,BIND_KEY_FLAG=2,CURRY_BOUND_FLAG=4,CURRY_FLAG=8,CURRY_RIGHT_FLAG=16,PARTIAL_FLAG=32,PARTIAL_RIGHT_FLAG=64,ARY_FLAG=128,REARG_FLAG=256,DEFAULT_TRUNC_LENGTH=30,DEFAULT_TRUNC_OMISSION="...",HOT_COUNT=150,HOT_SPAN=16,LARGE_ARRAY_SIZE=200,LAZY_FILTER_FLAG=1,LAZY_MAP_FLAG=2,FUNC_ERROR_TEXT="Expected a function",PLACEHOLDER="__lodash_placeholder__",argsTag="[object Arguments]",arrayTag="[object Array]",boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",funcTag="[object Function]",mapTag="[object Map]",numberTag="[object Number]",objectTag="[object Object]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",weakMapTag="[object WeakMap]",arrayBufferTag="[object ArrayBuffer]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",reEmptyStringLeading=/\b__p \+= '';/g,reEmptyStringMiddle=/\b(__p \+=) '' \+/g,reEmptyStringTrailing=/(__e\(.*?\)|\b__t\)) \+\n'';/g,reEscapedHtml=/&(?:amp|lt|gt|quot|#39|#96);/g,reUnescapedHtml=/[&<>"'`]/g,reHasEscapedHtml=RegExp(reEscapedHtml.source),reHasUnescapedHtml=RegExp(reUnescapedHtml.source),reEscape=/<%-([\s\S]+?)%>/g,reEvaluate=/<%([\s\S]+?)%>/g,reInterpolate=/<%=([\s\S]+?)%>/g,reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\n\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/,rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,reRegExpChars=/^[:!,]|[\\^$.*+?()[\]{}|\/]|(^[0-9a-fA-Fnrtuvx])|([\n\r\u2028\u2029])/g,reHasRegExpChars=RegExp(reRegExpChars.source),reComboMark=/[\u0300-\u036f\ufe20-\ufe23]/g,reEscapeChar=/\\(\\)?/g,reEsTemplate=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,reFlags=/\w*$/,reHasHexPrefix=/^0[xX]/,reIsHostCtor=/^\[object .+?Constructor\]$/,reIsUint=/^\d+$/,reLatin1=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g,reNoMatch=/($^)/,reUnescapedString=/['\n\r\u2028\u2029\\]/g,reWords=function(){
var upper="[A-Z\\xc0-\\xd6\\xd8-\\xde]",lower="[a-z\\xdf-\\xf6\\xf8-\\xff]+";return RegExp(upper+"+(?="+upper+lower+")|"+upper+"?"+lower+"|"+upper+"+|[0-9]+","g")}(),contextProps=["Array","ArrayBuffer","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Math","Number","Object","RegExp","Set","String","_","clearTimeout","isFinite","parseFloat","parseInt","setTimeout","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap"],templateCounter=-1,typedArrayTags={};typedArrayTags[float32Tag]=typedArrayTags[float64Tag]=typedArrayTags[int8Tag]=typedArrayTags[int16Tag]=typedArrayTags[int32Tag]=typedArrayTags[uint8Tag]=typedArrayTags[uint8ClampedTag]=typedArrayTags[uint16Tag]=typedArrayTags[uint32Tag]=!0,typedArrayTags[argsTag]=typedArrayTags[arrayTag]=typedArrayTags[arrayBufferTag]=typedArrayTags[boolTag]=typedArrayTags[dateTag]=typedArrayTags[errorTag]=typedArrayTags[funcTag]=typedArrayTags[mapTag]=typedArrayTags[numberTag]=typedArrayTags[objectTag]=typedArrayTags[regexpTag]=typedArrayTags[setTag]=typedArrayTags[stringTag]=typedArrayTags[weakMapTag]=!1;var cloneableTags={};cloneableTags[argsTag]=cloneableTags[arrayTag]=cloneableTags[arrayBufferTag]=cloneableTags[boolTag]=cloneableTags[dateTag]=cloneableTags[float32Tag]=cloneableTags[float64Tag]=cloneableTags[int8Tag]=cloneableTags[int16Tag]=cloneableTags[int32Tag]=cloneableTags[numberTag]=cloneableTags[objectTag]=cloneableTags[regexpTag]=cloneableTags[stringTag]=cloneableTags[uint8Tag]=cloneableTags[uint8ClampedTag]=cloneableTags[uint16Tag]=cloneableTags[uint32Tag]=!0,cloneableTags[errorTag]=cloneableTags[funcTag]=cloneableTags[mapTag]=cloneableTags[setTag]=cloneableTags[weakMapTag]=!1;var deburredLetters={"":"A","":"A","":"A","":"A","":"A","":"A","":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss"},htmlEscapes={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},htmlUnescapes={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},objectTypes={function:!0,object:!0},regexpEscapes={0:"x30",1:"x31",2:"x32",3:"x33",4:"x34",5:"x35",6:"x36",7:"x37",8:"x38",9:"x39",A:"x41",B:"x42",C:"x43",D:"x44",E:"x45",F:"x46",a:"x61",b:"x62",c:"x63",d:"x64",e:"x65",f:"x66",n:"x6e",r:"x72",t:"x74",u:"x75",v:"x76",x:"x78"},stringEscapes={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},freeExports=objectTypes[typeof exports]&&exports&&!exports.nodeType&&exports,freeModule=objectTypes[typeof module]&&module&&!module.nodeType&&module,freeGlobal=freeExports&&freeModule&&"object"==typeof global&&global&&global.Object&&global,freeSelf=objectTypes[typeof self]&&self&&self.Object&&self,freeWindow=objectTypes[typeof window]&&window&&window.Object&&window,moduleExports=freeModule&&freeModule.exports===freeExports&&freeExports,root=freeGlobal||freeWindow!==(this&&this.window)&&freeWindow||freeSelf||this,_=runInContext();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(root._=_,define(function(){return _})):freeExports&&freeModule?moduleExports?(freeModule.exports=_)._=_:freeExports._=_:root._=_}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],162:[function(_dereq_,module,exports){"use strict";var elementsDefinitions={Group:_dereq_("./elements/Group.js"),Box:_dereq_("./elements/Box.js"),SvgSymbol:_dereq_("./elements/SvgSymbol.js"),Input2:_dereq_("./elements/Input2.js"),AndroidGear:_dereq_("./elements/AndroidGear.js"),AndroidIcon:_dereq_("./elements/AndroidIcon.js"),Arrow:_dereq_("./elements/Arrow.js"),Banner:_dereq_("./elements/Banner.js"),Button:_dereq_("./elements/Button.js"),Canvas:_dereq_("./elements/Canvas.js"),Checkbox:_dereq_("./elements/Checkbox.js"),Circle:_dereq_("./elements/Circle.js"),Clipart:_dereq_("./elements/Clipart.js"),Component:_dereq_("./elements/Component.js"),CostcoIcon:_dereq_("./elements/CostcoIcon.js"),Dialog:_dereq_("./elements/Dialog.js"),FontAwesome:_dereq_("./elements/FontAwesome.js"),FontAwesome47:_dereq_("./elements/FontAwesome47.js"),GeoSvg:_dereq_("./elements/GeoSvg.js"),GlassCanvas:_dereq_("./elements/GlassCanvas.js"),GroupingInstance:_dereq_("./elements/GroupingInstance.js"),HorizontalScrollbar:_dereq_("./elements/HorizontalScrollbar.js"),Hotspot:_dereq_("./elements/Hotspot.js"),Icon:_dereq_("./elements/Icon.js"),Image:_dereq_("./elements/Image.js"),ImageSketch:_dereq_("./elements/ImageSketch.js"),ImageCrop:_dereq_("./elements/ui/ImageCrop.js"),InputWithLabel:_dereq_("./elements/InputWithLabel.js"),iOS7:_dereq_("./elements/iOS7.js"),iOS8:_dereq_("./elements/iOS8.js"),Label:_dereq_("./elements/Label.js"),Line:_dereq_("./elements/Line.js"),Link:_dereq_("./elements/Link.js"),LinkList:_dereq_("./elements/LinkList.js"),MaterialIcon:_dereq_("./elements/MaterialIcon.js"),Menu:_dereq_("./elements/Menu.js"),MobileSymbol:_dereq_("./elements/MobileSymbol.js"),Multistate:_dereq_("./elements/Multistate.js"),Navigation:_dereq_("./elements/Navigation.js"),Password:_dereq_("./elements/Password.js"),PixleIcon:_dereq_("./elements/PixleIcon.js"),Radio:_dereq_("./elements/Radio.js"),RetinaIcon:_dereq_("./elements/RetinaIcon.js"),Scrollbar:_dereq_("./elements/Scrollbar.js"),Selectlist:_dereq_("./elements/Selectlist.js"),SvgCustomIcon:_dereq_("./elements/SvgCustomIcon.js"),SvgIconLegacy:_dereq_("./elements/SvgIconLegacy.js"),Table:_dereq_("./elements/Table.js"),Tab:_dereq_("./elements/Tab.js"),Tag:_dereq_("./elements/Tag.js"),Textarea:_dereq_("./elements/Textarea.js"),TextElement:_dereq_("./elements/TextElement.js"),Tooltip:_dereq_("./elements/Tooltip.js"),UniSvg:_dereq_("./elements/UniSvg.js"),UXPinIconSet:_dereq_("./elements/UXPinIconSet.js"),Video:_dereq_("./elements/Video.js"),VirtualGroup:_dereq_("./elements/VirtualGroup.js")},_=_dereq_("lodash"),ElementTypes=_dereq_("./enums/ElementTypes.js"),Properties=_dereq_("./enums/Properties.js"),ImageEditor=_dereq_("./elements/helpers/ImageEditor.js"),ElementsHelper=_dereq_("./elements/helpers/ElementsHelper.js"),LegacyMap=_dereq_("./LegacyMap.js"),Logger=_dereq_("./utils/Logger");module.exports=function(){function translateIdsOnDuplicate(serialized,idsMap){return ElementsHelper.TranslateIds(serialized,idsMap)}function getElementsByType(elements,type){return _.filter(elements,function(element){return element.type===type&&element.name})}function getCopyIndex(name){var result=REGEXP_DUPLICATED_NAME.exec(name);return _.isArray(result)?_.isNaN(parseInt(result[2]))?1:parseInt(result[2]):0}function getNameIndexForDuplicated(type,elements,name){var nameStripped=stripCopyFromName(name),elementsByType=getElementsByType(elements,type);return _.reduce(elementsByType,function(index,element){return nameStripped===stripCopyFromName(element.name)?Math.max(index,getCopyIndex(element.name)):index},0)}function stripCopyFromName(name){return name.replace(REGEXP_DUPLICATED_NAME,"")}function generateNameForDuplicated(type,elements,nameToDuplicate){var index=getNameIndexForDuplicated(type,elements,nameToDuplicate);return index?stripCopyFromName(nameToDuplicate)+" "+COPY_SUFFIX+" "+(index+1):nameToDuplicate+" "+COPY_SUFFIX}function getNameIndex(name,namePrefix){var regexp=new RegExp(namePrefix+" (\\d+)( "+COPY_SUFFIX+"( \\d*))?"),result=regexp.exec(name);return _.isArray(result)&&!_.isNaN(parseInt(result[1]))?parseInt(result[1]):null}function generateName(type,elements,namePrefix){var elementsByType=getElementsByType(elements,type),index=_.reduce(elementsByType,function(index,element){var nextNameIndex=getNameIndex(element.name,namePrefix);return"number"==typeof nextNameIndex?Math.max(index,nextNameIndex+1):index},1);return namePrefix+" "+index}function getElementsWithoutCanvasReversed(serializedList){return _.filter(serializedList,function(element){return element.type!==ElementTypes.CANVAS}).reverse()}function GetNewElement(type,id,Page){if(type=LegacyMap.MapType(type),"function"!=typeof elementsDefinitions[type])throw Error("Element "+type+" not supported");return new elementsDefinitions[type](id,Page)}function CreateElement(type,props,Page){var id=ElementsHelper.GetUniqueId(type),element=GetNewElement(type,id,Page),elements=Page.getAllElements(),namePrefix=props[Properties.LABEL]||type;return element.initProperties(_.defaults(props,{name:generateName(type,elements,namePrefix)})),element}function CreateElementFromCollaboration(id,type,props,Page,componentInstance){var element=GetNewElement(type,id,Page);return componentInstance&&(element.componentInstance=componentInstance,componentInstance._elements[id]=element),element.initProperties(props),element}function CreateCanvas(containerEl,Page){var element=new elementsDefinitions.Canvas(ElementsHelper.CANVAS_ID,Page);return element.createCanvas(containerEl),element.initProperties({}),element}function CreateGroupedElements(serialized,x,y,Page){return _.map(serialized,function(elementSerialized){var elementProps=elementSerialized.props;return elementProps[Properties.X]=x+(elementProps[Properties.X]||0),elementProps[Properties.Y]=y+(elementProps[Properties.Y]||0),CreateElement(elementSerialized.type,elementProps,Page)})}function CreateComponentElements(serialized,component){serialized=LegacyMap.ParseElements(serialized);var elements=_.reduce(ElementsHelper.GetElementsWithoutCanvas(serialized),function(elements,elementSerialized,elementId){try{var element=GetNewElement(elementSerialized.type,elementId,component.Page);return element.componentInstance=component,component._elements[elementId]=element,elements.concat(element)}catch(e){return Logger.error(e),elements}},[]);return _.forEach(elements,function(element){try{element.initProperties(serialized[element.id].props)}catch(e){Logger.error(e)}}),_.map(serialized[ElementsHelper.CANVAS_ID].props.storedElements,function(elementId){return component._elements[elementId]})}function CreateComponentForNormalisation(Page){var element=GetNewElement(ElementTypes.COMPONENT,null,Page);return element.initProperties({}),element}function DuplicateElement(element,props){var id=ElementsHelper.GetUniqueId(element.type),duplicated=GetNewElement(element.type,id,element.Page);return duplicated.componentInstance=element.componentInstance,duplicated.initProperties(_.extend(element.serialize().props,props,{name:generateNameForDuplicated(duplicated.type,element.Page.getAllElements(),element.name)})),duplicated}function DuplicateElementsFromClipboard(clipboard,Page,preserveNames){var clipboardMap=ElementsHelper.ConvertListToMap(clipboard),oldNewIdsMap={},newOldIdsMap={},elements=_.map(getElementsWithoutCanvasReversed(clipboard),function(elementSerialized){var id=ElementsHelper.GetUniqueId(elementSerialized.type),element=GetNewElement(elementSerialized.type,id,Page);return oldNewIdsMap[elementSerialized.id]=id,newOldIdsMap[id]=elementSerialized.id,element}),elementsMap=ElementsHelper.ConvertListToMap(elements),allElements=_.union(Page.getAllElements(),elements);return _.forEach(elements,function(element){var serialized=clipboardMap[newOldIdsMap[element.id]];element.componentInstance=Page.ElementsManager.getEditingComponent(),element.initProperties(_.extend(translateIdsOnDuplicate(serialized,oldNewIdsMap).props,{name:preserveNames?serialized.props.name:generateNameForDuplicated(element.type,allElements,serialized.props.name)})),Page.ElementsManager.addElement(element)}),_.map(clipboardMap[ElementsHelper.CANVAS_ID].props.storedElements,function(id){return elementsMap[oldNewIdsMap[id]]})}function FromSerialized(serialized,componentInstanceId,Page){var element=GetNewElement(serialized.type,serialized.id,Page);return element.componentInstance=Page.ElementsManager.getElementById(componentInstanceId),element.initProperties(serialized.props),element}function FromRawImageBlobSrc(src,props,Page){return new Promise(function(resolve){ImageEditor.GetImageSize(src).then(function(size){resolve(CreateElement(ElementTypes.IMAGE,_.extend({x:0,y:0,width:size.width,height:size.height,src:src},props),Page))})})}function setPastedElementsCoordinates(elements,canvas,position,boundingBox,newPage){var viewPortCenterPoint,activeElement=canvas.Page.getSelectedElement(),pastedElementOffset={x:0,y:10},dx=0,dy=0;newPage&&activeElement.type===ElementTypes.CANVAS&&!position||(activeElement.type===ElementTypes.CANVAS||position?(viewPortCenterPoint=getViewPortCenterPoint(canvas),dx=(position?position.x:viewPortCenterPoint.x-boundingBox.width/2)-boundingBox.left,dy=(position?position.y:viewPortCenterPoint.y-boundingBox.height/2)-boundingBox.top):position||(dx=activeElement.x+pastedElementOffset.x-boundingBox.left,dy=activeElement.y+activeElement.height+pastedElementOffset.y-boundingBox.top),_.each(elements,function(element){element._updateProperty(Properties.X,dx+element.x,!0),element._updateProperty(Properties.Y,dy+element.y,!0)}))}function getViewPortCenterPoint(canvas){var viewPortCenterPoint={},workbenchCoordinates=canvas.view.workbenchDomElement.getBoundingClientRect(),domElementCoordinates=canvas.view.domElement.getBoundingClientRect();return viewPortCenterPoint.x=workbenchCoordinates.width/2+workbenchCoordinates.left-domElementCoordinates.left,viewPortCenterPoint.y=workbenchCoordinates.height/2+workbenchCoordinates.top-domElementCoordinates.top,viewPortCenterPoint}var COPY_SUFFIX="copy",REGEXP_DUPLICATED_NAME=new RegExp("( "+COPY_SUFFIX+"( \\d+)?)$"),ElementsFactory={GetNewElement:GetNewElement,CreateElement:CreateElement,CreateElementFromCollaboration:CreateElementFromCollaboration,CreateCanvas:CreateCanvas,CreateGroupedElements:CreateGroupedElements,CreateComponentElements:CreateComponentElements,CreateComponentForNormalisation:CreateComponentForNormalisation,DuplicateElement:DuplicateElement,DuplicateElementsFromClipboard:DuplicateElementsFromClipboard,FromSerialized:FromSerialized,FromRawImageBlobSrc:FromRawImageBlobSrc,setPastedElementsCoordinates:setPastedElementsCoordinates,getViewPortCenterPoint:getViewPortCenterPoint};return ElementsFactory}()},{"./LegacyMap.js":164,"./elements/AndroidGear.js":167,"./elements/AndroidIcon.js":168,"./elements/Arrow.js":169,"./elements/Banner.js":170,"./elements/Box.js":171,"./elements/Button.js":172,"./elements/Canvas.js":173,"./elements/Checkbox.js":174,"./elements/Circle.js":175,"./elements/Clipart.js":176,"./elements/Component.js":177,"./elements/CostcoIcon.js":178,"./elements/Dialog.js":179,"./elements/FontAwesome.js":180,"./elements/FontAwesome47.js":181,"./elements/GeoSvg.js":183,"./elements/GlassCanvas.js":184,"./elements/Group.js":185,"./elements/GroupingInstance.js":186,"./elements/HorizontalScrollbar.js":187,"./elements/Hotspot.js":188,"./elements/Icon.js":189,"./elements/Image.js":190,"./elements/ImageSketch.js":191,"./elements/Input2.js":192,"./elements/InputWithLabel.js":193,"./elements/Label.js":194,"./elements/Line.js":195,"./elements/Link.js":196,"./elements/LinkList.js":197,"./elements/MaterialIcon.js":198,"./elements/Menu.js":199,"./elements/MobileSymbol.js":200,"./elements/Multistate.js":201,"./elements/Navigation.js":202,"./elements/Password.js":203,"./elements/PixleIcon.js":204,"./elements/Radio.js":205,"./elements/RetinaIcon.js":206,"./elements/Scrollbar.js":207,"./elements/Selectlist.js":208,"./elements/SvgCustomIcon.js":209,"./elements/SvgIconLegacy.js":211,"./elements/SvgSymbol.js":212,"./elements/Tab.js":213,"./elements/Table.js":214,"./elements/Tag.js":215,"./elements/TextElement.js":216,"./elements/Textarea.js":217,"./elements/Tooltip.js":218,"./elements/UXPinIconSet.js":219,"./elements/UniSvg.js":220,"./elements/Video.js":221,"./elements/VirtualGroup.js":222,"./elements/helpers/ElementsHelper.js":250,"./elements/helpers/ImageEditor.js":251,"./elements/iOS7.js":263,"./elements/iOS8.js":264,"./elements/ui/ImageCrop.js":279,"./enums/ElementTypes.js":346,"./enums/Properties.js":358,"./utils/Logger":413,lodash:161}],163:[function(_dereq_,module,exports){"use strict";var _FontsManager=_dereq_("./fonts/FontsManager"),_=_dereq_("lodash"),ArrangeHelper=_dereq_("./elements/helpers/ArrangeHelper.js"),Batch=_dereq_("./history/Batch.js"),DuplicateHelper=_dereq_("./elements/helpers/DuplicateHelper.js"),ElementTypes=_dereq_("./enums/ElementTypes.js"),ElementsFactory=_dereq_("./ElementsFactory.js"),ElementsHelper=_dereq_("./elements/helpers/ElementsHelper.js"),EventEmitter=_dereq_("event-emitter"),Events=_dereq_("./enums/Events.js"),Group=_dereq_("./elements/Group"),HistoryManager=_dereq_("./history/HistoryManager.js"),ImageEditor=_dereq_("./elements/helpers/ImageEditor.js"),Logger=_dereq_("./utils/Logger.js"),Parse=_dereq_("./utils/Parse.js"),Properties=_dereq_("./enums/Properties.js"),RemoveHelper=_dereq_("./elements/helpers/RemoveHelper.js"),Tree=_dereq_("./utils/Tree.js"),TextHelper=_dereq_("./elements/helpers/TextStyleHelper.js");module.exports=function(){function getSerializedElements(elementsMap){return _.reduce(elementsMap,function(serializedElements,element,id){return element.isVirtualGroup()||(serializedElements[id]=serializeElement(element)),serializedElements},{})}function getElementsWithComponentCanvas(serialized,component){return serialized[ElementsHelper.CANVAS_ID]||(serialized[ElementsHelper.CANVAS_ID]=ElementsHelper.GetSerializedCanvas(component.children)),serialized}function updateComponentInstances(elements,componentId,componentInstanceIdToSkip){_.forEach(elements,function(element){!element.isComponent()||element.idComponent!==componentId||componentInstanceIdToSkip&&componentInstanceIdToSkip===element.id||(element.shouldUpdateElements=!0)})}function normalizeChanges(changes,oldComponent,newComponent){function hasPositionChange(element){return element&&_.size(_.pick(element.props,POSITION_PROPERTIES))}function isPosition(property){return POSITION_PROPERTIES.indexOf(property)>-1}var positionChanges,POSITION_PROPERTIES=[Properties.X,Properties.Y,Properties.CLIP];return _.forEach(changes,function(elementChanges,elementId){_.forEach(elementChanges.props,function(propertyValue,propertyName){elementChanges.props[propertyName]=newComponent[elementId].props[propertyName]})}),positionChanges=_.reduce(_.cloneDeep(newComponent),function(positionChanges,element,elementId){return element.props=_.pick(element.props,function(value,property){return isPosition(property)&&oldComponent[elementId]&&!_.isEqual(value,oldComponent[elementId].props[property])&&!hasPositionChange(changes[elementId])}),_.isEmpty(element.props)||(positionChanges[elementId]=element),positionChanges},{}),_.extend(changes,positionChanges),_.isEqual(oldComponent[ElementsHelper.CANVAS_ID],newComponent[ElementsHelper.CANVAS_ID])||(changes[ElementsHelper.CANVAS_ID]=_.cloneDeep(newComponent[ElementsHelper.CANVAS_ID])),!_.isEmpty(positionChanges)}function serializeElement(element){return element.serialize()}function isLegacyFormat(serialized){return!(serialized[ElementsHelper.CANVAS_ID]&&serialized[ElementsHelper.CANVAS_ID].v)}function hasComponent(elements,componentId){return _.some(elements,function(element){return element.idComponent===componentId})}function applyPositionDeltaToProperties(properties,delta){return delta&&delta.x&&delta.y&&(properties.x+=delta.x,properties.y+=delta.y),properties}function setGhostSize(element,size,scale){element.style.width=size.width+"px",element.style.height=size.height+"px",element.style.transform="scale("+scale+", "+scale+")"}function ElementsManager(Page){this.Page=Page,this.batch=null,this.elements={},this.components={},this.componentsMasters={},this.componentElementsMap={},this.componentsAvailableIds=[],this.editingComponent=null,this.emitter=new EventEmitter}return ElementsManager.prototype.setComponentsAvailableIds=function(componentsIds){this.componentsAvailableIds=componentsIds},ElementsManager.prototype.inBatch=function(calls){"function"==typeof calls&&(this.startBatch(),calls.apply(),this.endBatch())},ElementsManager.prototype.startBatch=function(updateOnBatchEnd,addToHistory){"undefined"==typeof addToHistory&&(addToHistory=!0),this.batch=new Batch(this.Page,updateOnBatchEnd,addToHistory)},ElementsManager.prototype.endBatch=function(){var changes,componentId,oldComponent,newComponent,isComponentWithOneElementAndOnCanvas,batch=this.batch,updateComponentInstance=!1;return!!batch&&(this.batch.end(),this.batch=null,void(batch.hasChanges()&&(changes=batch.getChanges(),componentId=batch.getComponentId(),componentId&&(oldComponent=_.cloneDeep(this.getComponentById(componentId)),this.updateComponent(componentId,this.editingComponent.id),newComponent=this.getComponentById(componentId),isComponentWithOneElementAndOnCanvas=2===Object.keys(newComponent).length&&this.getElementById(batch.getComponentInstanceId()),updateComponentInstance=isComponentWithOneElementAndOnCanvas||normalizeChanges(changes.changed_elements,oldComponent,newComponent)),batch.addToHistory&&HistoryManager.Add(batch),_.isEmpty(changes.deleted_elements)||(changes.components_used=this.getComponentsUsed()),this.emitter.emit(Events.ELEMENTS_CHANGE,changes,componentId||this.Page.pageId),updateComponentInstance&&this._updateComponentPosition(batch))))},ElementsManager.prototype.createElement=function(type,props){var element=ElementsFactory.CreateElement(type,props,this.Page);return this.addElement(element),element},ElementsManager.prototype.createElementFromCollaboration=function(id,type,props){var element=ElementsFactory.CreateElementFromCollaboration(id,type,props,this.Page);return this.elements[element.id]=element,element.isComponent()&&this.getComponentDefinition(element.idComponent,element.id),element},ElementsManager.prototype.createElementComponentFromCollaboration=function(id,data,componentInstance){var element=ElementsFactory.CreateElementFromCollaboration(id,data.type,data.props,this.Page,componentInstance);return this.componentElementsMap[id]=componentInstance.idComponent,element.isComponent()&&this.getComponentDefinition(element.idComponent,element.id),element},ElementsManager.prototype.createCanvas=function(containerEl){var element=ElementsFactory.CreateCanvas(containerEl,this.Page);return this.addElement(element),element},ElementsManager.prototype.createMultistate=function(elements,stateName,props){var element=ElementsFactory.CreateElement(ElementTypes.MULTISTATE,props||{},this.Page);element.componentInstance=this.editingComponent,element[Properties.STATES]=[element.createInitialState(elements)];var states=_.clone(element[Properties.STATES]);return states.push(element.createNewState(stateName)),element[Properties.STATES]=states,this.addElement(element),element},ElementsManager.prototype.createComponentElements=function(component,componentId){var serialized=this.getComponentById(componentId);return ElementsFactory.CreateComponentElements(serialized,component)},ElementsManager.prototype.createGroupedElements=function(serialized,x,y){var elements=ElementsFactory.CreateGroupedElements(serialized,x,y,this.Page);return _.forEach(elements,function(element){this.addElement(element)}.bind(this)),elements},ElementsManager.prototype.duplicateElement=function(element,props){var duplicated=ElementsFactory.DuplicateElement(element,props);return this.addElement(duplicated),duplicated},ElementsManager.prototype.duplicateElementsFromClipboard=function(clipboard,preserveNames){return ElementsFactory.DuplicateElementsFromClipboard(ElementsHelper.GetSortedPageElements(clipboard),this.Page,preserveNames)},ElementsManager.prototype.createUploadingImages=function(files,x,y){var DELTA_POSITION=15,elements=[];return x=x||0,y=y||0,_.forEach(files,function(file,index){var element=this.createElement(ElementTypes.IMAGE,{x:x+index*DELTA_POSITION,y:y+index*DELTA_POSITION,width:file.width,height:file.height,src:file.finalUrl});elements.push(element)}.bind(this)),elements},ElementsManager.prototype.addElement=function(element,componentInstanceId){var component;this.editingComponent&&(componentInstanceId=this.editingComponent.id),componentInstanceId?(component=this.getElementById(componentInstanceId),this.componentElementsMap[element.id]=component.idComponent,component._elements[element.id]=element,element.componentInstance=component):this.elements[element.id]=element,element.isComponent()&&(this.getComponentDefinition(element.idComponent,element.id),HistoryManager.AddToComponentsMap(element.idComponent,element.id)),this.batch&&this.batch.addElement(element.id,componentInstanceId,element.serialize())},ElementsManager.prototype.addElementSerialized=function(serialized,componentInstanceId){var element=ElementsFactory.FromSerialized(serialized,componentInstanceId,this.Page);return this.addElement(element),element},ElementsManager.prototype.loadPageElements=function(serialized,position){for(var element,sorted=ElementsHelper.GetSortedPageElements(serialized),i=sorted.length;i-- >0;)if(sorted[i].type!==ElementTypes.CANVAS)try{element=ElementsFactory.GetNewElement(sorted[i].type,sorted[i].id,this.Page),element.initProperties(applyPositionDeltaToProperties(sorted[i].props,position)),this.addElement(element)}catch(e){Logger.error(e)}},ElementsManager.prototype.cantRemoveElement=function(element){if(this.Page.collaboration.isElementEditing(element.id))return!0;var isElementEditingInGroup=element.isGroup()&&_.some(Tree.GetAllDescendants(element),function(element){return this.Page.collaboration.isElementEditing(element.id)}.bind(this));return isElementEditingInGroup||element.isComponent()&&_.some(element._elements,function(element){return this.cantRemoveElement(element)}.bind(this))},ElementsManager.prototype.removeElementById=function(elementId){var element=this.getElementById(elementId);return!!element&&this.removeElement(element)},ElementsManager.prototype.removeElement=function(element,componentInstanceId){var component,selectedElementIndex=this.Page.canvas.selectedElements.indexOf(element);return componentInstanceId=this.getComponentInstanceIdByElementId(element.id)||componentInstanceId,selectedElementIndex!==-1&&this.Page.canvas.deselect(),componentInstanceId?(component=this.getElementById(componentInstanceId),delete this.componentElementsMap[element.id],delete component._elements[element.id]):delete this.elements[element.id],element.isComponent()&&this._updateComponentElementsMap(element.idComponent),this.onRemoveElement(element,componentInstanceId),this.batch&&this.batch.removeElement(element.id,componentInstanceId,element.serialize()),!0},ElementsManager.prototype.onRemoveElement=function(element,componentInstanceId){var elements=_.extend({},this.getElements(componentInstanceId),componentInstanceId?{}:{canvas:this.Page.canvas});this.Page.canvas.removeAnnotationLink(element),RemoveHelper.updateActions(element,elements),element.deleteLinkedElements()},ElementsManager.prototype.clear=function(){this.elements=_.pick(this.elements,ElementsHelper.CANVAS_ID),this.components={},this.componentsMasters={},this.componentElementsMap={}},ElementsManager.prototype.destroy=function(){this.elements=null,this.components=null,this.componentsMasters=null,this.componentElementsMap=null},ElementsManager.prototype.getElementById=function(id,componentInstanceId){return componentInstanceId?this.elements[componentInstanceId]._elements[id]:this.elements[id]},ElementsManager.prototype.save=function(element){this.batch&&this.batch.addSaveOperation(element)},ElementsManager.prototype.update=function(element,property,value,addToHistory){var prevSerialized,componentInstanceId;!this.batch||this.batch.updateOnBatchEnd&&!this.batch.canUpdate(element.id,property)?addToHistory&&(element[property]=value):(this.batch.updateOnBatchEnd&&this.batch.setUpdated(element.id,property),prevSerialized=element.serialize(),addToHistory&&(componentInstanceId=this.getComponentInstanceIdByElementId(element.id),element[property]=value,this.batch.changeProperty(element.id,componentInstanceId,element.serialize(),prevSerialized,property)))},ElementsManager.prototype.createComponent=function(name,elements){return new Promise(function(resolve,reject){var normalized=this._normalizeComponentContent(this.getElementsSerializedWithCanvas(elements));this.Page.emit(Events.COMPONENT_CREATED,{content:normalized,onComplete:function(componentId){var componentsElements={};componentId=componentId.toString(),componentsElements[componentId]=normalized,this.addComponent(componentId,componentsElements),resolve(componentId)}.bind(this),onError:function(){reject()}})}.bind(this))},ElementsManager.prototype.createComponentFromCollaboration=function(componentId,elements){var componentsElements={};componentId=componentId.toString(),componentsElements[componentId]=elements,this.addComponent(componentId,componentsElements)},ElementsManager.prototype.editComponent=function(component){this.editingComponent=component},ElementsManager.prototype.getEditingComponent=function(){return this.editingComponent},ElementsManager.prototype.setComponentMastersIds=function(componentMasters){var _this=this;_.forEach(componentMasters,function(masterId,componentId){_this.setComponentMaster(componentId,masterId)})},ElementsManager.prototype.setComponentMaster=function(componentId,masterId){this.componentsMasters[componentId]=masterId},ElementsManager.prototype.updateComponent=function(componentId,componentInstanceId){var componentInstance=this.getElementById(componentInstanceId),serialized=getSerializedElements(componentInstance._elements),normalized=this._normalizeComponentContent(getElementsWithComponentCanvas(serialized,componentInstance),componentInstance.scaleX,componentInstance.scaleY);this.components[componentId]=normalized,updateComponentInstances(this.elements,componentId,componentInstanceId)},ElementsManager.prototype.finishEditingComponent=function(){var componentId=this.editingComponent.idComponent,serialized=getSerializedElements(this.editingComponent._elements),normalized=this._normalizeComponentContent(getElementsWithComponentCanvas(serialized,this.editingComponent),this.editingComponent.scaleX,this.editingComponent.scaleY);this.editingComponent=null,this.components[componentId]=normalized,updateComponentInstances(this.elements,componentId)},ElementsManager.prototype.addComponent=function(componentId,elements){this.componentsAvailableIds.push(componentId),this.addComponentsElements(elements)},ElementsManager.prototype.addComponentsElements=function(value){var components=_.mapValues(value,function(serialized){return _.isEmpty(serialized)?{}:isLegacyFormat(serialized)?this._normalizeComponentContent(serialized):serialized}.bind(this)),componentElementsMap=_.reduce(components,function(elementsMap,component,id){return _.extend(elementsMap,_.mapValues(ElementsHelper.GetElementsWithoutCanvas(component),function(){return id}))},{});this.components=_.extend(this.components,components),this.componentElementsMap=_.extend(this.componentElementsMap,componentElementsMap)},ElementsManager.prototype.removeComponent=function(componentId){var componentInstances=this.getElementsByComponentId(componentId);RemoveHelper.DeleteElements(componentInstances),this.componentsAvailableIds.splice(this.componentsAvailableIds.indexOf(componentId),1),this._updateComponentElementsMap(componentId),HistoryManager.ValidateAndStore(this.Page)},ElementsManager.prototype.getComponentById=function(id){return this.components[id]},ElementsManager.prototype.getComponentIdByElementId=function(elementId){return this.componentElementsMap[elementId]},ElementsManager.prototype.getComponentInstanceIdByElementId=function(elementId){return this.editingComponent&&this.editingComponent.idComponent===this.getComponentIdByElementId(elementId)?this.editingComponent.id:""},ElementsManager.prototype.getElementsByComponentId=function(componentId){return componentId=parseInt(componentId),_.reduce(this.elements,function(elements,element){
return element.isComponent()&&parseInt(element.idComponent)===componentId&&elements.push(element),elements}.bind(this),[])},ElementsManager.prototype.getComponentsUsed=function(){return _.reduce(this.getElements(),function(usedComponents,element){return element.isComponent()&&(usedComponents[element.idComponent]=!0),usedComponents},{})},ElementsManager.prototype.getComponentMasterId=function(componentId){return this.componentsMasters[componentId]},ElementsManager.prototype.getRadioElementsByFormGroupName=function(formGroupName){return _.filter(this.getElements(),function(element){return element.type===ElementTypes.RADIO&&element.hasProperty("formGroupName")&&element.formGroupName===formGroupName})},ElementsManager.prototype.getElements=function(componentInstanceId){return componentInstanceId?this.elements[componentInstanceId]._elements:this.elements},ElementsManager.prototype.getElementsSerializedWithCanvas=function(elements){var allElements=_.reduce(elements,function(allElements,element){return allElements.push(element),allElements.concat(Tree.GetAllDescendants(element))},[]),elementsSerialized=_.mapValues(Parse.getElementsMap(allElements),serializeElement);return ArrangeHelper.ZSortSelectedElements(elements),elementsSerialized[ElementsHelper.CANVAS_ID]=ElementsHelper.GetSerializedCanvas(elements),elementsSerialized},ElementsManager.prototype.translateIds=function(map){var elements=this.editingComponent?this.editingComponent._elements:this.elements;_.forEach(elements,function(element){var serialized=element.serialize();_.forEach(_.keys(serialized.props),function(property){"function"==typeof DuplicateHelper[property]&&(DuplicateHelper[property](serialized.props,map),element._updateProperty(property,serialized.props[property],!0))})})},ElementsManager.prototype.getComponentDefinition=function(componentId,elementId,componentInstanceId){this.getComponentById(componentId)||(HistoryManager.Lock(!0),this.Page.emit(Events.COMPONENT_ADDED,componentId,function(componentId){var element=this.getElementById(elementId,componentInstanceId);element.idComponent=componentId,HistoryManager.Lock(!1)}.bind(this),function(){HistoryManager.Lock(!1)}))},ElementsManager.prototype.addListener=function(event,callback){this.emitter.on(event,callback)},ElementsManager.prototype.createGhostElement=function(type,properties){var element=this._getGhostElementInstance(type,_.omit(properties,Properties.SRC)),bb=element.getBoundingBox(),scale=this.Page.canvas.scale;return setGhostSize(element.view.domElement,bb,scale),TextHelper.UseDefaultTextStyle(element,properties),element.view.domElement.classList.add("temporary-element"),(0,_FontsManager.loadFontsFromElements)([element]).then(function(fonts){element.Page.emit(Events.ELEMENTS_FONTS_LOADED,{fonts:fonts})}),type===ElementTypes.IMAGE&&(element.view.domElement.classList.add("ghost-element","ghost-image"),element.view.domElement.style.opacity=.5,ImageEditor.PreloadImage(properties.src).then(function(){element.view.domElement.src=properties.src})),element},ElementsManager.prototype.renderGhostElement=function(type,properties){var ghost=this.createGhostElement(type,properties);return ghost.view.domElement},ElementsManager.prototype.renderMultiElementGhost=function(serialized){var elements=_.reduce(serialized,function(elements,serializedElement){var element;return serializedElement.props.storedElements||serializedElement.props.states||(element=this._getGhostElementInstance(serializedElement.type,serializedElement.props),elements.push(element)),elements}.bind(this),[]),domElement=document.createElement("div"),scale=this.Page.canvas.scale,bb=_.reduce(_.rest(elements),function(mergedBB,element){return mergedBB.add(element.getBoundingBox())},_.first(elements).getBoundingBox());return setGhostSize(domElement,bb,scale),domElement.classList.add("ng-element","ghost-element","temporary-element"),domElement},ElementsManager.prototype.setPastedElementsCoordinates=function(elements,canvas,position,boundingBox,newPage){return ElementsFactory.setPastedElementsCoordinates(elements,canvas,position,boundingBox,newPage)},ElementsManager.prototype._getGhostElementInstance=function(type,properties){var element=ElementsFactory.GetNewElement(type,ElementsHelper.GetUniqueId(type),this.Page);return element.initProperties(properties),element.update(),element},ElementsManager.prototype._normalizeComponentContent=function(serialized){var scaleX=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,scaleY=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,component=ElementsFactory.CreateComponentForNormalisation(this.Page);return component.addChildren(ElementsFactory.CreateComponentElements(serialized,component)),component._updateBoundingBox(),component.x=0,component.y=0,component.resizeFromPoint(1/scaleX,1/scaleY,component.rect._p0),getElementsWithComponentCanvas(getSerializedElements(component._elements),component)},ElementsManager.prototype._updateComponentElementsMap=function(deletedComponentId){hasComponent(this.elements,deletedComponentId)||(delete this.components[deletedComponentId],this.componentElementsMap=_.omit(this.componentElementsMap,function(id){return id===deletedComponentId}))},ElementsManager.prototype._updateComponentPosition=function(batch){var serialized,componentInstanceId=batch.getComponentInstanceId(),componentInstance=this.getElementById(componentInstanceId),prevSerialized=batch.getSerializedComponent(componentInstanceId);componentInstance.update(),serialized=componentInstance.serialize(),this.startBatch(!1,!1),this.batch.addSaveOperation(componentInstance,prevSerialized),this.batch.changeProperty(componentInstanceId,"",serialized,prevSerialized,Properties.X),this.batch.changeProperty(componentInstanceId,"",serialized,prevSerialized,Properties.Y),this.endBatch()},ElementsManager.prototype.tintElementsExcept=function(elements,elementSkipped,value){_.forEach(elements,function(element){element instanceof Group&&(!element.isComponent()||element===elementSkipped)||element.tintView(value)})},ElementsManager}()},{"./ElementsFactory.js":162,"./elements/Group":185,"./elements/helpers/ArrangeHelper.js":242,"./elements/helpers/DuplicateHelper.js":249,"./elements/helpers/ElementsHelper.js":250,"./elements/helpers/ImageEditor.js":251,"./elements/helpers/RemoveHelper.js":255,"./elements/helpers/TextStyleHelper.js":261,"./enums/ElementTypes.js":346,"./enums/Events.js":347,"./enums/Properties.js":358,"./fonts/FontsManager":365,"./history/Batch.js":368,"./history/HistoryManager.js":370,"./utils/Logger.js":413,"./utils/Parse.js":415,"./utils/Tree.js":419,"event-emitter":98,lodash:161}],164:[function(_dereq_,module,exports){"use strict";var ElementTypes=_dereq_("./enums/ElementTypes.js"),Properties=_dereq_("./enums/Properties.js"),Calc=_dereq_("./utils/Calc.js"),ElementsHelper=_dereq_("./elements/helpers/ElementsHelper.js"),Point=_dereq_("./primitives/Point.js"),_=_dereq_("lodash");module.exports=function(){function getAngle(props){return parseInt(props.rotation)?parseInt(props.rotation):-props.angle}function isSvg(type){return[ElementTypes.ANDROID_ICON,ElementTypes.COSTCO_ICON,ElementTypes.FONT_AWESOME,ElementTypes.GEO_SVG,ElementTypes.ICON,ElementTypes.MATERIAL_ICON,ElementTypes.PIXLE_ICON,ElementTypes.RETINA_ICON,ElementTypes.SVG_SYMBOL,ElementTypes.UNI_SVG,ElementTypes.UXPIN_ICON_SET].indexOf(MapType(type))>-1}function getRotatedPoint(props){var angle=getAngle(props),point=new Point(props.left,props.top);return point.rotate(new Point(props.left+props.width/2,props.top+props.height/2),angle),point}function toCamelCase(str){return str.replace(/[-|_]([a-z])/g,function(match,p1){return p1.toUpperCase()})}function hasZIndex(element){return"undefined"!=typeof element.props.zIndex||"undefined"!=typeof element.props["z-index"]}function sortElementIds(serialized,elementIds){return serialized&&_.every(_.pick(serialized,elementIds),hasZIndex)?_.sortBy(elementIds,function(elementId){return parseInt(serialized[elementId].props.zIndex||serialized[elementId].props["z-index"])}):elementIds}function getRootElementIds(serialized){var childrenMap=getChildrenMap(serialized);return sortElementIds(serialized,_.reduce(serialized,function(elements,elementSerialized,elementId){return childrenMap[elementId]||elements.push(elementId),elements},[]))}function getSerializedCanvas(serialized){return{type:ElementTypes.CANVAS,props:{storedElements:getRootElementIds(serialized)}}}function getChildrenMap(serialized){return _.reduce(serialized,function(childrenMap,elementSerialized,elementId){return elementSerialized.type===ElementTypes.GROUP?_.forEach(elementSerialized.props.storedElements,function(childId){childrenMap[childId]=elementId}):elementSerialized.type===ElementTypes.MULTISTATE&&_.forEach(elementSerialized.props.states,function(state){_.forEach(state.elements,function(childId){childrenMap[childId]=elementId})}),childrenMap},{})}function getLegacyElements(serialized){return _.omit(serialized,function(elementSerialized){return!!elementSerialized.v})}function isLegacyProperty(property){return LEGACY_PROPERTIES.hasOwnProperty(property)}function mapProperty(property,value,elementType,elementProps,serialized){var mapped={};return isLegacyProperty(property)?"function"==typeof LEGACY_PROPERTIES[property]?mapped=LEGACY_PROPERTIES[property].call(null,value,elementType,elementProps,serialized):mapped[LEGACY_PROPERTIES[property]]=value:mapped[property]=value,mapped}function mapStyles(properties,elementType){var textLines,fragment=document.createDocumentFragment();if("undefined"==typeof properties[Properties.INPUT_VALUE])return properties;var addNodeOnTop=function(nodeName){var i,node=document.createElement(nodeName),childNodes=[];for(i=fragment.childNodes.length;--i>=0;)childNodes.push(fragment.childNodes[i]),fragment.removeChild(fragment.childNodes[i]);for(i=childNodes.length;--i>=0;)node.appendChild(childNodes[i]);return fragment.appendChild(node),node};textLines=(properties[Properties.INPUT_VALUE]||"").replace("\n","\n<br>\n").split("\n"),_.forEach(textLines,function(nodeContent){var node;node="<br>"===nodeContent?document.createElement("br"):document.createTextNode(nodeContent),fragment.appendChild(node)}),properties[Properties.COLOR]&&(addNodeOnTop("span").style[Properties.COLOR]=properties[Properties.COLOR]),properties[Properties.FONT_WEIGHT]&&"normal"!==properties[Properties.FONT_WEIGHT]&&(addNodeOnTop("span").style[Properties.FONT_WEIGHT]=properties[Properties.FONT_WEIGHT]),properties[Properties.FONT_STYLE]&&"normal"!==properties[Properties.FONT_STYLE]&&(addNodeOnTop("span").style[Properties.FONT_STYLE]=properties[Properties.FONT_STYLE]),properties[Properties.TEXT_DECORATION]&&"none"!==properties[Properties.TEXT_DECORATION]&&(addNodeOnTop("span").style[Properties.TEXT_DECORATION]=properties[Properties.TEXT_DECORATION]),properties[Properties.FONT_FAMILY]&&(addNodeOnTop("span").className="wysiwyg-font-type-"+properties[Properties.FONT_FAMILY].replace(/[^\w]/g,"")),properties[Properties.FONT_SIZE]&&elementType!==ElementTypes.TEXT&&(addNodeOnTop("span").style[Properties.FONT_SIZE]=properties[Properties.FONT_SIZE]),addNodeOnTop("span").style[Properties.VERTICAL_ALIGN]="top";var mainNode=addNodeOnTop("p");return properties[Properties.TEXT_ALIGN]&&(mainNode.style[Properties.TEXT_ALIGN]=properties[Properties.TEXT_ALIGN]),properties[Properties.FONT_SIZE]&&elementType===ElementTypes.TEXT&&(mainNode.style[Properties.FONT_SIZE]=properties[Properties.FONT_SIZE]),properties[Properties.LINE_HEIGHT]&&(mainNode.style[Properties.LINE_HEIGHT]=properties[Properties.LINE_HEIGHT]),properties[Properties.INPUT_VALUE]=fragment.firstChild.outerHTML.replace("&amp;","&"),properties}function ParseElementProps(elementProps,elementType,serialized){var data=_.reduce(elementProps,function(data,value,key){return isLegacyProperty(key)?_.extend(data,mapProperty(key,value,elementType,elementProps,serialized)):data[toCamelCase(key)]=value,data},{});return LEGACY_TEXT_EDITABLE.indexOf(elementType)>-1&&(data=mapStyles(data,elementType)),data}function ParseElements(serialized){return _.forEach(getLegacyElements(ElementsHelper.GetElementsWithoutCanvas(serialized)),function(elementSerialized){elementSerialized.props=ParseElementProps(elementSerialized.props,elementSerialized.type,serialized)}),serialized[ElementsHelper.CANVAS_ID]||(serialized[ElementsHelper.CANVAS_ID]=getSerializedCanvas(serialized)),serialized}function MapType(type){return LEGACY_TYPES[type]&&(type=LEGACY_TYPES[type]),type}function IsLegacy(serialized){return _.some(serialized,function(element){return!element.v})}var LEGACY_INPUT_TYPES=[ElementTypes.INPUT2,ElementTypes.INPUT_WITH_LABEL],LEGACY_TEXT_EDITABLE=[ElementTypes.BOX,ElementTypes.CHECKBOX,ElementTypes.CIRCLE,ElementTypes.LABEL,ElementTypes.LINK,ElementTypes.RADIO,ElementTypes.TEXT,ElementTypes.TOOLTIP],LEGACY_BOXABLE=[ElementTypes.BOX,ElementTypes.BUTTON,ElementTypes.TEXTAREA,ElementTypes.GLASS_CANVAS],LEGACY_TYPES={SocialButtons:ElementTypes.GROUPING_INSTANCE,UIKit:ElementTypes.GROUPING_INSTANCE,Bootstrap:ElementTypes.GROUPING_INSTANCE,Foundation:ElementTypes.GROUPING_INSTANCE,Newui:ElementTypes.GROUPING_INSTANCE,Flatui:ElementTypes.GROUPING_INSTANCE,Semanticui:ElementTypes.GROUPING_INSTANCE,GlassPattern:ElementTypes.GROUPING_INSTANCE,GeoSVG:ElementTypes.GEO_SVG,UniSVG:ElementTypes.UNI_SVG,PixleGesty:ElementTypes.UNI_SVG,LineHorizontal:ElementTypes.LINE,LineVertical:ElementTypes.LINE,StickyNote:ElementTypes.BOX,Tab:ElementTypes.TAB,Text:ElementTypes.TEXT_ELEMENT,Text2:ElementTypes.TEXT_ELEMENT,Input:ElementTypes.INPUT2,SvgIcon:ElementTypes.SVG_ICON_LEGACY},LEGACY_PROPERTIES={caption:Properties.INPUT_VALUE,"textarea-value":Properties.INPUT_VALUE,"list-font-size":Properties.FONT_SIZE,"list-font-weight":Properties.FONT_WEIGHT,"list-font-style":Properties.FONT_STYLE,"list-font-family":Properties.FONT_FAMILY,"list-text-decoration":Properties.TEXT_DECORATION,"list-text-align":Properties.TEXT_ALIGN,"list-color":Properties.COLOR,"note-color":Properties.BACKGROUND_COLOR,"header-text":Properties.HEADER_TEXT,"header-color":Properties.HEADER_COLOR,"header-font-weight":Properties.HEADER_FONT_WEIGHT,"header-font-style":Properties.HEADER_FONT_STYLE,"header-font-size":Properties.HEADER_FONT_SIZE,"header-font-family":Properties.HEADER_FONT_FAMILY,"header-text-decoration":Properties.HEADER_TEXT_DECORATION,"header-text-align":Properties.HEADER_TEXT_ALIGN,"header-display":function(value,elementType){elementType===ElementTypes.LINK_LIST&&("block"===value?value=1:"none"===value&&(value=0));var returnable={};return returnable[Properties.HEADER_DISPLAY]=value,returnable},left:function(x,elementType,elementProps){return getAngle(elementProps)&&(x=getRotatedPoint(elementProps).x),{x:x}},top:function(y,elementType,elementProps){var delta,LINE_HEIGHT=18;return isSvg(elementType)&&(delta=Math.ceil(LINE_HEIGHT/2)-elementProps.height+3,delta>0&&(y+=delta*Math.cos(Calc.DegToRad(elementProps.angle)),elementProps.top=y)),getAngle(elementProps)&&(y=getRotatedPoint(elementProps).y),{y:y}},angle:function(_angle,elementType,elementProps){return{angle:getAngle(elementProps)}},rotation:function(_rotation,elementType,elementProps){return{angle:getAngle(elementProps)}},id_component:function(idComponent){return{idComponent:idComponent.toString()}},states:function(_states,elementType,elementProps,serialized){return{states:_.map(_states,function(state){return state.elements=sortElementIds(serialized,_.map(state.elements,function(element){return element.toString()})),state})}},type:function(_type,elementType){return elementType===ElementTypes.TAB?{tabType:_type}:_.contains(LEGACY_INPUT_TYPES,elementType)?{inputType:_type}:elementType===ElementTypes.LINE?{lineType:_type}:elementType===ElementTypes.NAVIGATION?{orientation:_type}:{type:_type}},"border-width":function(value,elementType){return _.contains([ElementTypes.INPUT,ElementTypes.TABLE],elementType)||_.contains(LEGACY_BOXABLE,elementType)?{borderTopWidth:value,borderRightWidth:value,borderBottomWidth:value,borderLeftWidth:value}:{borderWidth:value}},"border-radius":function(value,elementType){return _.contains(LEGACY_INPUT_TYPES,elementType)||_.contains(LEGACY_BOXABLE,elementType)?{borderTopLeftRadius:value,borderTopRightRadius:value,borderBottomRightRadius:value,borderBottomLeftRadius:value}:{borderRadius:value}},"border-bottom":function(value,elementType){return elementType===ElementTypes.LINE_HORIZONTAL?{stroke:value,lineOrientation:"horizontal"}:{borderBottom:value}},"border-right":function(value,elementType){return elementType===ElementTypes.LINE_VERTICAL?{stroke:value,lineOrientation:"vertical"}:{borderRight:value}},stored_elements:function(storedElements,elementType,elementProps,serialized){return elementType===ElementTypes.COMPONENT?{}:{storedElements:sortElementIds(serialized,_.unique(_.map(storedElements,function(element){return element.toString()})))}},"input-value":function(value,elementType){if(elementType===ElementTypes.TAG){var content=value.split("\n"),title=content.shift(),text=content.join("\n");return{title:title,text:text}}return elementType===ElementTypes.PASSWORD?{inputValue:value,inputType:"password"}:elementType===ElementTypes.STICKY_NOTE?{caption:value}:{inputValue:value}},color:function(value,elementType){return elementType===ElementTypes.TEXT_ELEMENT?{}:{color:value}},"font-size":function(value,elementType){return elementType===ElementTypes.TEXT_ELEMENT?{}:{fontSize:value}},"font-style":function(value,elementType){return elementType===ElementTypes.TEXT_ELEMENT?{}:{fontStyle:value}},"font-weight":function(value,elementType){return elementType===ElementTypes.TEXT_ELEMENT?{}:{fontWeight:value}},"line-height":function(value,elementType){return elementType===ElementTypes.TEXT_ELEMENT?{}:{lineHeight:value}},"text-align":function(value,elementType){return elementType===ElementTypes.TEXT_ELEMENT?{}:{textAlign:value}},value:function(_value,elementType){return ElementTypes.INPUT2===elementType?{inputValue:_value}:{value:_value}},"label-text":function(value,elementType){return elementType===ElementTypes.INPUT_WITH_LABEL?{labelText:value}:{inputValue:value}},"table-value":function(value){var rows=_.map(value.split("\n"),function(row){return row.split(";")});return{tableValue:rows}},cells_styles:function(value,elementType){return{cellsStyles:_.mapValues(value,function(styles){return ParseElementProps(styles,elementType)})}},init_elements:function(value){return{initElements:JSON.stringify(ParseElements(JSON.parse(value)))}},"inactive-background-color":function(value,elementType){return elementType===ElementTypes.NAVIGATION?{backgroundColor:value}:{inactiveBackgroundColor:value}},original_width:function(value){return{originalWidth:parseInt(value)}},width:function(value){return{width:parseInt(value)}},original_height:function(value){return{originalHeight:parseInt(value)}},height:function(value){return{height:parseInt(value)}},data:function(value,elementType){return elementType===ElementTypes.SVG_ICON_LEGACY?{data:"https://app.uxpin.com"+value}:{data:value}},is_clip:function(value,elementType,elementProps){return value?{isClip:value,clip:{x:elementProps.left,y:elementProps.top,width:elementProps.width,height:elementProps.height,angle:0}}:{isClip:value}},zebra:function(value,elementType,elementProps){return{zebra:elementProps.oddBackgroundColor?value:0}}},LegacyMap={ParseElementProps:ParseElementProps,ParseElements:ParseElements,MapType:MapType,IsLegacy:IsLegacy};return LegacyMap}()},{"./elements/helpers/ElementsHelper.js":250,"./enums/ElementTypes.js":346,"./enums/Properties.js":358,"./primitives/Point.js":403,"./utils/Calc.js":407,lodash:161}],165:[function(_dereq_,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}return Array.from(arr)}var _FontsManager=_dereq_("./fonts/FontsManager"),_FontsLoader=_dereq_("./fonts/FontsLoader"),_TypekitLoader=_dereq_("./fonts/TypekitLoader"),_factory=_dereq_("./mode/factory"),_factory2=_interopRequireDefault(_factory),_=_dereq_("lodash"),CDNHelper=_dereq_("./utils/CDNHelper.js"),CollaborationUtils=_dereq_("./utils/Collaboration.js"),ElementsHelper=_dereq_("./elements/helpers/ElementsHelper.js"),ElementsManager=_dereq_("./ElementsManager.js"),ElementTypes=_dereq_("./enums/ElementTypes.js"),EventEmitter=_dereq_("event-emitter"),Events=_dereq_("./enums/Events.js"),HistoryManager=_dereq_("./history/HistoryManager.js"),InteractionsManager=_dereq_("./interactions/InteractionsManager.js"),InteractionTriggers=_dereq_("./enums/InteractionTriggers.js"),LegacyMap=_dereq_("./LegacyMap.js"),PageModes=_dereq_("./enums/PageModes.js"),Properties=_dereq_("./enums/Properties.js"),RestrictModes=_dereq_("./enums/RestrictModes.js"),SelectionHelper=_dereq_("./elements/helpers/SelectionHelper.js"),TextEditor=_dereq_("./elements/helpers/TextEditor.js"),TextStyleHelper=_dereq_("./elements/helpers/TextStyleHelper.js"),VideoHelper=_dereq_("./elements/helpers/VideoHelper");module.exports=function(){function refreshElement(element){element.type===ElementTypes.TEXT_ELEMENT&&(element.shouldUpdateHeight=!0)}function Page(options){this.setOptions(options),this.currentMode=(0,_factory2.default)(this.options.mode,this),this.restrictMode=RestrictModes.NONE,this.ElementsManager=new ElementsManager(this),this.InteractionsManager=new InteractionsManager(this.ElementsManager),this.canvas=this.ElementsManager.createCanvas(this.options),this.canvas.initProperties({}),this.currentMode.handleCanvas(this.canvas),this.currentMode.afterCreate(),this.pickerDefer={},HistoryManager.AddListener(Events.HISTORY_CHANGE,function(data){this.emit(Events.HISTORY_CHANGE,data)}.bind(this)),this.ElementsManager.addListener(Events.ELEMENTS_CHANGE,function(changes,pageId){this.emit(Events.ELEMENTS_CHANGE,changes,pageId)}.bind(this)),this.interactWithElementThrottled=_.throttle(this.InteractionsManager.interactWithElement,50).bind(this.InteractionsManager),this.collaboration=new CollaborationUtils(this.canvas,this)}var defaultOptions={containerEl:".ng-canvas-container",rulerElClass:"ng-ruler",mode:PageModes.DESIGN,enableGuides:!0,enableGuidesSnapping:!0,enableSmartGuides:!0,enableSmartGuidesSnapping:!0},defaultNewElementPosition={x:100,y:100};return Page.FromSerialized=function(){var p=new Page;return p},Page.Events=Events,Page.Modes=PageModes,Page.prototype=Object.create(new EventEmitter),Page.constructor=Page,Object.defineProperties(Page.prototype,{MODE:{get:function(){return this.currentMode&&this.currentMode.name||null}}}),Page.prototype.setOptions=function(options){this.options=_.extend(this.options||_.clone(defaultOptions),options),(0,_FontsLoader.setCustomFontCssUrl)(this.options.customFontCssUrl),CDNHelper.Init(this.options),(0,_TypekitLoader.init)(this.options.typekit,this),this.canvas&&options&&options.hasOwnProperty("enableGuides")&&this.canvas.displayGuides(options.enableGuides)},Page.prototype.toggleMode=function(value){value||(value=this.isDesignMode()?PageModes.PREVIEW:PageModes.DESIGN),this.setMode(value),this.emit(this.isDesignMode()?Events.ENABLED_DESIGN_MODE:Events.ENABLED_PREVIEW_MODE),this.isPreviewMode()&&this._updateOffset(this.ElementsManager.getElements())},Page.prototype.setMode=function(mode){var _this=this;if(mode&&this.MODE!==mode){var prevMode=this.MODE;this.currentMode&&(this.currentMode.beforeSwitch(mode),this.currentMode.onDestroy()),this.currentMode=(0,_factory2.default)(mode,this),this.currentMode.handleCanvas(this.canvas),this.currentMode.afterCreate(),this.emit(Events.MODE_CHANGE,prevMode,this.MODE),setTimeout(function(){_this.canvas._updateRelativeRectangle()})}},Page.prototype.clearSpecMode=function(){this.endPickMode(),this.deselectAllElements(),this.canvas._updateRelativeRectangle(),this.getPicker(this.pickerDefer)},Page.prototype.getPicker=function(picker){var _this2=this,ignoreMultistateChildren=!1,returnNullOnCanvas=!0,validator=function(elementId,componentInstanceId){var validatedElement=this.getElementById(elementId,componentInstanceId);return!(_.contains(this.getSelectedElements(),elementId)||validatedElement&&!validatedElement.isVisible()||this.isSpecModeSkippedType(validatedElement))}.bind(this),endPickMode=function(){picker={},this.endPickMode()}.bind(this),restartPicker=function(){endPickMode(),picker=this.getPicker(this.pickerDefer)}.bind(this);return new Promise(function(resolve,reject){picker.resolve=resolve,picker.reject=reject,_this2.startPickMode(validator,ignoreMultistateChildren,returnNullOnCanvas).then(function(elementData){elementData=elementData||{};var pickedElement=_this2.getElementById(elementData.elementId,elementData.componentInstanceId);return _this2.currentMode.getPickerConfig().handlePickedElement(elementData.elementId,pickedElement,resolve),_this2.currentMode.getPickerConfig().singlePick?endPickMode():void restartPicker()}).then(function(){var endCb=_this2.currentMode.getPickerConfig().endCallback;"function"==typeof endCb&&endCb()}).catch(function(e){endPickMode(),console.error("Picker error:",e),reject("picker_error")})})},Page.prototype.deselectSpecElements=function(){this.deselectAllElements(),this.emit(Events.ELEMENT_PICKED,{element:null})},Page.prototype.isSpecModeSkippedType=function(element){return!!element&&_.includes([ElementTypes.HOTSPOT,ElementTypes.TAG],element.type)},Page.prototype.isDesignMode=function(){return this.MODE===PageModes.DESIGN},Page.prototype.isDrawMode=function(){return this.MODE===PageModes.DRAW},Page.prototype.isPreviewMode=function(){return _.includes([PageModes.PREVIEW,PageModes.EXPORT],this.MODE)},Page.prototype.isExportMode=function(){return this.MODE===PageModes.EXPORT},Page.prototype.isSpecMode=function(){return this.MODE===PageModes.SPEC},Page.prototype.isDocumentationMode=function(){return this.MODE===PageModes.DOCUMENTATION},Page.prototype.isInteractableMode=function(){return!this.isSpecMode()&&!this.isDocumentationMode()},Page.prototype.shouldResetZoom=function(){return this.isDesignMode()||this.isDrawMode()},Page.prototype.setComponentsIds=function(componentsIds){this.ElementsManager.setComponentsAvailableIds(componentsIds)},Page.prototype.addElement=function(element){this.canvas.addElement(element),this.emit(Events.ELEMENT_ADDED)},Page.prototype.addComponent=function(componentId,component){var _this3=this;if(!this.ElementsManager.getComponentById(componentId)){var componentsElements={};componentsElements[componentId]=component,this.ElementsManager.addComponentsElements(componentsElements),(0,_FontsManager.loadFontsFromElements)(component).then(function(fonts){_this3.emit(Events.ELEMENTS_FONTS_LOADED,{fonts:fonts})})}},Page.prototype.removeComponent=function(componentId){this.ElementsManager.removeComponent(componentId)},Page.prototype.bulkCreateElements=function(elementsList,position,selectElement){var _this4=this,idsMap=ElementsHelper.GenerateIdsMap(_.map(elementsList,function(element){return element.id}));LegacyMap.IsLegacy(elementsList)&&(elementsList=ElementsHelper.GenerateZIndicesInList(elementsList)),_.forEach(elementsList,function(element){element.props.isClip&&(element.props.clip=ElementsHelper.GetNewGroupClipping(element.props,position))});var elements,serialized=LegacyMap.ParseElements(ElementsHelper.ConvertListToMap(elementsList)),translated=ElementsHelper.TranslateAllIds(serialized,idsMap);this.ElementsManager.startBatch(),this.ElementsManager.loadPageElements(translated,position),elements=_.map(translated[ElementsHelper.CANVAS_ID].props.storedElements,function(elementId){return this.getElementById(elementId)}.bind(this)),this.canvas.getCurrentEditingParent().addChildren(elements),this.ElementsManager.endBatch(),(0,_FontsManager.loadFontsFromElements)(elementsList).then(function(fonts){_this4.emit(Events.ELEMENTS_FONTS_LOADED,{fonts:fonts})}),selectElement&&this.canvas._select(elements)},Page.prototype.createElement=function(type,props,selectElement){var _this5=this;props=_.defaults(LegacyMap.ParseElementProps(props),defaultNewElementPosition),this.ElementsManager.startBatch();var element=this.ElementsManager.createElement(type,props);return TextStyleHelper.UseDefaultTextStyle(element,props),this.addElement(element),this.ElementsManager.endBatch(),(0,_FontsManager.loadFontsFromElements)([element]).then(function(fonts){_this5.emit(Events.ELEMENTS_FONTS_LOADED,{fonts:fonts})}),selectElement&&this.canvas.select(element,!0),element},Page.prototype.createUploadingImages=function(data){var elements;return this.ElementsManager.startBatch(),data.target?(data.target.setImageSrc(_.first(data.files).finalUrl,!0),elements=[data.target]):(elements=this.ElementsManager.createUploadingImages(data.files,data.point.x,data.point.y),_.forEach(elements,this.addElement.bind(this))),this.ElementsManager.endBatch(),_.forEach(elements,function(element,i){var file=data.files[i];element.showProgress(),element.setTemporaryImageSrc(file.src),file.onProgress=element.setProgress.bind(element),file.onComplete=element.setCompleted.bind(element,file.finalUrl),file.onError=element.setFailed.bind(element)}),this.canvas._select(elements),data.files},Page.prototype.createMultistateFromSelection=function(){this.canvas.createMultistate()},Page.prototype.createComponentFromSelection=function(){this.canvas.createComponent()},Page.prototype.zoomIn=function(params){this.emit(Events.ZOOM_IN,params)},Page.prototype.zoomOut=function(params){this.emit(Events.ZOOM_OUT,params)},Page.prototype.zoomReset=function(){this.emit(Events.ZOOM_RESET)},Page.prototype.getScale=function(){return this.canvas.scale},Page.prototype.setScale=function(value){this.canvas.setScale(value)},Page.prototype.undo=function(){HistoryManager.CanUndo()&&HistoryManager.Undo()},Page.prototype.redo=function(){HistoryManager.CanRedo()&&HistoryManager.Redo()},Page.prototype.canUndo=function(){return HistoryManager.CanUndo()},Page.prototype.canRedo=function(){return HistoryManager.CanRedo()},Page.prototype.getCanvas=function(){return this.canvas},Page.prototype.getAllImages=function(){return this.canvas.getImages()},Page.prototype.getElementById=function(id,componentInstanceId){var component=this.ElementsManager.getEditingComponent();return component?this.ElementsManager.getElementById(id,component.id):this.ElementsManager.getElementById(id,componentInstanceId)},Page.prototype.getAllElements=function(withCanvas){var component=this.ElementsManager.getEditingComponent(),elements=component?component.getElements():this.ElementsManager.getElements();return withCanvas?elements:_.reject(elements,function(element){return element.isCanvas()})},Page.prototype.getNonGroupElementsCount=function(withCanvas){var allElements=this.getAllElements(withCanvas),nonGroupElements=_.reject(allElements,function(element){return element.isGroup()});return nonGroupElements.length},Page.prototype.getRootElement=function(){return this.ElementsManager.getEditingComponent()||this.canvas},Page.prototype.getElementsByIds=function(ids){var _this6=this;return _.compact(_.map(ids,function(id){return _this6.getElementById(id)}))},Page.prototype.getSelectedElements=function(){return this.mapSelectedElements(this.canvas.selectedElements)},Page.prototype.getSelectedElementsColors=function(){var selectedElements=this.getSelectedElements(),data={colors:[],gradients:[]};return _.each(selectedElements,function(element){if(!element.isCanvas()){var specProperties=element.getSpecProperties();data.colors=[].concat(_toConsumableArray(data.colors),_toConsumableArray(specProperties.colors.map(function(color){return color.hex}))),data.gradients=[].concat(_toConsumableArray(data.gradients),_toConsumableArray(specProperties.gradients||[]))}}),data.colors=_.uniq(_.compact(data.colors)),data.gradients=_.uniq(_.compact(data.gradients)),data},Page.prototype.getSelectedElement=function(){return _.first(this.mapSelectedElements([this.canvas.getSelectedElement()]))},Page.prototype.selectElement=function(id,replaceSelection){var element=this.getElementById(id);
element&&replaceSelection?this.canvas.select(element):element&&this.canvas.addToSelection(element)},Page.prototype.editSelectedElements=function(){this.canvas.editSelectedElements()},Page.prototype.selectAllElements=function(){return this.canvas.selectAll()},Page.prototype.setAnnotationSelection=function(id,shouldSelect){var element=this.getElementById(id);if(element)return shouldSelect?element.selectAnnotation():element.deselectAnnotation()},Page.prototype.setAnnotationHighlight=function(id,shouldHighlight){var element=this.getElementById(id);if(element)return shouldHighlight?element.highlightAnnotation():element.removeAnnotationHighlight()},Page.prototype.deselectElement=function(id){var element=this.getElementById(id);element&&this.canvas.removeFromSelection(element)},Page.prototype.deselectAllElements=function(){this.canvas.deselect()},Page.prototype.highlightElement=function(id,interactive){var element=this.getElementById(id);element&&this.currentMode.overlay.highlightElement(element,interactive||this.canvas.pickMode)},Page.prototype.removeHighlight=function(){this.currentMode.overlay.removeHighlight()},Page.prototype.alignSelectedElements=function(axis){0!==this.canvas.selectedElements.length&&this.canvas.align(axis)},Page.prototype.distributeSelectedElements=function(orientation){0!==this.canvas.selectedElements.length&&this.canvas.distribute(orientation)},Page.prototype.groupSelectedElements=function(){this.canvas.group()},Page.prototype.ungroupSelectedElements=function(){this.canvas.ungroup()},Page.prototype.moveElements=function(elementsIds,target,direction){var elements=this.getElementsByIds(elementsIds);target=this.getElementById(target),target&&0!==elements.length&&(direction>0?this.canvas.moveElementsBefore(elements,target):direction<0?this.canvas.moveElementsAfter(elements,target):0===direction&&this.canvas.moveElementsBefore(elements,target.children[0]))},Page.prototype.moveSelectedElementsForward=function(){this.canvas.moveForward()},Page.prototype.moveSelectedElementsBehind=function(){this.canvas.moveBehind()},Page.prototype.moveSelectedElementsToFront=function(){this.canvas.moveToFront()},Page.prototype.moveSelectedElementsToBack=function(){this.canvas.moveToBack()},Page.prototype.lockSelectedElements=function(){this.canvas.lock()},Page.prototype.unlockSelectedElements=function(){this.canvas.unlock()},Page.prototype.showElements=function(elements){this.canvas.setElementsVisibility(!0,elements)},Page.prototype.hideElements=function(elements){this.canvas.setElementsVisibility(!1,elements)},Page.prototype.updateElement=function(id,update,addToHistory){var element=this.getElementById(id);element&&(this.ElementsManager.startBatch(),_.forEach(update,function(value,property){var validated=element.validateProperty(property,value);element._updateProperty(property,validated,"undefined"==typeof addToHistory||addToHistory),TextStyleHelper.IsStyleProperty(element,property)&&TextStyleHelper.SetDefaultTextStyle(this.getProjectId(),property,validated)}.bind(this)),this.ElementsManager.endBatch(),(0,_FontsManager.loadFontsOnElementUpdate)(element.type,update).then(function(fonts){this.emit(Events.ELEMENTS_FONTS_LOADED,{fonts:fonts})}.bind(this)))},Page.prototype.collaborationUpdateElement=function(id,data){var _this7=this,element=this.ElementsManager.getElementById(id);return element?(_.forEach(data.props,function(value,property){return property===Properties.ANGLE&&[ElementTypes.GROUP,ElementTypes.MULTISTATE].indexOf(element.type)!==-1?element.collaborationUpdateAngle(value):void element._updateProperty(property,value,!0)}),(0,_FontsManager.loadFontsOnElementUpdate)(data.type,data.props).then(function(fonts){_this7.emit(Events.ELEMENTS_FONTS_LOADED,{fonts:fonts})}),void refreshElement(element)):(element=this.ElementsManager.createElementFromCollaboration(id,data.type,data.props),this.canvas.addChild(element),void(this.isComponentEditMode()&&this.ElementsManager.tintElementsExcept([element],[],!0)))},Page.prototype.collaborationCreateComponent=function(data){this.ElementsManager.createComponentFromCollaboration(data.id_page,data.changed_elements)},Page.prototype.addElementState=function(id,stateName){var element=this.getElementById(id);return!!element&&void(element.isMultistate()?(this.ElementsManager.startBatch(),element.addState(stateName),this.ElementsManager.endBatch()):(element=SelectionHelper.CreateOrConvertToMultistate([element],stateName),this.canvas._select([element])))},Page.prototype.removeElementState=function(id,stateId){var element=this.getElementById(id);if(element&&element.isMultistate()){var editByCollaborator=_.some(element.getStateChildrenById(stateId),function(child){return child.isEditByCollaborator()});if(editByCollaborator)return this.emit(Events.CANT_DELETE_ELEMENT);this.ElementsManager.startBatch(),element.removeState(stateId),1===element.getStatesCount()&&this.canvas._select(SelectionHelper.ConvertFromMultistate(element)),this.ElementsManager.endBatch()}},Page.prototype.renameElementState=function(id,stateId,stateName){var element=this.getElementById(id);element&&element.isMultistate()&&(this.ElementsManager.startBatch(),element.renameState(stateId,stateName),this.ElementsManager.endBatch())},Page.prototype.getElementState=function(id){var element=this.getElementById(id);if(element&&element.isMultistate())return element.activeState.id},Page.prototype.setElementState=function(id,stateId){var element=this.getElementById(id);if(element&&element.isMultistate()&&(this.ElementsManager.startBatch(),element.showState(stateId),this.ElementsManager.endBatch(),this.canvas.editingGroup===element)){var stateFirstElement=element.getStateFirstElement(stateId);stateFirstElement?this.canvas.select(this.getElementById(stateFirstElement)):this.canvas.refreshEmptyState(element)}},Page.prototype.setElementDefaultState=function(id,stateId){var element=this.getElementById(id);element&&element.isMultistate()&&(this.ElementsManager.startBatch(),element.setDefaultState(stateId),this.ElementsManager.endBatch())},Page.prototype.editGroup=function(id){var element=this.getElementById(id);element&&element.isGroup()&&this.canvas.editGroup(element)},Page.prototype.enableImageCrop=function(id){var element=this.getElementById(id);return element&&element.type===ElementTypes.IMAGE?this.canvas.crop(element):Promise.reject("No Image element with id "+id)},Page.prototype.disableImageCrop=function(){this.canvas._cancelImageCrop()},Page.prototype.isActiveImageCrop=function(id){return this.canvas.imageCrop&&this.canvas.imageCrop.image.id===id},Page.prototype.applyImageCrop=function(){if(!this.canvas.imageCrop)throw Error("No active ImageCrop available");this.canvas.onCrop()},Page.prototype.getCropSettings=function(){if(this.canvas.imageCrop)return this.canvas.imageCrop.getCropSettings();throw Error("No active ImageCrop available")},Page.prototype.setCropSettings=function(settings){if(!this.canvas.imageCrop)throw Error("No active ImageCrop available");this.canvas.imageCrop.setCropSettings(settings)},Page.prototype.enableImageAdjustments=function(id){var element=this.getElementById(id);return element&&element.type===ElementTypes.IMAGE?this.canvas.editImage(element):Promise.reject("No Image element with id "+id)},Page.prototype.disableImageAdjustments=function(){this.canvas._cancelImageEdit()},Page.prototype.isActiveImageAdjustments=function(id){return this.canvas.imageEdit&&this.canvas.imageEdit.image.id===id},Page.prototype.applyImageAdjustments=function(){if(!this.canvas.imageEdit)throw Error("No active ImageEdit available");this.canvas.onApplyAdjustments()},Page.prototype.getAdjustmentsSettings=function(){if(this.canvas.imageEdit)return this.canvas.imageEdit.getAdjustments();throw Error("No active ImageCrop available")},Page.prototype.setAdjustmentsSettings=function(settings){if(!this.canvas.imageEdit)throw Error("No active ImageCrop available");this.canvas.imageEdit.setAdjustments(settings)},Page.prototype.load=function(serialized){var _this8=this;if(this.pageId=serialized.pageId,this.isComponent=serialized.isComponent,this.shouldResetZoom()&&this.zoomReset(),serialized.page&&Object.keys(serialized.page).length>0){ElementsHelper.RemoveNonexistingElementsFromActions(serialized.page),ElementsHelper.RemoveInvalidActionsFromElements(serialized.page),_.forEach(serialized.components,function(component){ElementsHelper.RemoveNonexistingElementsFromActions(component)}),this.ElementsManager.addComponentsElements(serialized.components),this.ElementsManager.loadPageElements(LegacyMap.ParseElements(serialized.page)),this.canvas.initProperties(serialized.page[ElementsHelper.CANVAS_ID].props);var componentElements=_.reduce(serialized.components,function(elements,component){return elements.concat(_.values(component))},_.values(serialized.page));(0,_FontsManager.loadFontsFromElements)(componentElements).then(function(fonts){_this8.emit(Events.ELEMENTS_FONTS_LOADED,{fonts:fonts,showMissingFonts:!0}),_this8._updateTextElementsHeight(_this8.getAllElements())})}this.ElementsManager.setComponentMastersIds(serialized.components_master_ids),this.isPreviewMode()?(this.InteractionsManager.loadInteractions(this.getAllElements().concat(this.canvas)),this.triggerWindowLoad()):(HistoryManager.Load(this),TextEditor.UpdateInstances(this)),this.emit(Events.LOAD_FUNCTION_FINISHED)},Page.prototype.getBoundingBox=function(immediateUpdate){return immediateUpdate&&this.canvas._updateBoundingBox(),this.canvas.getBoundingBox()},Page.prototype.addComponentsElements=function(componentsElements){this.ElementsManager.addComponentsElements(componentsElements)},Page.prototype.getComponentById=function(componentId){return this.ElementsManager.getComponentById(componentId)},Page.prototype.getGridOptions=function(option){return"undefined"==typeof option?this.canvas.getAllGridOptions():this.canvas.getGridOption(option)},Page.prototype.updateGrid=function(options){this.canvas.setGridOptions(options)},Page.prototype.setGridOptions=function(options,recalculateGridColumns){this.updateGrid(options),this.canvas.shouldUpdateGridColumns&&recalculateGridColumns&&this.canvas.updateGridColumns(),this.emit(Events.GRID_UPDATE,this.canvas.getAllGridOptions())},Page.prototype.setGuides=function(guides){this.canvas.resetGuides(),setTimeout(function(){_.forEach(guides,function(guide){this.canvas.createGuide(guide.orientation,guide.x,guide.y)}.bind(this))}.bind(this),0)},Page.prototype.updateSize=function(){this.canvas.resized=!0},Page.prototype.clipGroup=function(element,value){element.isGroup()&&(this.ElementsManager.startBatch(),element.clipGroup(value),this.ElementsManager.endBatch(),this.canvas._select([element]))},Page.prototype.clear=function(){this.isDesignMode()&&(this.deselectAllElements(),this.exitMultistateEditMode(),this.exitComponentEditMode()),this.canvas.clear(),this.ElementsManager.clear()},Page.prototype.destroy=function(){this.restrictMode=RestrictModes.NONE,this.canvas.destroy(),this.ElementsManager.destroy(),this.InteractionsManager.destroy()},Page.prototype.setOffset=function(x,y,scrollX,scrollY){this.canvas.offsetPoint.x=x,this.canvas.offsetPoint.y=y,this.canvas.scrollOffset.x=scrollX||0,this.canvas.scrollOffset.y=scrollY||0,this.isDesignMode()||this._updateOffset(this.ElementsManager.getElements())},Page.prototype.showOverlay=function(){this.canvas.view.showOverlay()},Page.prototype.hideOverlay=function(){this.canvas.view.hideOverlay()},Page.prototype.showElementsOverlay=function(){this.canvas.view.showElementsOverlay()},Page.prototype.hideElementsOverlay=function(){this.canvas.view.hideElementsOverlay()},Page.prototype.canAddDeleteElements=function(){return this.restrictMode===RestrictModes.NONE},Page.prototype.canChangeElements=function(){return this.restrictMode!==RestrictModes.ALL},Page.prototype.setRestrictMode=function(mode){this.restrictMode=mode},Page.prototype.storeAndClearHistory=function(){HistoryManager.StoreAndClear()},Page.prototype.restoreHistory=function(){HistoryManager.Restore()},Page.prototype.clearHistory=function(){HistoryManager.Clear()},Page.prototype.emitSelection=function(elements){this.emit(Events.ELEMENTS_SELECTED,this.mapSelectedElements(elements))},Page.prototype.isPickMode=function(){return this.canvas.isPickMode()},Page.prototype.pickElementId=function(id){return this.canvas.pickElementId(id)},Page.prototype.startPickMode=function(validator,ignoreMultistateChildren,returnNullOnCanvas){var pickerConfig=this.currentMode.getPickerConfig(),extendedConfig={ignoreMultistateChildren:ignoreMultistateChildren,returnNullOnCanvas:returnNullOnCanvas};return extendedConfig=_.filter(extendedConfig,function(key,value){return!_.isEmpty(value)}),this.canvas.startPickMode(validator,_.extend(pickerConfig,extendedConfig))},Page.prototype.endPickMode=function(){return this.currentMode.getPickerConfig().onEndPickMode()},Page.prototype.exitMultistateEditMode=function(){this.canvas.setGroupEditable(!1)},Page.prototype.setMultistateEditMode=function(value,multistateId){this.emit(value?Events.MULTISTATE_ELEMENT_OPENED:Events.MULTISTATE_ELEMENT_CLOSED,multistateId)},Page.prototype.mapSelectedElements=function(elements){return _.some(elements)?1===elements.length&&_.first(elements).type===ElementTypes.IMAGE_CROP?[_.first(elements).image]:_.clone(elements):[this.canvas]},Page.prototype.triggerWindowLoad=function(){this.InteractionsManager.hasOnPageLoadInteractions()&&this.canvas.onUpdate(),this.InteractionsManager.interactWithElement(this.canvas.id,null,InteractionTriggers.WINDOW_LOAD)},Page.prototype.triggerKeyDown=function(e){this.InteractionsManager.interactWithElement(this.canvas.id,null,InteractionTriggers.WINDOW_KEYDOWN,e)},Page.prototype.triggerScroll=function(e){this.interactWithElementThrottled(this.canvas.id,null,InteractionTriggers.WINDOW_SCROLL,e)},Page.prototype.detectVideoServiceByUrl=function(url){return VideoHelper.detectServiceByUrl(url)},Page.prototype.isComponentInSelection=function(){return ElementsHelper.ContainsComponent(this.canvas.selectedElements)},Page.prototype.isComponentEditMode=function(){return this.isComponent||!!this.ElementsManager.getEditingComponent()},Page.prototype.isTableEditMode=function(){return!(!this.canvas.editingMultipart||this.canvas.editingMultipart.type!==ElementTypes.TABLE)},Page.prototype.canMoveRowsUp=function(){return this.isTableEditMode()&&this.canvas.editingMultipart.canMoveRows(-1)},Page.prototype.canMoveRowsDown=function(){return this.isTableEditMode()&&this.canvas.editingMultipart.canMoveRows(1)},Page.prototype.canMoveColsLeft=function(){return this.isTableEditMode()&&this.canvas.editingMultipart.canMoveCols(-1)},Page.prototype.canMoveColsRight=function(){return this.isTableEditMode()&&this.canvas.editingMultipart.canMoveCols(1)},Page.prototype.canDeleteCols=function(){return this.isTableEditMode()&&this.canvas.editingMultipart.canDeleteCols()},Page.prototype.canDeleteRows=function(){return this.isTableEditMode()&&this.canvas.editingMultipart.canDeleteRows()},Page.prototype.moveRowsUp=function(){this.isTableEditMode()&&(this.canvas.editingMultipart.selectionMoveRows(-1),this.canvas.deselectMultipartSelection())},Page.prototype.moveRowsDown=function(){this.isTableEditMode()&&(this.canvas.editingMultipart.selectionMoveRows(1),this.canvas.deselectMultipartSelection())},Page.prototype.moveColsLeft=function(){this.isTableEditMode()&&(this.canvas.editingMultipart.selectionMoveCols(-1),this.canvas.deselectMultipartSelection())},Page.prototype.moveColsRight=function(){this.isTableEditMode()&&(this.canvas.editingMultipart.selectionMoveCols(1),this.canvas.deselectMultipartSelection())},Page.prototype.insertRowBefore=function(){this.isTableEditMode()&&this.canvas.editingMultipart.selectionInsertRow(-1)},Page.prototype.insertRowAfter=function(){this.isTableEditMode()&&this.canvas.editingMultipart.selectionInsertRow(1)},Page.prototype.insertColBefore=function(){this.isTableEditMode()&&this.canvas.editingMultipart.selectionInsertCol(-1)},Page.prototype.insertColAfter=function(){this.isTableEditMode()&&this.canvas.editingMultipart.selectionInsertCol(1)},Page.prototype.deleteRows=function(){this.isTableEditMode()&&(this.canvas.editingMultipart.selectionDeleteRows(),this.canvas.deselectMultipartSelection())},Page.prototype.deleteCols=function(){this.isTableEditMode()&&(this.canvas.editingMultipart.selectionDeleteCols(),this.canvas.deselectMultipartSelection())},Page.prototype.distributeColumnsEvenly=function(){this.isTableEditMode()&&this.canvas.editingMultipart.distributeColumnsEvenly()},Page.prototype.exitComponentEditMode=function(){this.ElementsManager.getEditingComponent()&&this.canvas.finishEditingComponent()},Page.prototype.createGhostElement=function(type,properties){var serializedElements;return properties&&properties.init_elements?(serializedElements=JSON.parse(properties.init_elements),this.ElementsManager.renderMultiElementGhost(serializedElements)):(properties=LegacyMap.ParseElementProps(properties,type),type=LegacyMap.MapType(type),this.ElementsManager.createGhostElement(type,properties))},Page.prototype.renderGhostElement=function(type,properties){var serializedElements;return properties&&properties.init_elements?(serializedElements=JSON.parse(properties.init_elements),this.ElementsManager.renderMultiElementGhost(serializedElements)):(properties=LegacyMap.ParseElementProps(properties,type),type=LegacyMap.MapType(type),this.ElementsManager.renderGhostElement(type,properties))},Page.prototype.getCanvasTopLeftCorner=function(){var topLeftCorner={},workbenchCoordinates=this.canvas.view.workbenchDomElement.getBoundingClientRect(),canvasCoordinates=this.canvas.view.domElement.getBoundingClientRect();return topLeftCorner.x=workbenchCoordinates.left-canvasCoordinates.left,topLeftCorner.y=workbenchCoordinates.top-canvasCoordinates.top,topLeftCorner},Page.prototype.getElementsSortedFromRoot=function(rootElement){return ElementsHelper.GetElementsSortedFromRoot(rootElement)},Page.prototype.getAllElementDescendants=function(element){return ElementsHelper.GetAllElementDescendants(element)},Page.prototype.setTypekitFontsPromise=function(typekitKitFontsPromise){var shouldNotUpdateTypekitFonts=!this._typekitFontsPromise;this._typekitFontsPromise=typekitKitFontsPromise,shouldNotUpdateTypekitFonts||(0,_FontsManager.loadTypekitFontsFromElements)([].concat(_toConsumableArray(_.values(this.ElementsManager.elements)),_toConsumableArray(_.reduce(this.ElementsManager.components,function(all,elements){return[].concat(_toConsumableArray(elements),_toConsumableArray(_.values(elements)))},[]))))},Page.prototype.getTypekitKitFonts=function(){return this._typekitFontsPromise},Page.prototype.updateFont=function(font){(0,_FontsManager.updateFont)(font)},Page.prototype.updateTypekitKit=function(data){(0,_TypekitLoader.init)({kit:data},this)},Page.prototype.updateRadioElementsCheckedState=function(id,formGroupName){_.forEach(this.ElementsManager.getRadioElementsByFormGroupName(formGroupName),function(radioElement){radioElement.uncheckRadioInFormGroup(id)}.bind(this))},Page.prototype.updateRelativeRectangle=function(){this.canvas.updateRelativeRectangle()},Page.prototype._updateTextElementsHeight=function(elements){var _this9=this;_.forEach(elements,function(element){element.type===ElementTypes.TEXT_ELEMENT&&(element.shouldUpdateHeight=!0),element.type===ElementTypes.COMPONENT&&_this9._updateTextElementsHeight(element.getElements())})},Page.prototype._updateElementOffset=function(element,canvasContainer){var _this10=this;element.setFixedOffset(this.canvas.offsetPoint),element.rect.updateScrollOffset({x:this.canvas.scrollOffset.x+canvasContainer.scrollLeft||0,y:this.canvas.scrollOffset.y+canvasContainer.scrollTop||0}),_.forEach(element.linkedElements,function(linkedElement){linkedElement.fixed&&_this10._updateElementOffset(linkedElement,canvasContainer)})},Page.prototype._updateOffset=function(elements){_.forEach(elements,function(element){if(element.fixed&&ElementsHelper.canBeFixed(element)||ElementsHelper.isAncestorFixed(element)){var canvasContainer=this.canvas.getContainerDomElement();this._updateElementOffset(element,canvasContainer),element.highlight&&element.highlight.fixed&&this._updateElementOffset(element.highlight,canvasContainer)}element.isComponent()&&this._updateOffset(element.getElements())}.bind(this))},Page.prototype.getProjectId=function(){return this.options.projectId},Page.prototype.setDrawElementDefinition=function(drawElementDefinition,config){this.MODE===PageModes.DRAW&&this.currentMode.setDrawElementDefinition(drawElementDefinition,config)},Page.prototype.setComponentMaster=function(componentId,masterId){this.ElementsManager.setComponentMaster(componentId,masterId)},Page.prototype.getCDNUrl=function(url){return CDNHelper.GetCdnUrl(url)},Page}()},{"./ElementsManager.js":163,"./LegacyMap.js":164,"./elements/helpers/ElementsHelper.js":250,"./elements/helpers/SelectionHelper.js":256,"./elements/helpers/TextEditor.js":260,"./elements/helpers/TextStyleHelper.js":261,"./elements/helpers/VideoHelper":262,"./enums/ElementTypes.js":346,"./enums/Events.js":347,"./enums/InteractionTriggers.js":351,"./enums/PageModes.js":357,"./enums/Properties.js":358,"./enums/RestrictModes.js":359,"./fonts/FontsLoader":364,"./fonts/FontsManager":365,"./fonts/TypekitLoader":367,"./history/HistoryManager.js":370,"./interactions/InteractionsManager.js":380,"./mode/factory":389,"./utils/CDNHelper.js":406,"./utils/Collaboration.js":408,"event-emitter":98,lodash:161}],166:[function(_dereq_,module,exports){"use strict";function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var _=_dereq_("lodash"),Base=_dereq_("../utils/Base.js"),Calc=_dereq_("../utils/Calc.js"),CDNHelper=_dereq_("../utils/CDNHelper.js"),Annotable=_dereq_("./behaviors/Annotable.js"),Customizable=_dereq_("./behaviors/Customizable.js"),ElementsHelper=_dereq_("./helpers/ElementsHelper.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),Events=_dereq_("../enums/Events.js"),FrameworkElement=_dereq_("./FrameworkElement.js"),Indicative=_dereq_("./behaviors/Indicative.js"),Interactable=_dereq_("./behaviors/Interactable.js"),Linkable=_dereq_("./behaviors/Linkable.js"),PageModes=_dereq_("../enums/PageModes"),Parse=_dereq_("../utils/Parse.js"),Properties=_dereq_("../enums/Properties.js"),Rectangle=_dereq_("../primitives/Rectangle.js"),Specable=_dereq_("./behaviors/Specable");module.exports=function(){function getHighlight(page){var Highlight=_dereq_("./ui/Highlight.js");return new Highlight(null,page)}function AbstractElement(id,Page){var _this=this;FrameworkElement.call(this),this.id=id,this.Page=Page,this.type=ElementTypes.ABSTRACT_ELEMENT,this.view=null,this.parent=null,this.highlight=null,this._rect=new Rectangle,this._dirty=!1,this._name=null,this._anchorX=null,this._anchorY=null,this._opacity=null,this._shouldUpdateFixed=!1,this._shouldUpdateScrollOffset=!1,this.onParentReorderRef=this._onParentReorder.bind(this),this.Page.on(Events.MODE_CHANGE,function(prevMode,currentMode){_this.view.domElement&&(currentMode===PageModes.PREVIEW?_this.view.domElement.style.pointerEvents="all":_this.view.domElement.style.removeProperty("pointerEvents"))})}var MIN_VISIBLE_OPACITY=5,higherPriorityProperties=[Properties.CUSTOM_STYLES];return AbstractElement.DefaultProperties={name:{value:""},width:{value:300,min:1,max:1e4},height:{value:100,min:1,max:1e4},keepRatio:{value:!1},angle:{value:0},x:{value:0,min:-1e4,max:1e4},y:{value:0,min:-1e4,max:1e4},opacity:{value:100,min:0,max:100},anchorX:{value:0,min:0,max:1},anchorY:{value:0,min:0,max:1},locked:{value:0},stateIa:{value:"visible"},fixed:{value:0},metadata:[]},Base.Extend(AbstractElement,FrameworkElement),Base.ApplyBehavior(AbstractElement,Linkable),Base.ApplyBehavior(AbstractElement,Indicative),Base.ApplyBehavior(AbstractElement,Interactable),Base.ApplyBehavior(AbstractElement,Specable),Base.ApplyBehavior(AbstractElement,Customizable),Base.ApplyBehavior(AbstractElement,Annotable),Object.defineProperties(AbstractElement.prototype,{name:{get:function(){return this._name},set:function(value){this._saveProperty(),this._name=value}},dirty:{get:function(){return this._dirty},set:function(value){this._dirty=value,this.parent&&(this.parent.dirty=value)}},rect:{get:function(){return this._rect}},width:{get:function(){return this.rect.width},set:function(value){null===value&&(value=1),_.forEach(this._calculateWidthRelatedProperties(value,this.x,this.y),function(relatedValue,property){this[property]=relatedValue}.bind(this)),this._saveProperty(),this.rect.width=value,this.dirty=!0,this.dirtyPosition=!0}},height:{get:function(){return this.rect.height},set:function(value){null===value&&(value=1),_.forEach(this._calculateHeightRelatedProperties(value,this.x,this.y),function(relatedValue,property){this[property]=relatedValue}.bind(this)),this._saveProperty(),this.rect.height=value,this.dirty=!0,this.dirtyPosition=!0}},aspectRatio:{get:function(){return this.rect.aspectRatio}},keepRatio:{get:function(){return this._keepRatio},set:function(value){this._saveProperty(),this._keepRatio=value}},angle:{get:function(){return this.rect.angle},set:function(value){this._saveProperty(),this.rect.angle=Parse.roundAngle(value),this.x=this.rect.x,this.y=this.rect.y,this.dirty=!0,this.dirtyPosition=!0}},x:{get:function(){return this.rect.x},set:function(value){null===value&&(value=0),this._saveProperty(),this.rect.x=value,this.dirty=!0,this.dirtyPosition=!0}},y:{get:function(){return this.rect.y},set:function(value){null===value&&(value=0),this._saveProperty(),this.rect.y=value,this.dirty=!0,this.dirtyPosition=!0}},opacity:{get:function(){return this._opacity},set:function(value){this._saveProperty(),this._opacity=value,this.view.setOpacity(value/100)}},anchorX:{get:function(){return this._anchorX},set:function(value){this._saveProperty(Properties.ANCHOR_X),this._anchorX=value}},anchorY:{get:function(){return this._anchorY},set:function(value){this._saveProperty(Properties.ANCHOR_Y),this._anchorY=value}},locked:{get:function(){return this._locked},set:function(value){this._saveProperty(),this._locked=value}},stateIa:{get:function(){return this._stateIa},set:function(value){this._saveProperty(),this._stateIa=value,this.view.setVisibility("visible"===value),this.shouldUpdateFixedIcon=!0,this.shouldUpdateInteractiveIcon=!0}},fixed:{get:function(){return this._fixed},set:function(value){this._saveProperty(),this._fixed=value?1:0,this.Page.isDesignMode()?this.shouldUpdateFixedIcon=!0:value&&(this._shouldUpdateFixed=!0)}},shouldUpdateScrollOffset:{get:function(){return this._shouldUpdateScrollOffset},set:function(value){this._shouldUpdateScrollOffset=value,value&&(this.dirty=value)}},componentInstance:{get:function(){return this._componentInstance},set:function(value){this._componentInstance=value}},dirtyOrder:{get:function(){return this._drityOrder},set:function(value){this._drityOrder=value}},isTransformationDisabled:{get:function(){return this._isTransformationDisabled}},metadata:{get:function(){return _.cloneDeep(this._metadata)},set:function(value){this._saveProperty(),this._metadata=value}}}),AbstractElement.prototype._calculateWidthRelatedProperties=function(value,x,y){var delta,rad,related={};return this.anchorX&&(delta=this.anchorX*(value-this.width),this.angle?(rad=Calc.DegToRad(this.angle),related.x=x-delta*Math.cos(rad),related.y=y-delta*Math.sin(rad)):related.x=x-delta),related},AbstractElement.prototype._calculateHeightRelatedProperties=function(value,x,y){var delta,rad,related={};return this.anchorY&&(delta=this.anchorY*(value-this.height),this.angle?(rad=Calc.DegToRad(this.angle)+Math.PI/2,related.x=x-delta*Math.cos(rad),related.y=y-delta*Math.sin(rad)):related.y=y-delta),related},AbstractElement.prototype.createView=function(ViewClass){return new ViewClass(this.id,this.Page.MODE)},AbstractElement.prototype.setParent=function(parent){this.parent&&this.parent.off(Events.GROUP_REORDER,this.onParentReorderRef),this.parent=parent,this.parent&&this.parent.on(Events.GROUP_REORDER,this.onParentReorderRef)},AbstractElement.prototype.update=function(){if(this._shouldUpdateFixed&&(this._shouldUpdateFixed=!1,ElementsHelper.canBeFixed(this)&&(this.view.setFixed(this.fixed),this.setFixedOffset(this.Page.canvas.offsetPoint))),this._shouldUpdateScrollOffset){var scrollOffset=this._getGroupScrollValues(this.parent);this.rect.updateScrollOffset(scrollOffset),this._shouldUpdateScrollOffset=!1}this.updateIndicators(),this.updateLinkedElements(),this.view.updateTransform(this)},AbstractElement.prototype.resizeFromPoint=function(scaleX,scaleY,point){this._saveProperty(),this.rect.resizeFromPoint(scaleX,scaleY,point),this.dirtyPosition=!0,this.dirty=!0},AbstractElement.prototype.absoluteResizeFromPoint=function(width,height,point){this._saveProperty(),this.rect.absoluteResizeFromPoint(width,height,point),this.dirtyPosition=!0,this.dirty=!0},AbstractElement.prototype.rotateByFromPoint=function(point,angle){this._saveProperty(),this.rect.rotateBy(point,angle),this.dirty=!0},AbstractElement.prototype.getBoundingBox=function(projected){return this.rect.getBoundingBox(projected)},AbstractElement.prototype.hitTest=function(p,disableCollaborationCheck){return this.isVisible()&&(disableCollaborationCheck||!this.isEditByCollaborator())&&this.rect.hitTest(p)?this:null},AbstractElement.prototype._getGroupScrollValues=function(group,initialOffset){var offset={x:initialOffset&&initialOffset.x||0,y:initialOffset&&initialOffset.y||0};return this.parent&&(offset.y-=group.getDomElement().scrollTop,offset.x-=group.getDomElement().scrollLeft),group.parent?this._getGroupScrollValues(group.parent,offset):offset},AbstractElement.prototype.isVisible=function(){return"visible"===this.stateIa},AbstractElement.prototype.isEditByCollaborator=function(){return this.Page.collaboration.isElementEditing(this.id)},AbstractElement.prototype.isUnlocked=function(){return!this.locked},AbstractElement.prototype.isSelectable=function(){return"visible"===this.stateIa},AbstractElement.prototype.setVisibility=function(value){var visibility=value?"visible":"hidden";this.stateIa=visibility},AbstractElement.prototype.isSelected=function(){return this.Page.getSelectedElement()===this},AbstractElement.prototype.setFixedOffset=function(point){ElementsHelper.isAncestorFixed(this)||this.view.setFixedOffset(point)},AbstractElement.prototype.isGroup=function(){return!1},AbstractElement.prototype.isMultistate=function(){return!1},AbstractElement.prototype.isComponent=function(){return!1},AbstractElement.prototype.isVirtualGroup=function(){return!1},AbstractElement.prototype.isCanvas=function(){return!1},AbstractElement.prototype.isTextEditable=function(){return!1},AbstractElement.prototype.isTextStyleable=function(){return!1},AbstractElement.prototype.isRichTextEditable=function(){return!1},AbstractElement.prototype.isTextInput=function(){return!1},AbstractElement.prototype.isMultipart=function(){return!1},AbstractElement.prototype.isUploadable=function(){return!1},AbstractElement.prototype.isKeepRatioDisabled=function(){return!1},AbstractElement.prototype.adjustHeightToText=function(){return!1},AbstractElement.prototype.isFixable=function(){return ElementsHelper.canBeFixed(this)},AbstractElement.prototype.isDrawable=function(){return!0},AbstractElement.prototype.getFixedChildren=function(){return ElementsHelper.getFixedChildren(this)},AbstractElement.prototype.getUnfixableParentElement=function(){return ElementsHelper.getUnfixableParentElement(this)},AbstractElement.prototype.containsRotatedElement=function(){return!!this.angle},AbstractElement.prototype.initProperties=function(props){this._initSetOfProperties(_.omit(this.DefaultProperties,higherPriorityProperties),props),this._initSetOfProperties(_.pick(this.DefaultProperties,higherPriorityProperties),props)},AbstractElement.prototype._initSetOfProperties=function(set,props){_.forEach(set,function(propValue,propName){this._isPropertySerializable(propName)&&(this[propName]="undefined"!=typeof props[propName]?props[propName]:propValue.value);
}.bind(this))},AbstractElement.prototype.getProperties=function(){return this.DefaultProperties},AbstractElement.prototype.getLayerChildren=function(){return this.children},AbstractElement.prototype.hasProperty=function(property){return this.getProperties().hasOwnProperty(property)},AbstractElement.prototype.highlightSelect=function(value,useBoundingBox){if(value){if(this.highlight)return;this.highlight=getHighlight(this.Page),this.addLinkedElement(this.highlight),this.highlight.link(this,useBoundingBox),this.Page.canvas.view.domElement.appendChild(this.highlight.view.domElement)}else this.highlight&&(this.Page.canvas.view.domElement.removeChild(this.highlight.view.domElement),this.highlight.unlink(this),this.removeLinkedElement(this.highlight),this.highlight=null)},AbstractElement.prototype.select=function(){this.isVisible()||(this.shouldUpdateFixedIcon=!0,this.shouldUpdateInteractiveIcon=!0)},AbstractElement.prototype.deselect=function(){this.isVisible()||(this.shouldUpdateFixedIcon=!0,this.shouldUpdateInteractiveIcon=!0),this.highlightSelect(!1)},AbstractElement.prototype.tintView=function(value){this.view.setOpacity(value?.1:this.opacity/100)},AbstractElement.prototype.clone=function(props){return this.Page.ElementsManager.duplicateElement(this,props)},AbstractElement.prototype.getPropsForSerialize=function(){return _.mapValues(this.DefaultProperties,function(propValue,propName){return _.cloneDeep(this[propName])}.bind(this))},AbstractElement.prototype.isTransparent=function(){return Properties.OPACITY in this&&this.opacity<MIN_VISIBLE_OPACITY},AbstractElement.prototype.serialize=function(){var serialized={};return serialized.id=this.id,serialized.type=this.type,serialized.props=this.getPropsForSerialize(),serialized.v="2.0",serialized},AbstractElement.prototype.updateProperty=function(property,value){return value=this.validateProperty(property,value),this.Page.ElementsManager.startBatch(),this._updateProperty(property,value,!0),this.Page.ElementsManager.endBatch(),value},AbstractElement.prototype.validateProperty=function(property,value){var propDefinition=this.DefaultProperties[property];return propDefinition?propDefinition.hasOwnProperty("min")&&value<propDefinition.min?value=propDefinition.min:propDefinition.hasOwnProperty("max")&&value>propDefinition.max?value=propDefinition.max:propDefinition.hasOwnProperty("options")&&propDefinition.options.indexOf(value)===-1&&(value=propDefinition.value):value=!1,value},AbstractElement.prototype.validateProperties=function(properties){return _.mapValues(properties,function(value,property){return this.validateProperty(property,value)}.bind(this))},AbstractElement.prototype.getDomElement=function(){return this.view.domElement},AbstractElement.prototype.destroyDomElement=function(){this.view.destroyDomElement()},AbstractElement.prototype.getDomFocusableElement=function(){return this.view.getDomFocusableElement()},AbstractElement.prototype.isKeepRatioDisabled=function(){return!1},AbstractElement.prototype.getScale=function(){for(var scale={x:1,y:1},element=this.parent;element;)element.isComponent()&&(scale.x*=element.scaleX,scale.y*=element.scaleY),element=element.parent;return scale},AbstractElement.prototype._saveProperty=function(property,value){this.Page.ElementsManager.save(this,property,value)},AbstractElement.prototype._updateProperty=function(property,value,addToHistory){this.Page.ElementsManager.update(this,property,value,addToHistory)},AbstractElement.prototype._isPropertySerializable=function(property){return!this.ExcludedProperties.hasOwnProperty(property)||("function"==typeof this.ExcludedProperties[property]?!this.ExcludedProperties[property].call(this):!this.ExcludedProperties[property])},AbstractElement.prototype._getGroupRotation=function(){for(var element=this.parent,angle=0;element;){if(element.isGroup()&&element.isClip||element.Page.isPreviewMode()&&element.isMultistate()){angle=element.angle;break}element=element.parent}return"rotate("+-angle+"deg)"},AbstractElement.prototype._getGroupTranslates=function(){for(var bb,translates=[],element=this.parent;element;){if(element.isGroup()&&element.isClip){bb=element.getBoundingBox(),translates.push("translate("+-bb.x+"px ,"+-bb.y+"px)");break}if((element.Page.isPreviewMode()||element.Page.isSpecMode())&&element.isMultistate()){bb=element.isInAnimatingState(this)?element.getStateBoundingBox(this):element.getBoundingBox(),translates.push("translate("+-bb.x+"px ,"+-bb.y+"px)");break}element=element.parent}return translates.join(" ")},AbstractElement.prototype._onParentReorder=function(){this.dirtyOrder=!0,this.updateLinkedElements()},AbstractElement.prototype._getCdnUrl=function(url){return CDNHelper.GetCdnUrl(url)},AbstractElement.prototype._disableTransformation=function(){this._isTransformationDisabled=!0},AbstractElement.prototype._enableTransformation=function(){this._isTransformationDisabled=!1},AbstractElement.prototype.getPropertiesMinMax=function(properties){var props=this.getProperties();return _.reduce(properties,function(minMax,property){return Object.assign({},minMax,_defineProperty({},property,{min:props[property].min||1,max:props[property].max||1/0}))},{})},AbstractElement}()},{"../enums/ElementTypes.js":346,"../enums/Events.js":347,"../enums/PageModes":357,"../enums/Properties.js":358,"../primitives/Rectangle.js":404,"../utils/Base.js":405,"../utils/CDNHelper.js":406,"../utils/Calc.js":407,"../utils/Parse.js":415,"./FrameworkElement.js":182,"./behaviors/Annotable.js":223,"./behaviors/Customizable.js":225,"./behaviors/Indicative.js":228,"./behaviors/Interactable.js":229,"./behaviors/Linkable.js":230,"./behaviors/Specable":237,"./helpers/ElementsHelper.js":250,"./ui/Highlight.js":272,lodash:161}],167:[function(_dereq_,module,exports){"use strict";var GroupingInstance=_dereq_("./GroupingInstance.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),Base=_dereq_("../utils/Base.js");module.exports=function(){function AndroidGear(){GroupingInstance.apply(this,arguments),this.type=ElementTypes.ANDROID_GEAR}return Base.Extend(AndroidGear,GroupingInstance),AndroidGear}()},{"../enums/ElementTypes.js":346,"../utils/Base.js":405,"./GroupingInstance.js":186}],168:[function(_dereq_,module,exports){"use strict";var SvgIcon=_dereq_("./SvgIcon.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),Base=_dereq_("../utils/Base.js");module.exports=function(){function AndroidIcon(){SvgIcon.apply(this,arguments),this.type=ElementTypes.ANDROID_ICON}return Base.Extend(AndroidIcon,SvgIcon),AndroidIcon}()},{"../enums/ElementTypes.js":346,"../utils/Base.js":405,"./SvgIcon.js":210}],169:[function(_dereq_,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _Color=_dereq_("../utils/Color.js"),_Color2=_interopRequireDefault(_Color),AbstractElement=_dereq_("./AbstractElement.js"),ArrowView=_dereq_("./views/ArrowView.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),Properties=_dereq_("../enums/Properties.js");module.exports=function(){function Arrow(){AbstractElement.apply(this,arguments),this.type=ElementTypes.ARROW,this.view=this.createView(ArrowView),this._shouldUpdateSvgPath=!1}return Arrow.HORIZONTAL="horizontal",Arrow.VERTICAL="vertical",Arrow.CURVE_NONE="0",Arrow.CURVE_UPPER="1",Arrow.CURVE_LOWER="2",Arrow.MARK_NONE="0",Arrow.MARK_ARROW="1",Arrow.DefaultProperties={width:{value:200},height:{value:100},color:{value:"#D9D9D9"},arrowOrientation:{value:Arrow.HORIZONTAL,options:[Arrow.HORIZONTAL,Arrow.VERTICAL]},arrowCurve:{value:Arrow.CURVE_LOWER,options:[Arrow.CURVE_NONE,Arrow.CURVE_UPPER,Arrow.CURVE_LOWER]},arrowStartMarker:{value:Arrow.MARK_NONE,options:[Arrow.MARK_NONE,Arrow.MARK_ARROW]},arrowEndMarker:{value:Arrow.MARK_ARROW,options:[Arrow.MARK_NONE,Arrow.MARK_ARROW]},stroke:{value:3,min:1,max:100}},Base.Extend(Arrow,AbstractElement),Object.defineProperties(Arrow.prototype,{shouldUpdateSvgPath:{get:function(){return this._shouldUpdateSvgPath},set:function(value){this._shouldUpdateSvgPath=value,value&&(this.dirty=value)}},width:{get:function(){return Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.WIDTH).get.call(this)},set:function(value){Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.WIDTH).set.call(this,value),this.shouldUpdateSvgPath=!0}},height:{get:function(){return Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.HEIGHT).get.call(this)},set:function(value){Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.HEIGHT).set.call(this,value),this.shouldUpdateSvgPath=!0}},color:{get:function(){return this._color},set:function(value){this._saveProperty(),this._color=value,this.view.setColor(value)}},stroke:{get:function(){return this._stroke},set:function(value){this._saveProperty(),this._stroke=value,this.shouldUpdateSvgPath=!0}},arrowOrientation:{get:function(){return this._arrowOrientation},set:function(value){this._saveProperty(),this._arrowOrientation=value,this.shouldUpdateSvgPath=!0}},arrowCurve:{get:function(){return this._arrowCurve},set:function(value){value=value.toString(),this._saveProperty(),this._arrowCurve=value,this.shouldUpdateSvgPath=!0}},arrowStartMarker:{get:function(){return this._arrowStartMarker},set:function(value){value=value.toString(),this._saveProperty(),this._arrowStartMarker=value,this.view.toggleArrowStartMarker(value===Arrow.MARK_ARROW)}},arrowEndMarker:{get:function(){return this._arrowEndMarker},set:function(value){value=value.toString(),this._saveProperty(),this._arrowEndMarker=value,this.view.toggleArrowEndMarker(value===Arrow.MARK_ARROW)}}}),Arrow.prototype.isHorizontal=function(){return this.arrowOrientation===Arrow.HORIZONTAL},Arrow.prototype.isVertical=function(){return this.arrowOrientation===Arrow.VERTICAL},Arrow.prototype.isNoCurve=function(){return this.arrowCurve===Arrow.CURVE_NONE},Arrow.prototype.isUpperCurve=function(){return this.arrowCurve===Arrow.CURVE_UPPER},Arrow.prototype.isLowerCurve=function(){return this.arrowCurve===Arrow.CURVE_LOWER},Arrow.prototype.update=function(){this.shouldUpdateSvgPath&&(this.view.updateSvgPath(this),this.shouldUpdateSvgPath=!1),AbstractElement.prototype.update.call(this)},Arrow.prototype.resizeFromPoint=function(){this.shouldUpdateSvgPath=!0,AbstractElement.prototype.resizeFromPoint.apply(this,arguments)},Arrow.prototype.getFillColor=function(){return _Color2.default.getColorsSet(this[Properties.COLOR])},Arrow}()},{"../enums/ElementTypes.js":346,"../enums/Properties.js":358,"../utils/Base.js":405,"../utils/Color.js":409,"./AbstractElement.js":166,"./views/ArrowView.js":303}],170:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("./AbstractElement.js"),BannerView=_dereq_("./views/BannerView.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js");module.exports=function(){function Banner(){AbstractElement.apply(this,arguments),this.type=ElementTypes.BANNER,this.view=this.createView(BannerView)}return Banner.DefaultProperties={backgroundImage:{value:""},clickIdPage:{value:""}},Base.Extend(Banner,AbstractElement),Object.defineProperties(Banner.prototype,{backgroundImage:{get:function(){return this._backgroundImage},set:function(value){this._saveProperty(),this._backgroundImage=value,this.view.setBackgroundImage(value)}}}),Banner}()},{"../enums/ElementTypes.js":346,"../utils/Base.js":405,"./AbstractElement.js":166,"./views/BannerView.js":304}],171:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("./AbstractElement.js"),TextEditable=_dereq_("./behaviors/TextEditable.js"),Boxable=_dereq_("./behaviors/Boxable.js"),Uploadable=_dereq_("./behaviors/Uploadable.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),BoxView=_dereq_("./views/BoxView.js");module.exports=function(){function Box(){AbstractElement.apply(this,arguments),this.type=ElementTypes.BOX,this.view=this.createView(BoxView)}return Box.DefaultProperties={paddingTop:{value:0},paddingRight:{value:0},paddingBottom:{value:0},paddingLeft:{value:0},paddingLock:{value:!0}},Base.Extend(Box,AbstractElement),Base.ApplyBehavior(Box,TextEditable),Base.ApplyBehavior(Box,Boxable),Base.ApplyBehavior(Box,Uploadable),Object.defineProperties(Box.prototype,{paddingTop:{get:function(){return this._paddingTop},set:function(value){this._saveProperty(),this._paddingTop=value,this.view.setPaddingTop(value)}},paddingRight:{get:function(){return this._paddingRight},set:function(value){this._saveProperty(),this._paddingRight=value,this.view.setPaddingRight(value)}},paddingBottom:{get:function(){return this._paddingBottom},set:function(value){this._saveProperty(),this._paddingBottom=value,this.view.setPaddingBottom(value)}},paddingLeft:{get:function(){return this._paddingLeft},set:function(value){this._saveProperty(),this._paddingLeft=value,this.view.setPaddingLeft(value)}},paddingLock:{get:function(){return this._paddingLock},set:function(value){this._saveProperty(),this._paddingLock=value}}}),Box.prototype.deselect=function(){this.view.setInputValue(this.inputValue),TextEditable.prototype.deselect.apply(this,arguments)},Box}()},{"../enums/ElementTypes.js":346,"../utils/Base.js":405,"./AbstractElement.js":166,"./behaviors/Boxable.js":224,"./behaviors/TextEditable.js":238,"./behaviors/Uploadable.js":240,"./views/BoxView.js":305}],172:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("./AbstractElement.js"),Boxable=_dereq_("./behaviors/Boxable.js"),SimpleTextEditable=_dereq_("./behaviors/SimpleTextEditable.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),ButtonView=_dereq_("./views/ButtonView.js");module.exports=function(){function Button(){AbstractElement.apply(this,arguments),this.type=ElementTypes.BUTTON,this.view=this.createView(ButtonView)}return Button.DefaultProperties={width:{value:120},height:{value:30},inputValue:{value:"Search"},shadowEnabled:{value:!1},boxShadow:{value:""},state:{value:"active"},borderLock:{value:!0},radiusLock:{value:!0},borderColor:{value:"#DDDDDD"},backgroundColor:{value:"#3498db"},backgroundColorGradient:{value:0},color:{value:"#FFFFFF"},fontWeight:{value:"bold"},paddingTop:{value:6},paddingBottom:{value:6},paddingLeft:{value:10},paddingRight:{value:10}},Base.Extend(Button,AbstractElement),Base.ApplyBehavior(Button,Boxable),Base.ApplyBehavior(Button,SimpleTextEditable),Object.defineProperties(Button.prototype,{backgroundColorGradient:{get:function(){return this._backgroundColorGradient},set:function(value){this._saveProperty(),this._backgroundColorGradient=value,this.view.setBackgroundColorGradient(value?this.backgroundColor:null)}},boxShadow:{get:function(){return this._boxShadow},set:function(value){this._saveProperty(),this._boxShadow=value,this.view.setBoxShadow(value)}},shadowEnabled:{get:function(){return this._shadowEnabled},set:function(value){this._saveProperty(),this._shadowEnabled=value}},opacity:{get:function(){return this._opacity},set:function(value){this._saveProperty(),this._opacity=value,this.view.setOpacity(value/100,this.state)}},state:{get:function(){return this._state},set:function(value){this._saveProperty(),this._state=value,this.view.setState(value,this.opacity/100)}},paddingTop:{get:function(){return this._paddingTop},set:function(value){this._saveProperty(),this._paddingTop=value,this.view.setPaddingTop(value)}},paddingRight:{get:function(){return this._paddingRight},set:function(value){this._saveProperty(),this._paddingRight=value,this.view.setPaddingRight(value)}},paddingBottom:{get:function(){return this._paddingBottom},set:function(value){this._saveProperty(),this._paddingBottom=value,this.view.setPaddingBottom(value)}},paddingLeft:{get:function(){return this._paddingLeft},set:function(value){this._saveProperty(),this._paddingLeft=value,this.view.setPaddingLeft(value)}}}),Button.prototype.getTextContent=function(){return(this.inputValue||"").replace(/<br\s*[\/]?>/gi,"\n").trim()},Button.prototype.tintView=function(value){this.view.setOpacity(value?.1:this.opacity/100,this.state)},Button}()},{"../enums/ElementTypes.js":346,"../utils/Base.js":405,"./AbstractElement.js":166,"./behaviors/Boxable.js":224,"./behaviors/SimpleTextEditable.js":236,"./views/ButtonView.js":306}],173:[function(_dereq_,module,exports){"use strict";function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}return Array.from(arr)}var _=_dereq_("lodash"),AlignHelper=_dereq_("./helpers/AlignHelper.js"),ArrangeHelper=_dereq_("./helpers/ArrangeHelper.js"),Base=_dereq_("../utils/Base.js"),CanvasView=_dereq_("./views/CanvasView.js"),ClipboardHelper=_dereq_("./helpers/ClipboardHelper.js"),Collaborator=_dereq_("./ui/Collaborator.js"),Color=_dereq_("../utils/Color.js"),ElementsHelper=_dereq_("./helpers/ElementsHelper.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),Events=_dereq_("../enums/Events.js"),Gridable=_dereq_("./behaviors/Gridable.js"),Group=_dereq_("./Group.js"),Guideable=_dereq_("./behaviors/Guideable.js"),ImageEditor=_dereq_("./helpers/ImageEditor.js"),InteractionTriggers=_dereq_("../enums/InteractionTriggers.js"),Mouse=_dereq_("./helpers/MouseHelper.js"),PageModes=_dereq_("../enums/PageModes.js"),Pickable=_dereq_("./behaviors/Pickable.js"),Point=_dereq_("../primitives/Point.js"),Properties=_dereq_("../enums/Properties.js"),Rectangle=_dereq_("../primitives/Rectangle.js"),SelectionHelper=_dereq_("./helpers/SelectionHelper.js"),SnappingHelper=_dereq_("./helpers/SnappingHelper.js"),TextEditor=_dereq_("./helpers/TextEditor.js"),Tree=_dereq_("../utils/Tree.js");module.exports=function(){function Canvas(id,Page){Group.call(this,id||ElementsHelper.CANVAS_ID,Page),this.type=ElementTypes.CANVAS,this.scale=1,this.clickPoint=new Point,this.offsetPoint=new Point,this.scrollOffset=new Point,this.selectedElements=[],this.editingGroup=null,this.imageCrop=null,this.imageEdit=null,this.mouseMoved=!1,this.rulersRef={},this._resized=!1,this.editingMultipart=null,this.overlay=null,this.annotationHighlights=[]}var INDICATOR_POSITION_DELTA=25;return Canvas.DefaultProperties={backgroundColor:{value:"#ffffff"},backgroundImage:{value:""},backgroundSize:{value:"auto"},backgroundRepeat:{value:"repeat"},backgroundPosition:{value:"center center"},sketchArtboard:{value:{}},annotations:{value:[]}},Canvas.ExcludedProperties={name:!0,width:!0,height:!0,keepRatio:!0,angle:!0,x:!0,y:!0,opacity:!0,anchorX:!0,anchorY:!0,locked:!0,stateIa:!0,fixed:!0,isClip:!0,clip:!0,isClipScrollX:!0,isClipScrollY:!0},Base.Extend(Canvas,Group),Base.ApplyBehavior(Canvas,Gridable),Base.ApplyBehavior(Canvas,Guideable),Base.ApplyBehavior(Canvas,Pickable),Object.defineProperties(Canvas.prototype,{resized:{get:function(){return this._resized},set:function(value){this._resized=value}},backgroundColor:{get:function(){return this._backgroundColor},set:function(value){this._saveProperty(),this._backgroundColor=value,this.view.setBackgroundColor(value)}},backgroundImage:{get:function(){return this._backgroundImage},set:function(value){this._saveProperty(),this._backgroundImage=value,this.view.setBackgroundImage(value)}},backgroundSize:{get:function(){return this._backgroundSize},set:function(value){this._saveProperty(),this._backgroundSize=value,this.view.setBackgroundSize(value)}},backgroundRepeat:{get:function(){return this._backgroundRepeat},set:function(value){this._saveProperty(),this._backgroundRepeat=value,this.view.setBackgroundRepeat(value)}},backgroundPosition:{get:function(){return this._backgroundPosition},set:function(value){this._saveProperty(),this._backgroundPosition=value,this.view.setBackgroundPosition(value)}},sketchArtboard:{get:function(){return this._sketchArtboard},set:function(value){this._sketchArtboard=value}},annotations:{get:function(){return _.cloneDeep(this._annotations)},set:function(value){this._saveProperty(),this._annotations=value,this.shouldUpdateDocumentationHighlights=!0}}}),Canvas.prototype.createCanvas=function(options){this.view=this.createView(CanvasView.bind(null,options.containerEl)),this.eventsRef=this.getEventsRef(options.mode),this.collaborators={},options.mode===PageModes.DESIGN&&this.view.setScale(this.scale),this._updateRelativeRectangle(),TextEditor.AddListener(Events.TEXT_SELECTION_CHANGED,function(textFormat){this.Page.emit(Events.TEXT_SELECTION_CHANGED,textFormat)}.bind(this)),window.requestAnimationFrame(this.eventsRef.onUpdate),this.view.containerDomElement.parentNode.addEventListener("scroll",this.eventsRef.onUpdateRelativeRect)},Canvas.prototype.getContainerDomElement=function(){return this.view.containerDomElement},Canvas.prototype.getEventsRef=function(){return{onUpdateRelativeRect:_.debounce(this._updateRelativeRectangle.bind(this),150),onUpdate:this.onUpdate.bind(this)}},Canvas.prototype.isCanvas=function(){return!0},Canvas.prototype.getCollaborator=function(id){return this.collaborators[id]||null},Canvas.prototype.setCollaborators=function(collaborators){_.forEach(_.difference(Object.keys(this.collaborators),Object.keys(collaborators)),function(id){this.collaborators[id].destroy(),delete this.collaborators[id]}.bind(this)),_.forEach(collaborators,function(collaboratorData,id){return this.collaborators[id]?void this.collaborators[id].setData(collaboratorData,this.scale):void(this.collaborators[id]=new Collaborator(null,this.Page,collaboratorData,this.scale))}.bind(this)),this.view.appendToOverlay(_.map(this.collaborators,function(collaborator){return collaborator.view.domElement}))},Canvas.prototype.select=function(element){this._select([element])},Canvas.prototype.removeAnnotation=function(element){return element?void(this.annotations=_.filter(this.annotations,function(doc){return doc.idElement!==element.id})):null},Canvas.prototype.removeAnnotationLink=function(element){return element?void(this.annotations=_.map(this.annotations,function(doc){if(doc.idElement!==element.id)return doc;var updatedDoc=doc;return delete updatedDoc.idElement,delete updatedDoc.idPin,updatedDoc})):null},Canvas.prototype.selectAll=function(){var all=this.editingGroup?this.editingGroup.getLayerChildren():this._getChildren();this._select(_.clone(this._getVisibleAndUnlockedElements(all)))},Canvas.prototype.getSelectedElement=function(){return this.overlay.getSelectedElement()},Canvas.prototype.getAllSelectedElements=function(){return this.selectedElements},Canvas.prototype.editSelectedElements=function(){var _this=this;window.requestAnimationFrame(function(){return _this.overlay.editSelectedElement()})},Canvas.prototype.deselect=function(){this._select([]),this.overlay.hideHighlight(),this.clearMultipartSelection()},Canvas.prototype.addToSelection=function(element){this.selectedElements.indexOf(element)===-1&&this._updateSelection(element)},Canvas.prototype.removeFromSelection=function(element){this.selectedElements.indexOf(element)>-1&&this._updateSelection(element)},Canvas.prototype.addElement=function(element){var target=this.getCurrentEditingParent();target.addChild(element)},Canvas.prototype.group=function(){if(this.Page.canAddDeleteElements()){var group,elements;this.getSelectedElement().isVirtualGroup()&&(elements=_.clone(this.getAllSelectedElements()),group=SelectionHelper.Group(elements),this.deselect(),this._select([group]))}},Canvas.prototype.createMultistate=function(){if(this.Page.canAddDeleteElements()){var multistate,elements,selectedElement=this.getSelectedElement();if(selectedElement.isMultistate())return!1;elements=_.clone(this.getAllSelectedElements()),multistate=SelectionHelper.CreateOrConvertToMultistate(elements),this._select([multistate])}},Canvas.prototype.ungroup=function(){if(this.Page.canAddDeleteElements()){var ungroupedElements,element=this.getSelectedElement();!element.isGroup()||element.isMultistate()||element.isVirtualGroup()||(ungroupedElements=SelectionHelper.Ungroup(element),this.deselect(),this._select(ungroupedElements))}},Canvas.prototype.lock=function(){this.Page.canAddDeleteElements()&&this._setPropertyForElements(this.getAllSelectedElements(),Properties.LOCKED,1,!0,function(affectedElements){1===affectedElements.length?this.overlay.selectElement(affectedElements[0]):this.deselect()}.bind(this))},Canvas.prototype.unlock=function(){this.Page.canAddDeleteElements()&&this._setPropertyForElements(this.getAllSelectedElements(),Properties.LOCKED,0,!0,function(affectedElements){affectedElements.length&&this.overlay.selectElement(affectedElements[0])}.bind(this))},Canvas.prototype.setElementsVisibility=function(visible,elements){var selectedElements=this.getAllSelectedElements();this._setPropertyForElements(elements||selectedElements,Properties.STATE_IA,visible?"hidden":"visible",!0,function(){this.overlay.highlightElements(selectedElements)}.bind(this))},Canvas.prototype.delete=function(){if(this.Page.canAddDeleteElements()){var restoreActiveState=function(elementsParent){if(!elementsParent.isMultistate())return _.noop;var activeStateId=elementsParent.activeState.id;return function(){elementsParent.showState(activeStateId)}},remove=function(){var elements=_.clone(this.selectedElements);this.overlay.removeHighlight();var elementsParent=elements[0].parent,restore=restoreActiveState(elementsParent);SelectionHelper.Delete(elements),restore(),this.selectRemainingElements(elementsParent)}.bind(this);if(this.selectedElements.length){if(_.some(this.selectedElements,"locked"))return this.Page.emit(Events.ELEMENT_DELETE_CONFIRMATION,{onSuccess:remove});remove()}}},Canvas.prototype.selectRemainingElements=function(parent){var remainingElements=[];parent.isGroup()&&!parent.isCanvas()&&(remainingElements=parent.getLayerChildren()),remainingElements.length?this._select([remainingElements[0]]):parent.isMultistate()&&parent.storedElements.length?this.refreshEmptyState(parent):this.deselect()},Canvas.prototype.duplicateInPlace=function(){var boundingBox=this.getSelectedElement().getBoundingBox(!1);this.copy(!1,!1),this.pasteInPlace({x:boundingBox.x,y:boundingBox.y},!0)},Canvas.prototype.copy=function(isCut,store){if(this.Page.canAddDeleteElements()){var elements;this.selectedElements.length&&(elements=_.clone(this.selectedElements),ClipboardHelper.CopyElements(elements,this.Page.pageId,isCut,this.getSelectedElement().getBoundingBox(!1),store))}},Canvas.prototype.pasteInPlace=function(position){if(this.Page.canAddDeleteElements()){var target=this.getCurrentEditingParent();this._select(ClipboardHelper.PasteInPlace(target,position,!0)),this.Page.emit(Events.ELEMENT_PASTE)}},Canvas.prototype.paste=function(position){if(this.Page.canAddDeleteElements()){var target=this.getCurrentEditingParent();ClipboardHelper.PasteElements(target,position).then(function(elements){this.Page.emit(Events.ELEMENT_PASTE),this._select(elements)}.bind(this))}},Canvas.prototype.cut=function(){this.copy(!0),this.delete()},Canvas.prototype.crop=function(image){var _this2=this;if(this.Page.canAddDeleteElements())return image.setLoading(!0),this.overlay._handleCropStart(),ImageEditor.GetImageCrop(image,this.Page).then(function(imageCrop){image.setLoading(!1),_this2.imageCrop=imageCrop,_this2.view.insertNodeAfter(imageCrop.view.domElement,image.view.domElement),_this2._select([imageCrop])})},Canvas.prototype.editImage=function(image){if(this.Page.canAddDeleteElements())return image.setLoading(!0),ImageEditor.GetImageEdit(image,this.Page).then(function(imageEdit){image.setLoading(!1),image.addLinkedElement(imageEdit),this.imageEdit=imageEdit,this.view.insertNodeAfter(imageEdit.view.domElement,image.view.domElement)}.bind(this))},Canvas.prototype.clipGroup=function(){this.Page.canAddDeleteElements()&&1===this.selectedElements.length&&this.Page.clipGroup(this.selectedElements[0],!this.selectedElements[0].isClip)},Canvas.prototype.createComponent=function(name){if(this.Page.canAddDeleteElements()){var bb,elements;this.selectedElements.length&&(elements=_.clone(this.selectedElements),bb=this.getSelectedElement().getBoundingBox(!0),this.deselect(),SelectionHelper.CreateComponent(name,elements,bb.x,bb.y).then(function(component){this._select([component])}.bind(this)).catch(function(){this._select(elements)}.bind(this)))}},Canvas.prototype.finishEditingComponent=function(){this.Page.canAddDeleteElements()&&(this.Page.ElementsManager.tintElementsExcept(this.Page.ElementsManager.getElements(),this.Page.ElementsManager.getEditingComponent(),!1),this.Page.ElementsManager.finishEditingComponent(),this.deselect(),this.Page.emit(Events.COMPONENT_EDIT_MODE,!1))},Canvas.prototype.editComponent=function(component){this.Page.canAddDeleteElements()&&(this.Page.ElementsManager.tintElementsExcept(this.Page.ElementsManager.getElements(),component,!0),this.Page.ElementsManager.editComponent(component),this.deselect(),this.Page.emit(Events.COMPONENT_EDIT_MODE,!0,component.idComponent))},Canvas.prototype.editGroup=function(group,select){var collidedElement=null;select&&(collidedElement=this.getCollidedElement([group],!0),this._select([collidedElement])),collidedElement&&collidedElement!==group&&collidedElement.hitTest(this.clickPoint)||!group.isMultistate()||this.refreshEmptyState(group)},Canvas.prototype.refreshEmptyState=function(multistate){var activeState=multistate.activeState.id;this.deselect(),multistate.showState(activeState),this.editingGroup=multistate,this.setGroupEditable(!0)},Canvas.prototype.finishEditingTextElement=function(){TextEditor.GetEditingElement()&&TextEditor.FinishEditing()},Canvas.prototype.editTextElement=function(element,callback){this.Page.canAddDeleteElements()&&TextEditor.Edit(element,callback)},Canvas.prototype.clickedOutsideActivePart=function(element,target){return element.activeParts&&element.getPart(element.activeParts[0])&&!element.getPart(element.activeParts[0]).domElement.contains(target)},Canvas.prototype.moveToFront=function(){this.Page.ElementsManager.startBatch(),ArrangeHelper.MoveToFront(this.selectedElements),this.Page.ElementsManager.endBatch()},Canvas.prototype.moveToBack=function(){this.Page.ElementsManager.startBatch(),ArrangeHelper.MoveToBack(this.selectedElements),this.Page.ElementsManager.endBatch()},Canvas.prototype.moveForward=function(){this.Page.ElementsManager.startBatch(),ArrangeHelper.MoveForward(this.selectedElements),this.Page.ElementsManager.endBatch()},Canvas.prototype.moveBehind=function(){this.Page.ElementsManager.startBatch(),ArrangeHelper.MoveBehind(this.selectedElements),this.Page.ElementsManager.endBatch()},Canvas.prototype.moveElementsBefore=function(elements,target){this.Page.canAddDeleteElements()&&(this.Page.ElementsManager.startBatch(),ArrangeHelper.MoveBefore(elements,target),this.Page.ElementsManager.endBatch())},Canvas.prototype.moveElementsAfter=function(elements,target){this.Page.canAddDeleteElements()&&(this.Page.ElementsManager.startBatch(),ArrangeHelper.MoveAfter(elements,target),this.Page.ElementsManager.endBatch())},Canvas.prototype.align=function(axis){this.Page.ElementsManager.startBatch(),AlignHelper.Align(axis,this.selectedElements),this.Page.ElementsManager.endBatch(),this.getSelectedElement().dirty=!0},Canvas.prototype.distribute=function(orientation){this.Page.ElementsManager.startBatch(),AlignHelper.Distribute(orientation,this.selectedElements),this.Page.ElementsManager.endBatch(),this.getSelectedElement().dirty=!0},Canvas.prototype.getCollidedElement=function(elements,searchInsideGroup,skipGroups,point){for(var element,hit,i=elements.length;i-- >0;)if(element=elements[i],hit=element.hitTest(point||this.clickPoint))return skipGroups?hit:this.getElementInsideGroup(hit,searchInsideGroup);return null},Canvas.prototype.getCollidedChild=function(point){var currentParent=this.Page.ElementsManager.getEditingComponent(),currentParentChildren=currentParent?currentParent.children:this.children;return this.getCollidedElement(currentParentChildren,!1,!1,point)},Canvas.prototype.getElementInsideGroup=function(element,searchInsideGroup){var editingComponent=this.Page.ElementsManager.getEditingComponent(),editingGroup=this.editingGroup||editingComponent;
return editingComponent&&!Tree.IsDescendantOf(editingComponent,element)?null:(searchInsideGroup?(editingGroup=editingGroup&&Tree.IsDescendantOf(editingGroup,element)?Tree.GetAncestorGroup(element,editingGroup):Tree.GetAncestorGroup(element,null),this.Page.emit(Events.GROUP_EDIT,[editingGroup.id].concat(_toConsumableArray(_.map(Tree.GetAllAncestors(editingGroup),"id"))))):editingGroup&&Tree.IsDescendantOf(editingGroup,element)||(editingGroup=null),Tree.GetRootElement(element,editingGroup))},Canvas.prototype.getCurrentEditingParent=function(){return this.editingGroup||this.Page.ElementsManager.getEditingComponent()||this},Canvas.prototype.setGroupEditable=function(value,elements){var editingComponent=this.Page.ElementsManager.getEditingComponent();this.editingGroup&&(this.editingGroup.setEditable(value?this.editingGroup:editingComponent,elements),this.editingGroup.isMultistate()&&(this.Page.setMultistateEditMode(value,this.editingGroup.id),value||this.Page.isSpecMode()||editingComponent&&Tree.IsDescendantOf(this.editingGroup,editingComponent)||this.editingGroup.showDefaultState())),value?this.overlay.showGroupHighlight(this.editingGroup):this.overlay.hideGroupHighlight()},Canvas.prototype.setScale=function(value){value!==this.scale&&(this.scale=value,this.setGuidesScale(value),this.view.setScale(value),this.overlay.setScale(value),this.Page.collaboration.refreshCollaborators(this.scale),this.emit(Events.SET_SCALE,this.scale))},Canvas.prototype.clear=function(){for(var i=this.children.length;i-- >0;)this.removeChild(this.children[i]);this.selectedElements=[],this.editingGroup=null,this.imageCrop=null,this.imageEdit=null,this.overlay.clear(),this.initProperties({}),this.view.clearCanvas()},Canvas.prototype.destroy=function(){this.clear(),this.overlay=null,SnappingHelper.RemoveListener(Events.SNAPPING_GUIDE_SHOW,this.eventsRef.onGuideShow),SnappingHelper.RemoveListener(Events.SNAPPING_GUIDE_HIDE,this.eventsRef.onGuideHide)},Canvas.prototype.onAnnotationsUpdate=function(){this.Page.currentMode.updateOverlay(!0)},Canvas.prototype.onUpdate=function(){for(var child,updated=!1,i=0,len=this.children.length;i<len;i++)child=this.children[i],child._dirty&&(updated=!0,child._dirty=!1,child.update());this.imageCrop&&this.imageCrop._dirty&&(updated=!0,this.imageCrop._dirty=!1,this.imageCrop.update()),this.imageEdit&&this.imageEdit._dirty&&(updated=!0,this.imageEdit._dirty=!1,this.imageEdit.update()),this.overlay.update(updated),this.shouldUpdateGrid&&(this.view.updateGrid(this),this.shouldUpdateGrid=!1),this.updateGuides(),this.resized&&(this.eventsRef.onUpdateRelativeRect(),this.resized=!1),this.shouldUpdateDocumentationHighlights&&(this.onAnnotationsUpdate(),this.shouldUpdateDocumentationHighlights=!1),window.requestAnimationFrame(this.eventsRef.onUpdate)},Canvas.prototype.onPickerMouseMove=function(element){this.Page.isSpecMode()&&(!element||element&&element.isVisible())&&!this.Page.isSpecModeSkippedType(element)&&this.Page.emit(Events.ELEMENT_HOVERED,{element:element})},Canvas.prototype.openUploadDialog=function(){this.Page.emit(Events.OPEN_IMAGE_UPLOAD_DIALOG)},Canvas.prototype.enablePartSelection=function(element){this.editingMultipart=element},Canvas.prototype.disablePartSelection=function(){this.editingMultipart=null},Canvas.prototype.showContextMenu=function(e){e.preventDefault(),this.Page.emit(Events.SHOW_CONTEXT_MENU,{element:this.selectedElements,e:e})},Canvas.prototype.updateRelativeRectangle=function(){this._updateRelativeRectangle()},Canvas.prototype.getSpecProperties=function(){var assets=this.getAssets(this.children,!1),grid=_.pick(this,["gridColumnWidth","gridColumns","gridDisplay","gridGutter","gridMargin","gridMaxWidth","gridOnTop","gridWidth"]);return this.backgroundImage&&!Color.isGradient(this.backgroundImage)&&assets.images.push(this.backgroundImage),_.extend({},assets,grid,{backgroundImage:this[Properties.BACKGROUND_IMAGE],backgroundColor:Color.getColorsSet(this[Properties.BACKGROUND_COLOR]),backgroundPosition:this[Properties.BACKGROUND_POSITION],backgroundRepeat:this[Properties.BACKGROUND_REPEAT],backgroundSize:this[Properties.BACKGROUND_SIZE],canvasViewWidth:this.view.containerDomElement.offsetWidth,canvasViewHeight:this.view.containerDomElement.offsetHeight,metadata:this[Properties.METADATA],sketchArtboard:this[Properties.SKETCH_ARTBOARD]})},Canvas.prototype.showOverlay=function(){this.view.showOverlay()},Canvas.prototype.hideOverlay=function(){this.view.hideOverlay()},Canvas.prototype.onDeselectElement=function(e){if(Mouse.addToSelection(e)||(this.deselect(),this.setGroupEditable(!1),this.editingGroup=null,this.editingMultipart&&this.disablePartSelection()),Mouse.rightButtonPressed(e))return this.showContextMenu(e),!0},Canvas.prototype.changeSelection=function(element,e){var addToSelection=Mouse.addToSelection(e),shouldDeselect=!1;return element&&(this.selectedElements.indexOf(element)===-1?addToSelection?this._updateSelection(element):this._select([element]):addToSelection&&(shouldDeselect=!0)),addToSelection&&e.stopImmediatePropagation(),shouldDeselect},Canvas.prototype.isClipboardEmpty=function(){return ClipboardHelper.IsClipboardEmpty()},Canvas.prototype.onPaste=function(e){if(this.Page.canAddDeleteElements()&&ClipboardHelper.IsRawImage(e.clipboardData)){this.Page.ElementsManager.startBatch();var src=ClipboardHelper.GetRawImageBlobSrc(e.clipboardData);this.Page.ElementsManager.createImagesFromSrc([src]).then(function(elements){this.addChildren(elements),this.Page.ElementsManager.endBatch(),this._select(elements)}.bind(this))}},Canvas.prototype.onCrop=function(){ImageEditor.Crop(this.imageCrop).then(this._cancelImageCrop.bind(this)).catch(this._cancelImageCrop.bind(this))},Canvas.prototype.onApplyAdjustments=function(){ImageEditor.ApplyEdit(this.imageEdit).then(function(){this._cancelImageEdit()}.bind(this))},Canvas.prototype.onScroll=function(e){this.Page.isPreviewMode()&&this.Page.InteractionsManager.interactWithElement(this.id,null,InteractionTriggers.WINDOW_SCROLL,e)},Canvas.prototype.onSetGuideVisibility=function(visible,data){var guide=data.axis===Properties.X?this.smartguideVertical:this.smartguideHorizontal;guide.visibility=visible,visible&&(guide[data.axis]=data.value*this.scale)},Canvas.prototype.deselectMultipartSelection=function(){this.editingMultipart&&(this.editingMultipart.setActiveParts([]),this.overlay.hideMultipartHighlight())},Canvas.prototype.clearMultipartSelection=function(){this.editingMultipart&&(this.editingMultipart=null,this.overlay.hideMultipartHighlight())},Canvas.prototype.updateHighlightSelect=function(){this.selectedElements.length>1&&this.overlay.updateHighlightSelect()},Canvas.prototype.getBoundingBox=function(){return new Rectangle(0,0,parseInt(this.view.domElement.style.width),parseInt(this.view.domElement.style.height))},Canvas.prototype.isLockedElementOnSelectedElementsList=function(){return this._isLockedElementOnElementsList(this.selectedElements)},Canvas.prototype.addAnnotationHighlight=function(highlightElement){highlightElement&&this.annotationHighlights.push(highlightElement)},Canvas.prototype.clearAnnotationHighlights=function(){this.annotationHighlights=[]},Canvas.prototype.getSortedAnnotationHighlights=function(){var _this3=this,sortedAnnotationHighlights=[];if(!this.annotationHighlights.length)return sortedAnnotationHighlights;for(var sortedElements=ElementsHelper.GetElementsSortedFromRoot(this),_loop=function(i){var id=sortedElements[i].id,annotations=_.filter(_this3.annotationHighlights,function(annotation){return annotation.element&&annotation.element.id===id});if(sortedAnnotationHighlights=[].concat(_toConsumableArray(sortedAnnotationHighlights),_toConsumableArray(annotations)),sortedAnnotationHighlights.length===_this3.annotationHighlights.length)return"break"},i=0;i<sortedElements.length;i++){var _ret=_loop(i);if("break"===_ret)break}return sortedAnnotationHighlights},Canvas.prototype._updateSelection=function(element){this.clearMultipartSelection();var elements=_.clone(this.selectedElements),index=elements.indexOf(element),lockedInSelection=this._isLockedElementOnElementsList(elements),shouldAddToSelection=!lockedInSelection&&!element.locked||_.isEmpty(elements);index>-1?elements.splice(index,1):shouldAddToSelection&&elements.push(element),_.isEmpty(elements)?this.deselect():this._select(elements)},Canvas.prototype.deselectWithoutEditingGroup=function(){var group=this.editingGroup;return group?(_.forEach(this.selectedElements,function(element){return element.deselect()}),void(this.selectedElements.length=0)):this.deselect()},Canvas.prototype._select=function(elements){this.clearMultipartSelection(),this._shouldCancelImageCrop(elements)&&this._cancelImageCrop(),_.forEach(_.difference(this.selectedElements,elements),function(element){element.deselect()}),this.Page.isPickMode()||this._selectParent(elements),_.forEach(_.difference(elements,this.selectedElements),function(element){element.select()}),this.selectedElements=elements,this.overlay.highlightElements(elements),this.Page.emitSelection(this.selectedElements)},Canvas.prototype._selectParent=function(elements){var editingGroup=null;_.forEach(elements,function(element){element.type===ElementTypes.IMAGE_CROP&&(element=element.image);var ancestorGroup=Tree.GetFirstAncestorGroup(element);ancestorGroup&&(editingGroup=ancestorGroup)}.bind(this)),this.editingGroup!==editingGroup&&(this.setGroupEditable(!1),this.editingGroup=editingGroup,this.setGroupEditable(!!editingGroup,elements))},Canvas.prototype._setPropertyForElements=function(elements,property,value,addToHistory,callback){_.isEmpty(elements)||(this.Page.ElementsManager.startBatch(),_.forEach(elements,function(element){element._updateProperty(property,value,addToHistory)}),this.Page.ElementsManager.endBatch(),"function"==typeof callback&&callback(elements))},Canvas.prototype._shouldCancelImageCrop=function(elements){return this.imageCrop&&(1!==elements.length||elements[0].type!==ElementTypes.IMAGE_CROP)},Canvas.prototype._cancelImageCrop=function(){var image;this.imageCrop&&(image=this.imageCrop.image,image.onCancelCrop(),this.view.removeNode(this.imageCrop.view.domElement),this.imageCrop=null,this._select([image]),this.overlay._handleCropEnd(),this.Page.emit(Events.CROP_DEACTIVATE))},Canvas.prototype._cancelImageEdit=function(){var image;this.imageEdit&&(image=this.imageEdit.image,image.removeLinkedElement(this.imageEdit),this.view.removeNode(this.imageEdit.view.domElement),this.imageEdit.destroy(),this.imageEdit=null)},Canvas.prototype._updateRelativeRectangle=function(){this.domElementRect=this.view.domElement.getClientRects()[0]},Canvas.prototype._getRelativeMousePosition=function(e){var position={x:e.pageX-this.domElementRect.left,y:e.pageY-this.domElementRect.top};return position},Canvas.prototype._getRelativeScaledMousePosition=function(e){var mousePosition=this._getRelativeMousePosition(e);return{x:mousePosition.x/this.scale,y:mousePosition.y/this.scale}},Canvas.prototype._getChildren=function(){var editingComponent=this.Page.ElementsManager.getEditingComponent();return editingComponent?editingComponent.children:this.children},Canvas.prototype._getVisibleAndUnlockedElements=function(elements){return _.filter(elements,function(element){return element.isVisible()&&element.isUnlocked()&&!element.isEditByCollaborator()})},Canvas.prototype._isLockedElementOnElementsList=function(elements){return _.some(elements,function(element){return element.locked})},Canvas.prototype._getRulerRef=function(orientation){return this.rulersRef[orientation]||(this.rulersRef[orientation]=document.querySelector("."+this.Page.options.rulerElClass+"."+orientation)),this.rulersRef[orientation]},Canvas.prototype.getCanvasWrapperDOM=function(){return document.getElementById("canvas-wrapper")},Canvas.prototype._elementNameHide=function(){this.elementName.hide()},Canvas.prototype._elementNameShow=function(element,e){var mousePosition=this._getRelativeMousePosition(e);this.elementName.setName(element.name),this.elementName.setPosition(mousePosition.x+INDICATOR_POSITION_DELTA,mousePosition.y+INDICATOR_POSITION_DELTA),this.elementName.show()},Canvas.prototype._mouseMove=function(){this.mouseMoved=!0,this.Page.ElementsManager.startBatch(!0)},Canvas.prototype.getRelativeScaledMousePosition=function(mousePosition){return{x:(mousePosition.x-this.domElementRect.left)/this.scale,y:(mousePosition.y-this.domElementRect.top)/this.scale}},Canvas}()},{"../enums/ElementTypes.js":346,"../enums/Events.js":347,"../enums/InteractionTriggers.js":351,"../enums/PageModes.js":357,"../enums/Properties.js":358,"../primitives/Point.js":403,"../primitives/Rectangle.js":404,"../utils/Base.js":405,"../utils/Color.js":409,"../utils/Tree.js":419,"./Group.js":185,"./behaviors/Gridable.js":226,"./behaviors/Guideable.js":227,"./behaviors/Pickable.js":233,"./helpers/AlignHelper.js":241,"./helpers/ArrangeHelper.js":242,"./helpers/ClipboardHelper.js":246,"./helpers/ElementsHelper.js":250,"./helpers/ImageEditor.js":251,"./helpers/MouseHelper.js":252,"./helpers/SelectionHelper.js":256,"./helpers/SnappingHelper.js":257,"./helpers/TextEditor.js":260,"./ui/Collaborator.js":266,"./views/CanvasView.js":307,lodash:161}],174:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("./AbstractElement.js"),Base=_dereq_("../utils/Base.js"),TextEditable=_dereq_("./behaviors/TextEditable.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),CheckboxView=_dereq_("./views/CheckboxView.js");module.exports=function(){function Checkbox(){AbstractElement.apply(this,arguments),this.type=ElementTypes.CHECKBOX,this.view=this.createView(CheckboxView)}return Checkbox.DefaultProperties={width:{value:150},height:{value:17,min:17},disabled:{value:0},checked:{value:!1},elementPosition:{value:"left"},inputValue:{value:"label"},textAlign:{value:"left"},color:{value:"#000000"}},Base.Extend(Checkbox,AbstractElement),Base.ApplyBehavior(Checkbox,TextEditable),Object.defineProperties(Checkbox.prototype,{checked:{get:function(){return this._checked},set:function(value){this._saveProperty(),this._checked=value,this.view.setChecked(value)}},disabled:{get:function(){return this._disabled},set:function(value){this._saveProperty(),this._disabled=value,this.view.setDisabled(value)}},elementPosition:{get:function(){return this._elementPosition},set:function(value){this._saveProperty(),this._elementPosition=value,this.view.setPosition(value)}}}),Checkbox}()},{"../enums/ElementTypes.js":346,"../utils/Base.js":405,"./AbstractElement.js":166,"./behaviors/TextEditable.js":238,"./views/CheckboxView.js":308}],175:[function(_dereq_,module,exports){"use strict";var Box=_dereq_("./Box.js"),CircleView=_dereq_("./views/CircleView.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js");module.exports=function(){function Circle(){Box.apply(this,arguments),this.type=ElementTypes.CIRCLE,this.view=this.createView(CircleView)}return Circle.DefaultProperties={width:{value:200},height:{value:200}},Circle.ExcludedProperties={borderTopLeftRadius:!0,borderTopRightRadius:!0,borderBottomRightRadius:!0,borderBottomLeftRadius:!0},Base.Extend(Circle,Box),Circle}()},{"../enums/ElementTypes.js":346,"../utils/Base.js":405,"./Box.js":171,"./views/CircleView.js":309}],176:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("./AbstractElement.js"),ClipartView=_dereq_("./views/ClipartView.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js");module.exports=function(){function Clipart(){AbstractElement.apply(this,arguments),this.type=ElementTypes.CLIPART,this.view=this.createView(ClipartView)}return Clipart.DefaultProperties={src:{value:""},idStoredFile:{value:""},clickIdPage:{value:""}},Base.Extend(Clipart,AbstractElement),Object.defineProperties(Clipart.prototype,{src:{get:function(){return this._src},set:function(value){this._saveProperty(),this._src=value,this.view.setSrc(this._getCdnUrl(value))}},idStoredFile:{get:function(){return this._idStoredFile},set:function(value){this._saveProperty(),this._idStoredFile=value}},clickIdPage:{get:function(){return this._clickIdPage},set:function(value){this._saveProperty(),this._clickIdPage=value}}}),Clipart}()},{"../enums/ElementTypes.js":346,"../utils/Base.js":405,"./AbstractElement.js":166,"./views/ClipartView.js":310}],177:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Base=_dereq_("../utils/Base.js"),AbstractElement=_dereq_("./AbstractElement.js"),Group=_dereq_("./Group.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),ElementsHelper=(_dereq_("../ElementsFactory"),_dereq_("./helpers/ElementsHelper")),ComponentView=_dereq_("./views/ComponentView.js"),Properties=_dereq_("../enums/Properties.js");module.exports=function(){function Component(){Group.apply(this,arguments),this.type=ElementTypes.COMPONENT,this.view=this.createView(ComponentView),this._shouldUpdateElements=!1,this._elements={}}return Component.DefaultProperties={idComponent:{value:""},scaleX:{value:1},scaleY:{value:1}},Component.ExcludedProperties={keepRatio:!0,storedElements:!0,x:!1,y:!1,hasMaster:!0},Base.Extend(Component,Group),Object.defineProperties(Component.prototype,{shouldUpdateElements:{get:function(){return this._shouldUpdateElements},set:function(value){this._shouldUpdateElements=value,value&&(this.dirty=value)}},idComponent:{get:function(){return this._idComponent},set:function(value){this._saveProperty(),value=value.toString(),value&&this.Page.ElementsManager.getComponentById(value)&&(this.shouldUpdateElements=!0),this._idComponent=value}},hasMaster:{get:function(){return!!this.Page.ElementsManager.getComponentMasterId(this.idComponent)}},scaleX:{get:function(){return this._scaleX},set:function(value){this._saveProperty(),this._scaleX=value}},scaleY:{get:function(){return this._scaleY},set:function(value){this._saveProperty(),this._scaleY=value}}}),Component.prototype.isGroup=function(){return!1},Component.prototype.isComponent=function(){return!0},Component.prototype.resizeFromPoint=function(scaleX,scaleY,point){this.scaleX*=scaleX,this.scaleY*=scaleY,Group.prototype.resizeFromPoint.call(this,scaleX,scaleY,point)},Component.prototype.update=function(){this.shouldUpdateElements&&(this.shouldUpdateElements=!1,this._updateElements(this.idComponent)),Group.prototype.update.call(this)},Component.prototype.serialize=function(){var serialized=Group.prototype.serialize.call(this);return serialized},Component.prototype.getElements=function(){return this._elements},Component.prototype.hitTest=function(p){if(this._preventHit(p))return null;var selectByBorder=this.Page.isPickMode()&&this.Page.isSpecMode(),hitChildren=this._hitTestOverChildren(this.children,p);return!this.Page.isSpecMode()&&this.Page.isPickMode()&&this.rect.hitTest(p)?this:this.Page.isSpecMode()&&this.Page.isPickMode()?hitChildren?hitChildren:(!hitChildren&&selectByBorder?this.rect.hitTestMargin(p)&&!this.rect.hitTest(p):this.rect.hitTest(p))?this:null:hitChildren},Component.prototype.clone=function(props){return AbstractElement.prototype.clone.call(this,props)},Component.prototype.isEditByCollaborator=function(){return AbstractElement.prototype.isEditByCollaborator.call(this)||_.some(this.children,function(child){return child.isEditByCollaborator()})},Component.prototype.collaborationUpdateComponent=function(component,nextComponent,changedElements){var x=this.x,y=this.y,shouldExcludeProperty=function(element,propertyName){return(!element.isComponent()||"storedElements"!==propertyName)&&(element.ExcludedProperties&&!_.isUndefined(element.ExcludedProperties[propertyName]))},currentChildrenIds=Object.keys(component),nextChildrenIds=Object.keys(nextComponent),changedElementsIds=_.map(changedElements,"id"),toRemove=_.difference(currentChildrenIds,nextChildrenIds),toAdd=_.sortBy(_.difference(nextChildrenIds,currentChildrenIds),function(id){return changedElementsIds.indexOf(id)});toRemove.forEach(function(id){var child=this.Page.ElementsManager.getElementById(id,this.id);child&&child.parent&&child.parent.removeChild(child)}.bind(this)),toAdd.forEach(function(id){var element=this.Page.ElementsManager.createElementComponentFromCollaboration(id,nextComponent[id],this);this.addChildAt(element,nextChildrenIds.indexOf(id)),element.resetIndicators()}.bind(this)),_.intersection(nextChildrenIds,currentChildrenIds).forEach(function(id){var child=this.Page.ElementsManager.getElementById(id,this.id);!child||child instanceof Group||(child[Properties.X]=nextComponent[id].props[Properties.X],child[Properties.Y]=nextComponent[id].props[Properties.Y])}.bind(this)),_.forEach(changedElements,function(changedElement){var element=changedElement.id===ElementsHelper.CANVAS_ID?this:this.Page.ElementsManager.getElementById(changedElement.id,this.id);element&&(_.forEach(changedElement.data.props,function(value,property){shouldExcludeProperty(element,property)||element._updateProperty(property,value,!0)}),element.dirty=!0,element.resetIndicators())}.bind(this)),this._updateBoundingBox(),this.x=x,this.y=y,Group.prototype.update.call(this)},Component.prototype._updateElements=function(componentId){var x=this.x,y=this.y,scaleX=this.scaleX,scaleY=this.scaleY;this._clear(),this.addChildren(this.Page.ElementsManager.createComponentElements(this,componentId)),this._updateBoundingBox(),this.x=x,this.y=y,this.scaleX=1,this.scaleY=1,this.resizeFromPoint(scaleX,scaleY,this.rect._p0)},Component.prototype._clear=function(){for(this._elements={};this.children.length;)this.children.pop();for(;this.storedElements.length;)this.storedElements.pop();var range=document.createRange();range.selectNodeContents(this.view.domElement),range.deleteContents()},Component.prototype._getElementById=function(id){return this._elements[id]},Component}()},{"../ElementsFactory":162,"../enums/ElementTypes.js":346,"../enums/Properties.js":358,"../utils/Base.js":405,"./AbstractElement.js":166,"./Group.js":185,"./helpers/ElementsHelper":250,"./views/ComponentView.js":311,lodash:161}],178:[function(_dereq_,module,exports){"use strict";var SvgIcon=_dereq_("./SvgIcon.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),Base=_dereq_("../utils/Base.js");module.exports=function(){function CostcoIcon(){SvgIcon.apply(this,arguments),this.type=ElementTypes.COSTCO_ICON}return Base.Extend(CostcoIcon,SvgIcon),CostcoIcon}()},{"../enums/ElementTypes.js":346,"../utils/Base.js":405,"./SvgIcon.js":210}],179:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("./AbstractElement.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),DialogView=_dereq_("./views/DialogView.js");module.exports=function(){function Dialog(){AbstractElement.apply(this,arguments),this.type=ElementTypes.DIALOG,this.view=this.createView(DialogView)}return Dialog.DefaultProperties={width:{value:350},height:{value:200},backgroundColor:{value:"#F7F5F5"},borderColor:{value:"#C7C7C7"},borderStyle:{value:"solid"},borderRadius:{value:0},borderWidth:{value:1},contentBackgroundColor:{value:"#FFFFFF"},contentText:{value:"Lorem ipsum dolor sit amet interdum lacus tortor sociis a! Purus gravida Praesent tortor. Consequat a ultrices auctor! Adipiscing. Risus viverra. Augue Sed, et auctor vehicula Etiam consequat. Mus placerat Sed sit placerat. Ut."},contentColor:{value:"#666666"},contentFontWeight:{value:"normal"},contentFontStyle:{value:"normal"},contentFontSize:{value:"14px"},contentFontFamily:{value:"Arial"},contentTextAlign:{value:"none"},topbarDisplay:{value:"block"},topbarBackgroundColor:{value:"#C7C7C7"},topbarText:{value:"Dialog title"},topbarColor:{value:"#363636"},topbarFontWeight:{value:"bold"},topbarFontStyle:{value:"normal"},topbarFontSize:{value:"14px"},topbarFontFamily:{value:"Arial"},topbarTextAlign:{value:"normal"},bottombarDisplay:{value:"block"},bottombarBackgroundColor:{value:"#F7F5F5"},modalOverlayDisplay:{value:"none"}},Base.Extend(Dialog,AbstractElement),Object.defineProperties(Dialog.prototype,{backgroundColor:{get:function(){return this._backgroundColor},set:function(value){this._saveProperty(),this._backgroundColor=value,this.view.setBackgroundColor(value)}},borderColor:{get:function(){return this._borderColor},set:function(value){this._saveProperty(),this._borderColor=value,this.view.setBorderColor(value)}},borderStyle:{get:function(){return this._borderStyle},set:function(value){this._saveProperty(),this._borderStyle=value,this.view.setBorderStyle(value)}},borderRadius:{get:function(){return this._borderRadius},set:function(value){this._saveProperty(),this._borderRadius=value,this.view.setBorderRadius(value)}},borderWidth:{get:function(){return this._borderWidth},set:function(value){this._saveProperty(),this._borderWidth=value,this.view.setBorderWidth(value)}},bottombarDisplay:{get:function(){return this._bottombarDisplay},set:function(value){this._saveProperty(),this._bottombarDisplay=value,this.view.setBottombarDisplay(value)}},bottombarBackgroundColor:{get:function(){return this._bottombarBackgroundColor},set:function(value){this._saveProperty(),this._bottombarBackgroundColor=value,this.view.setBottombarBackgroundColor(value)}},contentBackgroundColor:{get:function(){return this._contentBackgroundColor},set:function(value){this._saveProperty(),this._contentBackgroundColor=value,this.view.setContentBackgroundColor(value)}},contentText:{get:function(){return this._contentText},set:function(value){this._saveProperty(),this._contentText=value,this.view.setContentText(value)}},contentColor:{get:function(){return this._contentColor},set:function(value){this._saveProperty(),this._contentColor=value,this.view.setContentColor(value)}},contentFontWeight:{get:function(){return this._contentFontWeight},set:function(value){this._saveProperty(),this._contentFontWeight=value,this.view.setContentFontWeight(value)}},contentFontStyle:{get:function(){return this._contentFontStyle},set:function(value){this._saveProperty(),this._contentFontStyle=value,this.view.setContentFontStyle(value)}},contentFontSize:{get:function(){return this._contentFontSize},set:function(value){this._saveProperty(),this._contentFontSize=value,this.view.setContentFontSize(value)}},contentFontFamily:{get:function(){return this._contentFontFamily},set:function(value){this._saveProperty(),this._contentFontFamily=value,this.view.setContentFontFamily(value)}},contentTextAlign:{get:function(){return this._contentTextAlign},set:function(value){this._saveProperty(),this._contentTextAlign=value,this.view.setContentTextAlign(value)}},topbarDisplay:{get:function(){return this._topbarDisplay},set:function(value){this._saveProperty(),this._topbarDisplay=value,this.view.setTopbarDisplay(value)}},topbarBackgroundColor:{get:function(){return this._topbarBackgroundColor},set:function(value){this._saveProperty(),this._topbarBackgroundColor=value,this.view.setTopbarBackgroundColor(value)}},topbarText:{get:function(){return this._topbarText},set:function(value){this._saveProperty(),this._topbarText=value,this.view.setTopbarText(value)}},topbarColor:{get:function(){return this._topbarColor},set:function(value){this._saveProperty(),this._topbarColor=value,this.view.setTopbarColor(value)}},topbarFontWeight:{get:function(){return this._topbarFontWeight},set:function(value){this._saveProperty(),this._topbarFontWeight=value,this.view.setTopbarFontWeight(value)}},topbarFontStyle:{get:function(){return this._topbarFontStyle},set:function(value){this._saveProperty(),this._topbarFontStyle=value,this.view.setTopbarFontStyle(value)}},topbarFontSize:{get:function(){return this._topbarFontSize},set:function(value){this._saveProperty(),this._topbarFontSize=value,this.view.setTopbarFontSize(value)}},topbarFontFamily:{get:function(){return this._topbarFontFamily},set:function(value){this._saveProperty(),this._topbarFontFamily=value,this.view.setTopbarFontFamily(value)}},topbarTextAlign:{get:function(){return this._topbarTextAlign},set:function(value){this._saveProperty(),this._topbarTextAlign=value,this.view.setTopbarTextAlign(value)}},modalOverlayDisplay:{get:function(){return this._modalOverlayDisplay},set:function(value){this._saveProperty(),this._modalOverlayDisplay=value,this.view.setModalOverlayDisplay(value)}}}),Dialog.prototype.getTextContent=function(){return this.topbarText+"\n"+this.contentText},Dialog}()},{"../enums/ElementTypes.js":346,"../utils/Base.js":405,"./AbstractElement.js":166,"./views/DialogView.js":312}],180:[function(_dereq_,module,exports){"use strict";var SvgIcon=_dereq_("./SvgIcon.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),Base=_dereq_("../utils/Base.js");module.exports=function(){function FontAwesome(){SvgIcon.apply(this,arguments),this.type=ElementTypes.FONT_AWESOME}return Base.Extend(FontAwesome,SvgIcon),FontAwesome}()},{"../enums/ElementTypes.js":346,"../utils/Base.js":405,"./SvgIcon.js":210}],181:[function(_dereq_,module,exports){"use strict";var SvgIcon=_dereq_("./SvgIcon.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),Base=_dereq_("../utils/Base.js");module.exports=function(){function FontAwesome47(){SvgIcon.apply(this,arguments),this.type=ElementTypes.FONT_AWESOME47}return Base.Extend(FontAwesome47,SvgIcon),FontAwesome47}()},{"../enums/ElementTypes.js":346,"../utils/Base.js":405,"./SvgIcon.js":210}],182:[function(_dereq_,module,exports){"use strict";var EventEmitter=_dereq_("event-emitter");module.exports=function(){function FrameworkElement(){this._callBehaviorsConstructors()}return FrameworkElement.prototype=Object.create(EventEmitter.methods),FrameworkElement.constructor=FrameworkElement,FrameworkElement.prototype.DefaultProperties={},FrameworkElement.prototype.ExcludedProperties={},FrameworkElement.prototype.AppliedBehaviors=[],FrameworkElement.prototype._callBehaviorsConstructors=function(){this.AppliedBehaviors.forEach(function(behavior){behavior.call(this)}.bind(this))},FrameworkElement}()},{"event-emitter":98}],183:[function(_dereq_,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _Properties=_dereq_("../enums/Properties.js"),_Properties2=_interopRequireDefault(_Properties),_Color=_dereq_("../utils/Color.js"),_Color2=_interopRequireDefault(_Color),AbstractElement=_dereq_("./AbstractElement.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),GeoSvgView=_dereq_("./views/GeoSvgView.js");module.exports=function(){function GeoSvg(){AbstractElement.apply(this,arguments),this.type=ElementTypes.GEO_SVG,this.view=this.createView(GeoSvgView)}var ELEMENTS={star:{tag:"polygon",data:[{attributeName:"points",attributeValue:"68,60 100,40 61,40 50,0 39,40 0,40 32,60 20,100 50,72 80,100"}]},rhombus:{tag:"polygon",data:[{attributeName:"points",attributeValue:"0,50 50,0 100,50, 50,100"}]},parallel:{tag:"polygon",data:[{attributeName:"points",attributeValue:"0,100 50,100 100,0 50,0"}]},ellipse:{tag:"ellipse",data:[{attributeName:"cx",attributeValue:"50"},{attributeName:"cy",attributeValue:"50"},{attributeName:"rx",attributeValue:"50"},{attributeName:"ry",attributeValue:"50"}]},triangle:{tag:"polygon",data:[{attributeName:"points",attributeValue:"0,100 50,0, 100,100"}]},triangle2:{tag:"polygon",data:[{attributeName:"points",attributeValue:"100,0 0,0, 0,100"}]}};return GeoSvg.DefaultProperties={color:{value:"#ebebeb"},element:{value:"triangle",options:Object.keys(ELEMENTS)},width:{value:100},height:{value:100}},Base.Extend(GeoSvg,AbstractElement),Object.defineProperties(GeoSvg.prototype,{color:{get:function(){return this._color},set:function(value){this._saveProperty(),this._color=value,this.view.setColor(value)}},element:{get:function(){return this._element},set:function(value){this._saveProperty(),this._element=value,this.view.setElement(ELEMENTS[value])}}}),GeoSvg.prototype.getFillColor=function(){return _Color2.default.getColorsSet(this[_Properties2.default.COLOR])},GeoSvg}()},{"../enums/ElementTypes.js":346,"../enums/Properties.js":358,"../utils/Base.js":405,"../utils/Color.js":409,"./AbstractElement.js":166,"./views/GeoSvgView.js":314
}],184:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("./AbstractElement.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),GlassCanvasView=_dereq_("./views/GlassCanvasView.js"),Boxable=_dereq_("./behaviors/Boxable.js");module.exports=function(){function GlassCanvas(){AbstractElement.apply(this,arguments),this.type=ElementTypes.GLASS_CANVAS,this.view=this.createView(GlassCanvasView)}return GlassCanvas.DefaultProperties={width:{value:1280},height:{value:768},backgroundImage:{value:"/p/elements/googleglass/bg_los_angeles.jpg"},idStoredFile:{value:""}},Base.Extend(GlassCanvas,AbstractElement),Base.ApplyBehavior(GlassCanvas,Boxable),Object.defineProperties(GlassCanvas.prototype,{idStoredFile:{get:function(){return this._idStoredFile},set:function(value){this._saveProperty(),this._idStoredFile=value}}}),GlassCanvas}()},{"../enums/ElementTypes.js":346,"../utils/Base.js":405,"./AbstractElement.js":166,"./behaviors/Boxable.js":224,"./views/GlassCanvasView.js":315}],185:[function(_dereq_,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}return Array.from(arr)}var _lodash=_dereq_("lodash"),_lodash2=_interopRequireDefault(_lodash),_Color=_dereq_("../utils/Color"),_Color2=_interopRequireDefault(_Color),AbstractElement=_dereq_("./AbstractElement.js"),Base=_dereq_("../utils/Base.js"),ElementsHelper=_dereq_("./helpers/ElementsHelper.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),Events=_dereq_("../enums/Events.js"),GroupView=_dereq_("./views/GroupView.js"),Logger=_dereq_("../utils/Logger.js"),Parse=_dereq_("../utils/Parse.js"),Point=_dereq_("../primitives/Point.js"),Properties=_dereq_("../enums/Properties.js"),Rectangle=_dereq_("../primitives/Rectangle.js");module.exports=function(){function deleteLinkedElements(child){child.deleteLinkedElements()}function Group(){AbstractElement.apply(this,arguments),this.type=ElementTypes.GROUP,this.view=this.createView(GroupView),this.groupEventsRef=this._getGroupEventsRef(),this._addGroupEvents(),this._storedElements=[],this._clippingRect=new Rectangle,this._isEditable=!1,this._isResizing=!1,this.children=[]}return Group.DefaultProperties={isClip:{value:!1},clip:{value:{}},isClipScrollX:{value:!1},isClipScrollY:{value:!1},storedElements:{value:[]}},Group.ExcludedProperties={x:!0,y:!0,width:!0,height:!0},Base.Extend(Group,AbstractElement),Object.defineProperties(Group.prototype,{rect:{get:function(){return this.isClip?this._clippingRect:this._rect}},isClip:{get:function(){return this._isClip},set:function(value){this._saveProperty(),this._isClip=value,this.view.setClip(value)}},clip:{get:function(){return this._clip},set:function(value){var changed=!_lodash2.default.isEqual(this._clip,value)&&!_lodash2.default.isEmpty(value)||!_lodash2.default.isEmpty(this._clip);this._saveProperty(),this._clip=value,changed&&this._updateClip(value)}},isClipScrollX:{get:function(){return this._isClipScrollX},set:function(value){this._saveProperty(),this._isClipScrollX=value,this.view.setClipScrollX(value)}},isClipScrollY:{get:function(){return this._isClipScrollY},set:function(value){this._saveProperty(),this._isClipScrollY=value,this.view.setClipScrollY(value)}},storedElements:{get:function(){return this._storedElements},set:function(value){this._saveProperty(),this._updateStoredElements(value),this._updateStoredElementsOrder(value),this.dirty=!0}},x:{get:function(){return this.rect.x},set:function(value){var delta=value-this.x,child=void 0;if(this._saveProperty(),this.rect.x=value,this.isClip&&this._updateProperty(Properties.CLIP,this.rect.serialize(),!0),!this.isClip||!this._isResizing)for(var i=0,len=this.children.length;i<len;i++)child=this.children[i],child.x+=delta;this.dirty=!0,this.dirtyPosition=!0}},y:{get:function(){return this.rect.y},set:function(value){var delta=value-this.y,child=void 0;if(this._saveProperty(),this.rect.y=value,this.isClip&&this._updateProperty(Properties.CLIP,this.rect.serialize(),!0),!this.isClip||!this._isResizing)for(var i=0,len=this.children.length;i<len;i++)child=this.children[i],child.y+=delta;this.dirty=!0,this.dirtyPosition=!0}},width:{get:function(){return this.rect.width},set:function(value){if(this.isClip)return this.rect.width=value,void this._updateProperty(Properties.CLIP,this.rect.serialize(),!0);var bb=this.getBoundingBox(),p=new Point(bb.x+this.anchorX*bb.width,bb.y+this.anchorY*bb.height);if(bb.width>0){var scaleX=value/bb.width,scaleY=1;this.containsRotatedElement()&&(scaleY=value*(bb.height/bb.width)/this.height),this.resizeFromPoint(scaleX,scaleY,p)}else this.absoluteResizeFromPoint(value,this.height,p);this.dirtyPosition=!0}},height:{get:function(){return this.rect.height},set:function(value){if(this.isClip)return this.rect.height=value,void this._updateProperty(Properties.CLIP,this.rect.serialize(),!0);var bb=this.getBoundingBox(),p=new Point(bb.x+this.anchorX*bb.width,bb.y+this.anchorY*bb.height);if(bb.height>0){var scaleX=1,scaleY=value/bb.height;this.containsRotatedElement()&&(scaleX=value*(bb.width/bb.height)/this.width),this.resizeFromPoint(scaleX,scaleY,p)}else this.absoluteResizeFromPoint(this.width,value,p);this.dirtyPosition=!0}},angle:{get:function(){return this.rect.angle},set:function(value){var delta=Parse.roundAngle(value)-this.angle;this.rotateByFromPoint(this.rect.getCenterPoint(),delta)}},keepRatio:{get:function(){return Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.KEEP_RATIO).get.call(this)||!this.isClip&&_lodash2.default.some(this.children,function(child){return child.keepRatio})},set:function(value){Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.KEEP_RATIO).set.call(this,value)}}}),Group.prototype.isGroup=function(){return!0},Group.prototype._addGroupEvents=function(){this.view.domElement.addEventListener("scroll",this.groupEventsRef.onScroll)},Group.prototype._getGroupEventsRef=function(){return{onScroll:this.onGroupScroll.bind(this)}},Group.prototype.onGroupScroll=function(){(this.Page.isPreviewMode()||this.Page.isSpecMode())&&this.setChildrenScrollOffset()},Group.prototype.updateChildren=function(immediate){for(var child=void 0,i=0,len=this.children.length;i<len;i++)child=this.children[i],immediate?child.update():child._dirty=!0,child instanceof Group&&child.updateChildren(immediate)},Group.prototype.setChildrenScrollOffset=function(){for(var child=void 0,i=0,len=this.children.length;i<len;i++)child=this.children[i],child.shouldUpdateScrollOffset=!0,child instanceof Group&&child.setChildrenScrollOffset()},Group.prototype.resizeFromPoint=function(scaleX,scaleY,point){for(var child=void 0,i=0,len=this.children.length;i<len;i++)child=this.children[i],child.resizeFromPoint(scaleX,scaleY,point);this.isClip&&this._saveProperty(),this._updateBoundingBox(),this.dirty=!0,this.dirtyPosition=!0},Group.prototype.absoluteResizeFromPoint=function(width,height,point){for(var child=void 0,i=0,len=this.children.length;i<len;i++)child=this.children[i],child.absoluteResizeFromPoint(width,width,point);this.isClip&&this._saveProperty(),this._updateBoundingBox(),this.dirty=!0,this.dirtyPosition=!0},Group.prototype.rotateByFromPoint=function(point,delta,updateChildren){var child=void 0;if(updateChildren=!!_lodash2.default.isUndefined(updateChildren)||updateChildren,this.isClip)return this.rect.angle+=delta,void this._updateProperty(Properties.CLIP,this.rect.serialize(),!0);if(this._saveProperty(),this.rect.angle+=delta,updateChildren)for(var i=0,len=this.children.length;i<len;i++)child=this.children[i],child.rotateByFromPoint(point,delta);this.dirty=!0,this.dirtyPosition=!0},Group.prototype.collaborationUpdateAngle=function(value){var delta=value-this.angle;this.rotateByFromPoint(null,delta,!1)},Group.prototype.setEditable=function(group,selectedChildren){this.isClip&&(this._isEditable=!!group,group?this.view.domElement.classList.add("clipped-edit"):this.view.domElement.classList.remove("clipped-edit")),this.parent&&this.parent.setEditable(group?this:null,selectedChildren)},Group.prototype.selectChildren=function(elements){this.parent&&this.parent.selectChildren(elements)},Group.prototype.addChildren=function(children){for(var child=void 0,i=0,len=children.length;i<len;i++)child=children[i],this._add(child),child.resetIndicators();this.dirty=!0},Group.prototype.addChild=function(child){this._add(child),this.dirty=!0},Group.prototype.addChildAt=function(child,index){this._add(child,index),this.dirty=!0},Group.prototype.replaceChild=function(newChild,oldChild){var index=this.getChildIndex(oldChild);this._replace(newChild,index),this.dirty=!0},Group.prototype.getChildAt=function(index){return this.children[index]},Group.prototype.getFirstChild=function(){return this.getChildAt(0)},Group.prototype.getChildIndex=function(child){return this.children.indexOf(child)},Group.prototype.moveChildAt=function(child,index){var currentIndex=this.getChildIndex(child);this._remove(child,currentIndex),this._add(child,index),this.dirty=!0,this.emit(Events.GROUP_REORDER)},Group.prototype.removeChild=function(child){var index=this.getChildIndex(child);if(!(index>-1))throw new Error("Element "+child.name+" is not a child of Group "+this.name);deleteLinkedElements(child),this._remove(child,index),this.dirty=!0},Group.prototype.removeAllChildren=function(){_lodash2.default.forEach(this.children,deleteLinkedElements),this._removeAll(),this.dirty=!0},Group.prototype.hitTest=function(p){if(this._preventHit(p))return null;var selectByBorder=this.Page.isPickMode(),hitChild=this._hitTestOverChildren(this.children,p);return hitChild?hitChild:(!hitChild&&selectByBorder?this.rect.hitTestMargin(p)&&!this.rect.hitTest(p):this.rect.hitTest(p))?this:null},Group.prototype.update=function(){for(var child=void 0,i=0,len=this.children.length;i<len;i++)child=this.children[i],child._dirty&&(child._dirty=!1,child.update());this._updateBoundingBox(),AbstractElement.prototype.update.call(this)},Group.prototype.containsRotatedElement=function(){for(var containsRotatedElement=void 0,i=0;i<this.children.length;i++)if(containsRotatedElement=this.children[i].containsRotatedElement())return!0;return!1},Group.prototype.clone=function(props){var storedElements=_lodash2.default.map(this.children,function(child){return child.clone().id});return AbstractElement.prototype.clone.call(this,_lodash2.default.extend({storedElements:storedElements},props))},Group.prototype.initProperties=function(props){props.isClip&&(props.clip=props.clip||{x:props[Properties.X],y:props[Properties.Y],width:props[Properties.WIDTH],height:props[Properties.HEIGHT],angle:0},this._clippingRect=new Rectangle(props.clip.x,props.clip.y,props.clip.width,props.clip.height,props.clip.angle)),AbstractElement.prototype.initProperties.call(this,props)},Group.prototype.clipGroup=function(value){this._updateProperty(Properties.IS_CLIP,value,!0),this._updateProperty(Properties.CLIP,value?this._rect.serialize():{},!0)},Group.prototype.someDescendantsKeepRatio=function(){return _lodash2.default.some(this.children,function(child){return child.keepRatio})},Group.prototype.someButNotAllDescendantsKeepRatio=function(){return this.someDescendantsKeepRatio()&&_lodash2.default.some(this.children,function(child){return!child.keepRatio})},Group.prototype.isKeepRatioDisabled=function(){return!this.isClip&&(this.someDescendantsKeepRatio()||this.containsRotatedElement())},Group.prototype._updateClip=function(value){_lodash2.default.isEmpty(value)?(this._clippingRect=new Rectangle,this._rect=new Rectangle):(this._clippingRect.angle=value.angle,this._clippingRect.x=value.x,this._clippingRect.y=value.y,this._clippingRect.width=value.width,this._clippingRect.height=value.height),this.dirty=!0,this.updateChildren()},Group.prototype._updateBoundingBox=function(){if(this.children.length){var p=new Point(0,0),angle=this.angle,bb=void 0,child=void 0;this._rect=null;for(var i=0,len=this.children.length;i<len;i++)child=this.children[i],child instanceof Group&&child._updateBoundingBox(),bb=child.getBoundingBox(!1).clone(),bb.rotateBy(p,-angle),this._rect?this._rect=this._rect.add(bb):this._rect=len>1?bb:bb.getBoundingBox(!0);this._rect.rotateBy(p,angle),this.dirtyPosition=!0}},Group.prototype._add=function(child,index){var storedElements=_lodash2.default.clone(this._storedElements);"undefined"!=typeof index&&index<this.children.length?storedElements.splice(index,0,child.id):storedElements.push(child.id),this._updateProperty(Properties.STORED_ELEMENTS,storedElements,!0)},Group.prototype._remove=function(child,index){var storedElements=_lodash2.default.clone(this._storedElements);storedElements.splice(index,1),this._updateProperty(Properties.STORED_ELEMENTS,storedElements,!0)},Group.prototype._removeAll=function(){this._updateProperty(Properties.STORED_ELEMENTS,[],!0)},Group.prototype._replace=function(newChild,index){var storedElements=_lodash2.default.clone(this._storedElements);storedElements[index]=newChild.id,this._updateProperty(Properties.STORED_ELEMENTS,storedElements,!0)},Group.prototype._updateStoredElements=function(elements){_lodash2.default.difference(elements,this._storedElements).length&&this._addToStoredElements(elements),_lodash2.default.difference(this._storedElements,elements).length&&this._removeFromStoredElements(elements)},Group.prototype._updateStoredElementsOrder=function(elements){var everyElementsInSameOrder=_lodash2.default.every(this._storedElements,function(elementId,index){return elements[index]===elementId});if(!everyElementsInSameOrder){var sortOrder=_lodash2.default.reduce(elements,function(sortOrder,elementId,order){return sortOrder[elementId]=order,sortOrder},{});this._storedElements.sort(function(value,other){return sortOrder[value]-sortOrder[other]}.bind(this)),this.children.sort(function(value,other){return sortOrder[value.id]-sortOrder[other.id]}.bind(this)),this._sortChildren()}},Group.prototype._sortChildren=function(){for(var length=this.children.length;--length>0;)this.view.domElement.insertBefore(this.children[length-1].view.domElement,this.children[length].view.domElement)},Group.prototype._addToStoredElements=function(elements){var child=void 0,index=void 0;_lodash2.default.forEach(_lodash2.default.difference(elements,this._storedElements),function(elementId){return child=this._getElementById(elementId),index=elements.indexOf(elementId),child?(child.parent&&child.parent.removeChild(child),child.setParent(this),void(index<this.children.length?(this.view.domElement.insertBefore(child.view.domElement,this.children[index].view.domElement),this.children.splice(index,0,child),this._storedElements.splice(index,0,elementId)):(this.view.domElement.appendChild(child.view.domElement),this.children.push(child),this._storedElements.push(elementId)))):Logger.error("Child (id: "+elementId+") not found in "+this.type+" (id: "+this.id+")")}.bind(this))},Group.prototype._removeFromStoredElements=function(elements){var child=void 0,index=void 0;_lodash2.default.forEach(_lodash2.default.difference(this._storedElements,elements),function(elementId){child=this._getElementById(elementId),index=this.getChildIndex(child),child.parent===this&&(child.setParent(null),this.view.domElement.removeChild(child.view.domElement)),this.children.splice(index,1),this._storedElements.splice(index,1)}.bind(this))},Group.prototype._preventHit=function(p){return!this.isVisible()||this.isClip&&!this._isEditable&&!this.rect.hitTest(p)||this.Page.isPickMode()&&this.Page.isDesignMode()&&!this.Page.isComponentEditMode()&&ElementsHelper.isAncestorComponent(this)},Group.prototype._hitTestOverChildren=function(children,p){for(var child=void 0,i=children.length;i-- >0;)if(child=children[i].hitTest(p))return child;return null},Group.prototype.isElementRendered=function(element){return this.view.domElement.contains(element)},Group.prototype.extractAssetsFromElement=function(element,onlyRenderedElements){var elementToRemove=void 0,fonts={},colors=[],gradients=[],images=[],svgs=[];this.isElementRendered(element.view.domElement)||onlyRenderedElements||(elementToRemove=element.view.domElement.cloneNode(!0),document.body.appendChild(elementToRemove));var elementFonts=element.getFonts(elementToRemove);fonts=_lodash2.default.merge(fonts,elementFonts,function(a,b){if(_lodash2.default.isArray(a))return _lodash2.default.union(a.concat(b))}),element.backgroundImage&&!_Color2.default.isGradient(element.backgroundImage)&&images.push(element.backgroundImage),element.src&&images.push(element.src),"svg"===element.view.domElement.tagName.toLowerCase()&&svgs.push(element);var elementColors=element.getColors(elementToRemove);return colors=[].concat(_toConsumableArray(colors),_toConsumableArray(elementColors.colors)),gradients=[].concat(_toConsumableArray(gradients),_toConsumableArray(elementColors.gradients)),elementToRemove&&!onlyRenderedElements&&document.body.removeChild(elementToRemove),{colors:colors,fonts:fonts,gradients:gradients,images:images,svgs:svgs}},Group.prototype.getAssets=function(elements){var _this=this,onlyRenderedElements=arguments.length>1&&void 0!==arguments[1]&&arguments[1],colors=[],fonts={},gradients=[],images=[],svgs=[],mergeAssets=function(data){fonts=_lodash2.default.merge(fonts,data.fonts,function(a,b){if(_lodash2.default.isArray(a))return _lodash2.default.union(a.concat(b))}),colors=colors.concat(data.colors),gradients=gradients.concat(data.gradients),images=images.concat(data.images),svgs=svgs.concat(data.svgs)};return _lodash2.default.forEach(elements,function(element){var data=void 0;_this.Page.isSpecModeSkippedType(element)||(element.isComponent()?_lodash2.default.forEach(element._elements,function(componentElement){data=_this.extractAssetsFromElement(componentElement,onlyRenderedElements),mergeAssets(data)}):(data=_this.extractAssetsFromElement(element,onlyRenderedElements),mergeAssets(data),element.children&&element.children.length&&(data=_this.getAssets(element.children,onlyRenderedElements),mergeAssets(data))))}),colors=_lodash2.default.uniq(_lodash2.default.compact(colors),function(color){return color.hex+color.alpha}).filter(function(color){return color.alpha}),gradients=_lodash2.default.uniq(_lodash2.default.compact(gradients)),{colors:colors,gradients:gradients,fonts:fonts,images:images,svgs:svgs}},Group.prototype.getSpecProperties=function(){var basicProperties=AbstractElement.prototype.getSpecProperties.call(this),assets=this.getAssets([this]);return _lodash2.default.extend({},basicProperties,assets)},Group.prototype.hasCustomStyles=function(){return!1},Group.prototype.getImages=function(){return _lodash2.default.reduce(this.children,function(images,child){return _lodash2.default.isFunction(child.getImages)?[].concat(_toConsumableArray(images),_toConsumableArray(child.getImages())):child.isUploadable()?[].concat(_toConsumableArray(images),[child]):images},[])},Group.prototype._getElementById=function(id){return this.componentInstance?this.componentInstance._getElementById(id):this.Page.getElementById(id)},Group}()},{"../enums/ElementTypes.js":346,"../enums/Events.js":347,"../enums/Properties.js":358,"../primitives/Point.js":403,"../primitives/Rectangle.js":404,"../utils/Base.js":405,"../utils/Color":409,"../utils/Logger.js":413,"../utils/Parse.js":415,"./AbstractElement.js":166,"./helpers/ElementsHelper.js":250,"./views/GroupView.js":316,lodash:161}],186:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Group=_dereq_("./Group.js"),Base=_dereq_("../utils/Base.js"),Properties=_dereq_("../enums/Properties.js");module.exports=function(){function GroupingInstance(){Group.apply(this,arguments)}return Base.Extend(GroupingInstance,Group),GroupingInstance.prototype.initProperties=function(props){props.initElements&&(props.storedElements=this._initChildren(props)),Group.prototype.initProperties.call(this,props)},GroupingInstance.prototype._initChildren=function(props){var elements=this.Page.ElementsManager.createGroupedElements(JSON.parse(props.initElements),props[Properties.X],props[Properties.Y]);return _.map(elements,function(element){return element.id})},GroupingInstance}()},{"../enums/Properties.js":358,"../utils/Base.js":405,"./Group.js":185,lodash:161}],187:[function(_dereq_,module,exports){"use strict";var Scrollbar=_dereq_("./Scrollbar.js"),HorizontalScrollbarView=_dereq_("./views/HorizontalScrollbarView.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js");module.exports=function(){function HorizontalScrollbar(){Scrollbar.apply(this,arguments),this.type=ElementTypes.HORIZONTAL_SCROLLBAR,this.view=this.createView(HorizontalScrollbarView)}return HorizontalScrollbar.DefaultProperties={width:{value:150,min:2*Scrollbar.SCROLL_BUTTON_SIZE},height:{value:Scrollbar.SCROLL_BUTTON_SIZE,min:Scrollbar.SCROLL_BUTTON_SIZE}},Base.Extend(HorizontalScrollbar,Scrollbar),Object.defineProperties(HorizontalScrollbar.prototype,{scrollPosition:{get:function(){return this._scrollPosition},set:function(value){this._saveProperty(),this._scrollPosition=value,this.view.setScrollPosition(value,this.width)}}}),HorizontalScrollbar}()},{"../enums/ElementTypes.js":346,"../utils/Base.js":405,"./Scrollbar.js":207,"./views/HorizontalScrollbarView.js":317}],188:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("./AbstractElement.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),Events=_dereq_("../enums/Events.js"),HotspotView=_dereq_("./views/HotspotView.js"),PageModes=_dereq_("../enums/PageModes.js");module.exports=function(){function Hotspot(){var _this=this;AbstractElement.apply(this,arguments),this.type=ElementTypes.HOTSPOT,this.view=this.createView(HotspotView),this.Page.on(Events.MODE_CHANGE,function(prevMode,nextMode){nextMode===PageModes.SPEC?_this.enableSpecMode():prevMode===PageModes.SPEC&&_this.disableSpecMode()})}return Base.Extend(Hotspot,AbstractElement),delete Hotspot.prototype.DefaultProperties.opacity,Hotspot.prototype.hasCustomStyles=function(){return!1},Hotspot.prototype.enableSpecMode=function(){this.stateIaOld=this.stateIa,this.setVisibility(!1)},Hotspot.prototype.disableSpecMode=function(){this.setVisibility("visible"===this.stateIaOld)},Hotspot}()},{"../enums/ElementTypes.js":346,"../enums/Events.js":347,"../enums/PageModes.js":357,"../utils/Base.js":405,"./AbstractElement.js":166,"./views/HotspotView.js":318}],189:[function(_dereq_,module,exports){"use strict";var SvgIcon=_dereq_("./SvgIcon.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),Base=_dereq_("../utils/Base.js");module.exports=function(){function Icon(){SvgIcon.apply(this,arguments),this.type=ElementTypes.ICON}return Base.Extend(Icon,SvgIcon),Icon}()},{"../enums/ElementTypes.js":346,"../utils/Base.js":405,"./SvgIcon.js":210}],190:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),Properties=_dereq_("../enums/Properties.js"),AbstractElement=_dereq_("./AbstractElement.js"),Uploadable=_dereq_("./behaviors/Uploadable.js"),ImageView=_dereq_("./views/ImageView.js"),ImageEditor=_dereq_("./helpers/ImageEditor.js"),Events=_dereq_("../enums/Events.js");module.exports=function(){function extractFileNameFromPath(path){return path.replace(/^.*\//,"").replace(/\?.*$/,"")}function Image(){AbstractElement.apply(this,arguments),this.type=ElementTypes.IMAGE,this.view=this.createView(ImageView),this._uploadCancelled=!1,this.isDuringProcessing=!1}var EMPTY_PLACEHOLDER="/p/imagepixel.png",adjustmentProperties=[Properties.BRIGHTNESS,Properties.CONTRAST,Properties.SATURATION,Properties.VIBRANCE,Properties.EXPOSURE,Properties.SHARPEN,Properties.BLUR];return Image.DefaultProperties={width:{value:150},height:{value:150},borderTopLeftRadius:{value:0},borderTopRightRadius:{value:0},borderBottomRightRadius:{value:0},borderBottomLeftRadius:{value:0},radiusLock:{value:!0},src:{value:EMPTY_PLACEHOLDER},srcMod:{value:""},brightness:{value:0},contrast:{value:0},saturation:{value:0},vibrance:{value:0},exposure:{value:0},sharpen:{value:0},blur:{value:0},crop:{value:[]},keepRatio:{value:!0}},Base.Extend(Image,AbstractElement),Base.ApplyBehavior(Image,Uploadable),Object.defineProperties(Image.prototype,{shouldUpdateSrc:{get:function(){return this._shouldUpdateSrc},set:function(value){this._shouldUpdateSrc=value,value&&(this.dirty=value)}},borderTopLeftRadius:{get:function(){return this._borderTopLeftRadius},set:function(value){this._saveProperty(),this._borderTopLeftRadius=value,this.view.setBorderTopLeftRadius(value)}},borderTopRightRadius:{get:function(){return this._borderTopRightRadius},set:function(value){this._saveProperty(),this._borderTopRightRadius=value,this.view.setBorderTopRightRadius(value)}},borderBottomRightRadius:{get:function(){return this._borderBottomRightRadius},set:function(value){this._saveProperty(),this._borderBottomRightRadius=value,this.view.setBorderBottomRightRadius(value)}},borderBottomLeftRadius:{get:function(){return this._borderBottomLeftRadius},set:function(value){this._saveProperty(),this._borderBottomLeftRadius=value,this.view.setBorderBottomLeftRadius(value)}},radiusLock:{get:function(){return this._radiusLock},set:function(value){this._saveProperty(),this._radiusLock=value}},src:{get:function(){return this._src},set:function(value){this._saveProperty(),this._src=value,this._resetModifications(),this.shouldUpdateSrc=!0}},srcCdn:{get:function(){if(!this._src)return this._getCdnUrl(this._src)}},srcMod:{get:function(){return this._srcMod},set:function(value){this._saveProperty(),this._srcMod=value,this.shouldUpdateSrc=!0}},brightness:{get:function(){return this._brightness},set:function(value){this._saveProperty(),this._brightness=value,this.dirty=!0}},contrast:{get:function(){return this._contrast},set:function(value){this._saveProperty(),this._contrast=value,this.dirty=!0}},saturation:{get:function(){return this._saturation},set:function(value){this._saveProperty(),this._saturation=value,this.dirty=!0}},vibrance:{get:function(){return this._vibrance},set:function(value){this._saveProperty(),this._vibrance=value,this.dirty=!0}},exposure:{get:function(){return this._exposure},set:function(value){this._saveProperty(),this._exposure=value,this.dirty=!0}},sharpen:{get:function(){return this._sharpen},set:function(value){this._saveProperty(),this._sharpen=value,this.dirty=!0}},blur:{get:function(){return this._blur},set:function(value){this._saveProperty(),this._blur=value,this.dirty=!0}},crop:{get:function(){return this._crop},set:function(value){this._saveProperty(),this._crop=value,this.cancelUpload()}}}),Image.prototype.setLoading=function(value){this.view.setLoading(value)},Image.prototype.updateCrop=function(imageRect,cropRect,src){var crop=_.clone(this.crop);crop.push({left:cropRect.x,top:cropRect.y,width:cropRect.width,height:cropRect.height,prevWidth:this.width,prevHeight:this.height}),this.Page.ElementsManager.startBatch(),this._updateProperty(Properties.X,imageRect.x,!0),this._updateProperty(Properties.Y,imageRect.y,!0),this._updateProperty(Properties.WIDTH,imageRect.width,!0),this._updateProperty(Properties.HEIGHT,imageRect.height,!0),this._updateProperty(Properties.SRC_MOD,src,!0),this._updateProperty(Properties.CROP,crop,!0),this.Page.ElementsManager.endBatch()},Image.prototype.updateAdjustments=function(adjustments,src){this.Page.ElementsManager.startBatch(),_.forEach(adjustments,function(value,property){this._updateProperty(property,value,!0)}.bind(this)),this._updateProperty(Properties.SRC_MOD,src,!0),this.Page.ElementsManager.endBatch()},Image.prototype.isAdjusted=function(){return _.some(adjustmentProperties,function(property){return this[property]!==this.DefaultProperties[property].value}.bind(this))},Image.prototype.isCropped=function(){return!_.isEmpty(this.crop)},Image.prototype.onCompletedModifiedUpload=function(src){ImageEditor.PreloadImage(src).then(function(){this.updateModifiedImageSrc(src),this.setCompleted()}.bind(this))},Image.prototype.updateModifiedImageSrc=function(src){return!this._uploadCancelled&&(this.Page.ElementsManager.startBatch(!1,!1),this._updateProperty(Properties.SRC_MOD,src,!0),void this.Page.ElementsManager.endBatch())},Image.prototype.createModifiedFileName=function(){var pageId=this.Page.pageId,modififiedPrefix="uxpmod_"+this.id+"_"+pageId+"_",name=extractFileNameFromPath(this.src);return modififiedPrefix+name},Image.prototype.cancelUpload=function(){this._uploadCancelled=!0,this.hideProgress()},Image.prototype.enableUpload=function(){this._uploadCancelled=!1},Image.prototype.onStartCrop=function(imageCropElement){imageCropElement&&(this._imageCropElement=imageCropElement)},Image.prototype.onCancelCrop=function(){this._imageCropElement=null},Image.prototype.hitTest=function(p){return this._imageCropElement?this._imageCropElement.hitTest(p):AbstractElement.prototype.hitTest.call(this,p)},Image.prototype.update=function(){var src;this.shouldUpdateSrc&&(this.shouldUpdateSrc=!1,src=_.isEmpty(this.srcMod)?this.src:this.srcMod,this.view.setSrc(this._getCdnUrl(src),this.Page.isDesignMode())),AbstractElement.prototype.update.call(this)},Image.prototype.isEmpty=function(){return this.src===EMPTY_PLACEHOLDER},Image.prototype.isSmall=function(){return this.width<225||this.height<145},Image.prototype.imageProcessingStart=function(){this.isDuringProcessing=!0,this.Page.emit(Events.IMAGE_PROCESSING,!0)},Image.prototype.imageProcessingEnd=function(){this.isDuringProcessing=!1,this.Page.emit(Events.IMAGE_PROCESSING,!1)},Image.prototype._resetModifications=function(){this._srcMod="",this._crop=[],this._brightness=0,this._contrast=0,this._saturation=0,this._vibrance=0,this._exposure=0,this._sharpen=0,this._blur=0},Image}()},{"../enums/ElementTypes.js":346,"../enums/Events.js":347,"../enums/Properties.js":358,"../utils/Base.js":405,"./AbstractElement.js":166,"./behaviors/Uploadable.js":240,"./helpers/ImageEditor.js":251,"./views/ImageView.js":320,lodash:161}],191:[function(_dereq_,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var _Properties=_dereq_("../enums/Properties.js"),_Properties2=_interopRequireDefault(_Properties),_CssHelper=_dereq_("./helpers/CssHelper"),_Color=_dereq_("../utils/Color"),_Color2=_interopRequireDefault(_Color),_lodash=_dereq_("lodash"),_lodash2=_interopRequireDefault(_lodash),ImageView=_dereq_("./views/ImageView.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),AbstractElement=_dereq_("./AbstractElement.js");module.exports=function(){function ImageSketch(){AbstractElement.apply(this,arguments),this.type=ElementTypes.IMAGE_SKETCH,this.view=this.createView(ImageView)}return ImageSketch.DefaultProperties={src:{value:""},styles:[],inputValue:{value:""},importedDimensions:{value:{}}},Base.Extend(ImageSketch,AbstractElement),Object.defineProperties(ImageSketch.prototype,{src:{get:function(){return this._src},set:function(value){this._saveProperty(),this._src=value,this.view.setSrc(this._getCdnUrl(value))}},styles:{get:function(){return(0,_CssHelper.parseCss)(this._styles)},set:function(value){this._saveProperty(),this._styles=value,this.styles.filter?(this.shadows=this.extractDropShadowData(this.styles.filter),this.view.setFilter(this.getDropShadowStyle(this.shadows))):(this.shadows=[],this.view.setFilter(null))}},inputValue:{get:function(){return this._inputValue},set:function(value){this._saveProperty(),this._inputValue=value}},importedDimensions:{get:function(){return _lodash2.default.clone(this._importedDimensions)},set:function(value){this._saveProperty(),this._importedDimensions=value}}}),ImageSketch.prototype.getDropShadowStyle=function(shadows){
return shadows.map(function(shadow){return"drop-shadow("+shadow.x+"px "+shadow.y+"px "+shadow.blur+"px "+shadow.color.rgba+")"}).join(" ")},ImageSketch.prototype.fillShadowArray=function(shadowArray){var DEFAULT_VALUES={BLUR:"0px",SPREAD:"0px",COLOR:"#000000"};switch(shadowArray.length){case 2:return shadowArray.concat(DEFAULT_VALUES.BLUR,DEFAULT_VALUES.SPREAD,DEFAULT_VALUES.COLOR);case 3:return _Color2.default.isValid(shadowArray[2])?[shadowArray[0],shadowArray[1],DEFAULT_VALUES.BLUR,DEFAULT_VALUES.SPREAD,shadowArray[2]]:shadowArray.concat(DEFAULT_VALUES.SPREAD,DEFAULT_VALUES.COLOR);case 4:return _Color2.default.isValid(shadowArray[3])?[shadowArray[0],shadowArray[1],shadowArray[2],DEFAULT_VALUES.SPREAD,shadowArray[3]]:shadowArray.concat(DEFAULT_VALUES.COLOR);default:return shadowArray}},ImageSketch.prototype.getDropShadowData=function(shadow){var data=shadow.trim().match(/^drop-shadow\((.*)\)/);if(!data[1])return{};var shadowArray=data[1].trim().split(" ");return this.fillShadowArray(shadowArray).reduce(function(previousValue,currentValue,index){var color;switch(index){case 0:previousValue.x=parseInt(currentValue.trim());break;case 1:previousValue.y=parseInt(currentValue.trim());break;case 2:previousValue.blur=parseInt(currentValue.trim());break;case 3:previousValue.spread=parseInt(currentValue.trim());break;case 4:color=_Color2.default.getColorsSet(currentValue),previousValue.color=color||{}}return previousValue},{})},ImageSketch.prototype.extractDropShadowData=function(filter){var _this=this,shadows=filter.match(/drop-shadow\(( -?\d*(px)?)+[ a-zA-Z0-9.,#\(\)]+\)/g)||[];return _lodash2.default.compact(shadows.map(function(shadow){return _this.getDropShadowData(shadow)}))},ImageSketch.prototype.getGradient=function(){return _Color2.default.isGradient(this.styles.backgroundImage)?this.styles.backgroundImage:null},ImageSketch.prototype.getBackgroundColor=function(){return this.styles.backgroundColor?_Color2.default.getColorsSet(this.styles.backgroundColor):null},ImageSketch.prototype.getBorderColor=function(){var borderData=this.extractBorderData();return borderData.borderColor?borderData.borderColor:null},ImageSketch.prototype.extractBorderData=function(){var data=void 0,bordersData=void 0,borderRadius=void 0,borderWidth=void 0;if(!this.styles.border&&!this.styles.borderRadius)return{};if(this.styles.border){var _bordersData;data=this.styles.border.split(" "),borderWidth=parseInt(data[0])||0,_bordersData={},_defineProperty(_bordersData,_Properties2.default.BORDER_BOTTOM_WIDTH,borderWidth),_defineProperty(_bordersData,_Properties2.default.BORDER_LEFT_WIDTH,borderWidth),_defineProperty(_bordersData,_Properties2.default.BORDER_RIGHT_WIDTH,borderWidth),_defineProperty(_bordersData,_Properties2.default.BORDER_TOP_WIDTH,borderWidth),_defineProperty(_bordersData,_Properties2.default.BORDER_STYLE,data[1]),_defineProperty(_bordersData,_Properties2.default.BORDER_COLOR,_Color2.default.getColorsSet(data[2])),bordersData=_bordersData}if(this.styles.borderRadius){var _$extend;borderRadius=parseInt(this.styles.borderRadius)||0,bordersData=_lodash2.default.extend({},bordersData,(_$extend={},_defineProperty(_$extend,_Properties2.default.BORDER_BOTTOM_LEFT_RADIUS,borderRadius),_defineProperty(_$extend,_Properties2.default.BORDER_BOTTOM_RIGHT_RADIUS,borderRadius),_defineProperty(_$extend,_Properties2.default.BORDER_TOP_LEFT_RADIUS,borderRadius),_defineProperty(_$extend,_Properties2.default.BORDER_TOP_RIGHT_RADIUS,borderRadius),_$extend))}return bordersData},ImageSketch.prototype.getFonts=function(){var font=_lodash2.default.pick(this.styles,["fontFamily","lineHeight","fontSize","letterSpacing","fontWeight","textAlign","color"]);return this.initFontsCollection(),font.fontFamily&&(font.fontName=font.fontFamily,font.fontData={family:font.fontFamily,fvd:font.fontWeight},this.addFontToCollection(font)),this._fontsCollection},ImageSketch.prototype.getSpecProperties=function(){var basicProperties=AbstractElement.prototype.getSpecProperties.call(this);return _lodash2.default.extend(basicProperties,{backgroundColor:_Color2.default.getColorsSet(this.styles.backgroundColor),gradient:this.getGradient(this.styles),shadows:this.shadows,boxShadow:this.styles.boxShadow,transform:this.styles.transform,opacity:Math.round(100*parseFloat(this.styles.opacity))||100},this.importedDimensions,this.extractBorderData())},ImageSketch.prototype.getTextContent=function(){return(this.inputValue||"").trim()},ImageSketch}()},{"../enums/ElementTypes.js":346,"../enums/Properties.js":358,"../utils/Base.js":405,"../utils/Color":409,"./AbstractElement.js":166,"./helpers/CssHelper":247,"./views/ImageView.js":320,lodash:161}],192:[function(_dereq_,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _Properties=_dereq_("../enums/Properties.js"),_Color=(_interopRequireDefault(_Properties),_dereq_("../utils/Color.js")),AbstractElement=(_interopRequireDefault(_Color),_dereq_("./AbstractElement.js")),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),Input2View=_dereq_("./views/Input2View.js"),SimpleTextEditable=_dereq_("./behaviors/SimpleTextEditable.js"),Boxable=_dereq_("./behaviors/Boxable.js");module.exports=function(){function Input2(){AbstractElement.apply(this,arguments),this.type=ElementTypes.INPUT2,this.view=this.createView(Input2View)}return Input2.DefaultProperties={width:{value:300},height:{value:30},backgroundColor:{value:"#FFFFFF"},borderColor:{value:"#c8c8c8"},borderTopWidth:{value:1},borderBottomWidth:{value:1},borderLeftWidth:{value:1},borderRightWidth:{value:1},inactive:{value:0},inputType:{value:"text"},required:{value:0},clickIdPage:{value:""},boxShadow:{value:""},color:{value:"#474747"},paddingTop:{value:0},paddingRight:{value:10},paddingBottom:{value:0},paddingLeft:{value:10},textAlign:{value:"left"}},Base.Extend(Input2,AbstractElement),Base.ApplyBehavior(Input2,SimpleTextEditable),Base.ApplyBehavior(Input2,Boxable),Object.defineProperties(Input2.prototype,{inactive:{get:function(){return this._inactive},set:function(value){this._saveProperty(),this._inactive=value,this.view.setInactive(value)}},inputType:{get:function(){return this._inputType},set:function(value){this._saveProperty(),this._inputType=value,this.view.setInputType(value)}},required:{get:function(){return this._required},set:function(value){this._saveProperty(),this._required=value,this.view.setRequired(value)}},clickIdPage:{get:function(){return this._clickIdPage},set:function(value){this._saveProperty(),this._clickIdPage=value}},boxShadow:{get:function(){return this._boxShadow},set:function(value){this._saveProperty(),this._boxShadow=value,this.view.setBoxShadow(value)}},paddingTop:{get:function(){return this._paddingTop},set:function(value){this._saveProperty(),this._paddingTop=value,this.view.setPaddingTop(value)}},paddingRight:{get:function(){return this._paddingRight},set:function(value){this._saveProperty(),this._paddingRight=value,this.view.setPaddingRight(value)}},paddingBottom:{get:function(){return this._paddingBottom},set:function(value){this._saveProperty(),this._paddingBottom=value,this.view.setPaddingBottom(value)}},paddingLeft:{get:function(){return this._paddingLeft},set:function(value){this._saveProperty(),this._paddingLeft=value,this.view.setPaddingLeft(value)}}}),Input2.prototype.isTextInput=function(){return!0},Input2.prototype.getFonts=function(domEl){var font=this.getFontFromDOMElement(domEl||this.view.domElement);return this.initFontsCollection(),this.addFontToCollection(font),this._fontsCollection},Input2}()},{"../enums/ElementTypes.js":346,"../enums/Properties.js":358,"../utils/Base.js":405,"../utils/Color.js":409,"./AbstractElement.js":166,"./behaviors/Boxable.js":224,"./behaviors/SimpleTextEditable.js":236,"./views/Input2View.js":321}],193:[function(_dereq_,module,exports){"use strict";var Base=_dereq_("../utils/Base.js"),AbstractElement=_dereq_("./AbstractElement.js"),InputWithLabelView=_dereq_("./views/InputWithLabelView.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),TextStyleHelper=_dereq_("./helpers/TextStyleHelper.js");module.exports=function(){function InputWithLabel(){AbstractElement.apply(this,arguments),this.type=ElementTypes.INPUT_WITH_LABEL,this.view=this.createView(InputWithLabelView)}return InputWithLabel.DefaultProperties={height:{value:100,min:20},labelPosition:{value:"left"},labelText:{value:""},inputValue:{value:""},labelWidth:{value:50},inputWidth:{value:130},fontWeight:{value:"normal"},fontStyle:{value:"normal"},fontSize:{value:"14px"},fontFamily:{value:"S-Arial-n4"},textDecoration:{value:""},textAlign:{value:"none"},color:{value:"#474747"},inactive:{value:0},required:{value:0},inputType:{value:"text"},borderTopLeftRadius:{value:0},borderTopRightRadius:{value:0},borderBottomRightRadius:{value:0},borderBottomLeftRadius:{value:0},clickIdPage:{value:""}},Base.Extend(InputWithLabel,AbstractElement),Object.defineProperties(InputWithLabel.prototype,{labelPosition:{get:function(){return this._labelPosition},set:function(value){this._saveProperty(),this._labelPosition=value,this.view.setLabelPosition(value)}},labelText:{get:function(){return this._labelText},set:function(value){this._saveProperty(),this._labelText=value,this.view.setLabelText(value)}},inputValue:{get:function(){return this._inputValue},set:function(value){this._saveProperty(),this._inputValue=value,this.view.setInputValue(value)}},labelWidth:{get:function(){return this._labelWidth},set:function(value){this._saveProperty(),this._labelWidth=value,this.view.setLabelWidth(value)}},inputWidth:{get:function(){return this._inputWidth},set:function(value){this._saveProperty(),this._inputWidth=value,this.view.setInputWidth(value)}},fontSize:{get:function(){return this._fontSize},set:function(value){this._saveProperty(),this._fontSize=value,this.view.setFontSize(value)}},fontWeight:{get:function(){return this._fontWeight},set:function(value){this._saveProperty(),this._fontWeight=value,this.view.setFontWeight(value)}},fontStyle:{get:function(){return this._fontStyle},set:function(value){this._saveProperty(),this._fontStyle=value,this.view.setFontStyle(value)}},fontFamily:{get:function(){return this._fontFamily},set:function(value){this._saveProperty(),this._fontFamily=value,this.view.setFontFamily(TextStyleHelper.SanitizeFontName(value))}},textDecoration:{get:function(){return this._textDecoration},set:function(value){this._saveProperty(),this._textDecoration=value,this.view.setTextDecoration(value)}},textAlign:{get:function(){return this._textAlign},set:function(value){this._saveProperty(),this._textAlign=value,this.view.setTextAlign(value)}},color:{get:function(){return this._color},set:function(value){this._saveProperty(),this._color=value,this.view.setColor(value)}},inactive:{get:function(){return this._inactive},set:function(value){this._saveProperty(),this._inactive=value,this.view.setInactive(value)}},inputType:{get:function(){return this._inputType},set:function(value){this._saveProperty(),this._inputType=value,this.view.setInputType(value)}},required:{get:function(){return this._required},set:function(value){this._saveProperty(),this._required=value,this.view.setRequired(value)}},clickIdPage:{get:function(){return this._clickIdPage},set:function(value){this._saveProperty(),this._clickIdPage=value}},borderTopLeftRadius:{get:function(){return this._borderTopLeftRadius},set:function(value){this._saveProperty(),this._borderTopLeftRadius=value,this.view.setBorderTopLeftRadius(value)}},borderTopRightRadius:{get:function(){return this._borderTopRightRadius},set:function(value){this._saveProperty(),this._borderTopRightRadius=value,this.view.setBorderTopRightRadius(value)}},borderBottomRightRadius:{get:function(){return this._borderBottomRightRadius},set:function(value){this._saveProperty(),this._borderBottomRightRadius=value,this.view.setBorderBottomRightRadius(value)}},borderBottomLeftRadius:{get:function(){return this._borderBottomLeftRadius},set:function(value){this._saveProperty(),this._borderBottomLeftRadius=value,this.view.setBorderBottomLeftRadius(value)}}}),InputWithLabel}()},{"../enums/ElementTypes.js":346,"../utils/Base.js":405,"./AbstractElement.js":166,"./helpers/TextStyleHelper.js":261,"./views/InputWithLabelView.js":322}],194:[function(_dereq_,module,exports){"use strict";var TextElement=_dereq_("./TextElement.js"),LabelView=_dereq_("./views/LabelView.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js");module.exports=function(){function Label(){TextElement.apply(this,arguments),this.type=ElementTypes.LABEL,this.view=this.createView(LabelView)}return Base.Extend(Label,TextElement),Label}()},{"../enums/ElementTypes.js":346,"../utils/Base.js":405,"./TextElement.js":216,"./views/LabelView.js":323}],195:[function(_dereq_,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _Color=_dereq_("../utils/Color.js"),_Color2=_interopRequireDefault(_Color),AbstractElement=_dereq_("./AbstractElement.js"),LineView=_dereq_("./views/LineView.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),Properties=_dereq_("../enums/Properties.js");module.exports=function(){function Line(){AbstractElement.apply(this,arguments),this.type=ElementTypes.LINE,this.view=this.createView(LineView),this.shouldUpdateLineSvg=!1}return Line.HORIZONTAL="horizontal",Line.VERTICAL="vertical",Line.DefaultProperties={height:{value:11},lineOrientation:{value:Line.HORIZONTAL,options:[Line.HORIZONTAL,Line.VERTICAL]},color:{value:"#8A8A8A"},lineType:{value:"solid",options:["solid","dotted","dashed"]}},Base.Extend(Line,AbstractElement),Object.defineProperties(Line.prototype,{width:{get:function(){return Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.WIDTH).get.call(this)},set:function(value){this.shouldUpdateLineSvg=!0,Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.WIDTH).set.call(this,value)}},height:{get:function(){return Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.HEIGHT).get.call(this)},set:function(value){this.shouldUpdateLineSvg=!0,Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.HEIGHT).set.call(this,value)}},lineOrientation:{get:function(){return this._lineOrientation},set:function(value){var width=this.width,height=this.height;this.lineOrientation&&value!==this.lineOrientation&&(width=this.height,height=this.width),this._saveProperty(),this._lineOrientation=value,width!==this.width&&(this.width=width),height!==this.height&&(this.height=height),this.shouldUpdateLineSvg=!0}},color:{get:function(){return this._color},set:function(value){this._saveProperty(),this._color=value,this.view.setStroke(value)}},lineType:{get:function(){return this._lineType},set:function(value){this._saveProperty(),this._lineType=value,this.shouldUpdateLineSvg=!0}},shouldUpdateLineSvg:{get:function(){return this._shouldUpdateLineSvg},set:function(value){this._shouldUpdateLineSvg=value,value&&(this.dirty=value)}}}),Line.prototype.update=function(){this.shouldUpdateLineSvg&&(this.view.updateLineSvg(this),this.shouldUpdateLineSvg=!1),AbstractElement.prototype.update.call(this)},Line.prototype.isHorizontal=function(){return this.lineOrientation===Line.HORIZONTAL},Line.prototype.isVertical=function(){return this.lineOrientation===Line.VERTICAL},Line.prototype.resizeFromPoint=function(){this.shouldUpdateLineSvg=!0,AbstractElement.prototype.resizeFromPoint.apply(this,arguments)},Line.prototype.getFillColor=function(){return _Color2.default.getColorsSet(this[Properties.COLOR])},Line}()},{"../enums/ElementTypes.js":346,"../enums/Properties.js":358,"../utils/Base.js":405,"../utils/Color.js":409,"./AbstractElement.js":166,"./views/LineView.js":324}],196:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("./AbstractElement.js"),TextEditable=_dereq_("./behaviors/TextEditable.js"),LinkView=_dereq_("./views/LinkView.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js");module.exports=function(){function Link(){AbstractElement.apply(this,arguments),this.type=ElementTypes.LINK,this.view=this.createView(LinkView)}return Link.DefaultProperties={width:{value:160},height:{value:20},clickIdPage:{value:""},inputValue:{value:'<span style="text-decoration: underline;"><span style="color: #3498db;">link</span></span>'},textAlign:{value:"left"}},Base.Extend(Link,AbstractElement),Base.ApplyBehavior(Link,TextEditable),Object.defineProperties(Link.prototype,{clickIdPage:{get:function(){return this._clickIdPage},set:function(value){this._saveProperty(),this._clickIdPage=value}}}),Link.prototype.adjustHeightToText=function(){return!0},Link}()},{"../enums/ElementTypes.js":346,"../utils/Base.js":405,"./AbstractElement.js":166,"./behaviors/TextEditable.js":238,"./views/LinkView.js":326}],197:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("./AbstractElement.js"),SimpleTextEditable=_dereq_("./behaviors/SimpleTextEditable.js"),LinkListView=_dereq_("./views/LinkListView.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),InteractionsHelper=_dereq_("../interactions/InteractionsHelper.js"),InteractionsActions=_dereq_("../enums/InteractionActions.js");module.exports=function(){function LinkList(){AbstractElement.apply(this,arguments),this.type=ElementTypes.LINK_LIST,this.view=this.createView(LinkListView),this.Page.isPreviewMode()&&this.addLinkEvent(),this._shouldRestyleAnchors=!1}return LinkList.DefaultProperties={width:{value:70},height:{value:40},headerDisplay:{value:0,options:[1,0]},headerText:{value:"Header"},inputValue:{value:[{text:"Link 1"},{text:"Link 2"}]},headerColor:{value:"#000000"},headerFontWeight:{value:"bold"},headerFontStyle:{value:"normal"},headerFontSize:{value:"14px"},headerFontFamily:{value:"Arial"},headerTextDecoration:{value:"none"},headerTextAlign:{value:"left"},color:{value:"#3498db"},textAlign:{value:"left"}},Base.Extend(LinkList,AbstractElement),Base.ApplyBehavior(LinkList,SimpleTextEditable),Object.defineProperties(LinkList.prototype,{shouldRestyleAnchors:{get:function(){return this._shouldRestyleAnchors},set:function(value){this._shouldRestyleAnchors=value,value&&(this.dirty=value)}},inputValue:{get:function(){return this._inputValue},set:function(value){this._saveProperty(),this._inputValue=value,this.view.setInputValue(value),this.shouldRestyleAnchors=!0}},headerDisplay:{get:function(){return this._headerDisplay},set:function(value){this._saveProperty(),this._headerDisplay=value,this.view.setHeaderDisplay(value)}},headerText:{get:function(){return this._headerText},set:function(value){this._saveProperty(),this._headerText=value,this.view.setHeaderText(value)}},headerColor:{get:function(){return this._headerColor},set:function(value){this._saveProperty(),this._headerColor=value,this.view.setHeaderColor(value)}},headerFontWeight:{get:function(){return this._headerFontWeight},set:function(value){this._saveProperty(),this._headerFontWeight=value,this.view.setHeaderFontWeight(value)}},headerFontStyle:{get:function(){return this._headerFontStyle},set:function(value){this._saveProperty(),this._headerFontStyle=value,this.view.setHeaderFontStyle(value)}},headerFontSize:{get:function(){return this._headerFontSize},set:function(value){this._saveProperty(),this._headerFontSize=value,this.view.setHeaderFontSize(value)}},headerFontFamily:{get:function(){return this._headerFontFamily},set:function(value){this._saveProperty(),this._headerFontFamily=value,this.view.setHeaderFontFamily(value)}},headerTextDecoration:{get:function(){return this._headerTextDecoration},set:function(value){this._saveProperty(),this._headerTextDecoration=value,this.view.setHeaderTextDecoration(value)}},headerTextAlign:{get:function(){return this._headerTextAlign},set:function(value){this._saveProperty(),this._headerTextAlign=value,this.view.setHeaderTextAlign(value)}}}),LinkList.prototype.isTextEditable=function(){return!1},LinkList.prototype.addLinkEvent=function(){this.view.domElement.addEventListener("click",this.mouseDownHandler.bind(this))},LinkList.prototype.mouseDownHandler=function(e){e.target.dataset.pageId&&InteractionsHelper.ApplyInteractionEffect(this,{action:InteractionsActions.LINK_PAGE,value:{id_page:e.target.dataset.pageId,target:!1}})},LinkList.prototype.update=function(){this.shouldRestyleAnchors&&(this.view.setColor(this.color),this.shouldRestyleAnchors=!1),AbstractElement.prototype.update.call(this)},LinkList.prototype.getTextContent=function(){return(this.inputValue||[]).map(function(value){return value.text}).join("\n")},LinkList}()},{"../enums/ElementTypes.js":346,"../enums/InteractionActions.js":350,"../interactions/InteractionsHelper.js":379,"../utils/Base.js":405,"./AbstractElement.js":166,"./behaviors/SimpleTextEditable.js":236,"./views/LinkListView.js":325}],198:[function(_dereq_,module,exports){"use strict";var SvgIcon=_dereq_("./SvgIcon.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),Base=_dereq_("../utils/Base.js");module.exports=function(){function MaterialIcon(){SvgIcon.apply(this,arguments),this.type=ElementTypes.MATERIAL_ICON}return Base.Extend(MaterialIcon,SvgIcon),MaterialIcon}()},{"../enums/ElementTypes.js":346,"../utils/Base.js":405,"./SvgIcon.js":210}],199:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Box=_dereq_("./Box.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js");module.exports=function(){function menuValueToString(value){return _.map(value,function(item){return item.label}).join(" | ")}function Menu(){Box.apply(this,arguments),this.type=ElementTypes.MENU}return Menu.DefaultProperties={menuValue:{value:[]}},Base.Extend(Menu,Box),Object.defineProperties(Menu.prototype,{menuValue:{get:function(){return this._menuValue},set:function(value){this._saveProperty(),this._menuValue=value,this.view.setInputValue(menuValueToString(value))}}}),Menu.prototype.isTextEditable=function(){return!1},Menu.prototype.isRichTextEditable=function(){return!1},Menu}()},{"../enums/ElementTypes.js":346,"../utils/Base.js":405,"./Box.js":171,lodash:161}],200:[function(_dereq_,module,exports){"use strict";var SvgSymbol=_dereq_("./SvgSymbol.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),Base=_dereq_("../utils/Base.js"),MobileSymbolView=_dereq_("./views/MobileSymbolView.js"),ImageEditor=_dereq_("./helpers/ImageEditor.js"),Properties=_dereq_("../enums/Properties.js");module.exports=function(){function createSvgSrc(element){var svgSrc=element.svgSrc;return!svgSrc&&element.data&&element.originalHeight&&element.originalWidth&&(svgSrc=ImageEditor.GetBlobSrcFromSvg(element.data,element.originalWidth,element.originalHeight)),svgSrc}function MobileSymbol(){SvgSymbol.apply(this,arguments),this.type=ElementTypes.MOBILE_SYMBOL,this.view=this.createView(MobileSymbolView),this._shouldUpdateSvgSrc=!1,this._shouldUpdateCssClass=!1}return MobileSymbol.DefaultProperties={elementsConfig:{value:""},cssClass:{value:""},svgSrc:{value:""}},Base.Extend(MobileSymbol,SvgSymbol),Object.defineProperties(MobileSymbol.prototype,{shouldUpdateSvgSrc:{get:function(){return this._shouldUpdateSvgSrc},set:function(value){this._shouldUpdateSvgSrc=value,value&&(this.dirty=value)}},shouldUpdateCssClass:{get:function(){return this._shouldUpdateCssClass},set:function(value){this._shouldUpdateCssClass=value,value&&(this.dirty=value)}},elementsConfig:{get:function(){return this._elementsConfig},set:function(value){this._saveProperty(),this._elementsConfig=value}},cssClass:{get:function(){return this._cssClass},set:function(value){this._saveProperty(),this._cssClass=value,this.shouldUpdateCssClass=!0}},svgSrc:{get:function(){return this._svgSrc},set:function(value){this._saveProperty(),this._svgSrc=value,this.shouldUpdateSvgSrc=!0}},data:{get:function(){return this._data},set:function(value){this._saveProperty(),this._data=value,this.shouldUpdateSvgSrc=!0}}}),MobileSymbol.prototype.update=function(){this.shouldUpdateSvgSrc&&(this.view.setSvgSrc(this._getCdnUrl(createSvgSrc(this))),this.shouldUpdateSvgSrc=!1),this.shouldUpdateCssClass&&(this.view.setCssClass(this.cssClass),this.shouldUpdateCssClass=!1),SvgSymbol.prototype.update.call(this)},MobileSymbol.prototype.setSymbol=function(id,props){var width=this.width,height=this.height,ratio=width/height,width2=props.width,height2=props.height,ratio2=width2/height2;this.Page.ElementsManager.startBatch(),(ratio>1&&ratio2<1||ratio<1&&ratio2>1)&&(this._updateProperty(Properties.WIDTH,height,!0),this._updateProperty(Properties.HEIGHT,width,!0)),this._updateProperty(Properties.SVG_SRC,props.svgSrc,!0),this._updateProperty(Properties.CURRENT_ELEMENT_ID,id,!0),this.Page.ElementsManager.endBatch()},MobileSymbol}()},{"../enums/ElementTypes.js":346,"../enums/Properties.js":358,"../utils/Base.js":405,"./SvgSymbol.js":212,"./helpers/ImageEditor.js":251,"./views/MobileSymbolView.js":327}],201:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),AbstractElement=_dereq_("./AbstractElement.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),Events=_dereq_("../enums/Events.js"),Group=_dereq_("./Group.js"),InteractionTriggers=_dereq_("../enums/InteractionTriggers.js"),MultistateView=_dereq_("./views/MultistateView.js"),PageModes=_dereq_("../enums/PageModes.js"),Point=_dereq_("../primitives/Point.js"),Properties=_dereq_("../enums/Properties.js"),Rectangle=_dereq_("../primitives/Rectangle.js"),RemoveHelper=_dereq_("./helpers/RemoveHelper.js"),Tree=_dereq_("../utils/Tree.js");module.exports=function(){function getDefaultState(states){return _.find(states,{type:DEFAULT})}function getState(states,stateId){return _.find(states,function(state){return state.id===stateId})}function getStateIndex(states,state){return states.indexOf(state)}function getNextId(states){return _.reduce(states,function(id,state){return Math.max(id,state.id)},0)+1}function getElementsForAllStates(states){return _.reduce(states,function(elements,state){return elements.concat(state.elements)},[])}function getNextState(states,currentStateId){var stateIndex=getStateIndex(states,getState(states,currentStateId));return states[stateIndex>=states.length-1?0:stateIndex+1].id}function getPreviousState(states,currentStateId){var stateIndex=getStateIndex(states,getState(states,currentStateId));return states[stateIndex<1?states.length-1:stateIndex-1].id}function getStateForElement(states,elementId){return _.find(states,function(state){return state.elements.indexOf(elementId)>-1})}function removeElementFromState(state,elementId){state.elements=_.filter(state.elements,function(childId){return childId!==elementId})}function Multistate(){var _this=this;Group.apply(this,arguments),this.type=ElementTypes.MULTISTATE,this.view=this.createView(MultistateView),this._animatingToState=null,this.Page.on(Events.MODE_CHANGE,function(prevMode,nextMode){nextMode===PageModes.PREVIEW?_this.enablePreviewMode():prevMode===PageModes.PREVIEW&&_this.disablePreviewMode()})}var DEFAULT="default",DEFAULT_STATE_NAME="First state",DEFAULT_BB={x:0,y:0,width:100,height:100};return Multistate.DefaultProperties={states:{value:[]},multistateOrigin:{value:""}},Multistate.ExcludedProperties={storedElements:!0},Base.Extend(Multistate,Group),Object.defineProperties(Multistate.prototype,{states:{get:function(){return this._states},set:function(value){var currentDefaultState=_.find(this._states,{type:DEFAULT}),nextDefaultState=_.find(value,{type:DEFAULT});0===value.length&&value.push(this.createInitialState([])),this._saveProperty(),this._updateActiveState(value),this._updateStoredElements(getElementsForAllStates(value)),this._states=value,this.dirty=!0,!nextDefaultState||_.isEqual(currentDefaultState,nextDefaultState)||this._editModeActive||this.showState(nextDefaultState.id)}},activeState:{get:function(){return this._activeState},set:function(value){this._activeState=value,this._displayActiveState(value),this.dirty=!0}},multistateOrigin:{get:function(){return this._multistateOrigin},set:function(value){this._saveProperty(),this._multistateOrigin=value}}}),Multistate.prototype.isMultistate=function(){return!0},Multistate.prototype.enablePreviewMode=function(){this.view.state.style.backfaceVisibility="hidden"},Multistate.prototype.disablePreviewMode=function(){this.view.state.style.removeProperty("backfaceVisibility")},Multistate.prototype.getStatesCount=function(){return this.states.length},Multistate.prototype.isCreatedFromGroup=function(){return this.multistateOrigin===ElementTypes.GROUP},Multistate.prototype.getLayerChildren=function(){return _.filter(Group.prototype.getLayerChildren.call(this),this._isDescendantInActiveState.bind(this))},Multistate.prototype.getStateChildren=function(state){return _.map(state.elements,function(elementId){return _.find(this.children,{id:elementId})}.bind(this))},Multistate.prototype.getStateChildrenById=function(stateId){var state=getState(this.states,stateId);return state?_.map(state.elements,function(elementId){return _.find(this.children,{id:elementId})}.bind(this)):[]},Multistate.prototype.setEditable=function(group,selectedChildren){var state;this._editModeActive=!!group,state=selectedChildren&&selectedChildren.length>0?this._getStateByChildren(selectedChildren):group?getStateForElement(this.states,group.id):this.activeState?this.activeState:getDefaultState(this.states),state&&this.showState(state.id),Group.prototype.setEditable.call(this,group,selectedChildren)},Multistate.prototype.selectChildren=function(elements){this.showStateByChildren(elements),Group.prototype.selectChildren.call(this,elements)},Multistate.prototype.deselect=function(){AbstractElement.prototype.deselect.call(this),this._editModeActive||this.Page.isSpecMode()||this.showDefaultState()},Multistate.prototype.getStateFirstElement=function(stateId){var elements=(_.find(this.states,function(state){return state.id===stateId})||{}).elements;return _.find(elements,function(id){var element=this._getElementById(id);return!element.isEditByCollaborator()}.bind(this))},Multistate.prototype.createInitialState=function(elements){return{id:1,name:DEFAULT_STATE_NAME,type:DEFAULT,elements:_.map(elements,"id")}},Multistate.prototype.createNewState=function(name){var elementsToDuplicate=this.activeState?this.activeState.elements:this.storedElements;return{id:getNextId(this.states),name:name||"New state",type:"",elements:_.map(elementsToDuplicate,function(elementId){return this._getElementById(elementId).clone().id}.bind(this))}},Multistate.prototype.addInitialState=function(elements){var states=[this.createInitialState(elements)];this._updateProperty(Properties.STATES,states,!0)},Multistate.prototype.addState=function(name){var states=_.clone(this.states);states.push(this.createNewState(name)),this._updateProperty(Properties.STATES,states,!0)},Multistate.prototype.removeState=function(stateId){if(this.states.length<2)return!1;var stateToRemove=getState(this.states,stateId),states=_.filter(_.cloneDeep(this.states),function(state){return state.id!==stateId});stateToRemove.type===DEFAULT?this._setDefaultState(states,_.first(states).id):this._updateProperty(Properties.STATES,states,!0),RemoveHelper.DeleteElements(_.map(stateToRemove.elements,this._getElementById.bind(this)),!0)},Multistate.prototype.renameState=function(stateId,name){var states=_.cloneDeep(this.states);getState(states,stateId).name=name,this.updateProperty(Properties.STATES,states)},Multistate.prototype.reorderState=function(stateId,position){var states=_.cloneDeep(this.states),state=getState(states,stateId),index=states.indexOf(state);return!(index===position||position>=states.length)&&(states.splice(index,1),states.splice(position,0,state),void this.updateProperty(Properties.STATES,states))},Multistate.prototype.showState=function(stateId){stateId=stateId||this.activeState.id||getDefaultState(this.states).id,this.activeState.id!==stateId&&(this.activeState=getState(this.states,stateId));
},Multistate.prototype.showDefaultState=function(){var defaultState=getDefaultState(this.states);this.activeState.id!==defaultState.id&&(this.activeState=defaultState)},Multistate.prototype.setDefaultState=function(stateId){return getDefaultState(this.states).id!==stateId&&(this._setDefaultState(_.cloneDeep(this.states),stateId),void this.showState(stateId))},Multistate.prototype.getChildIndex=function(child){var state=this._getDescendantState(child);return _.findIndex(state.elements,function(childId){return childId===child.id})},Multistate.prototype.hitTest=function(p,ignoreChildren){if(this._preventHit(p))return null;var stateChildren=this.getStateChildren(this.activeState);if((0===stateChildren.length||ignoreChildren)&&this.rect.hitTest(p))return this;var hitChildren=this._hitTestOverChildren(stateChildren,p),selectByBorder=this.Page.isPickMode();return hitChildren?hitChildren:(!hitChildren&&selectByBorder?this.rect.hitTestMargin(p)&&!this.rect.hitTest(p):this.rect.hitTest(p))?this:null},Multistate.prototype._hitTestOverChildren=function(children,p){for(var child,ignoreChildren=!1,i=children.length;i-- >0;)if(child=children[i].hitTest(p,ignoreChildren))return child;return null},Multistate.prototype.animateNextState=function(animation,reversed){var stateId="number"!=typeof this._animatingToState?this.activeState.id:this._animatingToState,newStateId=reversed?getPreviousState(this.states,stateId):getNextState(this.states,stateId);this._animateToState(newStateId,animation,reversed)},Multistate.prototype.animatePreviousState=function(animation,reversed){var stateId="number"!=typeof this._animatingToState?this.activeState.id:this._animatingToState,newStateId=reversed?getNextState(this.states,stateId):getPreviousState(this.states,stateId);this._animateToState(newStateId,animation,reversed)},Multistate.prototype.isBogusTrigger=function(lastInteraction,currentInteraction){var lastReversed=lastInteraction[1],currentReversed=currentInteraction[1];return currentInteraction=currentInteraction[0],lastInteraction=lastInteraction[0],lastReversed===currentReversed&&lastInteraction.id===currentInteraction.id&&lastInteraction.action===currentInteraction.action&&lastInteraction.value===currentInteraction.value},Multistate.prototype.animateChangeState=function(stateId,animation,reversed,interactionDetail){if(this._lastInteraction&&this.isBogusTrigger(this._lastInteraction,[interactionDetail,reversed]))return!1;reversed||interactionDetail.trigger!==InteractionTriggers.HOVER||(this._originalState=getState(this.states,this._animatingToState)||this.activeState);var state;reversed&&interactionDetail.trigger===InteractionTriggers.HOVER&&this._originalState?(state=this._originalState,this._originalState=null):state=getState(this.states,parseInt(stateId)),state&&(this._animateToState(state.id,animation,reversed),this._lastInteraction=[interactionDetail,reversed])},Multistate.prototype.isInAnimatingState=function(element){return"number"==typeof this._animatingToState&&this._animatingToState===this._getDescendantState(element).id},Multistate.prototype.getStateBoundingBox=function(element){return this._getBoundingBoxForState(this._getDescendantState(element).id)},Multistate.prototype.update=function(){Group.prototype.update.call(this),(this.Page.isPreviewMode()||this.Page.isSpecMode())&&this.updateChildren(!0)},Multistate.prototype.clone=function(props){var states=_.cloneDeep(this.states);return _.forEach(states,function(state){state.elements=_.map(state.elements,function(elementId){return this._getElementById(elementId).clone().id}.bind(this))}.bind(this)),AbstractElement.prototype.clone.call(this,_.extend({states:states},props))},Multistate.prototype._add=function(child,index){var stateElements=_.clone(this.activeState.elements),stateIndex=this.states.indexOf(this.activeState),states=_.cloneDeep(this.states);"undefined"!=typeof index&&index<stateElements.length?stateElements.splice(index,0,child.id):stateElements.push(child.id),states[stateIndex].elements=stateElements,this._updateProperty(Properties.STATES,states,!0)},Multistate.prototype._remove=function(child){var states=_.cloneDeep(this.states);removeElementFromState(getStateForElement(states,child.id),child.id),this._updateProperty(Properties.STATES,states,!0)},Multistate.prototype._replace=function(newChild,index){var stateElements=_.clone(this.activeState.elements),stateIndex=this.states.indexOf(this.activeState),states=_.cloneDeep(this.states);stateElements[index]=newChild.id,states[stateIndex].elements=stateElements,this._updateProperty(Properties.STATES,states,!0)},Multistate.prototype._removeAll=function(){this._updateProperty(Properties.STATES,[],!0)},Multistate.prototype._setDefaultState=function(states,stateId){var defaultState=getDefaultState(states);defaultState&&(defaultState.type=""),getState(states,stateId).type=DEFAULT,this._updateProperty(Properties.STATES,states,!0)},Multistate.prototype._isChildInActiveState=function(childId){return this.activeState&&this.activeState.elements.indexOf(childId)>-1},Multistate.prototype._isDescendantInActiveState=function(child){return this._isChildInActiveState(Tree.GetRootElement(child,this).id)},Multistate.prototype._getDescendantState=function(child){var directChild=Tree.GetRootElement(child,this);return _.find(this.states,function(state){return state.elements.indexOf(directChild.id)>-1})},Multistate.prototype._getStateByChildren=function(elements){return _.reduce(elements,function(state,element){return this._getDescendantState(element)||state}.bind(this),getDefaultState(this.states))},Multistate.prototype._updateBoundingBox=function(){this._rect=this._getBoundingBoxForState(this.activeState.id),this.dirtyPosition=!0},Multistate.prototype._getElementsForBoundingBox=function(stateId){for(var state=getState(this.states,stateId);0===state.elements.length&&getStateIndex(this.states,state)>0;)state=getState(this.states,getPreviousState(this.states,state.id));for(;0===state.elements.length&&getStateIndex(this.states,state)<this.states.length-1;)state=getState(this.states,getNextState(this.states,state.id));return this.getStateChildren(state)},Multistate.prototype._getBoundingBoxForState=function(stateId){for(var bb,child,p=new Point(0,0),angle=this.angle,bbElements=this._getElementsForBoundingBox(stateId),stateBB=null,i=0,len=bbElements.length;i<len;i++)child=bbElements[i],child instanceof Group&&child._updateBoundingBox(),bb=child.getBoundingBox(!1).clone(),bb.rotateBy(p,-angle),stateBB=stateBB?stateBB.add(bb):len>1?bb:bb.getBoundingBox(!0);return stateBB||(stateBB=new Rectangle(DEFAULT_BB.x,DEFAULT_BB.y,DEFAULT_BB.width,DEFAULT_BB.height)),stateBB.rotateBy(p,angle),stateBB},Multistate.prototype._updateActiveState=function(states){var id=this.activeState&&getState(states,this.activeState.id)?this.activeState.id:null;this.activeState=id?getState(states,id):getDefaultState(states)},Multistate.prototype._displayActiveState=function(){var range=document.createRange();range.selectNodeContents(this.view.state),range.deleteContents(),_.forEach(this.children,function(child){this._isChildInActiveState(child.id)&&(this.view.state.appendChild(child.view.domElement),child.resetIndicators())}.bind(this))},Multistate.prototype._canAnimate=function(animatingToState,activeStateId,stateId){return!this.Page.isSpecMode()&&("number"!=typeof animatingToState&&activeStateId!==stateId||"number"==typeof animatingToState&&animatingToState!==stateId)},Multistate.prototype._addToStoredElements=function(elements){_.forEach(_.difference(elements,this._storedElements),function(elementId){var child=this._getElementById(elementId),index=elements.indexOf(elementId),isChildInActiveState=this._isChildInActiveState(elementId),indexOfState=this.activeState.elements.indexOf(elementId);child.parent&&child.parent.removeChild(child),child.setParent(this),index<this.children.length?(isChildInActiveState&&(indexOfState>=this.view.state.children.length?this.view.state.appendChild(child.view.domElement):this.view.state.insertBefore(child.view.domElement,this.view.state.children[indexOfState])),this.children.splice(index,0,child),this._storedElements.splice(index,0,elementId)):(isChildInActiveState&&this.view.state.appendChild(child.view.domElement),this.children.push(child),this._storedElements.push(elementId))}.bind(this))},Multistate.prototype._removeFromStoredElements=function(elements){var child,index;_.forEach(_.difference(this._storedElements,elements),function(elementId){child=this._getElementById(elementId),index=Group.prototype.getChildIndex.call(this,child),child.setParent(null),this._isChildInActiveState(elementId)&&this.view.state.removeChild(child.view.domElement),this.children.splice(index,1),this._storedElements.splice(index,1)}.bind(this))},Multistate.prototype._animateToState=function(stateId,animation,reversed){if(this._canAnimate(this._animatingToState,this.activeState.id,stateId)){var container=this.view.createNextStateContainer(stateId,this._getBoundingBoxForState(stateId),this.isClip,this);"number"==typeof this._animatingToState&&(this.view.resetAnimation(),this.showState(this._animatingToState),this._animatingToState=null),this._animatingToState=stateId,_.forEach(getState(this.states,stateId).elements,function(elementId){var child=this._getElementById(elementId);container.appendChild(child.view.domElement)}.bind(this)),this.updateChildren(!0),this.view.animateChangeState(container,animation,reversed).then(function(){this._animatingToState=null,this.showState(stateId),this.update(),this.updateChildren(!0)}.bind(this))}},Multistate}()},{"../enums/ElementTypes.js":346,"../enums/Events.js":347,"../enums/InteractionTriggers.js":351,"../enums/PageModes.js":357,"../enums/Properties.js":358,"../primitives/Point.js":403,"../primitives/Rectangle.js":404,"../utils/Base.js":405,"../utils/Tree.js":419,"./AbstractElement.js":166,"./Group.js":185,"./helpers/RemoveHelper.js":255,"./views/MultistateView.js":328,lodash:161}],202:[function(_dereq_,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _Color=_dereq_("../utils/Color.js"),_Color2=_interopRequireDefault(_Color),_=_dereq_("lodash"),AbstractElement=_dereq_("./AbstractElement.js"),SimpleTextEditable=_dereq_("./behaviors/SimpleTextEditable.js"),NavigationView=_dereq_("./views/NavigationView.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),InteractionsHelper=_dereq_("../interactions/InteractionsHelper.js"),InteractionsActions=_dereq_("../enums/InteractionActions.js");module.exports=function(){function Navigation(){AbstractElement.apply(this,arguments),this.type=ElementTypes.NAVIGATION,this.view=this.createView(NavigationView),this.Page.isPreviewMode()&&this.addLinkEvent(),this._shouldRepaintElement=!1}return Navigation.DefaultProperties={width:{value:600},height:{value:40},orientation:{value:"horizontal"},inputValue:{value:["Home","* This is active","This is dropdown","/ shhh...","// we  you","Last one"].map(function(pLine){return{text:pLine,page_id:null}})},textAlign:{value:"center"},color:{value:"#666666"},backgroundColor:{value:"#EBEBEB"},activeBackgroundColor:{value:"#FFFFFF"},elementBorderWidth:{value:1},elementBorderColor:{value:"#DEDEDE"}},Base.Extend(Navigation,AbstractElement),Base.ApplyBehavior(Navigation,SimpleTextEditable),Object.defineProperties(Navigation.prototype,{shouldRepaintElement:{get:function(){return this._shouldRepaintElement},set:function(value){this._shouldRepaintElement=value,value&&(this.dirty=value)}},inputValue:{get:function(){return this._inputValue},set:function(value){_.isString(value)&&(value=JSON.parse(value)),this._saveProperty(),this._inputValue=value,this.view.setInputValue(value),this.shouldRepaintElement=!0}},orientation:{get:function(){return this._orientation},set:function(value){this._saveProperty(),this.adjustDimensions(value),this._orientation=value,this.view.setOrientation(value)}},backgroundColor:{get:function(){return this._backgroundColor},set:function(value){this._saveProperty(value),this._backgroundColor=value,this.view.setBackgroundColor(value)}},activeBackgroundColor:{get:function(){return this._activeBackgroundColor},set:function(value){this._saveProperty(value),this._activeBackgroundColor=value,this.view.setActiveBackgroundColor(value)}},elementBorderWidth:{get:function(){return this._elementBorderWidth},set:function(value){this._saveProperty(value),this._elementBorderWidth=value,this.view.setElementBorder(value,this.elementBorderColor)}},elementBorderColor:{get:function(){return this._elementBorderColor},set:function(value){this._saveProperty(value),this._elementBorderColor=value,this.view.setElementBorder(this.elementBorderWidth,value)}}}),Navigation.prototype.isTextEditable=function(){return!1},Navigation.prototype.adjustDimensions=function(value){if("horizontal"===this._orientation&&"vertical"===value||"vertical"===this._orientation&&"horizontal"===value){var navMainElements=this.view.domElement.children,elementWidth=navMainElements[0].offsetWidth,elementHeight=navMainElements[0].offsetHeight;"horizontal"===this._orientation?(this.width=elementWidth,this.height=navMainElements.length*elementHeight):"vertical"===this._orientation&&(this.width=navMainElements.length*elementWidth,this.height=elementHeight)}},Navigation.prototype.addLinkEvent=function(){this.view.domElement.addEventListener("click",this.mouseDownHandler.bind(this))},Navigation.prototype.addHoverEffects=function(){var items=this.view.domElement.getElementsByTagName("li");Array.prototype.forEach.call(items,function(item){item.classList.contains("active")||(item.addEventListener("mouseover",this.handleHoverEffect.bind(this,item,!0)),item.addEventListener("mouseout",this.handleHoverEffect.bind(this,item,!1)))},this)},Navigation.prototype.mouseDownHandler=function(e){e.target.dataset.pageId&&InteractionsHelper.ApplyInteractionEffect(this,{action:InteractionsActions.LINK_PAGE,value:{id_page:e.target.dataset.pageId,target:!1}})},Navigation.prototype.handleHoverEffect=function(element,isHovered){isHovered?this.view.setElementBackgroundColor(element,this._activeBackgroundColor):this.view.setElementBackgroundColor(element,this._backgroundColor)},Navigation.prototype.getActiveBackgroundColor=function(){return _Color2.default.getColorsSet(this.activeBackgroundColor)},Navigation.prototype.getBorderColor=function(){return _Color2.default.getColorsSet(this.elementBorderColor)},Navigation.prototype.getSpecProperties=function(){var basicProperties=AbstractElement.prototype.getSpecProperties.call(this);return _.extend({},basicProperties,{activeBackgroundColor:this.getActiveBackgroundColor(),borderColor:this.getBorderColor(),borderBottomWidth:this.elementBorderWidth,borderLeftWidth:this.elementBorderWidth,borderRightWidth:this.elementBorderWidth,borderTopWidth:this.elementBorderWidth})},Navigation.prototype.update=function(){this.shouldRepaintElement&&(this.view.setBackgroundColor(this.backgroundColor),this.view.setActiveBackgroundColor(this.activeBackgroundColor),this.view.setElementBorder(this.elementBorderWidth,this.elementBorderColor),this.addHoverEffects(),this.shouldRepaintElement=!1),AbstractElement.prototype.update.call(this)},Navigation}()},{"../enums/ElementTypes.js":346,"../enums/InteractionActions.js":350,"../interactions/InteractionsHelper.js":379,"../utils/Base.js":405,"../utils/Color.js":409,"./AbstractElement.js":166,"./behaviors/SimpleTextEditable.js":236,"./views/NavigationView.js":329,lodash:161}],203:[function(_dereq_,module,exports){"use strict";var Input2=_dereq_("./Input2.js"),Base=_dereq_("../utils/Base.js");module.exports=function(){function Password(){Input2.apply(this,arguments)}return Password.DefaultProperties={inputValue:{value:"password"},inputType:{value:"password"}},Base.Extend(Password,Input2),Password}()},{"../utils/Base.js":405,"./Input2.js":192}],204:[function(_dereq_,module,exports){"use strict";var SvgIcon=_dereq_("./SvgIcon.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),Base=_dereq_("../utils/Base.js");module.exports=function(){function PixleIcon(){SvgIcon.apply(this,arguments),this.type=ElementTypes.PIXLE_ICON}return Base.Extend(PixleIcon,SvgIcon),PixleIcon}()},{"../enums/ElementTypes.js":346,"../utils/Base.js":405,"./SvgIcon.js":210}],205:[function(_dereq_,module,exports){"use strict";var Checkbox=_dereq_("./Checkbox.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),RadioView=_dereq_("./views/RadioView.js");module.exports=function(){function Radio(){Checkbox.apply(this,arguments),this.type=ElementTypes.RADIO,this.view=this.createView(RadioView)}return Radio.DefaultProperties={checked:{value:!1},formGroupName:{value:"Group 1"}},Base.Extend(Radio,Checkbox),Object.defineProperties(Radio.prototype,{checked:{get:function(){return this._checked},set:function(value){this._saveProperty(),this._checked=value,this.view.setChecked(value),value&&this.Page.updateRadioElementsCheckedState(this.id,this.formGroupName)}},formGroupName:{get:function(){return this._formGroupName},set:function(value){this._saveProperty(),this._formGroupName=value,this.view.setFormGroupName(value)}}}),Radio.prototype.uncheckRadioInFormGroup=function(checkedRadioId){this.id!==checkedRadioId&&(this.checked=!1)},Radio}()},{"../enums/ElementTypes.js":346,"../utils/Base.js":405,"./Checkbox.js":174,"./views/RadioView.js":330}],206:[function(_dereq_,module,exports){"use strict";var SvgIcon=_dereq_("./SvgIcon.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),Base=_dereq_("../utils/Base.js");module.exports=function(){function RetinaIcon(){SvgIcon.apply(this,arguments),this.type=ElementTypes.RETINA_ICON}return Base.Extend(RetinaIcon,SvgIcon),RetinaIcon}()},{"../enums/ElementTypes.js":346,"../utils/Base.js":405,"./SvgIcon.js":210}],207:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("./AbstractElement.js"),ScrollbarView=_dereq_("./views/ScrollbarView.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js");module.exports=function(){function Scrollbar(){AbstractElement.apply(this,arguments),this.type=ElementTypes.SCROLLBAR,this.view=this.createView(ScrollbarView)}return Scrollbar.SCROLL_BUTTON_SIZE=18,Scrollbar.DefaultProperties={width:{value:Scrollbar.SCROLL_BUTTON_SIZE,min:Scrollbar.SCROLL_BUTTON_SIZE},height:{value:150,min:2*Scrollbar.SCROLL_BUTTON_SIZE},scrollPosition:{value:30,min:0,max:100}},Base.Extend(Scrollbar,AbstractElement),Object.defineProperties(Scrollbar.prototype,{scrollPosition:{get:function(){return this._scrollPosition},set:function(value){this._saveProperty(),this._scrollPosition=value,this.view.setScrollPosition(value,this.height)}}}),Scrollbar}()},{"../enums/ElementTypes.js":346,"../utils/Base.js":405,"./AbstractElement.js":166,"./views/ScrollbarView.js":331}],208:[function(_dereq_,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _SimpleBorderAndRadius=(_dereq_("../fonts/FontsHelper"),_dereq_("./behaviors/SimpleBorderAndRadius.js")),_SimpleBorderAndRadius2=_interopRequireDefault(_SimpleBorderAndRadius),AbstractElement=_dereq_("./AbstractElement.js"),SimpleTextEditable=_dereq_("./behaviors/SimpleTextEditable.js"),SelectlistView=_dereq_("./views/SelectlistView.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js");module.exports=function(){function Selectlist(){AbstractElement.apply(this,arguments),this.type=ElementTypes.SELECTLIST,this.view=this.createView(SelectlistView)}return Selectlist.DefaultProperties={width:{value:200},height:{value:20},multiple:{value:!1},selectlistValue:{value:[{id:"id-1",text:"UX"},{id:"id-2",text:"UI"}]},color:{value:"#666666"},clickIdPage:{value:""}},Selectlist.ExcludedProperties={inputValue:!0},Base.Extend(Selectlist,AbstractElement),Base.ApplyBehavior(Selectlist,_SimpleBorderAndRadius2.default),Base.ApplyBehavior(Selectlist,SimpleTextEditable),Object.defineProperties(Selectlist.prototype,{multiple:{get:function(){return this._multiple},set:function(value){this._saveProperty(),this._multiple=value,this.view.setMultiple("enabled"===value)}},clickIdPage:{get:function(){return this._clickIdPage},set:function(value){this._saveProperty(),this._clickIdPage=value}},selectlistValue:{get:function(){return this._selectlistValue},set:function(value){this._saveProperty(),this._selectlistValue=value,this.view.setOptions(value)}}}),Selectlist.prototype.getFonts=function(domEl){var font=this.getFontFromDOMElement((domEl||this.view.domElement).querySelector("select"));return this.initFontsCollection(),this.addFontToCollection(font),this._fontsCollection},Selectlist.prototype.getTextContent=function(){return(this.selectlistValue||[]).map(function(value){return value.text}).join("\n")},Selectlist.prototype.isTextEditable=function(){return!1},Selectlist}()},{"../enums/ElementTypes.js":346,"../fonts/FontsHelper":363,"../utils/Base.js":405,"./AbstractElement.js":166,"./behaviors/SimpleBorderAndRadius.js":235,"./behaviors/SimpleTextEditable.js":236,"./views/SelectlistView.js":332}],209:[function(_dereq_,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}return Array.from(arr)}var _Color=_dereq_("../utils/Color"),_Color2=_interopRequireDefault(_Color),_=_dereq_("lodash"),SvgIcon=(_dereq_("../enums/Properties.js"),_dereq_("./SvgIcon.js")),SvgCustomIconView=_dereq_("./views/SvgCustomIconView.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js");module.exports=function(){function SvgCustomIcon(){SvgIcon.apply(this,arguments),this.view=this.createView(SvgCustomIconView),this.type=ElementTypes.SVG_CUSTOM_ICON}return SvgCustomIcon.DefaultProperties={color:{value:""}},Base.Extend(SvgCustomIcon,SvgIcon),SvgCustomIcon.prototype.getStrokeColor=function(){var nodes=this.view.getElementNodes(),colors=_.reduce(nodes,function(addedColors,node){var styles=window.getComputedStyle(node);if(parseInt(styles.strokeWidth,10)){var colorsSet=_Color2.default.getColorsSet(styles.stroke);if(colorsSet.alpha)return[].concat(_toConsumableArray(addedColors),[colorsSet])}return addedColors},[]);return _Color2.default.removeDuplicates(colors)},SvgCustomIcon.prototype.getFillColor=function(){var nodes=this.view.getElementNodes(),colors=_.reduce(nodes,function(addedColors,node){var styles=window.getComputedStyle(node),colorsSet=_Color2.default.getColorsSet(styles.fill);return colorsSet.alpha?[].concat(_toConsumableArray(addedColors),[colorsSet]):addedColors},[]);return _Color2.default.removeDuplicates(colors)},SvgCustomIcon.prototype.getColors=function(){var colors=[].concat(_toConsumableArray(this.getFillColor()),_toConsumableArray(this.getStrokeColor()));return{gradients:[],colors:_Color2.default.removeDuplicates(colors)}},SvgCustomIcon.prototype.getSpecProperties=function(){return _.extend({},SvgIcon.prototype.getSpecProperties.call(this),{strokeColor:this.getStrokeColor()})},SvgCustomIcon}()},{"../enums/ElementTypes.js":346,"../enums/Properties.js":358,"../utils/Base.js":405,"../utils/Color":409,"./SvgIcon.js":210,"./views/SvgCustomIconView.js":333,lodash:161}],210:[function(_dereq_,module,exports){"use strict";var Properties=_dereq_("../enums/Properties.js"),SvgSymbol=_dereq_("./SvgSymbol.js"),SvgIconView=_dereq_("./views/SvgIconView.js"),Base=_dereq_("../utils/Base.js");module.exports=function(){function SvgIcon(){SvgSymbol.apply(this,arguments),this.view=this.createView(SvgIconView)}return SvgIcon.DefaultProperties={color:{value:"#000000"}},Base.Extend(SvgIcon,SvgSymbol),SvgIcon.prototype.setSymbol=function(id,categoryId,iconData,originalWidth,originalHeight,originalRatio){this.Page.ElementsManager.startBatch(),this._updateProperty(Properties.CURRENT_ELEMENT_ID,id,!0),this._updateProperty(Properties.CURRENT_ELEMENT_CATEGORY_ID,categoryId,!0),this._updateProperty(Properties.ORIGINAL_HEIGHT,parseInt(originalHeight),!0),this._updateProperty(Properties.ORIGINAL_WIDTH,parseInt(originalWidth),!0),this._updateProperty(Properties.ORIGINAL_RATIO,originalRatio||1,!0),this._updateProperty(Properties.DATA,iconData,!0),this.Page.ElementsManager.endBatch()},SvgIcon}()},{"../enums/Properties.js":358,"../utils/Base.js":405,"./SvgSymbol.js":212,"./views/SvgIconView.js":334}],211:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("./AbstractElement.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),ImageView=_dereq_("./views/ImageView.js");module.exports=function(){function SvgIconLegacy(){AbstractElement.apply(this,arguments),this.type=ElementTypes.SVG_ICON_LEGACY,this.view=this.createView(ImageView)}return SvgIconLegacy.DefaultProperties={data:{value:""}},Base.Extend(SvgIconLegacy,AbstractElement),Object.defineProperties(SvgIconLegacy.prototype,{data:{get:function(){return this._data},set:function(value){this._saveProperty(),this._data=value,this.view.setSrc(this._getCdnUrl(value))}}}),SvgIconLegacy}()},{"../enums/ElementTypes.js":346,"../utils/Base.js":405,"./AbstractElement.js":166,"./views/ImageView.js":320}],212:[function(_dereq_,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _Properties=_dereq_("../enums/Properties.js"),_Properties2=_interopRequireDefault(_Properties),_Color=_dereq_("../utils/Color.js"),_Color2=_interopRequireDefault(_Color),AbstractElement=_dereq_("./AbstractElement.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),SvgSymbolView=_dereq_("./views/SvgSymbolView.js");module.exports=function(){function SvgSymbol(){AbstractElement.apply(this,arguments),this.type=ElementTypes.SVG_SYMBOL,this.view=this.createView(SvgSymbolView),this._shouldUpdateViewBox=!1}return SvgSymbol.DefaultProperties={data:{value:""},color:{value:"#ebebeb"},currentElementCategoryId:{value:""},currentElementId:{value:""},originalWidth:{value:""},originalHeight:{value:""},viewBox:{value:""},originalRatio:{value:1},keepRatio:{value:!0}},Base.Extend(SvgSymbol,AbstractElement),Object.defineProperties(SvgSymbol.prototype,{shouldUpdateViewBox:{get:function(){return this._shouldUpdateViewBox},set:function(value){this._shouldUpdateViewBox=value,value&&(this.dirty=value)}},data:{get:function(){return this._data},set:function(value){this._saveProperty(),this._data=value,this.view.setData(value),this.shouldUpdateViewBox=!0}},viewBox:{get:function(){return this._viewBox},set:function(value){this._saveProperty(),this._viewBox=value,this.shouldUpdateViewBox=!0}},color:{get:function(){return this._color},set:function(value){this._saveProperty(),this._color=value,this.view.setColor(value)}},currentElementCategoryId:{get:function(){return this._currentElementCategoryId},set:function(value){this._saveProperty(),this._currentElementCategoryId=value}},currentElementId:{get:function(){return this._currentElementId},set:function(value){this._saveProperty(),this._currentElementId=value}},originalWidth:{get:function(){return this._originalWidth},set:function(value){this._saveProperty(),this._originalWidth=value,this.shouldUpdateViewBox=!0}},originalHeight:{get:function(){return this._originalHeight},set:function(value){this._saveProperty(),this._originalHeight=value,this.shouldUpdateViewBox=!0}},originalRatio:{get:function(){return this._originalRatio},set:function(value){this._saveProperty(),this._originalRatio=value||1,this.shouldUpdateViewBox=!0}}}),SvgSymbol.prototype.update=function(){this.shouldUpdateViewBox&&(this.viewBox?this.view.setViewBox(this.viewBox):this.view.updateViewBox(this.originalWidth,this.originalHeight,this.originalRatio),this.shouldUpdateViewBox=!1),AbstractElement.prototype.update.call(this)},SvgSymbol.prototype.getFillColor=function(){return _Color2.default.getColorsSet(this[_Properties2.default.COLOR])},SvgSymbol}()},{"../enums/ElementTypes.js":346,"../enums/Properties.js":358,"../utils/Base.js":405,"../utils/Color.js":409,"./AbstractElement.js":166,"./views/SvgSymbolView.js":335}],213:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("./AbstractElement.js"),TabView=_dereq_("./views/TabView.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),Orientations=_dereq_("../enums/Orientations.js");module.exports=function(){function Tab(){AbstractElement.apply(this,arguments),this.type=ElementTypes.TAB,this.view=this.createView(TabView),this._renderInitially=!0}return Tab.DefaultProperties={elementBorderColor:{value:"#dedede"},elementBorderRadius:{value:2,min:0,max:100},elementBorderWidth:{value:1,min:0,max:100},color:{value:"#666666"},elementBorderStyle:{value:"solid",options:["solid","dashed","dotted","double","groove","ridge","inset","outset"]},inputValue:{value:["Home","*Active tab","Third tab"].map(function(line){return{text:line,page_id:null}})},tabType:{value:Orientations.HORIZONTAL,options:[Orientations.HORIZONTAL,Orientations.VERTICAL]},typeHorizontal:{value:"top",options:["top","bottom"]},typeVertical:{value:"left",options:["left","right"]},fontSize:{value:"14px",options:["8px","9px","10px","11px","12px","14px","18px","24px","30px","36px","48px","60px","72px"]},fontFamily:{value:"Arial",options:["Arial","Comic Sans MS","Courier New","Georgia","Tahoma","Times New Roman","Trebuchet MS","Verdana"]},fontWeight:{value:"normal"},fontStyle:{value:""},textDecoration:{value:""},textAlign:{value:"center"},activeBackgroundColor:{value:"#ffffff"},inactiveBackgroundColor:{value:"#ebebeb"},width:{value:400},height:{value:40}},Base.Extend(Tab,AbstractElement),Object.defineProperties(Tab.prototype,{inputValue:{get:function(){return this._inputValue},set:function(value){this._saveProperty(),this._inputValue=value}},tabType:{get:function(){return this._tabType},set:function(value){this._saveProperty(),this._tabType=value}},typeHorizontal:{get:function(){return this._typeHorizontal},set:function(value){this._saveProperty(),this._typeHorizontal=value}},typeVertical:{get:function(){return this._typeVertical},set:function(value){this._saveProperty(),this._typeVertical=value}},fontSize:{get:function(){return this._fontSize},set:function(value){this._saveProperty(),this._fontSize=value}},fontFamily:{get:function(){return this._fontFamily},set:function(value){this._saveProperty(),this._fontFamily=value}},fontWeight:{get:function(){return this._fontWeight},set:function(value){this._saveProperty(),this._fontWeight=value}},fontStyle:{get:function(){return this._fontStyle},set:function(value){this._saveProperty(),this._fontStyle=value}},textDecoration:{get:function(){return this._textDecoration},set:function(value){this._saveProperty(),this._textDecoration=value}},textAlign:{get:function(){return this._textAlign},set:function(value){this._saveProperty(),this._textAlign=value}},color:{get:function(){return this._color},set:function(value){this._saveProperty(),this._color=value}},activeBackgroundColor:{get:function(){return this._activeBackgroundColor},set:function(value){this._saveProperty(),this._activeBackgroundColor=value}},inactiveBackgroundColor:{get:function(){return this._inactiveBackgroundColor},set:function(value){this._saveProperty(),this._inactiveBackgroundColor=value}},width:{get:function(){return Object.getOwnPropertyDescriptor(AbstractElement.prototype,"width").get.call(this)},set:function(value){Object.getOwnPropertyDescriptor(AbstractElement.prototype,"width").set.call(this,value),this.view.setTabSizes(this)}},height:{get:function(){return Object.getOwnPropertyDescriptor(AbstractElement.prototype,"height").get.call(this)},set:function(value){Object.getOwnPropertyDescriptor(AbstractElement.prototype,"height").set.call(this,value),this.view.setTabSizes(this)}}}),Tab.prototype.update=function(){this._renderInitially&&(this._renderInitially=!1,this.view.renderTabs(this)),AbstractElement.prototype.update.call(this);
},Tab}()},{"../enums/ElementTypes.js":346,"../enums/Orientations.js":356,"../utils/Base.js":405,"./AbstractElement.js":166,"./views/TabView.js":336}],214:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),AbstractElement=_dereq_("./AbstractElement.js"),SimpleTextEditable=_dereq_("./behaviors/SimpleTextEditable.js"),Multipart=_dereq_("./behaviors/Multipart.js"),TableView=_dereq_("./views/TableView.js"),Base=_dereq_("../utils/Base.js"),Parse=_dereq_("../utils/Parse.js"),Color=_dereq_("../utils/Color.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),TableHelper=_dereq_("./helpers/TableHelper.js"),TextStyleHelper=_dereq_("./helpers/TextStyleHelper.js"),SimpleBorder=_dereq_("./behaviors/SimpleBorder.js"),Properties=_dereq_("../enums/Properties.js");module.exports=function(){function sanitizeValue(prop,value){return prop===Properties.FONT_FAMILY?TextStyleHelper.SanitizeFontName(value):value}function updateStyles(styles,cellIndex,cellNewIndex){var style=styles[cellIndex],styleNew=styles[cellNewIndex];style&&styleNew?(styles[cellIndex]=styleNew,styles[cellNewIndex]=style):style&&!styleNew?(styles[cellNewIndex]=style,delete styles[cellIndex]):!style&&styleNew&&(styles[cellIndex]=styleNew,delete styles[cellNewIndex])}function getCompensatedWidths(widths,width){var sum=_.reduce(widths,function(sum,w){return sum+parseInt(w)},0),ratio=width/sum;return _.map(widths,function(w){return Parse.toPx(Math.round(parseInt(w)*ratio))}.bind(this))}function Table(){AbstractElement.apply(this,arguments),this.type=ElementTypes.TABLE,this.view=this.createView(TableView),this._shouldUpdateStyles=!1,this.editable=!1,this.allowMultiplePartsSelected=!0,this.eventsRef={},this.debouncedColumnWidths=_.debounce(function(){this.updateColumnWidths()}.bind(this),1e3)}var minColumnWidth=10,headerBackground="#666666",headerFontWeight="bold",headerColor="#FFFFFF",directPropsMap={backgroundColor:"_backgroundColor",columnWidths:"_columnWidths",borderColor:"_borderColor",borderBottomWidth:"_borderBottomWidth",borderTopWidth:"_borderTopWidth",borderRightWidth:"_borderRightWidth",borderLeftWidth:"_borderLeftWidth",borderStyle:"_borderStyle"};return Table.DefaultProperties={width:{value:500},height:{value:210},zebra:{value:1},borderTopWidth:{value:1},borderBottomWidth:{value:1},borderLeftWidth:{value:1},borderRightWidth:{value:1},borderColor:{value:"#DEDEDE"},borderStyle:{value:"solid"},backgroundColor:{value:"#F0F0F0"},tableValue:{value:[["","",""],["","",""],["","",""],["","",""],["","",""]]},columnWidths:{value:["166px","166px","167px"]},cellsStyles:{value:{A0:{backgroundColor:headerBackground,fontWeight:headerFontWeight,color:headerColor},B0:{backgroundColor:headerBackground,fontWeight:headerFontWeight,color:headerColor},C0:{backgroundColor:headerBackground,fontWeight:headerFontWeight,color:headerColor}}}},Base.Extend(Table,AbstractElement),Base.ApplyBehavior(Table,SimpleTextEditable),Base.ApplyBehavior(Table,Multipart),Base.ApplyBehavior(Table,SimpleBorder),Table.prototype.getPropsForSerialize=function(){return _.mapValues(this.DefaultProperties,function(propValue,propName){return propName=directPropsMap[propName]||propName,_.cloneDeep(this[propName])}.bind(this))},Table.prototype.initProperties=function(props){this.beforeInitProperties&&this.beforeInitProperties(),_.forEach(this.DefaultProperties,function(propValue,propName){this._isPropertySerializable(propName)&&(this[propName]="undefined"!=typeof props[propName]?props[propName]:propValue.value)}.bind(this)),this._propertiesInitialized=!0},Table.prototype.beforeInitProperties=function(){var simpleTextProps=Object.keys(SimpleTextEditable.DefaultProperties);_.each(simpleTextProps,function(prop){directPropsMap[prop]="_"+prop,Object.defineProperty(Table.prototype,prop,{set:function(value){this.multipartSet(prop,value)},get:function(){return this.multipartGet(prop)}})})},Table.prototype.getMulitpleSelectionCells=function(firstPart,secondPart){for(var firstRow=TableHelper.GetRowIndex(firstPart),firstColumn=TableHelper.GetColumnIndex(firstPart),secondRow=TableHelper.GetRowIndex(secondPart),secondColumn=TableHelper.GetColumnIndex(secondPart),rows=_.sortBy([firstRow,secondRow]),cols=_.sortBy([firstColumn,secondColumn]),parts=[],r=rows[0];r<=rows[1];r++)for(var c=cols[0];c<=cols[1];c++)parts.push(TableHelper.GetCellCoordinates(r,c));return parts},Table.prototype.addActivePart=function(onePartId){var parts=this.getMulitpleSelectionCells(this.firstPartSelected,onePartId);this.activeParts=parts},Table.prototype.updateColumnWidths=function(){var widths=this.getRealCellWidths();this.updateProperty(Properties.COLUMNWIDTHS,widths,!0)},Table.prototype.multipartSet=function(prop,value,updateStyles,beforeViewCallback){updateStyles=void 0===updateStyles||updateStyles;var applied=!1;value=sanitizeValue(prop,value);var save=function(prop,value,beforeViewCallback){var propUpFirst=prop.charAt(0).toUpperCase()+prop.slice(1);this._saveProperty(),this["_"+prop]=value,beforeViewCallback&&beforeViewCallback(),this.view["set"+propUpFirst](value),this.shouldUpdateStyles=updateStyles}.bind(this);if(this._propertiesInitialized)if(this.anyPartsSelected())this.applyStyleToCells(this.getActiveParts(),prop,value);else{if(this._cellsStyles){var cells=Object.keys(this._cellsStyles);applied=this.applyStyleToCells(cells,prop,void 0)}save(prop,value,beforeViewCallback),this.view.setCellsStyles(this._mergeCellsStyles(applied))}else save(prop,value,beforeViewCallback)},Table.prototype.multipartGet=function(prop){return this._propertiesInitialized?this.anyPartsSelected()&&this.cellsStyles[this.firstPartSelected]&&this.cellsStyles[this.firstPartSelected][prop]?this.cellsStyles[this.firstPartSelected][prop]:this["_"+prop]?this["_"+prop]:void 0:this["_"+prop]},Table.prototype.getRealCellWidths=function(){for(var tds=this.view.getTableElement().querySelector("tr").querySelectorAll("td"),widths=[],i=0,len=tds.length;i<len;i++){var styles=window.getComputedStyle(tds[i]);widths[i]=styles.width}return widths},Table.prototype.getRealHeight=function(){return parseInt(window.getComputedStyle(this.view.getTableElement()).height)},Object.defineProperties(Table.prototype,{width:{get:function(){return Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.WIDTH).get.call(this)},set:function(value){Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.WIDTH).set.call(this,value),this._propertiesInitialized&&this.debouncedColumnWidths()}},shouldUpdateStyles:{get:function(){return this._shouldUpdateStyles},set:function(value){this._shouldUpdateStyles=value,value&&(this.dirty=value)}},zebra:{get:function(){return this._zebra},set:function(value){this._saveProperty(),this._zebra=parseInt(value),this.shouldUpdateStyles=!0}},borderLeftWidth:{get:function(){return this.multipartGet("borderLeftWidth")},set:function(value){this.multipartSet("borderLeftWidth",value)}},borderBottomWidth:{get:function(){return this.multipartGet("borderBottomWidth")},set:function(value){this.multipartSet("borderBottomWidth",value)}},borderRightWidth:{get:function(){return this.multipartGet("borderRightWidth")},set:function(value){this.multipartSet("borderRightWidth",value)}},borderTopWidth:{get:function(){return this.multipartGet("borderTopWidth")},set:function(value){this.multipartSet("borderTopWidth",value)}},borderColor:{get:function(){return this.multipartGet("borderColor")},set:function(value){this.multipartSet("borderColor",value)}},backgroundColor:{get:function(){return this.multipartGet("backgroundColor")},set:function(value){return this.multipartSet("backgroundColor",value,!1,function(){this._oddBackgroundColor=this.zebra?Color.illuminate(value,.15):value}.bind(this))}},tableValue:{get:function(){return this._tableValue},set:function(value){this._saveProperty(),this._tableValue=value,this.view.setTableValue(value),this.shouldUpdateStyles=!0,this.resetParts(),_.forEach(TableHelper.GetAllCellsCoordinates(value),function(coords){this.addPart(coords,this.view.getCell(coords))}.bind(this))}},columnWidths:{get:function(){if(this.firstPartSelected){var columnIndex=TableHelper.GetColumnIndex(this.firstPartSelected);return parseInt(this._columnWidths[columnIndex])}return this._columnWidths},set:function(width){if(!this._propertiesInitialized||Array.isArray(width))return this._saveProperty(),this._columnWidths=width,void(this.shouldUpdateStyles=!0);var columnWidths=_.cloneDeep(this._columnWidths);if(width=parseInt(width),this.anyPartsSelected()){var indexes=_.uniq(this.activeParts.map(TableHelper.GetColumnIndex));columnWidths=this.computeCellWidths(indexes,width,columnWidths)}else for(var i=0,len=columnWidths.length;i<len;i++)columnWidths[i]=width;this._saveProperty(),this._columnWidths=columnWidths,this.view.setCellsStyles(this._mergeCellsStyles());var realWidths=this.getRealCellWidths();this._columnWidths=realWidths,this.shouldUpdateStyles=!0}},cellsStyles:{get:function(){return this._cellsStyles},set:function(value){this._saveProperty(),this._cellsStyles=value,this.shouldUpdateStyles=!0}}}),Table.prototype.getColumnWidths=function(){return this._columnWidths},Table.prototype.computeCellWidths=function(indexes,width,columnWidths,removing){var selectedTotal=indexes.map(function(i){return parseInt(columnWidths[i]||0)}.bind(this)).reduce(function(a,b){return parseInt(a)+parseInt(b)}.bind(this)),requested=indexes.length*width,toFind=requested-selectedTotal,tableTotal=columnWidths.reduce(function(a,b){return parseInt(a)+parseInt(b)}.bind(this));return removing&&(indexes=indexes.sort().reverse(),indexes.forEach(function(index){columnWidths.splice(index,1)}),indexes=[]),columnWidths.forEach(function(columnWidth,index){if(!_.includes(indexes,index)){var prop=parseInt(columnWidth)/(tableTotal-selectedTotal);columnWidths[index]=parseInt(columnWidths[index])-Math.round(toFind*prop)+"px"}}),indexes.forEach(function(index){columnWidths[index]=width+"px"}),columnWidths},Table.prototype.getColumnWidth=function(){if(this.firstPartSelected){var columnIndex=TableHelper.GetColumnIndex(this.firstPartSelected);return this.columnWidths[columnIndex]}return this.areAllColumnsEqual()?this.columnWidths[0]:""},Table.prototype.areAllColumnsEqual=function(){return!!this.columnWidths.reduce(function(a,b){return a===b&&a})},Table.prototype.getColsNumber=function(){return this.tableValue[0].length},Table.prototype.getRowsNumber=function(){return this.tableValue.length},Table.prototype.setRowsNumber=function(newRowsAmount){var i,currentRowsAmount=this.getRowsNumber(),diff=newRowsAmount-currentRowsAmount,values=_.cloneDeep(this.tableValue),columns=this.tableValue[0].length,cellStyles=_.cloneDeep(this._cellsStyles);if(diff>0){for(i=0;i<diff;i++){for(var row=[],newRowIndex=values.length,j=0;j<columns;j++){var newColIndex=row.push("")-1,newCellCoords=TableHelper.GetCellCoordinates(newRowIndex,newColIndex),adjacentCellCoords=TableHelper.GetCellCoordinates(newRowIndex-1,newColIndex);cellStyles[adjacentCellCoords]&&(cellStyles[newCellCoords]=cellStyles[adjacentCellCoords])}values.push(row)}this.Page.ElementsManager.inBatch(function(){this._updateProperty(Properties.CELLSSTYLES,cellStyles,!0),this._updateProperty(Properties.TABLEVALUE,values,!0)}.bind(this))}else if(diff<0){for(i=0;i<Math.abs(diff);i++)values.pop();this.updateProperty(Properties.TABLEVALUE,values,!0)}},Table.prototype.setColsNumber=function(newColsAmount,copyText){var currentColsAmount=this.getColsNumber(),diff=newColsAmount-currentColsAmount,values=_.cloneDeep(this.tableValue),widths=_.cloneDeep(this._columnWidths),columnIndexes=[],cellStyles=_.cloneDeep(this._cellsStyles);0!==diff&&(values.forEach(function(row,rowIndex){for(var i=0;i<Math.abs(diff);i++)if(diff>0){var newColIndex=row.push(copyText?row[row.length-1]:"")-1;columnIndexes.push(newColIndex);var newCellCoords=TableHelper.GetCellCoordinates(rowIndex,newColIndex),adjacentCellCoords=TableHelper.GetCellCoordinates(rowIndex,newColIndex-1);cellStyles[adjacentCellCoords]&&(cellStyles[newCellCoords]=cellStyles[adjacentCellCoords])}else row.pop(),columnIndexes.push(row.length)}),widths=diff>0?this.computeCellWidths(_.uniq(columnIndexes),minColumnWidth,widths):this.computeCellWidths(_.uniq(columnIndexes),0,widths,!0),this.Page.ElementsManager.inBatch(function(){this._updateProperty(Properties.CELLSSTYLES,cellStyles,!0),this._updateProperty(Properties.TABLEVALUE,values,!0),this._updateProperty(Properties.COLUMNWIDTHS,widths,!0)}.bind(this)))},Table.prototype.deleteColumns=function(indices){var values=_.cloneDeep(this._tableValue),styles=_.cloneDeep(this._cellsStyles),widths=_.cloneDeep(this._columnWidths),movedStyles={};_.forEach(_.sortBy(indices).reverse(),function(index){values.forEach(function(row){row.splice(index,1)}),widths.splice(index,1),_.each(styles,function(styleData,key){var column=TableHelper.GetColumnIndex(key);if(column===index)delete styles[key];else if(column>=index){var row=TableHelper.GetRowIndex(key);movedStyles[TableHelper.GetCellCoordinates(row,column-1)]=_.cloneDeep(styles[key]),delete styles[key]}})}),Object.assign(styles,movedStyles),this.Page.ElementsManager.inBatch(function(){this._updateProperty(Properties.TABLEVALUE,values,!0),this._updateProperty(Properties.CELLSSTYLES,styles,!0),this._updateProperty(Properties.COLUMNWIDTHS,this.getRealCellWidths(),!0)}.bind(this))},Table.prototype.moveColumns=function(colIndices,direction){var values=_.cloneDeep(this._tableValue),styles=_.cloneDeep(this._cellsStyles);_.forEach(direction>0?_.sortBy(colIndices).reverse():_.sortBy(colIndices),function(colIndex){var colNewIndex=colIndex+direction;_.forEach(values,function(row,rowIndex){var cell=row[colIndex],cellNew=row[colNewIndex],cellIndex=TableHelper.GetCellCoordinates(rowIndex,colIndex),cellNewIndex=TableHelper.GetCellCoordinates(rowIndex,colNewIndex);updateStyles(styles,cellIndex,cellNewIndex),row[colIndex]=cellNew,row[colNewIndex]=cell})}),this.Page.ElementsManager.inBatch(function(){this._updateProperty(Properties.TABLEVALUE,values,!0),this._updateProperty(Properties.CELLSSTYLES,styles,!0)}.bind(this))},Table.prototype.insertColumn=function(index,duplicate){var values=_.cloneDeep(this._tableValue),styles=_.cloneDeep(this._cellsStyles),widths=_.cloneDeep(this._columnWidths),movedStyles={};widths.splice(index,0,"undefined"!=typeof duplicate?widths[duplicate]:minColumnWidth),widths=getCompensatedWidths(widths,this.width),values.forEach(function(row){var newColumn;newColumn=void 0!==duplicate?_.cloneDeep(row[duplicate]):"",row.splice(index,0,newColumn)}),_.each(styles,function(styleData,key){var row=TableHelper.GetRowIndex(key),column=TableHelper.GetColumnIndex(key);column===duplicate&&(movedStyles[TableHelper.GetCellCoordinates(row,index)]=_.cloneDeep(styles[key])),column>=index&&(movedStyles[TableHelper.GetCellCoordinates(row,column+1)]=_.cloneDeep(styles[key]),delete styles[key])}),Object.assign(styles,movedStyles),this.Page.ElementsManager.inBatch(function(){this._updateProperty(Properties.TABLEVALUE,values,!0),this._updateProperty(Properties.CELLSSTYLES,styles,!0),this._updateProperty(Properties.COLUMNWIDTHS,widths,!0)}.bind(this))},Table.prototype.insertRow=function(index,duplicate){var newRow,values=_.cloneDeep(this._tableValue),styles=_.cloneDeep(this._cellsStyles);newRow=void 0!==duplicate?_.cloneDeep(values[duplicate]):Array(values[0].length).join("x").split("x"),values.splice(index,0,newRow);var movedStyles={};_.each(styles,function(styleData,key){var row=TableHelper.GetRowIndex(key),column=TableHelper.GetColumnIndex(key);row===duplicate&&(movedStyles[TableHelper.GetCellCoordinates(index,column)]=_.cloneDeep(styles[key])),row>=index&&(movedStyles[TableHelper.GetCellCoordinates(row+1,column)]=_.cloneDeep(styles[key]),delete styles[key])}),Object.assign(styles,movedStyles),this.Page.ElementsManager.inBatch(function(){this._updateProperty(Properties.TABLEVALUE,values,!0),this._updateProperty(Properties.CELLSSTYLES,styles,!0)}.bind(this))},Table.prototype.moveRows=function(rowIndices,direction){var values=_.cloneDeep(this._tableValue),styles=_.cloneDeep(this._cellsStyles);_.forEach(direction>0?_.sortBy(rowIndices).reverse():_.sortBy(rowIndices),function(rowIndex){var rowNewIndex=rowIndex+direction,row=values[rowIndex],rowNew=values[rowNewIndex];_.forEach(row,function(cell,colIndex){var cellIndex=TableHelper.GetCellCoordinates(rowIndex,colIndex),cellNewIndex=TableHelper.GetCellCoordinates(rowNewIndex,colIndex);updateStyles(styles,cellIndex,cellNewIndex)}),values[rowIndex]=rowNew,values[rowNewIndex]=row}),this.Page.ElementsManager.inBatch(function(){this._updateProperty(Properties.TABLEVALUE,values,!0),this._updateProperty(Properties.CELLSSTYLES,styles,!0)}.bind(this))},Table.prototype.deleteRows=function(indices){var values=_.cloneDeep(this._tableValue),styles=_.cloneDeep(this._cellsStyles),movedStyles={};_.forEach(_.sortBy(indices).reverse(),function(index){values.splice(index,1),_.each(styles,function(styleData,key){var row=TableHelper.GetRowIndex(key);if(row===index)delete styles[key];else if(row>index){var column=TableHelper.GetColumnIndex(key);movedStyles[TableHelper.GetCellCoordinates(row-1,column)]=_.cloneDeep(styles[key]),delete styles[key]}})}),Object.assign(styles,movedStyles),this.Page.ElementsManager.inBatch(function(){this._updateProperty(Properties.TABLEVALUE,values,!0),this._updateProperty(Properties.CELLSSTYLES,styles,!0)}.bind(this))},Table.prototype.setColumnWidth=function(index,columnWidth){var siblingColumnWidth,columnWidths=_.clone(this.getRealCellWidths()),maxColumnWidth=this._calculateSiblingColumnWidth(parseInt(columnWidths[index]),parseInt(columnWidths[index+1]),minColumnWidth);columnWidth<minColumnWidth?columnWidth=minColumnWidth:columnWidth>maxColumnWidth&&(columnWidth=maxColumnWidth),siblingColumnWidth=this._calculateSiblingColumnWidth(parseInt(columnWidths[index]),parseInt(columnWidths[index+1]),columnWidth),columnWidths.splice(index,2,Parse.toPx(columnWidth),Parse.toPx(siblingColumnWidth)),this.Page.ElementsManager.inBatch(function(){this._updateProperty(Properties.COLUMNWIDTHS,columnWidths,!0)}.bind(this))},Table.prototype._calculateSiblingColumnWidth=function(oldColumnWidth,oldSiblingColumnWidth,newColumnWidth){return parseInt(oldColumnWidth)+parseInt(oldSiblingColumnWidth)-parseInt(newColumnWidth)},Table.prototype.isTextInput=function(){return this.editable},Table.prototype.isTextEditable=function(){return!1},Table.prototype.applyStyleToCells=function(cells,property,value){var cellsStyles=_.cloneDeep(this.cellsStyles);return _.each(cells,function(cell){return void 0===value&&cellsStyles[cell]&&cellsStyles[cell].hasOwnProperty(property)?void delete cellsStyles[cell][property]:void(void 0!==value&&(cellsStyles[cell]||(cellsStyles[cell]={}),cellsStyles[cell][property]=value))}),this._updateProperty(Properties.CELLSSTYLES,cellsStyles,!0),cellsStyles},Table.prototype.update=function(){this.shouldUpdateStyles&&(this.shouldUpdateStyles=!1,this.view.setCellsStyles(this._mergeCellsStyles())),AbstractElement.prototype.update.call(this),this.updateParts(this.Page.canvas.scale)},Table.prototype._mergeCellsStyles=function(newStyles){var cellsCoordinates=TableHelper.GetAllCellsCoordinates(this.tableValue),cellsStyles=newStyles||this.cellsStyles;return _.reduce(cellsCoordinates,function(styles,coords){var cellStyles=cellsStyles[coords],rowStyles=this._getRowStyles(coords),columnStyles=this._getColumnStyles(coords),genericStyles={};return styles[coords]=_.extend(genericStyles,rowStyles,columnStyles,cellStyles),styles}.bind(this),{})},Table.prototype._getRowStyles=function(coordinates){var styles={};return TableHelper.IsOddRow(coordinates)&&(styles.backgroundColor=this._oddBackgroundColor),styles},Table.prototype._getCols=function(parts){return _.unique(_.map(parts,this._getColById.bind(this)))},Table.prototype._getRows=function(parts){return _.unique(_.map(parts,this._getRowById.bind(this)))},Table.prototype._getColById=function(id){return Math.floor(_.sortBy(_.keys(this.parts)).indexOf(id)/this.getRowsNumber())},Table.prototype._getRowById=function(id){var sortClause=function(cellId){return parseInt(100*cellId.charCodeAt(0))+parseInt(cellId.slice(1))};return _.sortBy(_.keys(this.parts),sortClause).indexOf(id)%this.getRowsNumber()},Table.prototype._getColumnStyles=function(coordinates){var styles={},columnIndex=TableHelper.GetColumnIndex(coordinates),widths=this.getColumnWidths();return widths[columnIndex]&&(styles.width=Parse.toPx(widths[columnIndex])),styles},Table.prototype.select=function(){this.view.addEditInfo(),AbstractElement.prototype.select.call(this)},Table.prototype.deselect=function(){this.view.removeEditInfo(),this.editable=!1,this.activeParts=[],this.firstPartSelected=null,AbstractElement.prototype.deselect.call(this)},Table.prototype.setEditing=function(turnOn,partId){if(turnOn)this._addKeyboardEvents(),this.view.getTableElement().classList.add("ng-editing"),this.view.setCurrentlyEditable(partId);else{this._removeKeyboardEvents(),this.view.getTableElement().classList.remove("ng-editing");var coords=this.view.currentlyEditable,row=TableHelper.GetRowIndex(coords),column=TableHelper.GetColumnIndex(coords);this.view.setCurrentlyEditable(!1);var tableData=_.cloneDeep(this.tableValue);tableData[row][column]=this.view.getCellValue(coords),this.updateProperty(Properties.TABLEVALUE,tableData,!0),this.editable=!1}},Table.prototype.onEnablePartSelection=function(){this.view.removeEditInfo()},Table.prototype.onDisablePartSelection=function(){this.view.enableEditInfo()},Table.prototype.canMoveRows=function(direction){var rows=this._getRows(this.activeParts),row=direction>0?_.last(rows):_.first(rows);return direction>0?row!==this.getRowsNumber()-1:0!==row},Table.prototype.canMoveCols=function(direction){var cols=this._getCols(this.activeParts),col=direction>0?_.last(cols):_.first(cols);return direction>0?col!==this.getColsNumber()-1:0!==col},Table.prototype.canDeleteCols=function(){var cols=this._getCols(this.activeParts);return cols.length<this.getColsNumber()},Table.prototype.canDeleteRows=function(){var rows=this._getRows(this.activeParts);return rows.length<this.getRowsNumber()},Table.prototype.selectionMoveRows=function(direction){if(this.activeParts.length&&this.canMoveRows(direction)){var rows=this._getRows(this.activeParts);this.moveRows(rows,direction)}},Table.prototype.selectionMoveCols=function(direction){if(this.activeParts.length&&this.canMoveCols(direction)){var cols=this._getCols(this.activeParts);this.moveColumns(cols,direction)}},Table.prototype.selectionInsertRow=function(direction){if(this.activeParts.length){var rows=_.sortBy(this._getRows(this.activeParts)),row=direction>0?_.last(rows):_.first(rows);this.insertRow(row+(direction>0?1:0),row)}},Table.prototype.selectionInsertCol=function(direction){if(this.activeParts.length){var cols=this._getCols(this.activeParts),col=direction>0?_.last(cols):_.first(cols);this.insertColumn(col+(direction>0?1:0),col)}},Table.prototype.selectionDeleteRows=function(){this.activeParts.length&&this.deleteRows(this._getRows(this.activeParts))},Table.prototype.selectionDeleteCols=function(){this.activeParts.length&&this.deleteColumns(this._getCols(this.activeParts))},Table.prototype.distributeColumnsEvenly=function(){var widths=_.times(this.getColsNumber(),function(){return Parse.toPx(this.width/this.getColsNumber())}.bind(this));this.Page.ElementsManager.inBatch(function(){this._updateProperty(Properties.COLUMNWIDTHS,widths,!0),this._updateProperty(Properties.CELLSSTYLES,this.cellsStyles,!0)}.bind(this))},Table.prototype.getMinColumnWidth=function(){return minColumnWidth},Table.prototype.getLeftOffsetForColumn=function(columnIndex){var offset=_.reduce(this.getRealCellWidths().slice(0,columnIndex),function(sum,value){return sum+parseInt(value)},0)+parseInt(this.borderLeftWidth)/2;return offset},Table.prototype.hasTextNodes=function(){return!0},Table.prototype.getCellsBorderColors=function(){var _this=this;return _.compact(_.map(this.cellsStyles,function(cellStyle){return _this.hasBorder(cellStyle)?Color.getColorsSet(cellStyle.borderColor):null}))},Table.prototype.getBackgroundColor=function(){return null},Table.prototype.getCellsBackgroundColors=function(){for(var styledOddCellsNumber=(this.getColsNumber()*this.getRowsNumber(),0),styledEvenCellsNumber=0,oddCellsNumber=0,eventCellsNumber=0,colors=void 0,i=0;i<this.getRowsNumber();i++)i%2===0?eventCellsNumber+=this.getColsNumber():oddCellsNumber+=this.getColsNumber();return colors=_.compact(_.map(this.cellsStyles,function(cellStyle,id){var parsedNumber=id.match(/[0-9]+/)?id.match(/[0-9]+/)[0]:null,rowNumber=parseInt(parsedNumber);return rowNumber%2===1?styledOddCellsNumber++:rowNumber%2===0&&styledEvenCellsNumber++,Color.getColorsSet(cellStyle.backgroundColor)})),styledOddCellsNumber<oddCellsNumber/2&&(colors=colors.concat(Color.getColorsSet(this._oddBackgroundColor))),styledEvenCellsNumber<eventCellsNumber/2&&(colors=colors.concat(Color.getColorsSet(this.backgroundColor))),colors},Table}()},{"../enums/ElementTypes.js":346,"../enums/Properties.js":358,"../utils/Base.js":405,"../utils/Color.js":409,"../utils/Parse.js":415,"./AbstractElement.js":166,"./behaviors/Multipart.js":232,"./behaviors/SimpleBorder.js":234,"./behaviors/SimpleTextEditable.js":236,"./helpers/TableHelper.js":258,"./helpers/TextStyleHelper.js":261,"./views/TableView.js":337,lodash:161}],215:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("./AbstractElement.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),Events=_dereq_("../enums/Events.js"),PageModes=_dereq_("../enums/PageModes.js"),TagView=_dereq_("./views/TagView.js");module.exports=function(){function Tag(){var _this=this;AbstractElement.apply(this,arguments),this.type=ElementTypes.TAG,this.view=this.createView(TagView),this.Page.on(Events.MODE_CHANGE,function(prevMode,nextMode){nextMode===PageModes.SPEC_MODE?_this.enableSpecMode():prevMode===PageModes.SPEC_MODE&&_this.disableSpecMode()})}return Tag.DefaultProperties={width:{value:36},height:{value:36},title:{value:""},text:{value:""},src:{value:"/p/elements/standard/pins/black.png"}},Base.Extend(Tag,AbstractElement),Object.defineProperties(Tag.prototype,{title:{get:function(){return this._title},set:function(value){this._saveProperty(),this._title=value,this.view.setTitle(value)}},text:{get:function(){return this._text},set:function(value){this._saveProperty(),this._text=value,this.view.setText(value)}},src:{get:function(){return this._src},set:function(value){this._saveProperty(),this._src=value,this.view.setSrc(this._getCdnUrl(value))}}}),Tag.prototype.enableSpecMode=function(){this.stateIaOld=this.stateIa,this.setVisibility(!1)},Tag.prototype.disableSpecMode=function(){this.setVisibility("visible"===this.stateIaOld)},Tag.prototype.getBackgroundColor=function(){return null},Tag.prototype.getBorderColor=function(){return null},Tag.prototype.isDrawable=function(){return!1},Tag.prototype.hasCustomStyles=function(){return!1},Tag}()},{"../enums/ElementTypes.js":346,"../enums/Events.js":347,"../enums/PageModes.js":357,"../utils/Base.js":405,"./AbstractElement.js":166,"./views/TagView.js":338}],216:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("./AbstractElement.js"),TextEditable=_dereq_("./behaviors/TextEditable.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),TextElementView=_dereq_("./views/TextElementView.js"),TextEditor=_dereq_("./helpers/TextEditor.js"),TextStyleHelper=_dereq_("./helpers/TextStyleHelper.js"),Properties=_dereq_("../enums/Properties.js");module.exports=function(){function TextElement(){AbstractElement.apply(this,arguments),this.type=ElementTypes.TEXT_ELEMENT,this.view=this.createView(TextElementView)}return TextElement.DefaultProperties={inputValue:{value:TextStyleHelper.DEFAULT_TEXT},backgroundColor:{value:""},letterSpacing:{value:0},lineHeight:{value:""},link:{value:""},height:{value:14},textTransform:{value:""}},TextElement.ExcludedProperties={backgroundColor:!0,letterSpacing:!0,lineHeight:!0,link:!0,textAlign:!0,textTransform:!0},Base.Extend(TextElement,AbstractElement),Base.ApplyBehavior(TextElement,TextEditable),Object.defineProperties(TextElement.prototype,{backgroundColor:{get:function(){return TextEditor.GetBackgroundColor(this)},set:function(value){if(!this.Page.isDesignMode())return void this.view.setBackgroundColor(value);var contentData=TextEditor.SetBackgroundColor(this,value);return!!contentData&&(this._saveProperty(),this._updateProperty(Properties.INPUT_VALUE,contentData.content,!0),void this._updateProperty(Properties.HEIGHT,contentData.height,!0))}},lineHeight:{get:function(){return TextEditor.GetLineHeight(this)},set:function(value){var contentData=TextEditor.SetLineHeight(this,value);return!!contentData&&(this._saveProperty(),this._updateProperty(Properties.INPUT_VALUE,contentData.content,!0),void this._updateProperty(Properties.HEIGHT,contentData.height,!0))}},letterSpacing:{get:function(){return TextEditor.GetLetterSpacing(this)},set:function(value){var contentData=TextEditor.SetLetterSpacing(this,value);return!!contentData&&(this._saveProperty(),this._updateProperty(Properties.INPUT_VALUE,contentData.content,!0),void(this.adjustHeightToText()&&this._updateProperty(Properties.HEIGHT,contentData.height,!0)))}},textAlign:{get:function(){return TextEditor.GetAlign(this)},set:function(value){var contentData=TextEditor.SetAlign(this,value);return!!contentData&&(this._saveProperty(),this._updateProperty(Properties.INPUT_VALUE,contentData.content,!0),void this._updateProperty(Properties.HEIGHT,contentData.height,!0))}},textTransform:{get:function(){return TextEditor.GetTextTransform(this)},set:function(value){var contentData=TextEditor.SetTextTransform(this,value);return!!contentData&&(this._saveProperty(),this._updateProperty(Properties.INPUT_VALUE,contentData.content,!0),void(this.adjustHeightToText()&&this._updateProperty(Properties.HEIGHT,contentData.height,!0)))}},link:{get:function(){return TextEditor.GetLink(this)},set:function(value){var contentData=TextEditor.SetLink(this,value);return!!contentData&&(this._saveProperty(),this._updateProperty(Properties.INPUT_VALUE,contentData.content,!0),void this._updateProperty(Properties.HEIGHT,contentData.height,!0))}},width:{get:function(){return Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.WIDTH).get.call(this)},set:function(value){Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.WIDTH).set.call(this,value),this.shouldUpdateHeight=!0}},shouldUpdateHeight:{get:function(){return this._shouldUpdateHeight},set:function(value){this._shouldUpdateHeight=value,value&&(this.dirty=value)}}}),TextElement.prototype.update=function(){AbstractElement.prototype.update.call(this),this.shouldUpdateHeight&&(this.rect.height=parseInt(window.getComputedStyle(this.view.domElement).height)||this.rect.height,this.shouldUpdateHeight=!1)},TextElement.prototype.isTextEditable=function(){return!0},TextElement.prototype.isRichTextEditable=function(){return!0},TextElement.prototype.adjustHeightToText=function(){return!0},TextElement.prototype.getPropertiesMinMax=function(properties){var minMax=AbstractElement.prototype.getPropertiesMinMax.call(this,properties);return minMax[Properties.HEIGHT]&&(minMax[Properties.HEIGHT]={min:this.DefaultProperties[Properties.HEIGHT].value,max:this.DefaultProperties[Properties.HEIGHT].value}),minMax},TextElement.prototype.isKeepRatioDisabled=function(){return!0},TextElement}()},{"../enums/ElementTypes.js":346,"../enums/Properties.js":358,"../utils/Base.js":405,"./AbstractElement.js":166,"./behaviors/TextEditable.js":238,"./helpers/TextEditor.js":260,"./helpers/TextStyleHelper.js":261,"./views/TextElementView.js":339}],217:[function(_dereq_,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _Properties=_dereq_("../enums/Properties.js"),_Color=(_interopRequireDefault(_Properties),_dereq_("../utils/Color.js")),AbstractElement=(_interopRequireDefault(_Color),
_dereq_("./AbstractElement.js")),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),TextareaView=_dereq_("./views/TextareaView.js"),SimpleTextEditable=_dereq_("./behaviors/SimpleTextEditable.js"),Boxable=_dereq_("./behaviors/Boxable.js");module.exports=function(){function Textarea(){AbstractElement.apply(this,arguments),this.type=ElementTypes.TEXTAREA,this.view=this.createView(TextareaView)}return Textarea.DefaultProperties={color:{value:"#474747"},paddingTop:{value:0},paddingRight:{value:10},paddingBottom:{value:0},paddingLeft:{value:10},boxShadow:{value:""},disabled:{value:0},value:{value:""},borderTopWidth:{value:1},borderRightWidth:{value:1},borderBottomWidth:{value:1},borderLeftWidth:{value:1},borderLock:{value:!0},borderColor:{value:"#c8c8c8"},backgroundColor:{value:"#FFFFFF"},textAlign:{value:"left"}},Base.Extend(Textarea,AbstractElement),Base.ApplyBehavior(Textarea,SimpleTextEditable),Base.ApplyBehavior(Textarea,Boxable),Object.defineProperties(Textarea.prototype,{paddingTop:{get:function(){return this._paddingTop},set:function(value){this._saveProperty(),this._paddingTop=value,this.view.setPaddingTop(value)}},paddingRight:{get:function(){return this._paddingRight},set:function(value){this._saveProperty(),this._paddingRight=value,this.view.setPaddingRight(value)}},paddingBottom:{get:function(){return this._paddingBottom},set:function(value){this._saveProperty(),this._paddingBottom=value,this.view.setPaddingBottom(value)}},paddingLeft:{get:function(){return this._paddingLeft},set:function(value){this._saveProperty(),this._paddingLeft=value,this.view.setPaddingLeft(value)}},boxShadow:{get:function(){return this._boxShadow},set:function(value){this._saveProperty(),this._boxShadow=value,this.view.setBoxShadow(value)}},disabled:{get:function(){return this._disabled},set:function(value){this._saveProperty(),this._disabled=value,this.view.setDisabled(value)}}}),Textarea.prototype.isTextInput=function(){return!0},Textarea.prototype.getFonts=function(domEl){var font=this.getFontFromDOMElement(domEl||this.view.domElement);return this.initFontsCollection(),this.addFontToCollection(font),this._fontsCollection},Textarea}()},{"../enums/ElementTypes.js":346,"../enums/Properties.js":358,"../utils/Base.js":405,"../utils/Color.js":409,"./AbstractElement.js":166,"./behaviors/Boxable.js":224,"./behaviors/SimpleTextEditable.js":236,"./views/TextareaView.js":340}],218:[function(_dereq_,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _Properties=_dereq_("../enums/Properties.js"),_Color=(_interopRequireDefault(_Properties),_dereq_("../utils/Color.js")),AbstractElement=(_interopRequireDefault(_Color),_dereq_("./AbstractElement.js")),Box=_dereq_("./Box.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),TooltipView=_dereq_("./views/TooltipView.js");module.exports=function(){function Tooltip(){AbstractElement.apply(this,arguments),this.type=ElementTypes.TOOLTIP,this.view=this.createView(TooltipView)}return Tooltip.DefaultProperties={position:{value:"top"},borderTopWidth:{value:1},borderRightWidth:{value:1},borderBottomWidth:{value:1},borderLeftWidth:{value:1},backgroundColor:{value:"#f0f0f0"}},Base.Extend(Tooltip,Box),Object.defineProperties(Tooltip.prototype,{position:{get:function(){return this._position},set:function(value){this._saveProperty(),this._position=value,this.view.setPosition(value)}}}),Tooltip}()},{"../enums/ElementTypes.js":346,"../enums/Properties.js":358,"../utils/Base.js":405,"../utils/Color.js":409,"./AbstractElement.js":166,"./Box.js":171,"./views/TooltipView.js":341}],219:[function(_dereq_,module,exports){"use strict";var SvgIcon=_dereq_("./SvgIcon.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),Base=_dereq_("../utils/Base.js");module.exports=function(){function UXPinIconSet(){SvgIcon.apply(this,arguments),this.type=ElementTypes.UXPIN_ICON_SET}return Base.Extend(UXPinIconSet,SvgIcon),UXPinIconSet}()},{"../enums/ElementTypes.js":346,"../utils/Base.js":405,"./SvgIcon.js":210}],220:[function(_dereq_,module,exports){"use strict";var SvgSymbol=_dereq_("./SvgSymbol.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),UniSvgView=_dereq_("./views/UniSvgView.js");module.exports=function(){function UniSvg(){SvgSymbol.apply(this,arguments),this.type=ElementTypes.UNI_SVG,this.view=this.createView(UniSvgView)}return UniSvg.ExcludedProperties={color:!0},Base.Extend(UniSvg,SvgSymbol),UniSvg}()},{"../enums/ElementTypes.js":346,"../utils/Base.js":405,"./SvgSymbol.js":212,"./views/UniSvgView.js":342}],221:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("./AbstractElement.js"),VideoView=_dereq_("./views/VideoView.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),Properties=_dereq_("../enums/Properties.js"),Events=_dereq_("../enums/Events.js"),PageModes=_dereq_("../enums/PageModes.js"),VideoHelper=_dereq_("./helpers/VideoHelper");module.exports=function(){function Video(){var _this=this;AbstractElement.apply(this,arguments),this.type=ElementTypes.VIDEO,this.view=this.createView(VideoView),this.Page.on(Events.MODE_CHANGE,function(prevMode,nextMode){[PageModes.PREVIEW,PageModes.SPEC].indexOf(nextMode)!==-1?_this.setVideoActive():_this.setVideoInactive()})}return Video.DefaultProperties={width:{value:640},height:{value:385},videohtml:{value:""},videourl:{value:""},videohd:{value:""},backgroundImage:{value:""}},Base.Extend(Video,AbstractElement),Object.defineProperties(Video.prototype,{width:{get:function(){return Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.WIDTH).get.call(this)},set:function(value){return this.updateVideoHtml(),Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.WIDTH).set.call(this,value)}},height:{get:function(){return Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.HEIGHT).get.call(this)},set:function(value){return this.updateVideoHtml(),Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.HEIGHT).set.call(this,value)}},backgroundImage:{get:function(){return this._backgroundImage},set:function(value){this._saveProperty(),this._backgroundImage=value,this.view.setBackgroundImage(value)}},videohtml:{get:function(){return this._videohtml},set:function(value){this._saveProperty(),this._videohtml=value,(this.Page.isPreviewMode()||this.Page.isSpecMode())&&this.view.setVideoHtml(value)}},videourl:{get:function(){return this._videourl},set:function(value){this._saveProperty(),this._videourl=value,this.updateVideoHtml(value)}}}),Video.prototype.setVideoActive=function(){this.view.setVideoHtml(this.videohtml),this.view.setBackgroundImage("")},Video.prototype.setVideoInactive=function(){this.view.setVideoHtml(""),this.view.setBackgroundImage(this.backgroundImage)},Video.prototype.updateVideoHtml=function(url){var videoHtml=VideoHelper.getVideoHtml(url||this.videourl,this.width,this.height);videoHtml&&(this.videohtml=videoHtml)},Video.prototype.getTextContent=function(){return this.videourl},Video}()},{"../enums/ElementTypes.js":346,"../enums/Events.js":347,"../enums/PageModes.js":357,"../enums/Properties.js":358,"../utils/Base.js":405,"./AbstractElement.js":166,"./helpers/VideoHelper":262,"./views/VideoView.js":343}],222:[function(_dereq_,module,exports){"use strict";function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var _=_dereq_("lodash"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),Group=_dereq_("./Group.js"),Properties=_dereq_("../enums/Properties.js");module.exports=function(){function isVirtualGroupProperty(property){var properties=[Properties.ANGLE,Properties.CLIP,Properties.HEIGHT,Properties.IS_CLIP,Properties.KEEP_RATIO,Properties.STATES,Properties.STORED_ELEMENTS,Properties.WIDTH,Properties.X,Properties.Y];return properties.indexOf(property)>-1}function getTranslatedProperty(property,type){return propertyTranslationMap[type]&&propertyTranslationMap[type][property]||property}function getChildProperties(child){var properties=child.getProperties();return _.forEach(propertyTranslationMap[child.type],function(propertyTranslated,property){properties[property]={value:child[propertyTranslated]}}),properties}function VirtualGroup(){Group.apply(this,arguments),this.type=ElementTypes.VIRTUAL_GROUP}var _propertyTranslationM,propertyTranslationMap=(_propertyTranslationM={},_defineProperty(_propertyTranslationM,ElementTypes.ANDROID_ICON,_defineProperty({},Properties.BACKGROUND_COLOR,Properties.COLOR)),_defineProperty(_propertyTranslationM,ElementTypes.ARROW,_defineProperty({},Properties.BACKGROUND_COLOR,Properties.COLOR)),_defineProperty(_propertyTranslationM,ElementTypes.FONT_AWESOME,_defineProperty({},Properties.BACKGROUND_COLOR,Properties.COLOR)),_defineProperty(_propertyTranslationM,ElementTypes.GEO_SVG,_defineProperty({},Properties.BACKGROUND_COLOR,Properties.COLOR)),_defineProperty(_propertyTranslationM,ElementTypes.ICON,_defineProperty({},Properties.BACKGROUND_COLOR,Properties.COLOR)),_defineProperty(_propertyTranslationM,ElementTypes.LINE,_defineProperty({},Properties.BACKGROUND_COLOR,Properties.COLOR)),_defineProperty(_propertyTranslationM,ElementTypes.MATERIAL_ICON,_defineProperty({},Properties.BACKGROUND_COLOR,Properties.COLOR)),_defineProperty(_propertyTranslationM,ElementTypes.PIXLE_ICON,_defineProperty({},Properties.BACKGROUND_COLOR,Properties.COLOR)),_defineProperty(_propertyTranslationM,ElementTypes.RETINA_ICON,_defineProperty({},Properties.BACKGROUND_COLOR,Properties.COLOR)),_defineProperty(_propertyTranslationM,ElementTypes.SVG_SYMBOL,_defineProperty({},Properties.BACKGROUND_COLOR,Properties.COLOR)),_defineProperty(_propertyTranslationM,ElementTypes.UXPIN_ICON_SET,_defineProperty({},Properties.BACKGROUND_COLOR,Properties.COLOR)),_propertyTranslationM);return Base.Extend(VirtualGroup,Group),Object.defineProperties(VirtualGroup.prototype,{dirty:{get:function(){return this._dirty},set:function(value){this._dirty=value,this.update()}},keepRatio:{get:function(){return _.some(this.children,function(child){return child.keepRatio})},set:function(value){_.forEach(this.children,function(child){return child._updateProperty.call(child,Properties.KEEP_RATIO,value,!0)})}}}),VirtualGroup.prototype.isVirtualGroup=function(){return!0},VirtualGroup.prototype.update=function(){this._updateBoundingBox()},VirtualGroup.prototype.getProperties=function(){return _.reduce(_.rest(this.children),function(properties,child){var propertiesToMerge=getChildProperties(child);return _.pick(properties,function(propertyValue,propertyName){return propertiesToMerge[propertyName]})},getChildProperties(_.first(this.children)))},VirtualGroup.prototype.validateProperty=function(property,value){return value},VirtualGroup.prototype.getMaxBoxModelValue=function(property,edge){return _.min(_.map(this.children,function(child){return child.getMaxBoxModelValue(property,edge)}))},VirtualGroup.prototype.serialize=function(){var serialized={};return serialized.id=this.id,serialized.type=this.type,serialized.props={storedElements:_.cloneDeep(this.storedElements),x:this.x,y:this.y,width:this.width,height:this.height,angle:this.angle},serialized.v="2.0",serialized},VirtualGroup.prototype.getAllChildrenSiblings=function(){return _.reduce(this.children,function(children,child){return _.forEach(child.parent.children,function(child){children.seen[child.id]||(children.seen[child.id]=!0,children.nodes.push(child))}),children},{seen:{},nodes:[]}).nodes},VirtualGroup.prototype.isKeepRatioDisabled=function(){return _.some(this.children,function(child){return child.isKeepRatioDisabled()})},VirtualGroup.prototype._updateProperty=function(property,value,addToHistory){isVirtualGroupProperty(property)?Group.prototype._updateProperty.call(this,property,value,addToHistory):_.forEach(this.children,function(child){var translatedProperty=getTranslatedProperty(property,child.type);child._updateProperty.call(child,translatedProperty,value,addToHistory)})},VirtualGroup.prototype._saveProperty=function(){},VirtualGroup.prototype._updateStoredElements=function(elements){var child=void 0,index=void 0;elements.length>this._storedElements.length?_.forEach(_.difference(elements,this._storedElements),function(elementId){child=this._getElementById(elementId),index=elements.indexOf(elementId),index<this.children.length?this.children.splice(index,0,child):this.children.push(child)}.bind(this)):elements.length<this._storedElements.length&&_.forEach(_.difference(this._storedElements,elements),function(elementId){child=this._getElementById(elementId),index=this.getChildIndex(child),this.children.splice(index,1)}.bind(this)),this._storedElements=elements,this.update()},VirtualGroup.prototype._addChildProperties=function(child){_.forEach(_.reject(_.keys(getChildProperties(child)),isVirtualGroupProperty),function(property){this.hasOwnProperty(property)||Object.defineProperty(this,property,{get:function(){var translatedProperty=getTranslatedProperty(property,child.type);return child[translatedProperty]},set:function(value){return this._updateProperty(property,value,!0)}})}.bind(this))},VirtualGroup.prototype._add=function(child){this._addChildProperties(child),this.children.push(child),this._storedElements=_.map(this.children,function(child){return child.id})},VirtualGroup.prototype._remove=function(child,index){this.children.splice(index,1),this._storedElements=_.map(this.children,function(child){return child.id})},VirtualGroup}()},{"../enums/ElementTypes.js":346,"../enums/Properties.js":358,"../utils/Base.js":405,"./Group.js":185,lodash:161}],223:[function(_dereq_,module,exports){"use strict";module.exports=function(){function Annotable(){}return Annotable.prototype.getHighlightAnnotation=function(page,id,isSelected){var Highlight=_dereq_("../ui/HighlightAnnotation.js");return new Highlight(null,page,id,isSelected)},Annotable.prototype.setAnnotation=function(id){var isSelected=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.highlight?this.updateAnnotation(id,isSelected):this.addAnnotation(id,isSelected)},Annotable.prototype.addAnnotation=function(id){var isSelected=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.highlight||(this.highlight=this.getHighlightAnnotation(this.Page,id,isSelected),this.highlight.link(this,!0),this.Page.canvas.view.domElement.appendChild(this.highlight.view.domElement),this.highlight.addNumber())},Annotable.prototype.updateAnnotation=function(id){var isSelected=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.highlight&&(this.highlight.updateNumber(id),this.highlight.toggleSelection(isSelected))},Annotable.prototype.removeAnnotation=function(){this.highlight&&(this.Page.canvas.view.domElement.removeChild(this.highlight.view.domElement),this.highlight.unlink(this),this.highlight.removeNumber(),this.removeLinkedElement(this.highlight),this.highlight=null)},Annotable.prototype.isAnnotationSelected=function(){return!!this.highlight&&this.highlight.isSelected},Annotable.prototype.selectAnnotation=function(){this.highlight&&this.highlight.select()},Annotable.prototype.deselectAnnotation=function(){this.highlight&&this.highlight.deselect()},Annotable.prototype.highlightAnnotation=function(){this.highlight&&this.highlight.hover()},Annotable.prototype.removeAnnotationHighlight=function(){this.highlight&&this.highlight.removeHover()},Annotable}()},{"../ui/HighlightAnnotation.js":273}],224:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash");module.exports=function(){function getSizePropertyFromEdge(edge){return verticalEdges.indexOf(edge)>-1?"height":"width"}function getOppositeEdge(edge){return opposites[edge]}function Boxable(){this._defineMaxValuesGetters()}var verticalEdges=["top","bottom"],opposites={top:"bottom",left:"right",right:"left",bottom:"top"};return Boxable.DefaultProperties={borderTopWidth:{value:0},borderBottomWidth:{value:0},borderLeftWidth:{value:0},borderRightWidth:{value:0},borderTopLeftRadius:{value:0},borderTopRightRadius:{value:0},borderBottomRightRadius:{value:0},borderBottomLeftRadius:{value:0},borderColor:{value:"#c8c8c8"},borderStyle:{value:"solid"},borderLock:{value:!0},radiusLock:{value:!0},backgroundColor:{value:"#ebebeb"},backgroundImage:{value:""},backgroundSize:{value:"auto"},backgroundRepeat:{value:"repeat"},backgroundPosition:{value:"center center"}},Object.defineProperties(Boxable.prototype,{borderTopWidth:{get:function(){return this._borderTopWidth},set:function(value){this._saveProperty(),this._borderTopWidth=parseFloat(value)||0,this.view.setBorderTopWidth(value)}},borderBottomWidth:{get:function(){return this._borderBottomWidth},set:function(value){this._saveProperty(),this._borderBottomWidth=parseFloat(value)||0,this.view.setBorderBottomWidth(value)}},borderLeftWidth:{get:function(){return this._borderLeftWidth},set:function(value){this._saveProperty(),this._borderLeftWidth=parseFloat(value)||0,this.view.setBorderLeftWidth(value)}},borderRightWidth:{get:function(){return this._borderRightWidth},set:function(value){this._saveProperty(),this._borderRightWidth=parseFloat(value)||0,this.view.setBorderRightWidth(value)}},borderTopLeftRadius:{get:function(){return this._borderTopLeftRadius},set:function(value){this._saveProperty(),this._borderTopLeftRadius=parseFloat(value)||0,this.view.setBorderTopLeftRadius(this._borderTopLeftRadius)}},borderTopRightRadius:{get:function(){return this._borderTopRightRadius},set:function(value){this._saveProperty(),this._borderTopRightRadius=parseFloat(value)||0,this.view.setBorderTopRightRadius(this._borderTopRightRadius)}},borderBottomRightRadius:{get:function(){return this._borderBottomRightRadius},set:function(value){this._saveProperty(),this._borderBottomRightRadius=parseFloat(value)||0,this.view.setBorderBottomRightRadius(this._borderBottomRightRadius)}},borderBottomLeftRadius:{get:function(){return this._borderBottomLeftRadius},set:function(value){this._saveProperty(),this._borderBottomLeftRadius=parseFloat(value)||0,this.view.setBorderBottomLeftRadius(this._borderBottomLeftRadius)}},borderColor:{get:function(){return this._borderColor},set:function(value){this._saveProperty(),this._borderColor=value,this.view.setBorderColor(value)}},borderStyle:{get:function(){return this._borderStyle},set:function(value){this._saveProperty(),this._borderStyle=value,this.view.setBorderStyle(value)}},borderLock:{get:function(){return this._borderLock},set:function(value){this._saveProperty(),this._borderLock=value}},radiusLock:{get:function(){return this._radiusLock},set:function(value){this._saveProperty(),this._radiusLock=value}},backgroundColor:{get:function(){return this._backgroundColor},set:function(value){this._saveProperty(),this._backgroundColor=value,this.view.setBackgroundColor(value)}},backgroundImage:{get:function(){return this._backgroundImage},set:function(value){this._saveProperty(),this._backgroundImage=value,this.view.setBackgroundImage(value)}},backgroundSize:{get:function(){return this._backgroundSize},set:function(value){this._saveProperty(),this._backgroundSize=value,this.view.setBackgroundSize(value)}},backgroundRepeat:{get:function(){return this._backgroundRepeat},set:function(value){this._saveProperty(),this._backgroundRepeat=value,this.view.setBackgroundRepeat(value)}},backgroundPosition:{get:function(){return this._backgroundPosition},set:function(value){this._saveProperty(),this._backgroundPosition=value,this.view.setBackgroundPosition(value)}}}),Boxable.prototype.getMaxBoxModelValue=function(property,edge){var size=parseInt(this[getSizePropertyFromEdge(edge)]),oppositeEdge=getOppositeEdge(edge),_padding={top:parseInt(this.paddingTop)||0,left:parseInt(this.paddingLeft)||0,right:parseInt(this.paddingRight)||0,bottom:parseInt(this.paddingBottom)||0},_border={top:parseInt(this.borderTopWidth)||0,left:parseInt(this.borderLeftWidth)||0,right:parseInt(this.borderRightWidth)||0,bottom:parseInt(this.borderBottomWidth)||0},calculators={border:function(){return size-_border[oppositeEdge]-_padding[edge]-_padding[oppositeEdge]},padding:function(){return size-_padding[oppositeEdge]-_border[edge]-_border[oppositeEdge]}};return calculators[property]()},Boxable.prototype._defineMaxValuesGetters=function(){var getters={borderTopWidth:this.getMaxBoxModelValue.bind(this,"border","top"),borderLeftWidth:this.getMaxBoxModelValue.bind(this,"border","left"),borderRightWidth:this.getMaxBoxModelValue.bind(this,"border","right"),borderBottomWidth:this.getMaxBoxModelValue.bind(this,"border","bottom"),paddingTop:this.getMaxBoxModelValue.bind(this,"padding","top"),paddingLeft:this.getMaxBoxModelValue.bind(this,"padding","left"),paddingRight:this.getMaxBoxModelValue.bind(this,"padding","right"),paddingBottom:this.getMaxBoxModelValue.bind(this,"padding","bottom")};_.forEach(getters,function(getter,property){this.DefaultProperties.hasOwnProperty(property)&&!this.DefaultProperties[property].hasOwnProperty("max")&&Object.defineProperty(this.DefaultProperties[property],"max",{get:getter})}.bind(this))},Boxable.prototype.updateLockStatus=function(properties,lockType){_.every(properties,function(property){return property===properties[0]})||(this[lockType]=!1)},Boxable}()},{lodash:161}],225:[function(_dereq_,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var _Properties=_dereq_("../../enums/Properties.js"),_Properties2=_interopRequireDefault(_Properties),_CssHelper=_dereq_("../helpers/CssHelper"),_BorderHelper=_dereq_("../helpers/BorderHelper"),_PaddingHelper=_dereq_("../helpers/PaddingHelper"),_BackgroundHelper=_dereq_("../helpers/BackgroundHelper"),_=_dereq_("lodash"),tinycolor=_dereq_("tinycolor2");module.exports=function(){function setProperty(styles,property,value){null!==value&&(styles[property]=value)}function getComputedStyleValue(property){return helperElement.style[property]}function transformStyles(styles){helperElement.style.cssText=_.map(styles.orderedList,function(style){return _.kebabCase(style.property)+":"+style.value+";"}).join("");var newStyles={};return _.forEach(styles.orderedList,function(style){var property=style.property;switch(property){case _Properties2.default.WIDTH:case _Properties2.default.HEIGHT:case _Properties2.default.FONT_SIZE:setProperty(newStyles,property,parseInt(helperElement.style[property])||null);break;case _Properties2.default.OPACITY:var opacity=100*parseFloat(helperElement.style[property]);setProperty(newStyles,property,opacity||0===opacity?opacity:null);break;case _Properties2.default.BORDER:case _Properties2.default.BORDER_TOP:case _Properties2.default.BORDER_LEFT:case _Properties2.default.BORDER_RIGHT:case _Properties2.default.BORDER_BOTTOM:case _Properties2.default.BORDER_WIDTH:_.extend(newStyles,(0,_BorderHelper.extractBorderData)(helperElement.style));break;case _Properties2.default.BACKGROUND:_.extend(newStyles,(0,_BackgroundHelper.extractBackgroundData)(helperElement.style));break;case _Properties2.default.PADDING:_.extend(newStyles,(0,_PaddingHelper.extractPaddingData)(helperElement.style));break;case _Properties2.default.BORDER_RADIUS:_.extend(newStyles,(0,_BorderHelper.extractBorderRadiusData)(helperElement.style));break;case _Properties2.default.COLOR:case _Properties2.default.BACKGROUND_COLOR:case _Properties2.default.BORDER_COLOR:var color=tinycolor(helperElement.style[property]);setProperty(newStyles,property,color.isValid()?color.toRgbString():null);break;default:setProperty(newStyles,property,helperElement.style[property])}}),newStyles}function Customizable(){}var _LOCK_STATUS_PROPERTI,helperElement=document.createElement("div"),propsNeedUpdate=[_Properties2.default.BORDER_COLOR,_Properties2.default.BORDER_STYLE,_Properties2.default.BORDER_TOP_WIDTH,_Properties2.default.BORDER_RIGHT_WIDTH,_Properties2.default.BORDER_BOTTOM_WIDTH,_Properties2.default.BORDER_LEFT_WIDTH],LOCK_STATUS_PROPERTIES_MAP=(_LOCK_STATUS_PROPERTI={},_defineProperty(_LOCK_STATUS_PROPERTI,_Properties2.default.BORDER_LOCK,[_Properties2.default.BORDER_TOP_WIDTH,_Properties2.default.BORDER_RIGHT_WIDTH,_Properties2.default.BORDER_BOTTOM_WIDTH,_Properties2.default.BORDER_LEFT_WIDTH]),_defineProperty(_LOCK_STATUS_PROPERTI,_Properties2.default.RADIUS_LOCK,[_Properties2.default.BORDER_BOTTOM_LEFT_RADIUS,_Properties2.default.BORDER_BOTTOM_RIGHT_RADIUS,_Properties2.default.BORDER_TOP_LEFT_RADIUS,_Properties2.default.BORDER_TOP_RIGHT_RADIUS]),_LOCK_STATUS_PROPERTI);return Customizable.DefaultProperties={customStyles:{value:[]}},Object.defineProperties(Customizable.prototype,{customStyles:{get:function(){return _.clone(this._customStyles)},set:function(value){var styles,previousStyles,_this=this,additionalStyles={},cleanedValues=_.compact(value);if(this._saveProperty(),!_.isArray(cleanedValues))return this._customStyles=[],this.view.removeCustomStyles(this.additionalStyles),void(this.additionalStyles={});if(_.isEqual(this._customStyles,cleanedValues))return this._customStyles=cleanedValues,void this.view.setCustomStyles(this.additionalStyles);if(previousStyles=transformStyles((0,_CssHelper.parseCss)(this._customStyles)),styles=transformStyles((0,_CssHelper.parseCss)(cleanedValues)),this._customStyles&&styles){var toRemove=this.getCustomStylesToRemove(previousStyles,styles);this.view.removeCustomStyles(toRemove),this._refreshBorderDefaultProperties(toRemove)}_.forEach(styles,function(value,property){_this.hasProperty(property)?_this.setCustomStylesProperty(property,value):additionalStyles[property]=getComputedStyleValue(property)}),this._customStyles=cleanedValues,this.additionalStyles=additionalStyles,this.view.setCustomStyles(additionalStyles),this._updateLock(styles)}}}),Customizable.prototype.getCustomStylesToRemove=function(currentStyles,newStyles){var _this2=this;return _.difference(Object.keys(currentStyles),Object.keys(newStyles)).filter(function(property){return!_this2.hasProperty(property)})},Customizable.prototype.hasCustomStyles=function(){return!0},Customizable.prototype.setCustomStylesProperty=function(property,value){this[property]!==value&&this.Page.isDesignMode()&&this.isSelected()&&(property===_Properties2.default.BOX_SHADOW&&this._updateProperty(_Properties2.default.SHADOW_ENABLED,!0,!0),this._updateProperty(property,value,!0))},Customizable.prototype._refreshBorderDefaultProperties=function(styles){var _this3=this;if(!_.isEmpty(styles)){var shouldRefresh=!!_.find(styles,function(style){return style.toLowerCase().includes(_Properties2.default.BORDER)});shouldRefresh&&_.forEach(propsNeedUpdate,function(propertyToUpdate){_this3[propertyToUpdate]=_this3[propertyToUpdate]})}},Customizable.prototype._updateLock=function(styles){var _this4=this;_.isFunction(this.updateLockStatus)&&!_.isEmpty(styles)&&_.forEach(LOCK_STATUS_PROPERTIES_MAP,function(properties,lockType){_.some(properties,function(prop){return styles[prop]})&&_this4.updateLockStatus(properties,lockType)})},Customizable}()},{"../../enums/Properties.js":358,"../helpers/BackgroundHelper":243,"../helpers/BorderHelper":244,"../helpers/CssHelper":247,"../helpers/PaddingHelper":254,lodash:161,tinycolor2:159}],226:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),OPTIONS_ORDER=["gridColumnWidth","gridOnTop","gridGutter","gridMargin","gridMaxWidth","gridDisplay","gridColumns"];module.exports=function(){function Gridable(){}return Gridable.DefaultProperties={gridDisplay:{value:!1},gridOnTop:{value:!0},gridMaxWidth:{value:"100%"},gridColumnWidth:{value:60},gridMargin:{value:20},gridGutter:{value:20},gridWidth:{value:null},gridColumns:{value:null}},Gridable.ExcludedProperties={gridWidth:!0,gridColumns:!0},Object.defineProperties(Gridable.prototype,{gridDisplay:{get:function(){return this._gridDisplay},set:function(value){this._gridDisplay=value,this.shouldUpdateGrid=!0}},gridOnTop:{get:function(){return this._gridOnTop},set:function(value){this._gridOnTop=value,this.shouldUpdateGrid=!0}},gridMaxWidth:{get:function(){return this._gridMaxWidth},set:function(value){this._gridMaxWidth=value,this.shouldUpdateGridColumns=!0,this.shouldUpdateGrid=!0}},gridColumnWidth:{get:function(){return parseInt(this._gridColumnWidth)},set:function(value){this._gridColumnWidth=value,this.shouldUpdateGrid=!0}},gridMargin:{get:function(){return parseInt(this._gridMargin)},set:function(value){this._gridMargin=value,this.shouldUpdateGridColumns=!0,this.shouldUpdateGrid=!0}},gridGutter:{get:function(){return parseInt(this._gridGutter)},set:function(value){this._gridColumnWidth&&this._gridGutter&&this._gridMaxWidth&&!this.isGridMaxWidthHundredPercent()&&(this._gridColumnWidth-=value-this._gridGutter),this._gridGutter=value,this.shouldUpdateGridColumns=!0,this.shouldUpdateGrid=!0}},gridColumns:{get:function(){return this.calcGridColumns()},set:function(value){var width=this.gridMaxWidth;this.isGridMaxWidthHundredPercent()&&(width=this.view.domElement.offsetWidth),value&&(width-=2*this.gridMargin,width-=(value-1)*this.gridGutter,this.gridColumnWidth=Math.floor(width/value))}},gridWidth:{get:function(){var gridColumns,gridWidth;return this.isGridMaxWidthHundredPercent()?gridWidth=this.view.domElement.offsetWidth:(gridWidth=2*this.gridMargin,gridColumns=this.gridColumns,gridColumns>0&&(gridWidth+=this.gridColumnWidth*gridColumns,gridWidth+=this.gridGutter*(gridColumns-1))),gridWidth}}}),Gridable.prototype.getGridOption=function(property){return Gridable.DefaultProperties.hasOwnProperty(property)?this[property]:null},Gridable.prototype.getAllGridOptions=function(){return _.mapValues(Gridable.DefaultProperties,function(value,property){return this[property]}.bind(this))},Gridable.prototype.setGridOption=function(property,value){return Gridable.DefaultProperties.hasOwnProperty(property)?void(this[property]=value):null},Gridable.prototype.setGridOptions=function(options){var _this=this,optionsOrder=function(key){return OPTIONS_ORDER.indexOf(key)};_.sortBy(Object.keys(options),optionsOrder).forEach(function(key){_this.setGridOption(key,options[key])})},Gridable.prototype.updateGridColumns=function(){this.gridColumns=this.calcGridColumns(!0),this.shouldUpdateGridColumns=!1},Gridable.prototype.calcGridColumns=function(optimizeForColumnWidth){var width=this.gridMaxWidth;return this.isGridMaxWidthHundredPercent()&&(width=this.view.domElement.offsetWidth),width-=2*this.gridMargin,width<=0?0:(width+=this.gridGutter,optimizeForColumnWidth?Math.round(width/(this.gridColumnWidth+this.gridGutter)):Math.floor(width/(this.gridColumnWidth+this.gridGutter)))},Gridable.prototype.isGridMaxWidthHundredPercent=function(){return"100%"===this.gridMaxWidth},Gridable.prototype.getPropsForSerialize=function(){var propsForSerialize=_.omit(this.DefaultProperties,_.keys(Gridable.DefaultProperties));return _.mapValues(propsForSerialize,function(propValue,propName){return _.cloneDeep(this[propName])}.bind(this))},Gridable}()},{lodash:161}],227:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Guide=_dereq_("../ui/Guide.js"),Orientations=_dereq_("../../enums/Orientations.js");module.exports=function(){function Guideable(){this.activeGuide=null,this.guides=[]}return Guideable.prototype.resetGuides=function(){if(this.guides&&this.guides.length>0)for(var i=this.guides.length-1;i>=0;i--)this.removeGuide(this.guides[i])},Guideable.prototype.createGuide=function(orientation,x,y){var guide=new Guide(null,this.Page);return guide.initProperties({orientation:orientation,minX:-1*this.view.domElement.offsetLeft,minY:-1*this.view.domElement.offsetTop,x:x||0,y:y||0,width:this.view.containerDomElement.offsetWidth,height:this.view.containerDomElement.offsetHeight,visibility:this.Page.options.enableGuides}),guide.setScale(this.scale),
this.addGuide(guide),guide},Guideable.prototype.createGuidesFromSerialized=function(serialized){_.forEach(serialized,function(serializedGuide){this.createGuide(serializedGuide.orientation,serializedGuide.x,serializedGuide.y)}.bind(this))},Guideable.prototype.addGuide=function(guide){this.guides.push(guide),this.view.overlayDomElement.appendChild(guide.view.domElement)},Guideable.prototype.removeGuide=function(guide){this.guides.splice(this.guides.indexOf(guide),1),this.view.overlayDomElement.removeChild(guide.view.domElement)},Guideable.prototype.displayGuides=function(value){for(var i=0,l=this.guides.length;i<l;i++)this.guides[i].visibility=value},Guideable.prototype.setGuidesScale=function(value){for(var i=0,l=this.guides.length;i<l;i++)this.guides[i].setScale(value)},Guideable.prototype.updateGuides=function(){for(var guide,i=0,l=this.guides.length;i<l;i++)guide=this.guides[i],this.resized&&(guide.minX=-1*this.view.domElement.offsetLeft,guide.minY=-1*this.view.domElement.offsetTop,guide.orientation===Orientations.HORIZONTAL?guide.width=this.view.containerDomElement.offsetWidth:guide.orientation===Orientations.VERTICAL&&(guide.height=this.view.containerDomElement.offsetHeight)),guide.dirty&&(guide.update(),guide.dirty=!1)},Guideable.prototype.serializeGuides=function(){return _.map(this.guides,function(guide){return guide.serialize()})},Guideable}()},{"../../enums/Orientations.js":356,"../ui/Guide.js":270,lodash:161}],228:[function(_dereq_,module,exports){"use strict";var IndicatorAlign=_dereq_("../../enums/IndicatorAlign.js");module.exports=function(){function getNewAttributesIndicator(page,options){var AttributesIndicator=_dereq_("../ui/AttributesIndicator.js");return new AttributesIndicator(null,page,options)}function Indicative(){this._shouldUpdateFixedIcon=!1,this._shouldUpdateInteractiveIcon=!1,this._indicatorFixed=null,this._indicatorInteractive=null}var CLASS_NAME_FIXED="el-fixed",CLASS_NAME_INTERACTIVE="el-interactive";return Indicative.DefaultProperties={shouldUpdateFixedIcon:{value:!1},shouldUpdateInteractiveIcon:{value:!1}},Indicative.ExcludedProperties={shouldUpdateFixedIcon:!0,shouldUpdateInteractiveIcon:!0},Object.defineProperties(Indicative.prototype,{shouldUpdateFixedIcon:{get:function(){return this._shouldUpdateFixedIcon},set:function(value){this._shouldUpdateFixedIcon=value,value&&(this.dirty=value)}},shouldUpdateInteractiveIcon:{get:function(){return this._shouldUpdateInteractiveIcon},set:function(value){this._shouldUpdateInteractiveIcon=value,value&&(this.dirty=value)}}}),Indicative.prototype.resetIndicators=function(){this.setFixedIconVisibility(!1),this.setInteractiveIconVisibility(!1),this.shouldUpdateFixedIcon=!0,this.shouldUpdateInteractiveIcon=!0,this.updateIndicators()},Indicative.prototype.updateIndicators=function(){if(this._shouldUpdateFixedIcon){if(this._isInInactiveState())return;this.setFixedIconVisibility(this.fixed),this._shouldUpdateFixedIcon=!1}if(this._shouldUpdateInteractiveIcon){if(this._isInInactiveState())return;this._shouldUpdateInteractiveIcon=!1,this.setInteractiveIconVisibility(!!this.actions.length)}},Indicative.prototype.setFixedIconVisibility=function(value){if(value&&(this.isVisible()||this.isSelected())){if(this._indicatorFixed)return;this._indicatorFixed=getNewAttributesIndicator(this.Page,{align:IndicatorAlign.TOP_LEFT,className:[CLASS_NAME_FIXED]}),this.addLinkedElement(this._indicatorFixed),this._indicatorFixed.show(this)}else{if(!this._indicatorFixed)return;this._indicatorFixed.remove(),this.removeLinkedElement(this._indicatorFixed),this._indicatorFixed=null}},Indicative.prototype.setInteractiveIconVisibility=function(value){if(value&&(this.isVisible()||this.isSelected())){if(this._indicatorInteractive)return;this._indicatorInteractive=getNewAttributesIndicator(this.Page,{align:IndicatorAlign.TOP_RIGHT,className:[CLASS_NAME_INTERACTIVE]}),this.addLinkedElement(this._indicatorInteractive),this._indicatorInteractive.show(this)}else if(this._indicatorInteractive){if(!this._indicatorInteractive)return;this._indicatorInteractive.remove(),this.removeLinkedElement(this._indicatorInteractive),this._indicatorInteractive=null}},Indicative.prototype._isInInactiveState=function(){return!this.parent||this.parent.isMultistate()&&!this.parent._isDescendantInActiveState(this)},Indicative}()},{"../../enums/IndicatorAlign.js":349,"../ui/AttributesIndicator.js":265}],229:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Hammer=_dereq_("hammerjs"),InteractionTriggers=_dereq_("../../enums/InteractionTriggers.js"),Properties=_dereq_("../../enums/Properties.js");module.exports=function(){function isMouseTrigger(trigger){return[InteractionTriggers.CLICK,InteractionTriggers.CONTEXTMENU,InteractionTriggers.DBLCLICK,InteractionTriggers.MOUSEENTER,InteractionTriggers.MOUSELEAVE].indexOf(trigger)>-1}function isFormTrigger(trigger){return[InteractionTriggers.BLUR,InteractionTriggers.CHANGE,InteractionTriggers.FOCUS].indexOf(trigger)>-1}function isGestureTrigger(trigger){return[InteractionTriggers.TOUCH_PRESS,InteractionTriggers.TOUCH_PRESSUP,InteractionTriggers.TOUCH_SWIPEDOWN,InteractionTriggers.TOUCH_SWIPELEFT,InteractionTriggers.TOUCH_SWIPERIGHT,InteractionTriggers.TOUCH_SWIPEUP].indexOf(trigger)>-1}function getHammerGestureTrigger(trigger){return trigger.substr(6)}function createHammerInstance(element){var hammer=new Hammer(element,{prevent_default:!0});return hammer.get("swipe").set({direction:Hammer.DIRECTION_ALL,velocity:1e-4,threshold:2}),hammer.get("press").set({time:200}),hammer}function parseIdsToString(actions){return _.map(actions,function(action){return _.extend(action,{elements:_.map(action.elements,String)})})}function Interactable(){this._actions=[],this._hammer=null,this._propertyEndValues={},this._hoverPhase=null}return Interactable.DefaultProperties={actions:{value:[]},hammer:{value:null},propertyEndValues:{value:{}}},Interactable.ExcludedProperties={hammer:!0,propertyEndValues:!0},Object.defineProperties(Interactable.prototype,{actions:{get:function(){return this._actions},set:function(value){this._saveProperty(),this._actions=parseIdsToString(value),this.Page.isDesignMode()&&(this.shouldUpdateInteractiveIcon=!0)}},hammer:{get:function(){return this._hammer},set:function(value){this._hammer=value}},propertyEndValues:{get:function(){return this._propertyEndValues},set:function(value){this._propertyEndValues=value}}}),Interactable.prototype.addTrigger=function(trigger,componentInstanceId){this.view.setInteractive(!0),isMouseTrigger(trigger)?this.getDomElement().addEventListener(trigger,this.interactWithElement.bind(this,trigger,componentInstanceId)):trigger===InteractionTriggers.HOVER?this.getDomElement().addEventListener(InteractionTriggers.MOUSEENTER,this.initializeHoverTrigger.bind(this,trigger,this.getDomElement(),componentInstanceId)):isFormTrigger(trigger)?this.getDomFocusableElement().addEventListener(trigger,this.interactWithElement.bind(this,trigger,componentInstanceId)):isGestureTrigger(trigger)&&(this.hammer||(this.hammer=createHammerInstance(this.getDomElement())),this.hammer.on(getHammerGestureTrigger(trigger),this.interactWithElement.bind(this,trigger,componentInstanceId)))},Interactable.prototype.setPropertyEndValue=function(property,value){this.propertyEndValues[property]=value},Interactable.prototype.deletePropertyEndValue=function(property){delete this.propertyEndValues[property]},Interactable.prototype.getPropertyEndValue=function(property){return this.propertyEndValues[property]},Interactable.prototype.initializeHoverTrigger=function(trigger,domElement,componentInstanceId,e){this.interactWithElement(trigger,componentInstanceId,e),this.superviseMouseMoveOnElement(trigger,domElement,componentInstanceId)},Interactable.prototype.superviseMouseMoveOnElement=function(trigger,domElement,componentInstanceId){var _this=this,canvasWrapper=this.Page.canvas.getCanvasWrapperDOM(),shouldRemoveListener=!1,simulateMouseLeave=function simulateMouseLeave(e){if(shouldRemoveListener=componentInstanceId?!_this.Page.InteractionsManager.interactionsComponents[componentInstanceId]:!_this.Page.InteractionsManager.interactionsElements[_this.id])return void canvasWrapper.removeEventListener(InteractionTriggers.MOUSEMOVE,simulateMouseLeave);if(!domElement.contains(e.target)&&domElement!==e.target){var mouseLeaveEventObject=_.assign({},e,{type:InteractionTriggers.MOUSELEAVE,target:domElement});_this.interactWithElement(trigger,componentInstanceId,mouseLeaveEventObject),canvasWrapper.removeEventListener(InteractionTriggers.MOUSEMOVE,simulateMouseLeave)}};canvasWrapper.addEventListener(InteractionTriggers.MOUSEMOVE,simulateMouseLeave)},Interactable.prototype.interactWithElement=function(trigger,componentInstanceId,e){if(trigger===InteractionTriggers.HOVER){if(e.type===InteractionTriggers.MOUSEENTER&&this._hoverPhase===e.type)return;this._hoverPhase=e.type}this.Page.InteractionsManager.interactWithElement(this.id,componentInstanceId,trigger,e)},Interactable.prototype.duplicateInteraction=function(index){var actions=_.clone(this.actions);actions.splice(index,0,_.cloneDeep(this.actions[index])),this.updateProperty(Properties.ACTIONS,actions)},Interactable.prototype.removeInteraction=function(index){var actions=_.clone(this.actions);actions.splice(index,1),this.updateProperty(Properties.ACTIONS,actions)},Interactable}()},{"../../enums/InteractionTriggers.js":351,"../../enums/Properties.js":358,hammerjs:102,lodash:161}],230:[function(_dereq_,module,exports){"use strict";module.exports=function(){function Linkable(){this.linkedElements=[],this._dirtyPosition=!1}return Linkable.DefaultProperties={dirtyPosition:{value:!1},angle:{value:0},x:{value:0},y:{value:0},width:{value:100},height:{value:100}},Linkable.ExcludedProperties={dirtyPosition:!0},Object.defineProperties(Linkable.prototype,{dirtyPosition:{get:function(){return this._dirtyPosition},set:function(value){this._dirtyPosition=value}}}),Linkable.prototype.addLinkedElement=function(element){this.linkedElements.push(element)},Linkable.prototype.removeLinkedElement=function(element){this.linkedElements.splice(this.linkedElements.indexOf(element),1)},Linkable.prototype.updateLinkedElements=function(){this.dirtyPosition&&(this.linkedElements.forEach(function(element){element.initiatorUpdated(this)}.bind(this)),this.dirtyPosition=!1),this.dirtyOrder&&(this.linkedElements.forEach(function(element){element.initiatorReordered(this)}.bind(this)),this.dirtyOrder=!1)},Linkable.prototype.deleteLinkedElements=function(){this.linkedElements.forEach(function(element){element.initiatorDeleted(this)}.bind(this))},Linkable}()},{}],231:[function(_dereq_,module,exports){"use strict";module.exports=function(){function Linked(){this.changeListeners=[],this.reorderListeners=[],this.deleteListeners=[]}return Linked.prototype.initiatorUpdated=function(initiator){this.changeListeners.forEach(function(listener){"function"==typeof listener&&listener(initiator)})},Linked.prototype.initiatorReordered=function(initiator){this.reorderListeners.forEach(function(listener){"function"==typeof listener&&listener(initiator)})},Linked.prototype.initiatorDeleted=function(initiator){this.deleteListeners.forEach(function(listener){"function"==typeof listener&&listener(initiator)})},Linked.prototype.addChangeListener=function(callback){this.changeListeners.push(callback)},Linked.prototype.removeChangeListener=function(callback){this.changeListeners.splice(this.changeListeners.indexOf(callback),1)},Linked.prototype.addReorderListener=function(callback){this.reorderListeners.push(callback)},Linked.prototype.removeReorderListener=function(callback){this.reorderListeners.splice(this.reorderListeners.indexOf(callback),1)},Linked.prototype.addDeleteListener=function(callback){this.deleteListeners.push(callback)},Linked.prototype.removeDeleteListener=function(callback){this.deleteListeners.splice(this.deleteListeners.indexOf(callback),1)},Linked}()},{}],232:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Point=_dereq_("../../primitives/Point.js"),Rectangle=_dereq_("../../primitives/Rectangle.js");module.exports=function(){function Multipart(){this.firstPartSelected=null,this.activeParts=[]}return Multipart.prototype.isMultipart=function(){return!0},Multipart.prototype.resetParts=function(){this.parts={}},Multipart.prototype.addPart=function(id,domElement){this.parts[id]={domElement:domElement,rect:new Rectangle}},Multipart.prototype.getPart=function(id){return this.parts[id]},Multipart.prototype.setActiveParts=function(parts){parts&&(this.activeParts=parts,this.firstPartSelected=parts[0],this.editable=!0)},Multipart.prototype.onEnablePartSelection=function(){},Multipart.prototype.onDisablePartSelection=function(){},Multipart.prototype.getActiveParts=function(){return this.activeParts},Multipart.prototype.anyPartsSelected=function(){return!!this.activeParts.length},Multipart.prototype.setPartsApplicableProperties=function(properties){this.applicableProperties=properties},Multipart.prototype.isPartProperty=function(property){return this.applicableProperties.indexOf(property)>-1},Multipart.prototype.getPartBoundingBox=function(ids){var boxes=[];if(!Array.isArray(ids))return this.getPart(ids).rect.getBoundingBox();ids.forEach(function(partId){boxes.push(this.getPart(partId).rect.getBoundingBox())}.bind(this));var minX=boxes.sort(function(a,b){return a.x-b.x})[0],maxX=boxes[boxes.length-1],minY=boxes.sort(function(a,b){return a.y-b.y})[0],maxY=boxes[boxes.length-1];return new Rectangle(minX.x,minY.y,maxX.x+maxX.width-minX.x,maxY.y+maxY.height-minY.y)},Multipart.prototype.updateParts=function(scale){var parentBoundingRect=this.view.domElement.getBoundingClientRect(),angle=this.angle,rotatePoint=new Point;_.forEach(this.parts,function(part){var boundingRect=part.domElement.getBoundingClientRect();part.rect.x=(boundingRect.left-parentBoundingRect.left)/scale,part.rect.y=(boundingRect.top-parentBoundingRect.top)/scale,part.rect.width=boundingRect.width/scale,part.rect.height=boundingRect.height/scale,part.rect.rotate(rotatePoint,angle)})},Multipart.prototype.partHitTest=function(point){for(var id in this.parts)if(this.parts.hasOwnProperty(id)&&this.parts[id].rect.hitTest(point))return id;return null},Multipart}()},{"../../primitives/Point.js":403,"../../primitives/Rectangle.js":404,lodash:161}],233:[function(_dereq_,module,exports){"use strict";module.exports=function(){function Pickable(){this.pickMode=!1,this.ignoreMultistateChildren=!1}var onMouseMoveRef,onMouseDownRef,onKeyDownRef,validatePickRef,TARGETING_CLASS="targeting";return Pickable.prototype.getPickedElement=function(){for(var element,hit,elements=(this.Page.ElementsManager.getEditingComponent()||this).children,i=elements.length;i-- >0;)if(element=elements[i],(!this.Page.isSpecMode()||!this.Page.isSpecModeSkippedType(element)&&element.isVisible()&&!element.isTransparent())&&(hit=element.hitTest(this.clickPoint,this.ignoreMultistateChildren)))return hit;return null},Pickable.prototype.onPickMouseMove=function(validator,e){this.clickPoint=this._getRelativeScaledMousePosition(e);var element=this.getPickedElement();element&&validator(element.id,element.componentInstance&&element.componentInstance.id)?(this.overlay.highlightElement(element,!0),this.overlay._elementNameShow(element,e)):(this.overlay.hideHighlight(),this.overlay._elementNameHide()),"function"==typeof this.onPickerMouseMove&&this.onPickerMouseMove(element)},Pickable.prototype.pickElementId=function(elementId){validatePickRef(elementId)},Pickable.prototype.onPickMouseDown=function(e){this.clickPoint=this._getRelativeScaledMousePosition(e);var element=this.getPickedElement();element?validatePickRef(element.id,element.componentInstance&&element.componentInstance.id):this.returnNullOnCanvas&&!element&&validatePickRef(null),e.stopPropagation()},Pickable.prototype.onPickKeyDown=function(reject,e){27===e.which&&this.Page.isDesignMode()&&(e.preventDefault(),reject("exit"))},Pickable.prototype.isPickMode=function(){return this.pickMode},Pickable.prototype.validatePick=function(validator,resolve,elementId,componentInstanceId){this.returnNullOnCanvas&&!elementId&&resolve(null),validator(elementId,componentInstanceId)&&resolve(this.pickerResolver(elementId,componentInstanceId))},Pickable.prototype.startPickMode=function(validator,pickerConfig){if(!this.pickMode)return this.pickMode=!0,this.ignoreMultistateChildren=pickerConfig.ignoreMultistateChildren,this.returnNullOnCanvas=pickerConfig.returnNullOnCanvas,this.pickerResolver=pickerConfig.pickerResolver,this.Page.currentMode.removeListeners(!0),new Promise(function(resolve,reject){onMouseMoveRef=this.onPickMouseMove.bind(this,validator),onMouseDownRef=this.onPickMouseDown.bind(this),onKeyDownRef=this.onPickKeyDown.bind(this,reject),validatePickRef=this.validatePick.bind(this,validator,resolve),document.addEventListener("keydown",onKeyDownRef),this.view.containerDomElement.addEventListener("mousemove",onMouseMoveRef),this.view.containerDomElement.addEventListener("mousedown",onMouseDownRef),this.view.overlayDomElement.classList.add(TARGETING_CLASS)}.bind(this))},Pickable.prototype.endPickMode=function(){this.pickMode&&(this.pickMode=!1,this.ignoreMultistateChildren=!1,this.Page.currentMode.addListeners(!0),document.removeEventListener("keydown",onKeyDownRef),this.view.containerDomElement.removeEventListener("mousemove",onMouseMoveRef),this.view.containerDomElement.removeEventListener("mousedown",onMouseDownRef),this.view.overlayDomElement.classList.remove(TARGETING_CLASS))},Pickable}()},{}],234:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash");module.exports=function(){function getSizePropertyFromEdge(edge){return verticalEdges.indexOf(edge)>-1?"height":"width"}function getOppositeEdge(edge){return opposites[edge]}function SimpleBorder(){this._defineMaxValuesGetters()}var verticalEdges=["top","bottom"],opposites={top:"bottom",left:"right",right:"left",bottom:"top"};return SimpleBorder.DefaultProperties={borderTopWidth:{value:0},borderBottomWidth:{value:0},borderLeftWidth:{value:0},borderRightWidth:{value:0},borderColor:{value:"#c8c8c8"},borderStyle:{value:"solid"},borderLock:{value:!0}},Object.defineProperties(SimpleBorder.prototype,{borderTopWidth:{configurable:!0,get:function(){return this._borderTopWidth},set:function(value){this._saveProperty(),this._borderTopWidth=value,this.view.setBorderTopWidth(value)}},borderBottomWidth:{configurable:!0,get:function(){return this._borderBottomWidth},set:function(value){this._saveProperty(),this._borderBottomWidth=value,this.view.setBorderBottomWidth(value)}},borderLeftWidth:{configurable:!0,get:function(){return this._borderLeftWidth},set:function(value){this._saveProperty(),this._borderLeftWidth=value,this.view.setBorderLeftWidth(value)}},borderRightWidth:{configurable:!0,get:function(){return this._borderRightWidth},set:function(value){this._saveProperty(),this._borderRightWidth=value,this.view.setBorderRightWidth(value)}},borderColor:{configurable:!0,get:function(){return this._borderColor},set:function(value){this._saveProperty(),this._borderColor=value,this.view.setBorderColor(value)}},borderStyle:{configurable:!0,get:function(){return this._borderStyle},set:function(value){this._saveProperty(),this._borderStyle=value,this.view.setBorderStyle(value)}},borderLock:{configurable:!0,get:function(){return this._borderLock},set:function(value){this._saveProperty(),this._borderLock=value}}}),SimpleBorder.prototype.getMaxBoxModelValue=function(property,edge){var size=parseInt(this[getSizePropertyFromEdge(edge)]),oppositeEdge=getOppositeEdge(edge),_border={top:parseInt(this.borderTopWidth)||0,left:parseInt(this.borderLeftWidth)||0,right:parseInt(this.borderRightWidth)||0,bottom:parseInt(this.borderBottomWidth)||0},calculators={border:function(){return size-_border[oppositeEdge]}};return calculators[property]()},SimpleBorder.prototype._defineMaxValuesGetters=function(){var getters={borderTopWidth:this.getMaxBoxModelValue.bind(this,"border","top"),borderLeftWidth:this.getMaxBoxModelValue.bind(this,"border","left"),borderRightWidth:this.getMaxBoxModelValue.bind(this,"border","right"),borderBottomWidth:this.getMaxBoxModelValue.bind(this,"border","bottom")};_.forEach(getters,function(getter,property){this.DefaultProperties.hasOwnProperty(property)&&!this.DefaultProperties[property].hasOwnProperty("max")&&Object.defineProperty(this.DefaultProperties[property],"max",{get:getter})}.bind(this))},SimpleBorder}()},{lodash:161}],235:[function(_dereq_,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function SimpleBorderAndRadius(){this._defineMaxValuesGetters()}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=SimpleBorderAndRadius;var _SimpleBorder=_dereq_("./SimpleBorder.js"),_SimpleBorder2=_interopRequireDefault(_SimpleBorder),_=_dereq_("lodash");_.extend(SimpleBorderAndRadius.prototype,_SimpleBorder2.default.prototype),SimpleBorderAndRadius.DefaultProperties=_.extend({},_SimpleBorder2.default.DefaultProperties,{borderTopWidth:{value:1},borderBottomWidth:{value:1},borderLeftWidth:{value:1},borderRightWidth:{value:1},borderTopLeftRadius:{value:5},borderTopRightRadius:{value:5},borderBottomRightRadius:{value:5},borderBottomLeftRadius:{value:5},radiusLock:{value:!0}}),Object.defineProperties(SimpleBorderAndRadius.prototype,{borderTopWidth:{configurable:!0,get:function(){return this._borderTopWidth},set:function(value){this._saveProperty(),this._borderTopWidth=value,this.view.setBorderTopWidth(value)}},borderBottomWidth:{configurable:!0,get:function(){return this._borderBottomWidth},set:function(value){this._saveProperty(),this._borderBottomWidth=value,this.view.setBorderBottomWidth(value)}},borderLeftWidth:{configurable:!0,get:function(){return this._borderLeftWidth},set:function(value){this._saveProperty(),this._borderLeftWidth=value,this.view.setBorderLeftWidth(value)}},borderRightWidth:{configurable:!0,get:function(){return this._borderRightWidth},set:function(value){this._saveProperty(),this._borderRightWidth=value,this.view.setBorderRightWidth(value)}},borderColor:{configurable:!0,get:function(){return this._borderColor},set:function(value){this._saveProperty(),this._borderColor=value,this.view.setBorderColor(value)}},borderStyle:{configurable:!0,get:function(){return this._borderStyle},set:function(value){this._saveProperty(),this._borderStyle=value,this.view.setBorderStyle(value)}},borderLock:{configurable:!0,get:function(){return this._borderLock},set:function(value){this._saveProperty(),this._borderLock=value}},borderTopLeftRadius:{get:function(){return this._borderTopLeftRadius},set:function(value){this._saveProperty(),this._borderTopLeftRadius=parseFloat(value)||0,this.view.setBorderTopLeftRadius(this._borderTopLeftRadius)}},borderTopRightRadius:{get:function(){return this._borderTopRightRadius},set:function(value){this._saveProperty(),this._borderTopRightRadius=parseFloat(value)||0,this.view.setBorderTopRightRadius(this._borderTopRightRadius)}},borderBottomRightRadius:{get:function(){return this._borderBottomRightRadius},set:function(value){this._saveProperty(),this._borderBottomRightRadius=parseFloat(value)||0,this.view.setBorderBottomRightRadius(this._borderBottomRightRadius)}},borderBottomLeftRadius:{get:function(){return this._borderBottomLeftRadius},set:function(value){this._saveProperty(),this._borderBottomLeftRadius=parseFloat(value)||0,this.view.setBorderBottomLeftRadius(this._borderBottomLeftRadius)}},radiusLock:{get:function(){return this._radiusLock},set:function(value){this._saveProperty(),this._radiusLock=value}}})},{"./SimpleBorder.js":234,lodash:161}],236:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),TextFormattable=_dereq_("./TextFormattable.js"),TextStyleHelper=_dereq_("../helpers/TextStyleHelper");module.exports=function(){function SimpleTextEditable(){}return SimpleTextEditable.DefaultProperties={inputValue:{value:""},color:{value:"#000000"},fontSize:{value:"14px"},fontWeight:{value:"normal"},fontStyle:{value:"normal"},fontFamily:{value:"S-Arial-n4"},textDecoration:{value:""},textAlign:{value:"center"}},_.extend(SimpleTextEditable.prototype,TextFormattable.prototype),Object.defineProperties(SimpleTextEditable.prototype,{inputValue:{configurable:!0,get:function(){return this._inputValue},set:function(value){this._saveProperty(),value=this.isTextInput()?value.replace(/<br \/>/g,"\n"):value.replace(/\r?\n/g,"<br />"),this._inputValue=value,this.view.setInputValue(value)}},color:{configurable:!0,get:function(){return this._color},set:function(value){this._saveProperty(),this._color=value,this.view.setColor(value)}},fontSize:{configurable:!0,get:function(){return this._fontSize},set:function(value){this._saveProperty(),this._fontSize=value,this.view.setFontSize(value)}},fontWeight:{configurable:!0,get:function(){return this._fontWeight},set:function(value){this._saveProperty(),this._fontWeight=value,this.view.setFontWeight(value)}},fontStyle:{configurable:!0,get:function(){return this._fontStyle},set:function(value){this._saveProperty(),this._fontStyle=value,this.view.setFontStyle(value)}},fontFamily:{configurable:!0,get:function(){return this._fontFamily},set:function(value){this._saveProperty(),this._fontFamily=value,this.view.setFontFamily(TextStyleHelper.SanitizeFontName(value))}},textDecoration:{configurable:!0,get:function(){return this._textDecoration},set:function(value){this._saveProperty(),this._textDecoration=value,this.view.setTextDecoration(value)}},textAlign:{configurable:!0,get:function(){return this._textAlign},set:function(value){this._saveProperty(),this._textAlign=value,this.view.setTextAlign(value)}}}),SimpleTextEditable.prototype.isTextEditable=function(){return!0},SimpleTextEditable.prototype.isTextStyleable=function(){return!0},SimpleTextEditable.prototype.setEditing=function(value){this.view.setEditing(value),value?this._addKeyboardEvents():this._removeKeyboardEvents()},SimpleTextEditable.prototype._addKeyboardEvents=function(){this.keyboardEventRef=function(e){66===e.keyCode&&e.metaKey?(this.Page.ElementsManager.startBatch(),this.toggleBold(),this.Page.ElementsManager.endBatch()):73===e.keyCode&&e.metaKey?(this.Page.ElementsManager.startBatch(),this.toggleItalic(),this.Page.ElementsManager.endBatch()):85===e.keyCode&&e.metaKey&&(this.Page.ElementsManager.startBatch(),this.toggleUnderline(),this.Page.ElementsManager.endBatch())}.bind(this),this.view.domElement.addEventListener("keydown",this.keyboardEventRef)},SimpleTextEditable.prototype._removeKeyboardEvents=function(){this.view.domElement.removeEventListener("keydown",this.keyboardEventRef)},SimpleTextEditable}()},{"../helpers/TextStyleHelper":261,"./TextFormattable.js":239,lodash:161}],237:[function(_dereq_,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}return Array.from(arr)}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var _lodash=_dereq_("lodash"),_lodash2=_interopRequireDefault(_lodash),_Color=_dereq_("../../utils/Color"),_Color2=_interopRequireDefault(_Color),_InteractionActions=_dereq_("../../enums/InteractionActions"),_InteractionActions2=_interopRequireDefault(_InteractionActions),_FontsHelper=_dereq_("../../fonts/FontsHelper"),_Properties=_dereq_("../../enums/Properties.js"),_Properties2=_interopRequireDefault(_Properties);module.exports=function(){function Specable(){this._fontsCollection={}}return Specable.prototype.getBackgroundColor=function(){return!this.backgroundColor||_Color2.default.isTransparent(this.backgroundColor)?null:_Color2.default.getColorsSet(this.backgroundColor)},Specable.prototype.getBorderColor=function(){return this.borderColor&&!_Color2.default.isTransparent(this.borderColor)&&this.hasBorder(this)?_Color2.default.getColorsSet(this.borderColor):null},Specable.prototype.getInteractionsColors=function(){var _this=this,colors=[];return _lodash2.default.forEach(this.actions,function(action){action.action===_InteractionActions2.default.STYLE&&_lodash2.default.forEach(action.action_value,function(value,key){"border-color"===key&&_this.hasBorder(_this)||colors.push(_Color2.default.getColorsSet(value))})}),colors},Specable.prototype.getGradient=function(){return this.backgroundImage&&_Color2.default.isGradient(this.backgroundImage)?this.backgroundImage:null},Specable.prototype.getTextNodes=function(el){var _this2=this,textNodes=[];return _lodash2.default.forEach(el.childNodes,function(node){node.nodeType===Node.TEXT_NODE&&node.textContent.replace(/[\u200B-\u200D\uFEFF]/g,"").trim()?textNodes.push(node):textNodes=textNodes.concat(_this2.getTextNodes(node))}),textNodes},Specable.prototype.getFontFromDOMElement=function(domEl){var styles=window.getComputedStyle(domEl),fontFamily=styles.fontFamily.split(",")[0].replace(/['"]+/g,""),className=_lodash2.default.first((0,_FontsHelper.getClassesFromFontFamily)(fontFamily)),fontData=className?(0,_FontsHelper.getFontDataFromClass)(className):{};if("none"!==styles.display)return{textContent:domEl.textContent,fontFamily:fontFamily,fontData:fontData,fontName:fontData.displayFamily||fontData.family||fontFamily,fontSize:styles.fontSize,fontStyle:styles.fontStyle,fontWeight:styles.fontWeight,color:styles.color,letterSpacing:styles.letterSpacing,textAlign:styles.textAlign,lineHeight:styles.lineHeight,textDecoration:styles.textDecoration,textTransform:styles.textTransform,fontVariant:styles.fontVariant}},Specable.prototype.getTextNodeFontData=function(textNode){var parent=textNode.parentNode;return this.getFontFromDOMElement(parent)},Specable.prototype.getColorsFromFonts=function(fonts){var colors=[];return _lodash2.default.forEach(fonts,function(font){_lodash2.default.forEach(font.colors,function(color){colors.push(_Color2.default.getColorsSet(color))})}),colors},Specable.prototype.initFontsCollection=function(){this._fontsCollection={},Object.defineProperty(this._fontsCollection,"fontsList",{enumerable:!1,value:[]})},Specable.prototype.addFontToCollection=function(font){font&&(this._fontsCollection.fontsList.push(font),this._fontsCollection[font.fontName]?(this._fontsCollection[font.fontName].sizes=_lodash2.default.union(this._fontsCollection[font.fontName].sizes,[font.fontSize]),this._fontsCollection[font.fontName].variants=_lodash2.default.union(this._fontsCollection[font.fontName].variants,[font.fontData.fvd]),this._fontsCollection[font.fontName].displayVariants=_lodash2.default.assign({},this._fontsCollection[font.fontName].displayVariants,_defineProperty({},font.fontData.fvd,font.fontData.displayVariant)),this._fontsCollection[font.fontName].colors=_lodash2.default.union(this._fontsCollection[font.fontName].colors,[font.color])):this._fontsCollection[font.fontName]={fontFamily:font.fontFamily,fontName:font.fontName,fontData:font.fontData,sizes:[font.fontSize],variants:[font.fontData.fvd],displayVariants:_defineProperty({},font.fontData.fvd,font.fontData.displayVariant),colors:[font.color]})},Specable.prototype.getFonts=function(domEl){var _this3=this;if(!this.inputValue&&!this.hasTextNodes())return{};var textNodes=this.getTextNodes(domEl||this.view.domElement);return this.initFontsCollection(),_lodash2.default.forEach(textNodes,function(textNode){var font=_this3.getTextNodeFontData(textNode);font&&font.fontFamily&&_this3.addFontToCollection(font)}),this._fontsCollection},Specable.prototype.getFillColor=function(){return null},Specable.prototype.getActiveBackgroundColor=function(){return null},Specable.prototype.getTextContent=function(){return null},Specable.prototype.hasTextNodes=function(){return!1},Specable.prototype.getCellsBackgroundColors=function(){return null},Specable.prototype.getCellsBorderColors=function(){return null;
},Specable.prototype.hasBorder=function(element){return parseInt(element.borderBottomWidth)||parseInt(element.borderLeftWidth)||parseInt(element.borderRightWidth)||parseInt(element.borderTopWidth)},Specable.prototype.getColors=function(domEl){var elementFonts=this.getFonts(domEl),colors=[].concat(_toConsumableArray(this.getColorsFromFonts(elementFonts)||[]),_toConsumableArray(this.getInteractionsColors()||[]),_toConsumableArray(this.getCellsBackgroundColors()||[]),_toConsumableArray(this.getCellsBorderColors()||[]),[this.getBackgroundColor(),this.getBorderColor(),this.getFillColor(),this.getActiveBackgroundColor()]);return{colors:_lodash2.default.uniq(_lodash2.default.compact(colors),function(color){return color.hex+color.alpha}).filter(function(color){return color.alpha}),gradients:[this.getGradient()]}},Specable.prototype.getSpecProperties=function(){var fonts=this.getFonts(),basicProperties=_lodash2.default.extend({},{x:this[_Properties2.default.X],y:this[_Properties2.default.Y],name:this[_Properties2.default.NAME],width:this[_Properties2.default.WIDTH],height:this[_Properties2.default.HEIGHT],angle:this[_Properties2.default.ANGLE],opacity:this[_Properties2.default.OPACITY],paddingBottom:this[_Properties2.default.PADDING_BOTTOM],paddingLeft:this[_Properties2.default.PADDING_LEFT],paddingRight:this[_Properties2.default.PADDING_RIGHT],paddingTop:this[_Properties2.default.PADDING_TOP],borderStyle:this[_Properties2.default.BORDER_STYLE],borderBottomWidth:this[_Properties2.default.BORDER_BOTTOM_WIDTH],borderLeftWidth:this[_Properties2.default.BORDER_LEFT_WIDTH],borderRightWidth:this[_Properties2.default.BORDER_RIGHT_WIDTH],borderTopWidth:this[_Properties2.default.BORDER_TOP_WIDTH],borderBottomLeftRadius:this[_Properties2.default.BORDER_BOTTOM_LEFT_RADIUS],borderBottomRightRadius:this[_Properties2.default.BORDER_BOTTOM_RIGHT_RADIUS],borderTopLeftRadius:this[_Properties2.default.BORDER_TOP_LEFT_RADIUS],borderTopRightRadius:this[_Properties2.default.BORDER_TOP_RIGHT_RADIUS],borderColor:this.getBorderColor(),backgroundColor:this.getBackgroundColor(),backgroundPosition:this[_Properties2.default.BACKGROUND_POSITION],backgroundImage:this[_Properties2.default.BACKGROUND_IMAGE],backgroundRepeat:this[_Properties2.default.BACKGROUND_REPEAT],backgroundSize:this[_Properties2.default.BACKGROUND_SIZE],lineHeight:this[_Properties2.default.LINE_HEIGHT],textDecoration:this[_Properties2.default.TEXT_DECORATION],textAlign:this[_Properties2.default.TEXT_ALIGN],textTransform:this[_Properties2.default.TEXT_TRANSFORM],boxShadow:this[_Properties2.default.BOX_SHADOW],fill:this.getFillColor(),src:this[_Properties2.default.SRC],fonts:fonts,fontsColors:this.getColorsFromFonts(fonts),fixed:this[_Properties2.default.FIXED],metadata:this[_Properties2.default.METADATA],textContent:this.getTextContent(),gradient:this.getGradient(),cellsBackgroundColors:this.getCellsBackgroundColors(),cellsBorderColors:this.getCellsBorderColors(),additionalStyles:this.additionalStyles||{}},this.getColors());return basicProperties},Specable}()},{"../../enums/InteractionActions":350,"../../enums/Properties.js":358,"../../fonts/FontsHelper":363,"../../utils/Color":409,lodash:161}],238:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Properties=_dereq_("../../enums/Properties.js"),TextEditor=_dereq_("../helpers/TextEditor.js"),TextFormattable=_dereq_("./TextFormattable.js"),AbstractElement=_dereq_("../AbstractElement.js");module.exports=function(){var TextEditable=function(){};return TextEditable.DefaultProperties={inputValue:{value:""},color:{value:"#000000"},fontSize:{value:"14px"},fontWeight:{value:"normal"},fontStyle:{value:"normal"},fontFamily:{value:"Arial"},textDecoration:{value:""},textAlign:{value:"center"},list:{value:""},listIndentation:{value:""}},TextEditable.ExcludedProperties={fontSize:!0,fontWeight:!0,fontFamily:!0,fontStyle:!0,textDecoration:!0,color:!0,list:!0,listIndentation:!0},_.extend(TextEditable.prototype,TextFormattable.prototype),Object.defineProperties(TextEditable.prototype,{inputValue:{get:function(){return this._inputValue},set:function(value){this._saveProperty(),value=value.replace(/<p[^>]*>(<span[^>]*>)*\n+(<\/span>)*<\/p>/g,""),this._inputValue=value,TextEditor.GetEditingElement()!==this&&this.view.setInputValue(value)}},color:{get:function(){return TextEditor.GetColor(this)},set:function(value){if(!this.Page.isDesignMode())return void this.view.setColor(value);var contentData=TextEditor.SetColor(this,value);return!!contentData&&(this._saveProperty(),this._updateProperty(Properties.INPUT_VALUE,contentData.content,!0),void(this.adjustHeightToText()&&this._updateProperty(Properties.HEIGHT,contentData.height,!0)))}},fontSize:{get:function(){return TextEditor.GetFontSize(this)},set:function(value){var contentData=TextEditor.SetFontSize(this,value);return!!contentData&&(this._saveProperty(),this._updateProperty(Properties.INPUT_VALUE,contentData.content,!0),void(this.adjustHeightToText()&&this._updateProperty(Properties.HEIGHT,contentData.height,!0)))}},fontWeight:{get:function(){return TextEditor.GetBold(this)?"bold":"normal"},set:function(value){var contentData=TextEditor.SetBold(this,"bold"===value);return!!contentData&&(this._saveProperty(),this._updateProperty(Properties.INPUT_VALUE,contentData.content,!0),void(this.adjustHeightToText()&&this._updateProperty(Properties.HEIGHT,contentData.height,!0)))}},fontStyle:{get:function(){return TextEditor.GetItalic(this)?"italic":"normal"},set:function(value){var contentData=TextEditor.SetItalic(this,"italic"===value);return!!contentData&&(this._saveProperty(),this._updateProperty(Properties.INPUT_VALUE,contentData.content,!0),void(this.adjustHeightToText()&&this._updateProperty(Properties.HEIGHT,contentData.height,!0)))}},fontFamily:{get:function(){return TextEditor.GetFont(this)},set:function(value){var contentData=TextEditor.SetFont(this,value);return!!contentData&&(this._saveProperty(),this._updateProperty(Properties.INPUT_VALUE,contentData.content,!0),void(this.adjustHeightToText()&&this._updateProperty(Properties.HEIGHT,contentData.height,!0)))}},textDecoration:{get:function(){var decoration=[];return TextEditor.GetUnderline(this)&&decoration.push("underline"),TextEditor.GetLineThrough(this)&&decoration.push("line-through"),decoration.length>0?decoration.join(" "):"none"},set:function(value){var contentData;return"none"===value||_.isEmpty(value)?contentData=TextEditor.SetUnderline(this,!1)||TextEditor.SetLineThrough(this,!1):value.match(/underline/)?contentData=TextEditor.SetUnderline(this,!0):value.match(/line\-through/)&&(contentData=TextEditor.SetLineThrough(this,!0)),!!contentData&&(this._saveProperty(),this._updateProperty(Properties.INPUT_VALUE,contentData.content,!0),void(this.adjustHeightToText()&&this._updateProperty(Properties.HEIGHT,contentData.height,!0)))}},textAlign:{configurable:!0,get:function(){return this._textAlign},set:function(value){this._saveProperty(),this._textAlign=value,this.view.setTextAlign(value)}},list:{get:function(){return TextEditor.GetList(this)},set:function(value){var contentData=TextEditor.SetList(this,value);return!!contentData&&(this._saveProperty(),this._updateProperty(Properties.INPUT_VALUE,contentData.content,!0),void(this.adjustHeightToText()&&this._updateProperty(Properties.HEIGHT,contentData.height,!0)))}},listIndentation:{get:function(){return TextEditor.GetListIndentation(this)},set:function(value){var contentData=TextEditor.SetListIndentation(this,value);return!!contentData&&(this._saveProperty(),this._updateProperty(Properties.INPUT_VALUE,contentData.content,!0),void(this.adjustHeightToText()&&this._updateProperty(Properties.HEIGHT,contentData.height,!0)))}}}),TextEditable.prototype.isTextEditable=function(){return!0},TextEditable.prototype.isTextStyleable=function(){return!0},TextEditable.prototype.isRichTextEditable=function(){return!0},TextEditable.prototype.setEditing=function(value){this.view.setEditing(value)},TextEditable.prototype.select=function(){this.Page.isDesignMode()&&(this.shouldUpdateHeight=!0,this.view.setTextContentEditable(!0),TextEditor.Init(this)),AbstractElement.prototype.select.apply(this,arguments)},TextEditable.prototype.deselect=function(){this.Page.isDesignMode()&&(TextEditor.Destroy(this),this.view.setTextContentEditable(!1)),AbstractElement.prototype.deselect.apply(this,arguments)},TextEditable.prototype.insertText=function(text){var contentData=TextEditor.InsertText(this,text);contentData&&(this.Page.ElementsManager.startBatch(),this._updateProperty(Properties.INPUT_VALUE,contentData.content,!0),this.adjustHeightToText()&&this._updateProperty(Properties.HEIGHT,contentData.height,!0),this.Page.ElementsManager.endBatch())},TextEditable.prototype._updateProperty=function(property,value,addToHistory){this._isPropertySerializable(property)?AbstractElement.prototype._updateProperty.call(this,property,value,addToHistory):this[property]=value},TextEditable.prototype.getTextContent=function(){var div=document.createElement("div");return div.innerHTML=this.inputValue,div.innerHTML=_.map(div.childNodes,function(child){return child.nodeType===Node.TEXT_NODE?child.textContent:child.innerHTML?child.innerHTML.replace(/<br\s*[\/]?>([^<br>]*)$/,"").replace(/[\u200B-\u200D\uFEFF]/g,"").replace(/<br\s*[\/]?>/gi,"\n")+"\n":"\n"}).join(""),div.textContent},TextEditable}()},{"../../enums/Properties.js":358,"../AbstractElement.js":166,"../helpers/TextEditor.js":260,"./TextFormattable.js":239,lodash:161}],239:[function(_dereq_,module,exports){"use strict";var Properties=_dereq_("../../enums/Properties.js"),TextStyleHelper=_dereq_("../helpers/TextStyleHelper.js");module.exports=function(){function TextFormattable(){}return TextFormattable.prototype.toggleBold=function(){var value="bold"===this.fontWeight?"normal":"bold";this._updateProperty(Properties.FONT_WEIGHT,value,!0),TextStyleHelper.SetDefaultTextStyle(this.Page.getProjectId(),Properties.FONT_WEIGHT,value)},TextFormattable.prototype.toggleItalic=function(){var value="italic"===this.fontStyle?"normal":"italic";this._updateProperty(Properties.FONT_STYLE,value,!0),TextStyleHelper.SetDefaultTextStyle(this.Page.getProjectId(),Properties.FONT_STYLE,value)},TextFormattable.prototype.toggleUnderline=function(){var value,currentValue=this.textDecoration.replace("none","");value=currentValue.match(/underline/)?currentValue.replace("underline",""):currentValue+" underline",value=0===value.trim().length?"none":value,this._updateProperty(Properties.TEXT_DECORATION,value,!0),TextStyleHelper.SetDefaultTextStyle(this.Page.getProjectId(),Properties.TEXT_DECORATION,value)},TextFormattable}()},{"../../enums/Properties.js":358,"../helpers/TextStyleHelper.js":261}],240:[function(_dereq_,module,exports){"use strict";var ImageUpload=_dereq_("../ui/ImageUpload.js"),Properties=_dereq_("../../enums/Properties.js"),UploadStatus=_dereq_("../../enums/UploadStatus.js"),ImageEditor=_dereq_("../helpers/ImageEditor.js");module.exports=function(){function Uploadable(){this.imageUpload=null,this.hasProperty(Properties.SRC)?this.srcProperty=Properties.SRC:this.hasProperty(Properties.BACKGROUND_IMAGE)&&(this.srcProperty=Properties.BACKGROUND_IMAGE)}return Uploadable.prototype.isUploadable=function(){return!0},Uploadable.prototype.isDuringUpload=function(){return!!this.imageUpload&&this.imageUpload.status===UploadStatus.PENDING},Uploadable.prototype.setTemporaryImageSrc=function(src){this.shouldUpdateSrc=!1,this.srcProperty===Properties.SRC?this.view.setSrc(this._getCdnUrl(src),!0):this.srcProperty===Properties.BACKGROUND_IMAGE&&this.view.setBackgroundImage(this._getCdnUrl(src))},Uploadable.prototype.getCDNUrl=function(){var src=this[this.srcProperty];return src?this._getCdnUrl(src):""},Uploadable.prototype.setImageSrc=function(src,addToHistory){this._updateProperty(this.srcProperty,src,addToHistory)},Uploadable.prototype.showProgress=function(){this.imageUpload||(this.imageUpload=new ImageUpload(null,this.Page),this.addLinkedElement(this.imageUpload)),this.imageUpload.show(this),this.imageUpload.status=UploadStatus.PENDING},Uploadable.prototype.hideProgress=function(){this.imageUpload&&(this.imageUpload.remove(),this.removeLinkedElement(this.imageUpload),this.imageUpload=null)},Uploadable.prototype.setProgress=function(e){this.imageUpload&&(this.imageUpload.status=UploadStatus.PENDING,this.imageUpload.progress=e.loaded/e.total)},Uploadable.prototype.setCompleted=function(src){this.imageUpload&&(this.imageUpload.progress=1,this.imageUpload.status=UploadStatus.COMPLETED,this.hideProgress()),ImageEditor.PreloadImage(src).then(function(){this.setImageSrc(src,!0)}.bind(this))},Uploadable.prototype.setFailed=function(){this.imageUpload&&(this.imageUpload.status=UploadStatus.FAILED)},Uploadable}()},{"../../enums/Properties.js":358,"../../enums/UploadStatus.js":362,"../helpers/ImageEditor.js":251,"../ui/ImageUpload.js":281}],241:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Properties=_dereq_("../../enums/Properties.js");module.exports=function(){function getBoundingBox(selectedElements){return _.reduce(_.rest(selectedElements),function(bb,element){return bb.add(element.getBoundingBox(!0))},selectedElements[0].getBoundingBox(!0).clone())}function getCumulatedSize(selectedElements,sizeType){return _.reduce(selectedElements,function(size,element){return size+element.getBoundingBox(!0)[sizeType]},0)}function moveHorizontallyBy(element,delta){moveElementBy(element,Properties.X,delta)}function moveVerticallyBy(element,delta){moveElementBy(element,Properties.Y,delta)}function moveElementBy(element,property,delta){var value=element[property]+delta;element._updateProperty(property,value,!0)}function sortByPosition(selectedElements,position){return _.sortBy(selectedElements,function(element){return element.getBoundingBox(!0)[position]})}function Align(axis,selectedElements){var fn="Align"+_.capitalize(axis);if("function"==typeof this[fn])return this[fn](selectedElements)}function Distribute(orientation,selectedElements){var fn="Distribute"+_.capitalize(orientation);if("function"==typeof this[fn])return this[fn](selectedElements)}function AlignTop(selectedElements){var axis=getBoundingBox(selectedElements).top;_.forEach(selectedElements,function(element){moveVerticallyBy(element,axis-element.getBoundingBox(!0).top)})}function AlignMiddle(selectedElements){var axis=getBoundingBox(selectedElements).middle;_.forEach(selectedElements,function(element){var bb=element.getBoundingBox(!0),bbTop=axis-bb.height/2;moveVerticallyBy(element,bbTop-bb.top)})}function AlignBottom(selectedElements){var axis=getBoundingBox(selectedElements).bottom;_.forEach(selectedElements,function(element){moveVerticallyBy(element,axis-element.getBoundingBox(!0).bottom)})}function AlignLeft(selectedElements){var axis=getBoundingBox(selectedElements).left;_.forEach(selectedElements,function(element){moveHorizontallyBy(element,axis-element.getBoundingBox(!0).left)})}function AlignCenter(selectedElements){var axis=getBoundingBox(selectedElements).center;_.forEach(selectedElements,function(element){var bb=element.getBoundingBox(!0),bbLeft=axis-bb.width/2;moveHorizontallyBy(element,bbLeft-bb.left)})}function AlignRight(selectedElements){var axis=getBoundingBox(selectedElements).right;_.forEach(selectedElements,function(element){moveHorizontallyBy(element,axis-element.getBoundingBox(!0).right)})}function DistributeHorizontal(selectedElements){var bb=getBoundingBox(selectedElements),elementsWidth=getCumulatedSize(selectedElements,"width"),spacing=DEFAULT_SPACING,left=bb.left;bb.width>=elementsWidth&&(spacing=(bb.width-elementsWidth)/(selectedElements.length-1)),_.forEach(sortByPosition(selectedElements,"left"),function(element){moveHorizontallyBy(element,left-element.getBoundingBox(!0).left),left+=element.getBoundingBox(!0).width+spacing})}function DistributeVertical(selectedElements){var bb=getBoundingBox(selectedElements),elementsHeight=getCumulatedSize(selectedElements,"height"),spacing=DEFAULT_SPACING,top=bb.top;bb.height>=elementsHeight&&(spacing=(bb.height-elementsHeight)/(selectedElements.length-1)),_.forEach(sortByPosition(selectedElements,"top"),function(element){moveVerticallyBy(element,top-element.getBoundingBox(!0).top),top+=element.getBoundingBox(!0).height+spacing})}var DEFAULT_SPACING=5,AlignHelper={Align:Align,AlignTop:AlignTop,AlignMiddle:AlignMiddle,AlignBottom:AlignBottom,AlignLeft:AlignLeft,AlignCenter:AlignCenter,AlignRight:AlignRight,Distribute:Distribute,DistributeHorizontal:DistributeHorizontal,DistributeVertical:DistributeVertical};return Object.freeze(AlignHelper)}()},{"../../enums/Properties.js":358,lodash:161}],242:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Tree=_dereq_("../../utils/Tree.js"),RemoveHelper=_dereq_("./RemoveHelper.js");module.exports=function(){function zSort(reversed,element1,element2){var ancestor,order=reversed?-1:1;return Tree.IsAncestorOf(element2,element1)?-1*order:Tree.IsDescendantOf(element2,element1)?1*order:(ancestor=Tree.GetClosestAncestor(element1,element2),(ancestor.getChildIndex(Tree.GetRootElement(element1,ancestor))-ancestor.getChildIndex(Tree.GetRootElement(element2,ancestor)))*order)}function ZSortSelectedElements(selectedElements,reversed){selectedElements.sort(zSort.bind(this,reversed))}function MoveToFront(selectedElements){var index;selectedElements.sort(zSort.bind(null,!1)),_.forEach(selectedElements,function(element){index=element.parent.getChildIndex(element),index<element.parent.children.length-1&&element.parent.moveChildAt(element,element.parent.children.length-1)})}function MoveToBack(selectedElements){var index;selectedElements.sort(zSort.bind(null,!0)),_.forEach(selectedElements,function(element){index=element.parent.getChildIndex(element),index>0&&element.parent.moveChildAt(element,0)})}function MoveForward(selectedElements){var index;selectedElements.sort(zSort.bind(null,!0)),_.forEach(selectedElements,function(element){index=element.parent.getChildIndex(element),index<element.parent.children.length-1&&element.parent.moveChildAt(element,index+1)})}function MoveBehind(selectedElements){var index;selectedElements.sort(zSort.bind(null,!1)),_.forEach(selectedElements,function(element){index=element.parent.getChildIndex(element),index>0&&element.parent.moveChildAt(element,index-1)})}function MoveBefore(elements,target){elements.sort(zSort.bind(null,!1)),_.forEach(elements,function(element){if(!Tree.IsAncestorOf(target,element)){var originalParent=element.parent;originalParent.removeChild(element);var targetIndex=target.parent.getChildIndex(target);target.parent.addChildAt(element,targetIndex),RemoveHelper.isEmptyGroup(originalParent)&&RemoveHelper.DeleteElements([originalParent])}})}function MoveAfter(elements,target){elements.sort(zSort.bind(null,!0)),_.forEach(elements,function(element){if(!Tree.IsAncestorOf(target,element)){var originalParent=element.parent;originalParent.removeChild(element);var targetIndex=target.parent.getChildIndex(target);target.parent.addChildAt(element,targetIndex+1),RemoveHelper.isEmptyGroup(originalParent)&&RemoveHelper.DeleteElements([originalParent])}})}var ArrangeHelper={ZSortSelectedElements:ZSortSelectedElements,MoveToFront:MoveToFront,MoveToBack:MoveToBack,MoveForward:MoveForward,MoveBehind:MoveBehind,MoveBefore:MoveBefore,MoveAfter:MoveAfter};return ArrangeHelper}()},{"../../utils/Tree.js":419,"./RemoveHelper.js":255,lodash:161}],243:[function(_dereq_,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.extractBackgroundData=void 0;var _tinycolor=_dereq_("tinycolor2"),_tinycolor2=_interopRequireDefault(_tinycolor),_Properties=_dereq_("../../enums/Properties"),_Properties2=_interopRequireDefault(_Properties),_=_dereq_("lodash");exports.extractBackgroundData=function(style){var backgroundColor=(0,_tinycolor2.default)(style[_Properties2.default.BACKGROUND_COLOR]).isValid()?(0,_tinycolor2.default)(style[_Properties2.default.BACKGROUND_COLOR]).toRgbString():"",INITIAL_VALUE="initial",backgroundProperties=[_Properties2.default.BACKGROUND_ATTACHMENT,_Properties2.default.BACKGROUND_CLIP,_Properties2.default.BACKGROUND_COLOR,_Properties2.default.BACKGROUND_IMAGE,_Properties2.default.BACKGROUND_ORIGIN,_Properties2.default.BACKGROUND_POSITION,_Properties2.default.BACKGROUND_REPEAT,_Properties2.default.BACKGROUND_SIZE],backgroundData={};return _.forEach(backgroundProperties,function(property){style[property]!==INITIAL_VALUE&&(backgroundData[property]=property===_Properties2.default.BACKGROUND_COLOR?backgroundColor:style[property])}),backgroundData}},{"../../enums/Properties":358,lodash:161,tinycolor2:159}],244:[function(_dereq_,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function extractBorderRadiusData(style){var _ref;return _ref={},_defineProperty(_ref,_Properties2.default.BORDER_TOP_LEFT_RADIUS,parseInt(style[_Properties2.default.BORDER_TOP_LEFT_RADIUS])||0),_defineProperty(_ref,_Properties2.default.BORDER_TOP_RIGHT_RADIUS,parseInt(style[_Properties2.default.BORDER_TOP_RIGHT_RADIUS])||0),_defineProperty(_ref,_Properties2.default.BORDER_BOTTOM_RIGHT_RADIUS,parseInt(style[_Properties2.default.BORDER_BOTTOM_RIGHT_RADIUS])||0),_defineProperty(_ref,_Properties2.default.BORDER_BOTTOM_LEFT_RADIUS,parseInt(style[_Properties2.default.BORDER_BOTTOM_LEFT_RADIUS])||0),_ref}function extractBorderData(style){var borderData={};return style[_Properties2.default.BORDER_COLOR]&&(0,_tinycolor2.default)(style[_Properties2.default.BORDER_COLOR]).isValid()&&(borderData[_Properties2.default.BORDER_COLOR]=(0,_tinycolor2.default)(style[_Properties2.default.BORDER_COLOR]).toRgbString()),style[_Properties2.default.BORDER_STYLE]&&"initial"!==style[_Properties2.default.BORDER_STYLE]&&(borderData[_Properties2.default.BORDER_STYLE]=style[_Properties2.default.BORDER_STYLE]),_.forEach(SpecificProperties[_Properties2.default.BORDER_WIDTH],function(prop){parseInt(style[prop])&&(borderData[prop]=parseInt(style[prop]))}),_.forEach(SpecificProperties[_Properties2.default.BORDER_COLOR],function(prop){style[prop]&&(borderData[prop]=(0,_tinycolor2.default)(style[prop]).toRgbString())}),_.forEach(SpecificProperties[_Properties2.default.BORDER_STYLE],function(prop){style[prop]&&(borderData[prop]=style[prop])}),borderData}Object.defineProperty(exports,"__esModule",{value:!0});var _SpecificProperties;exports.extractBorderRadiusData=extractBorderRadiusData,exports.extractBorderData=extractBorderData;var _tinycolor=_dereq_("tinycolor2"),_tinycolor2=_interopRequireDefault(_tinycolor),_Properties=_dereq_("../../enums/Properties"),_Properties2=_interopRequireDefault(_Properties),_=_dereq_("lodash"),SpecificProperties=(_SpecificProperties={},_defineProperty(_SpecificProperties,_Properties2.default.BORDER_WIDTH,[_Properties2.default.BORDER_TOP_WIDTH,_Properties2.default.BORDER_LEFT_WIDTH,_Properties2.default.BORDER_RIGHT_WIDTH,_Properties2.default.BORDER_BOTTOM_WIDTH]),_defineProperty(_SpecificProperties,_Properties2.default.BORDER_COLOR,[_Properties2.default.BORDER_TOP_COLOR,_Properties2.default.BORDER_RIGHT_COLOR,_Properties2.default.BORDER_LEFT_COLOR,_Properties2.default.BORDER_BOTTOM_COLOR]),_defineProperty(_SpecificProperties,_Properties2.default.BORDER_STYLE,[_Properties2.default.BORDER_TOP_STYLE,_Properties2.default.BORDER_RIGHT_STYLE,_Properties2.default.BORDER_BOTTOM_STYLE,_Properties2.default.BORDER_LEFT_STYLE]),_SpecificProperties)},{"../../enums/Properties":358,lodash:161,tinycolor2:159}],245:[function(_dereq_,module,exports){"use strict";module.exports=function(){function isSafari(){var ua=navigator.userAgent.toLowerCase();return ua.indexOf("safari")>-1&&ua.indexOf("chrome")===-1}return Object.freeze({isSafari:isSafari})}()},{}],246:[function(_dereq_,module,exports){"use strict";var _FontsManager=_dereq_("../../fonts/FontsManager.js"),_=_dereq_("lodash"),Tree=_dereq_("../../utils/Tree.js"),ArrangeHelper=_dereq_("./ArrangeHelper.js"),ElementsHelper=_dereq_("./ElementsHelper.js"),ElementTypes=_dereq_("../../enums/ElementTypes.js"),Events=_dereq_("../../enums/Events.js"),Parse=_dereq_("../../utils/Parse.js"),Storage=_dereq_("../../utils/Storage.js"),Rectangle=_dereq_("../../primitives/Rectangle.js");module.exports=function(){function IsRawImage(clipboardData){if(clipboardData){var item,items=clipboardData.items;if(items)for(var i=0;i<items.length;i++)if(item=items[i],item.type.indexOf("image")!==-1)return!0}return!1}function saveToStorage(clipboard,boundingBox,pageId,isCut){Storage.Save(DB_ID,{_id:DB_ID,elements:clipboard,boundingBox:boundingBox.serialize(),pageId:pageId,isCut:isCut})}function containsComponent(elements){return _.some(elements,function(element){return element.type===ElementTypes.COMPONENT})}function GetRawImageBlobSrc(clipboardData){var src="";if(clipboardData){var items=clipboardData.items;items&&_.forEach(items,function(item){if(item.type.indexOf("image")!==-1){var blob=item.getAsFile();src=window.URL.createObjectURL(blob)}})}return src}function CopyElements(elements,pageId,isCut,boundingBox,store){var clipboard={},elementsWithAllDescendants=_.reduce(elements,function(copied,element){return copied.push(element),element.isComponent()?copied:copied.concat(Tree.GetAllDescendants(element))},[]);return store="undefined"==typeof store||store,clipboard=_.mapValues(Parse.getElementsMap(elementsWithAllDescendants),function(element){return element.serialize()}),ArrangeHelper.ZSortSelectedElements(elements),clipboard[ElementsHelper.CANVAS_ID]=ElementsHelper.GetSerializedCanvas(elements),store?void saveToStorage(clipboard,boundingBox,pageId,isCut):void(CLIPBOARD_CONTENT={elements:clipboard,boundingBox:boundingBox,pageId:pageId,isCut:isCut})}function PasteElements(parent,position){return Storage.Load(DB_ID).then(function(doc){return PasteToTarget(parent,position,doc.elements,doc.boundingBox,doc.pageId,doc.isCut)}).catch(function(){return[]})}function PasteInPlace(parent,position){if(!_.isEmpty(CLIPBOARD_CONTENT))return PasteToTarget(parent,position,CLIPBOARD_CONTENT.elements,CLIPBOARD_CONTENT.boundingBox,CLIPBOARD_CONTENT.pageId,CLIPBOARD_CONTENT.isCut,!0)}function PasteToTarget(parent,position,elements,boundingBox,pageId,isCut,updateElements){if(_.isEmpty(elements)||parent.Page.isComponentEditMode()&&containsComponent(elements))return[];var pageElementsIds=_.map(parent.Page.getAllElements(),function(element){return element.id});ElementsHelper.RemoveNonexistingElementsFromActions(elements,pageElementsIds);var children,boundingRectangle=Rectangle.FromSerialized(boundingBox),currentPageId=parent.Page.pageId,newPage=pageId!==currentPageId;return isCut=isCut||newPage,parent.Page.ElementsManager.startBatch(),children=parent.Page.ElementsManager.duplicateElementsFromClipboard(elements,isCut),parent.Page.ElementsManager.setPastedElementsCoordinates(children,parent.Page.canvas,position,boundingRectangle,newPage),updateElements&&updateGroupElements(children),parent.addChildren(children),(0,_FontsManager.loadFontsFromElements)(children).then(function(fonts){return parent.Page.emit(Events.ELEMENTS_FONTS_LOADED,{fonts:fonts})}),parent.Page.ElementsManager.endBatch(),children}function updateGroupElements(elements){elements.forEach(function(element){(element.isGroup()||element.isComponent())&&element.update()})}function IsClipboardEmpty(){return Storage.Load(DB_ID).then(function(doc){return _.isEmpty(doc.elements)}).catch(function(){return!0})}var DB_ID="clipboard",CLIPBOARD_CONTENT={},ClipboardHelper={IsRawImage:IsRawImage,GetRawImageBlobSrc:GetRawImageBlobSrc,CopyElements:CopyElements,PasteElements:PasteElements,PasteInPlace:PasteInPlace,IsClipboardEmpty:IsClipboardEmpty};return ClipboardHelper}()},{"../../enums/ElementTypes.js":346,"../../enums/Events.js":347,"../../fonts/FontsManager.js":365,"../../primitives/Rectangle.js":404,"../../utils/Parse.js":415,"../../utils/Storage.js":417,"../../utils/Tree.js":419,"./ArrangeHelper.js":242,"./ElementsHelper.js":250,lodash:161}],247:[function(_dereq_,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _=_dereq_("lodash");exports.parseCss=function(){var cssArray=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],cssObject={};return Object.defineProperty(cssObject,"orderedList",{enumerable:!1,value:[]}),_.isObject(cssArray)&&!_.isArray(cssArray)&&(cssArray=_.map(cssArray,function(value,prop){return prop+":"+value})),cssArray.reduce(function(ruleMap,ruleString){var rulePair=ruleString.split(":");if(rulePair.length<2)return ruleMap;var property=_.camelCase(rulePair[0].trim()),value=rulePair[1].replace(/\'|;|\"/g,"").trim();return ruleMap[property]=value,cssObject.orderedList.push({property:property,value:value}),ruleMap},cssObject)}},{lodash:161}],248:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash");module.exports=function(){function isImage(file){return file.type.indexOf("image")!==-1}function ContainsImageFile(dataTransfer){if(dataTransfer){var file,files=dataTransfer.files;if(files)for(var i=0;i<files.length;i++)if(file=files[i],isImage(file))return!0}return!1}function GetImages(dataTransfer){var images=[];if(dataTransfer){var files=dataTransfer.files;files&&_.forEach(files,function(file){isImage(file)&&images.push({src:window.URL.createObjectURL(file),file:file})})}return images}return{ContainsImageFile:ContainsImageFile,GetImages:GetImages}}()},{lodash:161}],249:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Properties=_dereq_("../../enums/Properties.js");module.exports=function(){function UpdateStates(props,idsMap){_.forEach(props[Properties.STATES],function(state){state.elements=_.map(state.elements,function(id){return idsMap[id]||id})})}function UpdateStoredElements(props,idsMap){props[Properties.STORED_ELEMENTS]=_.map(props[Properties.STORED_ELEMENTS],function(id){return idsMap[id]||id})}function UpdateActions(props,idsMap,animationsIdsMap){_.forEach(props[Properties.ACTIONS],function(action){action.elements=_.map(action.elements,function(id){return idsMap[id]||id}),action.id&&animationsIdsMap&&animationsIdsMap[action.id]&&(action.id=animationsIdsMap[action.id],action.name=action.name.replace(/[0-9]*$/,action.id.substring(0,5)))})}var DuplicateHelper={};return DuplicateHelper[Properties.STATES]=UpdateStates,DuplicateHelper[Properties.STORED_ELEMENTS]=UpdateStoredElements,DuplicateHelper[Properties.ACTIONS]=UpdateActions,DuplicateHelper}()},{"../../enums/Properties.js":358,lodash:161}],250:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),MD5=_dereq_("../../utils/MD5.js"),ElementTypes=_dereq_("../../enums/ElementTypes.js"),DuplicateHelper=_dereq_("../../elements/helpers/DuplicateHelper.js"),Tree=_dereq_("../../utils/Tree.js"),INTERACTION_TRIGGERS_GROUPED=_dereq_("../../enums/InteractionTriggersGrouped.js");module.exports=function(){function getElementsChildren(element,serialized){var children=[];return element.props.storedElements&&element.type!==ElementTypes.MULTISTATE&&element.type!==ElementTypes.COMPONENT?children=getGroupChildren(element,serialized):element.props.states&&(children=getMultistateChildren(element,serialized)),children}function getGroupChildren(element,serialized){return _.map(element.props.storedElements,function(elementId){return serialized[elementId]})}function getMultistateChildren(element,serialized){return _.reduce(element.props.states,function(children,state){return _.forEach(state.elements,function(elementId){children.push(serialized[elementId])}),children},[])}function getFixedChildren(element){return _.filter(element.children,function(child){return child.fixed})}function isAncestorFixed(element){for(;element.parent&&element.parent.type!==ElementTypes.CANVAS;){if(element.parent.fixed)return!0;
element=element.parent}return!1}function isAncestorComponent(element){for(;element.parent&&element.parent.type!==ElementTypes.CANVAS;){if(element.parent.type===ElementTypes.COMPONENT)return!0;element=element.parent}return!1}function getUnfixableParentElement(element){element.isVirtualGroup()&&(element=element.children[0]);var parentsList=Tree.GetAllAncestors(element);return _.find(parentsList,function(parent){return parent.isMultistate()||parent.isClip})}function GetUniqueId(elementType){return MD5((elementType||"")+Math.random()+Date.now())}function GetElementsWithoutCanvas(serialized){return _.omit(serialized,CANVAS_ID)}function GenerateIdsMap(ids){var map={};return _.forEach(ids,function(id){map[id]=id===CANVAS_ID?CANVAS_ID:GetUniqueId("AbstractElement",id)}),map}function TranslateIds(serialized,idsMap){var translated=_.cloneDeep(serialized);translated.id=idsMap[translated.id];var animationsIdsMap=_.isArray(translated.props.actions)?translated.props.actions.reduce(function(idsMap,newElement){return newElement.id?(idsMap[newElement.id]=GetUniqueId(),idsMap):idsMap},{}):null;return _.forEach(translated.props,function(value,property){"function"==typeof DuplicateHelper[property]&&DuplicateHelper[property].call(null,translated.props,idsMap,animationsIdsMap)}),translated}function TranslateAllIds(serializedElements,idsMap){var elements={};return idsMap[CANVAS_ID]||(idsMap[CANVAS_ID]=CANVAS_ID),_.forEach(serializedElements,function(serialized,elementId){elements[idsMap[elementId]]=TranslateIds(serialized,idsMap)}),elements}function ConvertListToMap(elementsSerializedList){return _.reduce(elementsSerializedList,function(map,elementSerialized){return map[elementSerialized.id]=elementSerialized,map},{})}function GetSortedPageElements(serialized){var sorted=[],appendElement=function appendElement(element){sorted.push(_.omit(element,"__children")),_.forEach(element.__children,appendElement)};return _.forEach(serialized,function(element,elementId){_.extend(element,{id:elementId,__children:getElementsChildren(element,serialized)})}),appendElement(serialized[CANVAS_ID]),sorted}function GetSerializedCanvas(elements){return{id:CANVAS_ID,type:ElementTypes.CANVAS,v:"2.0",props:{storedElements:_.map(elements,"id")}}}function ContainsComponent(elements){return _.some(elements,function(element){return element.isComponent()||element.children&&ContainsComponent(element.children)||!1})}function canBeFixed(element){var ancestors=Tree.GetAllAncestors(element);return!_.some(ancestors,function(ancestor){return ancestor.isClip||ancestor.isMultistate()})}function RemoveNonexistingElementsFromActions(serialized,pageElementsIds){var elementIds=_.keys(serialized);pageElementsIds&&(elementIds=_.union(elementIds,pageElementsIds)),_.forEach(serialized,function(element){var actions=[];element.props.actions&&(_.forEach(element.props.actions,function(action){_.size(action.elements)?(action.elements=_.filter(action.elements,function(elementId){return elementIds.indexOf(elementId.toString())>-1}),_.size(action.elements)&&actions.push(action)):actions.push(action)}),element.props.actions=actions)})}function isFormEventUnsupported(elementType,actionTrigger){return!_.contains(INTERACTION_TRIGGERS_GROUPED.EVENTS_SUPPORT.FORM_EVENTS,elementType)&&_.contains(INTERACTION_TRIGGERS_GROUPED.TRIGGERS_GROUP.FORM_EVENTS,actionTrigger)}function isSelectListEventUnsupported(elementType,actionTrigger){return!_.contains(INTERACTION_TRIGGERS_GROUPED.EVENTS_SUPPORT.SELECT_LIST_EVENTS,elementType)&&_.contains(INTERACTION_TRIGGERS_GROUPED.TRIGGERS_GROUP.SELECT_LIST_EVENTS,actionTrigger)}function isStandardEventUnsupported(elementType,actionTrigger){return _.contains(INTERACTION_TRIGGERS_GROUPED.EVENTS_SUPPORT.CANVAS_EVENTS,elementType)&&_.contains(INTERACTION_TRIGGERS_GROUPED.TRIGGERS_GROUP.STANDARD_EVENTS,actionTrigger)}function isActionSupported(elementType,actionTrigger){return!(isFormEventUnsupported(elementType,actionTrigger)||isSelectListEventUnsupported(elementType,actionTrigger)||isStandardEventUnsupported(elementType,actionTrigger))}function RemoveInvalidActionsFromElements(serialized){_.forEach(serialized,function(element){element.props.actions=_.filter(element.props.actions,function(action){return isActionSupported(element.type,action.event)})})}function GenerateZIndicesInList(serializedList){return _.map(serializedList,function(element,i){return"undefined"==typeof element.props["z-index"]&&(element.props["z-index"]=1e3+i),element})}function GetElementsSortedFromRoot(rootElement){var elements=[rootElement];return rootElement.isComponent()||_.forEach(rootElement.children,function(element){elements=elements.concat(GetElementsSortedFromRoot(element))}),elements}function GetAllElementDescendants(element){return Tree.GetAllDescendants(element)}function GetNewGroupClipping(groupElementProps,newPosition){return{angle:groupElementProps.clip.angle,height:groupElementProps.clip.height,width:groupElementProps.clip.width,x:newPosition.x+groupElementProps.x,y:newPosition.y+groupElementProps.y}}var CANVAS_ID="canvas",ElementsHelper={CANVAS_ID:CANVAS_ID,GetUniqueId:GetUniqueId,GetElementsWithoutCanvas:GetElementsWithoutCanvas,GenerateIdsMap:GenerateIdsMap,TranslateIds:TranslateIds,TranslateAllIds:TranslateAllIds,ConvertListToMap:ConvertListToMap,GetSortedPageElements:GetSortedPageElements,GetSerializedCanvas:GetSerializedCanvas,ContainsComponent:ContainsComponent,RemoveNonexistingElementsFromActions:RemoveNonexistingElementsFromActions,RemoveInvalidActionsFromElements:RemoveInvalidActionsFromElements,GenerateZIndicesInList:GenerateZIndicesInList,canBeFixed:canBeFixed,isAncestorFixed:isAncestorFixed,isAncestorComponent:isAncestorComponent,getFixedChildren:getFixedChildren,getUnfixableParentElement:getUnfixableParentElement,GetAllElementDescendants:GetAllElementDescendants,GetElementsSortedFromRoot:GetElementsSortedFromRoot,GetNewGroupClipping:GetNewGroupClipping};return ElementsHelper}()},{"../../elements/helpers/DuplicateHelper.js":249,"../../enums/ElementTypes.js":346,"../../enums/InteractionTriggersGrouped.js":352,"../../utils/MD5.js":414,"../../utils/Tree.js":419,lodash:161}],251:[function(_dereq_,module,exports){"use strict";_dereq_("../../lib/canvas-to-blob.min.js");var _=_dereq_("lodash"),Point=_dereq_("../../primitives/Point.js"),Rectangle=_dereq_("../../primitives/Rectangle.js"),Events=_dereq_("../../enums/Events.js"),ImageCrop=_dereq_("../ui/ImageCrop.js"),ImageEdit=_dereq_("../ui/ImageEdit.js"),BrowserHelper=_dereq_("./BrowserHelper.js");module.exports=function(){function getScaleForOriginalImage(element,originalWidth,originalHeight,cropRectangles){for(var rect,rectPrev,first=_.first(cropRectangles),last=_.last(cropRectangles),width=last?last.width:originalWidth,height=last?last.height:originalHeight,scale=new Point(element.width/width,element.height/height),i=cropRectangles.length;i-- >0;)rect=cropRectangles[i],rect!==last&&(rectPrev=cropRectangles[i+1],scale.x*=rectPrev.prevWidth/rect.width,scale.y*=rectPrev.prevHeight/rect.height);return first&&(scale.x*=first.prevWidth/originalWidth,scale.y*=first.prevHeight/originalHeight),scale}function getPositionForOriginalImage(element,cropRectangles){var scale,rectPrev,rect,delta,position=element.getBoundingBox().clone()._p0,last=_.last(cropRectangles);if(last){scale={x:element.width/last.width,y:element.height/last.height};for(var i=cropRectangles.length;i-- >0;)rect=cropRectangles[i],rectPrev=cropRectangles[i-1],delta={x:rect.left,y:rect.top},rectPrev&&(delta.x-=rectPrev.left,delta.y-=rectPrev.top),delta.x*=scale.x,delta.y*=scale.y,position.translate(-delta.x,-delta.y,element.angle)}return position}function getBlobSrcFromSrc(src){return new Promise(function(resolve){var xhr=new XMLHttpRequest;xhr.open("GET",src,!0),xhr.responseType="arraybuffer",xhr.onload=function(){var arrayBufferView=new Uint8Array(xhr.response),imageUrl=GetBlobSrc([arrayBufferView],"image/jpeg");resolve(imageUrl)},xhr.send()})}function getBlobSrcFromImg(img){return new Promise(function(resolve){var width=img.naturalWidth,height=img.naturalHeight,canvas=document.createElement("canvas");canvas.setAttribute("width",width+"px"),canvas.setAttribute("height",height+"px");var ctx=canvas.getContext("2d");ctx.drawImage(img,0,0,width,height),canvas.toBlob(function(blob){resolve(createBlobSrc(blob))})})}function normalizeBlob(blob){return BrowserHelper.isSafari()?flipBlob(blob):blob}function flipBlob(blob){return new Promise(function(resolve){var img=document.createElement("img");img.crossOrigin="Anonymous",img.onload=function(){var canvas=document.createElement("canvas"),ctx=canvas.getContext("2d");canvas.width=img.naturalWidth,canvas.height=img.naturalHeight,ctx.translate(0,img.naturalHeight),ctx.scale(1,-1),ctx.drawImage(img,0,0),canvas.toBlob(resolve)},img.src=createBlobSrc(blob)})}function GetBlobSrcFromSvg(svg,originalWidth,originalHeight){var viewBox="0 0 "+originalWidth+" "+originalHeight,wrapper=document.createElement("div");wrapper.innerHTML=svg;var svgElement=wrapper.querySelector("svg");return svgElement.setAttribute("viewBox",viewBox),svgElement.setAttribute("preserveAspectRatio","none"),GetBlobSrc([wrapper.innerHTML],"image/svg+xml")}function GetCropBlob(imageCropElement){var cropRectangle=imageCropElement.getCropRectangle();return new Promise(function(resolve){var canvas=document.createElement("canvas");canvas.setAttribute("width",cropRectangle.width+"px"),canvas.setAttribute("height",cropRectangle.height+"px");var ctx=canvas.getContext("2d");ctx.drawImage(imageCropElement.view.img,-cropRectangle.x,-cropRectangle.y,imageCropElement.originRect.width,imageCropElement.originRect.height),canvas.toBlob(resolve)})}function getEditedBlob(imageEditElement){return new Promise(function(resolve){imageEditElement.view.domElement.toBlob(resolve)})}function createBlobSrc(blob){return window.URL.createObjectURL(blob)}function GetBlobSrc(object,type){var blob=new Blob(object,{type:type});return createBlobSrc(blob)}function GetImageSize(src){return new Promise(function(resolve){var img=document.createElement("img");img.onload=function(){resolve({width:img.naturalWidth,height:img.naturalHeight})},img.src=src})}function Crop(imageCropElement){var promiseResolve,imageElement=imageCropElement.image,cropRectangle=imageCropElement.getCropRectangle(),croppedImageRectangle=imageCropElement.getImageRectangle(),promise=new Promise(function(resolve){promiseResolve=resolve});return imageElement.getBoundingBox().isEqual(croppedImageRectangle)?Promise.resolve():(imageCropElement.imageProcessingStart(),GetCropBlob(imageCropElement).then(function(blob){var blobSrc=createBlobSrc(blob);blob.name=imageElement.createModifiedFileName(),imageElement.Page.emit(Events.IMAGE_EDITED,{file:blob,onProgress:imageElement.setProgress.bind(imageElement),onComplete:imageElement.onCompletedModifiedUpload.bind(imageElement),onError:imageElement.setFailed.bind(imageElement),onGotSrc:function(src){imageElement.updateCrop(croppedImageRectangle,cropRectangle,src),imageElement.srcMod=blobSrc,imageElement.enableUpload(),imageElement.showProgress(),imageCropElement.imageProcessingEnd(),promiseResolve()}})}),promise)}function ApplyEdit(imageEditElement){var imageBlob,imageBlobSrc,promiseResolve,imageElement=imageEditElement.image,adjustments=imageEditElement.getChangedAdjustments(),promise=new Promise(function(resolve){promiseResolve=resolve});return _.isEmpty(adjustments)?Promise.resolve():(imageElement.imageProcessingStart(),getEditedBlob(imageEditElement).then(normalizeBlob).then(function(blob){return imageBlob=blob,imageBlobSrc=createBlobSrc(blob)}).then(PreloadImage).then(function(){imageBlob.name=imageElement.createModifiedFileName(),imageElement.Page.emit(Events.IMAGE_EDITED,{file:imageBlob,onComplete:imageElement.onCompletedModifiedUpload.bind(imageElement),onProgress:imageElement.setProgress.bind(imageElement),onError:imageElement.setFailed.bind(imageElement),onGotSrc:function(src){imageElement.updateAdjustments(adjustments,src),imageElement.srcMod=imageBlobSrc,imageElement.enableUpload(),imageElement.showProgress(),imageElement.imageProcessingEnd(),promiseResolve()}})}),promise)}function GetImageCrop(image,Page,ignoreAdjustments){return new Promise(function(resolve){var getBlobSrc;getBlobSrc=image.isAdjusted()&&!ignoreAdjustments?GetImageEdit(image,Page,!0).then(getEditedBlob).then(normalizeBlob).then(createBlobSrc):image.isCropped()?getBlobSrcFromSrc(image.src):getBlobSrcFromImg(image.view.domElement),getBlobSrc.then(function(src){GetImageSize(src).then(function(size){var position=getPositionForOriginalImage(image,image.crop),scale=getScaleForOriginalImage(image,size.width,size.height,image.crop),originRect=new Rectangle(position.x,position.y,size.width*scale.x,size.height*scale.y,image.angle),imageCrop=new ImageCrop(null,Page);imageCrop.initProperties({src:src,originRect:originRect,image:image}),ignoreAdjustments||image.onStartCrop(imageCrop),resolve(imageCrop)})})})}function GetImageEdit(image,Page,ignoreCrop){var getBlobSrc;return getBlobSrc=image.isCropped()&&!ignoreCrop?GetImageCrop(image,Page,!0).then(GetCropBlob).then(createBlobSrc):getBlobSrcFromSrc(image.src),getBlobSrc.then(function(src){var imageEdit=new ImageEdit(null,Page);return imageEdit.initProperties({src:src,image:image}),imageEdit.loaded()})}function PreloadImage(src){return new Promise(function(resolve,reject){var image=new window.Image;image.crossOrigin="Anonymous",image.onload=resolve,image.onerror=reject,image.src=src})}return{GetImageSize:GetImageSize,Crop:Crop,ApplyEdit:ApplyEdit,GetImageCrop:GetImageCrop,GetImageEdit:GetImageEdit,GetBlobSrc:GetBlobSrc,GetBlobSrcFromSvg:GetBlobSrcFromSvg,GetCropBlob:GetCropBlob,PreloadImage:PreloadImage}}()},{"../../enums/Events.js":347,"../../lib/canvas-to-blob.min.js":381,"../../primitives/Point.js":403,"../../primitives/Rectangle.js":404,"../ui/ImageCrop.js":279,"../ui/ImageEdit.js":280,"./BrowserHelper.js":245,lodash:161}],252:[function(_dereq_,module,exports){"use strict";module.exports=function(){function buttonPressed(e,button){return e.which===button}function leftButtonPressed(e){return buttonPressed(e,BUTTONS.LEFT)}function rightButtonPressed(e){return buttonPressed(e,BUTTONS.RIGHT)}function addToSelection(e){return leftButtonPressed(e)&&(e.shiftKey||e.metaKey||e.ctrlKey)}function isEventOnElement(e,element){var bb,x=e.clientX,y=e.clientY;return e.target===element||(bb=element.getBoundingClientRect(),bb.left<=x&&bb.right>=x&&bb.top<=y&&bb.bottom>=y)}var BUTTONS={LEFT:1,RIGHT:3};return{leftButtonPressed:leftButtonPressed,rightButtonPressed:rightButtonPressed,addToSelection:addToSelection,isEventOnElement:isEventOnElement}}()},{}],253:[function(_dereq_,module,exports){"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_=_dereq_("lodash"),Orientations=_dereq_("../../enums/Orientations.js");module.exports=function(){function MoveTracer(options){this._lastDirection=null,this._moves=[],this._options={tracingMovesCount:50},this.reset(),this.setOptions(options)}return MoveTracer.prototype.setOptions=function(options){return options&&"object"===("undefined"==typeof options?"undefined":_typeof(options))&&(this._options=_.extend(this._options,options)),this},MoveTracer.prototype.getOption=function(option){return this._options[option]},MoveTracer.prototype.reset=function(){return this._moves=[],this._lastDirection=null,this},MoveTracer.prototype.addMove=function(coordinates){return this._moves.length>this._options.tracingMovesCount-1&&this._moves.splice(0,this._moves.length-this._options.tracingMovesCount+1),this._moves.push(coordinates),this},MoveTracer.prototype.getMoves=function(limit){return this._moves.slice(0,limit>0?limit:this._moves.length)},MoveTracer.prototype.getDirection=function(coordinates){coordinates&&this.addMove(coordinates);var movedX=0,movedY=0,moves=this.getMoves();return moves.forEach(function(coordinates,index){index>0&&(movedX+=Math.abs(coordinates.x-moves[index-1].x),movedY+=Math.abs(coordinates.y-moves[index-1].y))}),movedX>movedY?this._lastDirection=Orientations.HORIZONTAL:movedY>movedX&&(this._lastDirection=Orientations.VERTICAL),this._lastDirection},MoveTracer}()},{"../../enums/Orientations.js":356,lodash:161}],254:[function(_dereq_,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function extractPaddingData(style){var _ref;return _ref={},_defineProperty(_ref,_Properties2.default.PADDING_TOP,parseInt(style[_Properties2.default.PADDING_TOP])||0),_defineProperty(_ref,_Properties2.default.PADDING_RIGHT,parseInt(style[_Properties2.default.PADDING_RIGHT])||0),_defineProperty(_ref,_Properties2.default.PADDING_BOTTOM,parseInt(style[_Properties2.default.PADDING_BOTTOM])||0),_defineProperty(_ref,_Properties2.default.PADDING_LEFT,parseInt(style[_Properties2.default.PADDING_LEFT])||0),_ref}Object.defineProperty(exports,"__esModule",{value:!0}),exports.extractPaddingData=extractPaddingData;var _Properties=_dereq_("../../enums/Properties"),_Properties2=_interopRequireDefault(_Properties)},{"../../enums/Properties":358}],255:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Properties=_dereq_("../../enums/Properties.js"),ElementTypes=_dereq_("../../enums/ElementTypes.js"),Events=_dereq_("../../enums/Events.js"),Tree=_dereq_("../../utils/Tree.js");module.exports=function(){function isEmptyGroup(element){return element.isGroup()&&element.type!==ElementTypes.CANVAS&&!element.storedElements.length}function updateActions(elementDeleted,elements){elementDeleted.isVirtualGroup()||_.forEach(elements,function(element){var changed=!1,actions=_.reduce(_.cloneDeep(element.actions),function(actions,action){var index=_.isArray(action.elements)?action.elements.indexOf(elementDeleted.id):-1;return index>-1&&(action.elements.splice(index,1),changed=!0),index!==-1&&_.isEmpty(action.elements)||actions.push(action),actions},[]);changed&&element._updateProperty(Properties.ACTIONS,actions,!0)})}function DeleteElements(elements,onMultistateStateRemoval){_.forEach(elements,function(element){if(element.Page.ElementsManager.cantRemoveElement(element))return void element.Page.emit(Events.CANT_DELETE_ELEMENT);var parent=element.parent;onMultistateStateRemoval||parent.removeChild(element),element.Page.ElementsManager.removeElement(element),element.isGroup()&&_.forEach(Tree.GetAllDescendants(element),function(descendant){descendant.Page.ElementsManager.removeElement(descendant)}),!onMultistateStateRemoval&&RemoveHelper.isEmptyGroup(parent)&&DeleteElements([parent])})}var RemoveHelper={isEmptyGroup:isEmptyGroup,updateActions:updateActions,DeleteElements:DeleteElements};return RemoveHelper}()},{"../../enums/ElementTypes.js":346,"../../enums/Events.js":347,"../../enums/Properties.js":358,"../../utils/Tree.js":419,lodash:161}],256:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),ArrangeHelper=_dereq_("./ArrangeHelper.js"),BrowserHelper=_dereq_("./BrowserHelper"),ElementTypes=_dereq_("../../enums/ElementTypes.js"),Properties=_dereq_("../../enums/Properties.js"),Events=_dereq_("../../enums/Events.js"),RemoveHelper=_dereq_("./RemoveHelper.js");module.exports=function(){function addMultistateNameSuffix(name){return name+MULTISTATE_NAME_SUFFIX}function removeMultistateNameSuffix(name){return name.replace(new RegExp(RegExp.quote(MULTISTATE_NAME_SUFFIX)+"$"),"")}function convertMultistateToGroup(multistate){var group,serialized=multistate.serialize(),properties=_.omit(serialized.props,[Properties.STORED_ELEMENTS,Properties.MULTISTATE_ORIGIN]),elements=_.clone(multistate.children),map={};return multistate.removeAllChildren(),properties[Properties.NAME]=removeMultistateNameSuffix(properties[Properties.NAME]),properties[Properties.MULTISTATE_ORIGIN]=ElementTypes.GROUP,group=multistate.Page.ElementsManager.createElement(ElementTypes.GROUP,properties),group.addChildren(elements),map[multistate.id]=group.id,multistate.parent.replaceChild(group,multistate),multistate.Page.ElementsManager.translateIds(map),multistate.Page.ElementsManager.removeElement(multistate),group}function extractElementsFromGroup(element){var child,parent=element.parent,index=parent.getChildIndex(element),children=_.clone(element.children);parent._remove(element,index);for(var i=element.children.length;i-- >0;)child=element.children[i],element._remove(child,element.getChildIndex(child)),parent._add(child,index),element.isClip&&(child.isGroup()&&child.updateChildren(),child.dirty=!0);return element.resetIndicators(),parent.Page.ElementsManager.removeElement(element),parent.dirty=!0,children}function CanDeleteAllElements(elements){return _.every(elements,function(element){return!element.Page.ElementsManager.cantRemoveElement(element)})}function Group(elements){var group,lastElement=_.last(elements),parent=lastElement.parent,index=parent.getChildIndex(lastElement);return ArrangeHelper.ZSortSelectedElements(elements,!1),parent.Page.ElementsManager.startBatch(),group=parent.Page.ElementsManager.createElement(ElementTypes.GROUP,{}),parent.addChildAt(group,index),_.forEach(elements,function(element){element.parent.removeChild(element)}),group.addChildren(elements),parent.Page.ElementsManager.endBatch(),isSafari&&group.update(),group}function Ungroup(element){var ungroupedElements,parent=element.parent;return parent.Page.ElementsManager.startBatch(),ungroupedElements=extractElementsFromGroup(element),parent.Page.ElementsManager.endBatch(),ungroupedElements}function Delete(elements){var elementsManager=_.last(elements).Page.ElementsManager;elementsManager.startBatch(),RemoveHelper.DeleteElements(elements),elementsManager.endBatch()}function emitCantCreateComponent(Page){var symbolsEnabled=!!Page.options.symbolsEnabled,name=symbolsEnabled?"Symbol":"Smart Element";Page.emit(Events.CANT_DELETE_ELEMENT,{header:"Cannot create "+name,content:"You cannot create "+name+" while somebody is editing element inside."})}function CreateComponent(name,elements,x,y){return new Promise(function(resolve,reject){var component,parent=_.last(elements).parent,index=parent.getChildIndex(_.last(elements));return CanDeleteAllElements(elements)?(ArrangeHelper.ZSortSelectedElements(elements,!1),void parent.Page.ElementsManager.createComponent(name,elements).then(function(componentId){var symbolsEnabled=!!parent.Page.options.symbolsEnabled;parent.Page.ElementsManager.startBatch(),component=parent.Page.ElementsManager.createElement(ElementTypes.COMPONENT,{idComponent:componentId,x:x,y:y,label:symbolsEnabled?"Symbol":"Component"}),parent.Page.emit(Events.COMPONENT_ADDED,componentId),parent.addChildAt(component,index),RemoveHelper.DeleteElements(elements),parent.Page.ElementsManager.endBatch(),resolve(component)}).catch(function(){emitCantCreateComponent(parent.Page),reject()})):(emitCantCreateComponent(parent.Page),reject())})}function CreateMultistate(elements,stateName){var multistate,lastElement=_.last(elements),parent=lastElement.parent,index=parent.getChildIndex(lastElement);return ArrangeHelper.ZSortSelectedElements(elements,!1),parent.Page.ElementsManager.startBatch(),_.forEach(elements,function(element){element.parent.removeChild(element)}),multistate=parent.Page.ElementsManager.createMultistate(elements,stateName),parent.addChildAt(multistate,index),parent.Page.ElementsManager.endBatch(),isSafari&&multistate.update(),multistate}function ConvertToMultistate(group,stateName){var multistate,serialized=group.serialize(),properties=_.omit(serialized.props,Properties.STORED_ELEMENTS),elements=_.clone(group.children),map={};return group.Page.ElementsManager.startBatch(),group.removeAllChildren(),properties[Properties.NAME]=addMultistateNameSuffix(properties[Properties.NAME]),properties[Properties.MULTISTATE_ORIGIN]=ElementTypes.GROUP,multistate=group.Page.ElementsManager.createMultistate(elements,stateName,properties),map[group.id]=multistate.id,group.parent.replaceChild(multistate,group),group.Page.ElementsManager.translateIds(map),group.Page.ElementsManager.removeElement(group),group.Page.ElementsManager.endBatch(),isSafari&&multistate.update(),multistate}function CreateOrConvertToMultistate(elements,stateName){return 1===elements.length&&elements[0].isGroup()&&!elements[0].isVirtualGroup()?ConvertToMultistate(elements[0],stateName):(1===elements.length&&elements[0].isVirtualGroup()&&(elements=elements[0].children),CreateMultistate(elements,stateName))}function ConvertFromMultistate(multistate){return!(!multistate.isMultistate()||multistate.getStatesCount()>1)&&(multistate.isCreatedFromGroup()?[convertMultistateToGroup(multistate)]:extractElementsFromGroup(multistate))}var isSafari=BrowserHelper.isSafari(),MULTISTATE_NAME_SUFFIX=" - Multistate",SelectionHelper={Group:Group,Ungroup:Ungroup,Delete:Delete,CreateComponent:CreateComponent,CreateMultistate:CreateMultistate,ConvertToMultistate:ConvertToMultistate,CreateOrConvertToMultistate:CreateOrConvertToMultistate,ConvertFromMultistate:ConvertFromMultistate};return SelectionHelper}()},{"../../enums/ElementTypes.js":346,"../../enums/Events.js":347,"../../enums/Properties.js":358,"./ArrangeHelper.js":242,"./BrowserHelper":245,"./RemoveHelper.js":255,lodash:161}],257:[function(_dereq_,module,exports){"use strict";function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}return Array.from(arr)}var EventEmitter=_dereq_("event-emitter"),Events=_dereq_("../../enums/Events.js"),Orientations=_dereq_("../../enums/Orientations.js"),Properties=_dereq_("../../enums/Properties.js"),Tree=_dereq_("../../utils/Tree.js");module.exports=function(){function emitGuideShow(axis,value){emitter.emit(Events.SNAPPING_GUIDE_SHOW,{axis:axis===xAxis?Properties.X:Properties.Y,value:value})}function emitGuideHide(axis){emitter.emit(Events.SNAPPING_GUIDE_HIDE,{axis:axis===xAxis?Properties.X:Properties.Y})}function getSnappedValue(value,axis){for(var len=elementValues.length,snappedValue=void 0,i=0;i<=5;i++)for(var j=0;j<len;j++){if(snappedValue=elementValues[j],axis[snappedValue-i])return emitGuideShow(axis,snappedValue-i),Math.round(value)-i;if(axis[snappedValue+i])return emitGuideShow(axis,snappedValue+i),Math.round(value)+i}return emitGuideHide(axis),value}function getSelectedElements(element){return element.isVirtualGroup()?Tree.GetAllDescendants(element):element.isGroup()?[element].concat(_toConsumableArray(Tree.GetAllDescendants(element))):[element]}function PrepareData(elementBoundingBox,elements,guides,selectedElement,canvasBoundingBox,gridOptions){var selectedElements=getSelectedElements(selectedElement),element=void 0,bb=void 0,i=void 0,l=void 0,columns=void 0,x=void 0;for(xAxis=[],yAxis=[],boundingBox=elementBoundingBox,i=0,l=guides.length;i<l;i++)guides[i].orientation===Orientations.HORIZONTAL?yAxis[guides[i].getPosition()]=!0:xAxis[guides[i].getPosition()]=!0;if(gridOptions.gridDisplay&&gridOptions.gridColumnWidth>0)for(columns=Math.ceil((gridOptions.gridWidth-2*gridOptions.gridMargin)/(gridOptions.gridColumnWidth+gridOptions.gridGutter)),i=0,l=columns;i<l;i++)x=gridOptions.gridMargin+i*(gridOptions.gridColumnWidth+gridOptions.gridGutter),xAxis[x]=!0,x+gridOptions.gridColumnWidth<=gridOptions.gridWidth&&(xAxis[x+gridOptions.gridColumnWidth]=!0);xAxis[canvasBoundingBox.left]=!0,xAxis[canvasBoundingBox.center]=!0,xAxis[canvasBoundingBox.right]=!0,yAxis[canvasBoundingBox.top]=!0,yAxis[canvasBoundingBox.middle]=!0,yAxis[canvasBoundingBox.bottom]=!0;for(i in elements)if(elements.hasOwnProperty(i)){if(element=elements[i],selectedElements.indexOf(element)>-1)continue;bb=element.getBoundingBox(!0),xAxis[Math.round(bb.left)]=!0,xAxis[Math.round(bb.center)]=!0,xAxis[Math.round(bb.right)]=!0,yAxis[Math.round(bb.top)]=!0,yAxis[Math.round(bb.middle)]=!0,yAxis[Math.round(bb.bottom)]=!0}}function GetSnappedX(x){var minX,maxX;return boundingBox.x=x,minX=boundingBox.getMinX(),maxX=boundingBox.getMaxX(),elementValues[0]=Math.round(minX),elementValues[1]=Math.round(minX+(maxX-minX)/2),elementValues[2]=Math.round(maxX),getSnappedValue(x,xAxis)}function GetSnappedY(y){var minY,maxY;return boundingBox.y=y,minY=boundingBox.getMinY(),maxY=boundingBox.getMaxY(),elementValues[0]=Math.round(minY),elementValues[1]=Math.round(minY+(maxY-minY)/2),elementValues[2]=Math.round(maxY),getSnappedValue(y,yAxis)}var xAxis=null,yAxis=null,boundingBox=null,elementValues=[],emitter=new EventEmitter;return{PrepareData:PrepareData,GetSnappedX:GetSnappedX,GetSnappedY:GetSnappedY,AddListener:emitter.on.bind(emitter),RemoveListener:emitter.off.bind(emitter)}}()},{"../../enums/Events.js":347,"../../enums/Orientations.js":356,"../../enums/Properties.js":358,"../../utils/Tree.js":419,"event-emitter":98}],258:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash");module.exports=function(){function generateSymbols(length){var symbol,alphabet="ABCDEFGHIJKLMNOPQRSTUWXYZ";if(length=length||1/0,symbolsCached.length<length)for(var i=symbolsCached.length;i<length;i++){if(i<alphabet.length)symbol=alphabet[i];else{if(!alphabet[Math.floor(i/alphabet.length)-1])break;symbol=alphabet[Math.floor(i/alphabet.length)-1]+alphabet[i%alphabet.length]}symbolsCached.push(symbol)}return symbolsCached}function GetColumnSymbol(index){return generateSymbols(index+1)[index]}function GetCellCoordinates(row,column){return GetColumnSymbol(column)+row.toString()}function GetAllCellsCoordinates(table){var coordinates=[],rowsCount=table.length,columnsCount=GetColumnsCount(table);generateSymbols(rowsCount*columnsCount);for(var rowIndex=0;rowIndex<rowsCount;rowIndex++)for(var columnIndex=0;columnIndex<columnsCount;columnIndex++)coordinates.push(GetCellCoordinates(rowIndex,columnIndex));return coordinates}function GetColumnsCount(table){return _.reduce(table,function(count,columns){return count<columns.length?columns.length:count},0)}function GetRowIndex(coordinates){return parseInt(coordinates.replace(/[A-Z]+/g,""))}function GetColumnIndex(coordinates){for(var columnSymbol=coordinates.replace(/\d+/g,""),allSymbols=generateSymbols(),allSymbolsLength=allSymbols.length,index=0;allSymbols[index]!==columnSymbol&&index+1<allSymbolsLength;)index++;return index}function IsEvenRow(coordinates){return GetRowIndex(coordinates)%2===0}function IsOddRow(coordinates){return GetRowIndex(coordinates)%2===1}var symbolsCached=[],TableHelper={GetColumnSymbol:GetColumnSymbol,GetCellCoordinates:GetCellCoordinates,GetAllCellsCoordinates:GetAllCellsCoordinates,GetColumnsCount:GetColumnsCount,GetRowIndex:GetRowIndex,GetColumnIndex:GetColumnIndex,IsEvenRow:IsEvenRow,IsOddRow:IsOddRow};return TableHelper}()},{lodash:161}],259:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),DomHelper=_dereq_("../../utils/DomHelper.js"),Styles=_dereq_("../../enums/Styles.js");module.exports=function(){function appendToCanvasHelper(element){var canvasHelper=_getCanvasHelper();canvasHelper.appendChild(element)}function calcNoteTextElementMaxHeight(noteTitleElement){return _calcNoteMaxHeight()-noteTitleElement.clientHeight}function calcNoteWidth(domElement){var availableSpace=_calcAvailableSpace(domElement);return availableSpace.right<NOTE.MIN_WIDTH||availableSpace.right>NOTE.MAX_WIDTH?NOTE.MAX_WIDTH:availableSpace.right}function calcNotePosition(domElement,noteElement,isFixed){var canvasContainer=_getCanvasContainer(),canvasWrapper=_getCanvasWrapper(),domElementData=_getElementData(domElement),position={x:_calcNotePositionX(domElementData)-canvasContainer.scrollLeft,y:_calcNotePositionY(domElementData,noteElement)-canvasContainer.scrollTop};return isFixed&&(position.x+=parseInt(_getComputedStyle(Styles.LEFT,domElement))-canvasWrapper.scrollLeft,position.y+=parseInt(_getComputedStyle(Styles.TOP,domElement))-canvasWrapper.scrollTop),
position}function _getElementData(element){return{element:element,position:_calcPositionOnCanvas(element),availableSpace:_calcAvailableSpace(element)}}function _calcAvailableSpace(domElement){var canvasWrapperRect,domElementRect,canvasWrapper=_getCanvasWrapper();return _.isNull(canvasWrapper)?{right:1/0,bottom:1/0}:(canvasWrapperRect=canvasWrapper.getBoundingClientRect(),domElementRect=domElement.getBoundingClientRect(),{right:canvasWrapperRect.left+canvasWrapper.clientWidth-domElementRect.left-domElementRect.width-2*NOTE.MARGIN,bottom:canvasWrapperRect.top+canvasWrapper.clientHeight-domElementRect.top-domElementRect.height-NOTE.MARGIN})}function _calcNotePositionX(domElementData){return _shouldDisplayNoteOnLeft(domElementData)?_calcLeftNotePosition(domElementData):_calcRightNotePosition(domElementData)}function _calcNotePositionY(domElementData,noteElement){return _shouldDisplayNoteOnTop(domElementData,noteElement)?_calcTopNotePosition(domElementData,noteElement):_calcBottomNotePosition(domElementData)}function _shouldDisplayNoteOnLeft(domElementData){return domElementData.availableSpace.right<=NOTE.MIN_WIDTH}function _shouldDisplayNoteOnTop(domElementData,noteElement){return domElementData.availableSpace.bottom+domElementData.element.clientHeight<noteElement.clientHeight}function _calcRightNotePosition(domElementData){return domElementData.position.x+parseInt(_getComputedStyle(Styles.WIDTH,domElementData.element))}function _calcLeftNotePosition(domElementData){var noteElementWidth=calcNoteWidth(domElementData.element);return domElementData.position.x-noteElementWidth-2*NOTE.MARGIN}function _calcTopNotePosition(domElementData,noteElement){var domElementPosition=domElementData.position,availableSpaceOnBottom=domElementData.availableSpace.bottom,domElementHeight=domElementData.element.clientHeight,noteElementHeight=_calcNoteElementHeight(noteElement);return domElementPosition.y>NOTE.MARGIN?domElementPosition.y-(noteElementHeight-availableSpaceOnBottom-domElementHeight):NOTE.MARGIN}function _calcBottomNotePosition(domElementData){return domElementData.position.y>NOTE.MARGIN?domElementData.position.y:NOTE.MARGIN}function _calcNoteMaxHeight(){var canvasWrapper=_getCanvasWrapper();return _.isNull(canvasWrapper)?1/0:canvasWrapper.clientHeight-2*NOTE.MARGIN}function _calcNoteElementHeight(noteElement){var canvasWrapper=_getCanvasWrapper();return _.isNull(canvasWrapper)?noteElement.clientHeight:canvasWrapper.clientHeight<noteElement.clientHeight+2*NOTE.MARGIN?_calcNoteMaxHeight():noteElement.clientHeight}function _calcPositionOnCanvas(element){var canvas=_getCanvas(),canvasRect=canvas.getBoundingClientRect(),elementRect=element.getBoundingClientRect();return{x:elementRect.left-canvasRect.left,y:elementRect.top-canvasRect.top}}function _getComputedStyle(property,element){return window.getComputedStyle(element).getPropertyValue(property)}var SELECTORS={CANVAS:".ng-canvas",CANVAS_CONTAINER:".ng-canvas-container",CANVAS_WRAPPER:"#canvas-wrapper",CANVAS_HELPER:".ng-canvas-helper"},NOTE={MIN_WIDTH:200,MAX_WIDTH:240,MARGIN:20},_getCanvas=DomHelper.elementGetter(SELECTORS.CANVAS),_getCanvasContainer=DomHelper.elementGetter(SELECTORS.CANVAS_CONTAINER),_getCanvasWrapper=DomHelper.elementGetter(SELECTORS.CANVAS_WRAPPER),_getCanvasHelper=DomHelper.elementGetter(SELECTORS.CANVAS_HELPER),TagViewHelper={appendToCanvasHelper:appendToCanvasHelper,calcNoteTextElementMaxHeight:calcNoteTextElementMaxHeight,calcNoteWidth:calcNoteWidth,calcNotePosition:calcNotePosition};return TagViewHelper}()},{"../../enums/Styles.js":361,"../../utils/DomHelper.js":410,lodash:161}],260:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),BrowserHelper=_dereq_("./BrowserHelper"),EventEmitter=_dereq_("event-emitter"),Events=_dereq_("../../enums/Events.js"),Styles=_dereq_("../../enums/Styles.js"),Keys=_dereq_("../../enums/Keys.js"),Properties=_dereq_("../../enums/Properties.js"),Parse=_dereq_("../../utils/Parse.js"),TextStyleHelper=_dereq_("./TextStyleHelper.js");module.exports=function(){function disableKeystrokes(){CKEDITOR.config.keystrokes=[[CKEDITOR.CTRL+66,null],[CKEDITOR.CTRL+73,null],[CKEDITOR.CTRL+85,null]]}function enableKeystrokes(){CKEDITOR.config.keystrokes=[[CKEDITOR.CTRL+66,BOLD],[CKEDITOR.CTRL+73,ITALIC],[CKEDITOR.CTRL+85,UNDERLINE]]}function applyStyle(styleFunction,element,value){var instance=getInstance(element),shouldSelectAll=!isEditingElement(element),focusedElement=document.activeElement;return shouldSelectAll?(element.setEditing(!0),selectAll(null,instance),styleFunction.call(null,instance,value),deselect(instance),element.setEditing(!1),focusedElement&&_.isFunction(focusedElement.focus)&&focusedElement.focus()):styleFunction.call(null,instance,value),element.shouldUpdateHeight=!0,getContentData(instance)}function applyText(text,element){var instance=getInstance(element),shouldSelectAll=!isEditingElement(element);return shouldSelectAll?(element.setEditing(!0),selectAll(null,instance),instance.insertText(text),deselect(instance),element.setEditing(!1)):instance.insertText(text),element.shouldUpdateHeight=!0,getContentData(instance)}function applyTextStylesToList(listElement,styles){_.forEach(styles,function(styleValue,styleKey){"fontFamilyClass"===styleKey&&styleValue?(listElement.classList.remove(getFontClassName(listElement)),listElement.classList.add(styleValue)):listElement.style[styleKey]=styleValue})}function refreshListStyles(instance){var elementStyles,parentListElement;_.forEach(getSelection(instance),function(element){parentListElement=element.closest("li"),parentListElement&&(elementStyles=getStylesForListElement(element),applyTextStylesToList(parentListElement,elementStyles))})}function selectAll(e,instance){var range=instance.createRange();range.selectNodeContents(instance.editable()),range.shrink(2,!0),range.select()}function deselect(instance){instance&&instance.getSelection().removeAllRanges()}function isEditingElement(element){return element===editingElement}function isTextNode(node){return 3===node.nodeType}function hasTextChildNode(node){return _.some(node.childNodes,isTextNode)}function getInstance(element){return editorInstances[element.id]}function getInstancePromise(element){return new Promise(function(resolve){var onCreated=function onCreated(){var instance=getInstance(element);instance&&(emitter.off(INSIDE_EVENTS.INSTANCE_CREATED,onCreated),resolve(instance))};getInstance(element)?onCreated():(emitter.on(INSIDE_EVENTS.INSTANCE_CREATED,onCreated),editorInstancesInitiated[element.id]||Init(element))})}function getContentData(instance){return{content:instance.element.$.innerHTML,height:parseInt(getElementStyle(instance.container.$,Properties.HEIGHT))}}function strip(html){var container=document.createElement("div");return container.appendChild(document.createTextNode(html)),container.textContent||""}function highlight(element){emitter.emit(Events.TEXT_SELECTION_CHANGED,getTextFormat(element))}function onPaste(e){e.data.type="text",e.data.dataValue=strip(e.data.dataValue)}function isSelectionEmpty(instance,isEditingElement){return!instance.getSelection().getSelectedText()&&isEditingElement}function getSelectedNodes(selection){var crawler,node,range=selection.getRanges()[0],start=range.startContainer.$,end=range.endContainer.$,nodes=[];if(start===end)nodes.push(start);else for(crawler=new CKEDITOR.dom.walker(range);null!==(node=crawler.next());)nodes.push(node.$);return _.unique(_.reduce(nodes,function(selectedNodes,node){return isTextNode(node)?selectedNodes.concat(node.parentNode):hasTextChildNode(node)?selectedNodes.concat(node):selectedNodes.concat(_.filter(node.querySelectorAll("*"),hasTextChildNode))},[]))}function getSelection(instance,element){var textElements,selection=instance?instance.getSelection(!0):null;return selection&&!_.isEmpty(selection.getRanges())?getSelectedNodes(selection):element?(textElements=_.filter(element.view.getEditableElement().querySelectorAll("*"),hasTextChildNode),0===textElements.length&&hasTextChildNode(element.view.getEditableElement())&&(textElements=[element.view.getEditableElement()]),textElements):null}function onSelectionChange(e){highlight(getSelection(e.editor))}function onBeforeCommandExec(e){isSelectionEmpty(e.editor)&&_.contains([BOLD,ITALIC,UNDERLINE,STRIKE],e.data.name)&&e.cancel()}function onChange(){editingElement.shouldUpdateHeight=!0}function onKeyDown(instance,element,e){var cmdKey=e.metaKey||e.ctrlKey;e.which===Keys.EQUALS&&cmdKey?(e.preventDefault(),increaseFontSize(instance,element)):e.which===Keys.DASH&&cmdKey&&(e.preventDefault(),decreaseFontSize(instance,element))}function increaseFontSize(instance,element){var size=parseInt(getFontSize(getSelection(instance))),sizeNew=size+1;selectAll(null,instance),setFontSize(instance,sizeNew),TextStyleHelper.SetDefaultTextStyle(element.Page.getProjectId(),Properties.FONT_SIZE,sizeNew),editingElement.shouldUpdateHeight=!0}function decreaseFontSize(instance,element){var size=parseInt(getFontSize(getSelection(instance))),sizeNew=size>1?size-1:1;selectAll(null,instance),setFontSize(instance,sizeNew),TextStyleHelper.SetDefaultTextStyle(element.Page.getProjectId(),Properties.FONT_SIZE,sizeNew),editingElement.shouldUpdateHeight=!0}function getElementStyle(element,property){return element?window.getComputedStyle(element).getPropertyValue(property):""}function getStyle(elements,property){return _.reduce(_.rest(elements),function(reduced,element){return reduced===getElementStyle(element,property)?reduced:""},getElementStyle(_.first(elements),property))}function hasStyle(elements,property,value){return getStyle(elements,property)===value}function getAlign(elements,defaultValue){return elements.length?getStyle(elements,Styles.TEXT_ALIGN):defaultValue}function getList(elements){return _.forEach(elements,function(element,index){"LI"===element.nodeName&&(elements[index]=element.parentNode)}),TextStyleHelper.GetListTypeFromStyle(getStyle(elements,Styles.LIST_STYLE))}function getListIndentation(element){var instance=getInstance(element);return{isIndentAllowed:!(!instance||!isEditingElement(element))&&instance.getCommand("indent").state===CKEDITOR.TRISTATE_OFF,isOutdentAllowed:!(!instance||!isEditingElement(element))&&instance.getCommand("outdent").state===CKEDITOR.TRISTATE_OFF}}function getBackgroundColor(elements){return getStyle(elements,Styles.BACKGROUND_COLOR)}function getColor(elements,defaultValue){return elements.length?getStyle(elements,Styles.COLOR):defaultValue}function getFont(elements,defaultValue){return elements.length?getStyle(elements,Styles.FONT_FAMILY).replace(/"/g,""):defaultValue}function getFontClassName(element){return _.find(element.classList,function(className){return _.startsWith(className,TextStyleHelper.FONT_PREFIX)})}function getFontSize(elements,defaultValue){return elements.length?getStyle(elements,Styles.FONT_SIZE):defaultValue}function getLetterSpacing(elements){return getStyle(elements,Styles.LETTER_SPACING)}function getMainSpanProperty(element,property){for(var mainSpanProperty,spanProperty;element&&("SPAN"===element.nodeName||"P"===element.nodeName);)spanProperty=_.isFunction(property)?property.call(this,element):element.style[property],spanProperty&&(mainSpanProperty=spanProperty),element=element.parentNode;return mainSpanProperty}function getStylesForListElement(element){return{"font-size":getMainSpanProperty(element,Styles.FONT_SIZE),"line-height":getMainSpanProperty(element,Styles.LINE_HEIGHT),color:getMainSpanProperty(element,Styles.COLOR),fontFamilyClass:getMainSpanProperty(element,getFontClassName)||""}}function safariParseBrokenContent(content){return content=content.replace(/(<ul>|<ol>)(<br>)+(<\/ul>|<\/ol>)/g,""),content=content.replace(/((<br>)+<\/li>(<br>)*|(<br>)*<\/li>(<br>)+)/g,"</li>")}function getLineHeightForElement(element){for(;element&&"P"!==element.tagName&&"LI"!==element.tagName;)element=element.parentNode;return element?element.style.getPropertyValue(Styles.LINE_HEIGHT):""}function getLineHeight(elements){var lineHeight=getLineHeightForElement(_.first(elements)),everyElementsHasSameLineHeight=_.every(_.rest(elements),function(element){return lineHeight===getLineHeightForElement(element)});return everyElementsHasSameLineHeight?lineHeight||"normal":""}function isBold(elements,defaultValue){return elements.length?hasStyle(elements,Styles.FONT_WEIGHT,BOLD):defaultValue}function isItalic(elements,defaultValue){return elements.length?hasStyle(elements,Styles.FONT_STYLE,ITALIC):defaultValue}function isUnderline(elements,defaultValue){return elements.length?hasStyle(elements,Styles.TEXT_DECORATION,UNDERLINE):defaultValue}function isLineThrough(elements,defaultValue){return elements.length?hasStyle(elements,Styles.TEXT_DECORATION,LINE_THROUGH):defaultValue}function getTextTransform(elements){var textTransform=getStyle(elements,Styles.TEXT_TRANSFORM),fontVariant=getStyle(elements,Styles.FONT_VARIANT);return TEXT_TRANSFORMS.indexOf(textTransform)>-1?textTransform:fontVariant===FONT_VARIANT_SMALL_CAPS?fontVariant:""}function isLink(element){for(;element&&"P"!==element.tagName;){if("A"===element.tagName)return!0;element=element.parentElement}return!1}function getTextFormat(element){return{align:getAlign(element),backgroundColor:getBackgroundColor(element),color:getColor(element),font:getFont(element),fontSize:getFontSize(element),lineHeight:getLineHeight(element),bold:isBold(element),italic:isItalic(element),underline:isUnderline(element),lineThrough:isLineThrough(element),link:isLink(element)}}function setAlign(instance,value){instance.execCommand(ALIGN_MAP[value])}function setBackgroundColor(instance,value){instance.applyStyle(new CKEDITOR.style(BACKGROUND_COLOR_CONFIG,{color:value}))}function setColor(instance,value){instance.applyStyle(new CKEDITOR.style(COLOR_CONFIG,{color:value})),refreshListStyles(instance)}function setFont(instance,value){instance.applyStyle(new CKEDITOR.style(FONT_CONFIG,{font:value})),refreshListStyles(instance)}function setFontSize(instance,value){instance.applyStyle(new CKEDITOR.style(SIZE_CONFIG,{size:Parse.toPx(value)})),refreshListStyles(instance)}function setLineHeight(instance,value){var alignClass=getAlign(getSelection(instance));instance.applyStyle(new CKEDITOR.style(LINE_HEIGHT_CONFIG,{height:value})),setAlign(instance,alignClass),refreshListStyles(instance)}function setLetterSpacing(instance,value){instance.applyStyle(new CKEDITOR.style(LETTER_SPACING_CONFIG,{spacing:value}))}function setBold(instance){instance.execCommand(BOLD)}function setItalic(instance){instance.execCommand(ITALIC)}function setUnderline(instance){instance.execCommand(UNDERLINE)}function setLineThrough(instance){instance.execCommand(STRIKE)}function setTextTransform(instance,value){instance.applyStyle(new CKEDITOR.style(TEXT_TRANSFORM_CONFIG,{transform:value})),instance.applyStyle(new CKEDITOR.style(FONT_VARIANT_CONFIG,{variant:FONT_VARIANT_NORMAL}))}function unsetTextTransformAndFontVariant(instance){instance.applyStyle(new CKEDITOR.style(TEXT_TRANSFORM_CONFIG,{transform:TEXT_TRANSFORM_NONE})),instance.applyStyle(new CKEDITOR.style(FONT_VARIANT_CONFIG,{variant:FONT_VARIANT_NORMAL}))}function setFontVariant(instance,value){instance.applyStyle(new CKEDITOR.style(FONT_VARIANT_CONFIG,{variant:value})),instance.applyStyle(new CKEDITOR.style(TEXT_TRANSFORM_CONFIG,{transform:TEXT_TRANSFORM_NONE}))}function setLink(instance,value){instance.applyStyle(new CKEDITOR.style(ANCHOR_CONFIG,{href:value}))}function setList(instance,value){instance.execCommand(value),refreshListStyles(instance)}function setListIndentation(instance,value){instance.execCommand(value)}function unsetLink(instance){instance.removeStyle(new CKEDITOR.style(ANCHOR_CONFIG))}function addEvents(instance,element){eventRefs[KEYDOWN]=onKeyDown.bind(null,instance,element),instance.on(ON_PASTE,onPaste),instance.on(ON_SELECTION_CHANGE,onSelectionChange),instance.on(ON_BEFORE_COMMAND_EXEC,onBeforeCommandExec),instance.on(CHANGE,onChange),document.addEventListener(KEYDOWN,eventRefs[KEYDOWN])}function removeEvents(instance){instance.removeListener(ON_PASTE,onPaste),instance.removeListener(ON_SELECTION_CHANGE,onSelectionChange),instance.removeListener(ON_BEFORE_COMMAND_EXEC,onBeforeCommandExec),instance.removeListener(CHANGE,onChange),document.removeEventListener(KEYDOWN,eventRefs[KEYDOWN])}function Destroy(element){var instance=getInstance(element);instance&&(window.getSelection().removeAllRanges(),instance.destroy(),delete editorInstances[element.id]),delete editorInstancesInitiated[element.id]}function Init(element){var elementEditor=CKEDITOR.instances[element.view.getEditableElementId()];return editorInstancesInitiated[element.id]=!0,elementEditor&&elementEditor.destroy(!0),CKEDITOR.inline(element.view.getEditableElementId())}function UpdateInstances(page){_.forEach(editorInstances,function(instance,instanceId){var element=page.ElementsManager.getElementById(instanceId),elementEditor=element&&CKEDITOR.instances[element.view.getEditableElementId()];!elementEditor&&element&&(editorInstances[element.id].destroy(!0),delete editorInstances[element.id],editorInstancesInitiated[element.id]=!1)})}function Edit(element,onEditReady){element.setEditing(!0),getInstancePromise(element).then(function(instance){return GetEditingElement(element)?instance:(element.Page.emit(Events.TEXT_EDITION_STARTED),instance.focus(),selectAll(null,instance),addEvents(instance,element),editingElement=element,element.isRichTextEditable()?(TextStyleHelper.UseDefaultStyleInRichTextElement(element),enableKeystrokes()):disableKeystrokes(),onEditReady(),instance)})}function FinishEditing(){var instance=getInstance(editingElement),contentData=getContentData(instance),content=contentData.content;deselect(instance),removeEvents(instance),editingElement.setEditing(!1),isSafari&&(content=safariParseBrokenContent(content),editingElement.view.setInputValue(content),contentData=getContentData(instance)),editingElement.Page.ElementsManager.startBatch(),editingElement.adjustHeightToText()&&editingElement._updateProperty(Properties.HEIGHT,contentData.height,!0),editingElement._updateProperty(Properties.INPUT_VALUE,content,!0),editingElement.Page.ElementsManager.endBatch(),editingElement.Page.emit(Events.TEXT_EDITION_FINISHED),editingElement=null}function GetEditingElement(){return editingElement}function GetAlign(element){var defaultValue=TextStyleHelper.GetLastUsedStyle(element,Properties.TEXT_ALIGN);return getAlign(getSelection(getInstance(element),element),defaultValue)}function SetAlign(element,value){return applyStyle(setAlign,element,value)}function GetBackgroundColor(element){return getBackgroundColor(getSelection(getInstance(element),element))}function SetBackgroundColor(element,value){return!isSelectionEmpty(getInstance(element),isEditingElement(element))&&applyStyle(setBackgroundColor,element,value)}function GetColor(element){var defaultValue=TextStyleHelper.GetLastUsedStyle(element,Properties.COLOR);return getColor(getSelection(getInstance(element),element),defaultValue)}function SetColor(element,value){return applyStyle(setColor,element,value)}function GetFont(element){var defaultValue=TextStyleHelper.GetLastUsedStyle(element,Properties.FONT_FAMILY);return getFont(getSelection(getInstance(element),element),defaultValue)}function SetFont(element,value){return applyStyle(setFont,element,TextStyleHelper.SanitizeFontName(value))}function GetFontSize(element){var defaultValue=TextStyleHelper.GetLastUsedStyle(element,Properties.FONT_SIZE);return getFontSize(getSelection(getInstance(element),element),defaultValue)}function SetFontSize(element,value){return applyStyle(setFontSize,element,value)}function GetLineHeight(element){return getLineHeight(getSelection(getInstance(element),element))}function SetLineHeight(element,value){return applyStyle(setLineHeight,element,value)}function GetLetterSpacing(element){return getLetterSpacing(getSelection(getInstance(element),element))}function SetLetterSpacing(element,value){return applyStyle(setLetterSpacing,element,value)}function GetBold(element,realValue){var defaultValue=TextStyleHelper.GetLastUsedStyle(element,Properties.FONT_WEIGHT)===BOLD;return isBold(getSelection(getInstance(element),element),!realValue&&defaultValue)}function SetBold(element,value){return GetBold(element,!0)!==value&&applyStyle(setBold,element,value)}function GetItalic(element,realValue){var defaultValue=TextStyleHelper.GetLastUsedStyle(element,Properties.FONT_STYLE)===ITALIC;return isItalic(getSelection(getInstance(element),element),!realValue&&defaultValue)}function SetItalic(element,value){return GetItalic(element,!0)!==value&&applyStyle(setItalic,element,value)}function GetUnderline(element,realValue){var defaultValue=TextStyleHelper.GetLastUsedStyle(element,Properties.TEXT_DECORATION)===UNDERLINE;return isUnderline(getSelection(getInstance(element),element),!realValue&&defaultValue)}function SetUnderline(element,value){return GetUnderline(element,!0)!==value&&applyStyle(setUnderline,element,value)}function GetLineThrough(element,realValue){var defaultValue=TextStyleHelper.GetLastUsedStyle(element,Properties.TEXT_DECORATION)===LINE_THROUGH;return isLineThrough(getSelection(getInstance(element),element),!realValue&&defaultValue)}function SetLineThrough(element,value){return GetLineThrough(element,!0)!==value&&applyStyle(setLineThrough,element,value)}function SetTextTransform(element,value){return TEXT_TRANSFORMS.indexOf(value)>-1?applyStyle(setTextTransform,element,value):value===FONT_VARIANT_SMALL_CAPS?applyStyle(setFontVariant,element,value):applyStyle(unsetTextTransformAndFontVariant,element)}function GetTextTransform(element){return getTextTransform(getSelection(getInstance(element),element))}function GetLink(element){return isLink(getSelection(getInstance(element),element))}function SetLink(element,value){return value?!isSelectionEmpty(getInstance(element),isEditingElement(element))&&applyStyle(setLink,element,value):applyStyle(unsetLink,element,value)}function GetList(element){return getList(getSelection(getInstance(element),element))}function SetList(element,value){return applyStyle(setList,element,value)}function GetListIndentation(element){return getListIndentation(element)}function SetListIndentation(element,value){return applyStyle(setListIndentation,element,value)}function GetTextFormat(element){return getTextFormat(getSelection(getInstance(element),element))}function InsertText(element,text){return!!getInstance(element)&&applyText(text,element)}var isSafari=BrowserHelper.isSafari(),CKEDITOR_EVENTS={INSTANCE_READY:"instanceReady"},INSIDE_EVENTS={INSTANCE_CREATED:"instanceCreated"};_.isEmpty(window.CKEDITOR)?window.CKEDITOR={}:(CKEDITOR.disableAutoInline=!0,CKEDITOR.config.allowedContent=!0,CKEDITOR.config.pasteFilter="plain-text",CKEDITOR.config.language="en",CKEDITOR.config.toolbar="Custom",CKEDITOR.config.toolbar_Custom=[],CKEDITOR.dtd.$editable.label=1,CKEDITOR.dtd.$editable.a=1,CKEDITOR.dtd.$editable.button=1,CKEDITOR.dtd.$removeEmpty.label=0,CKEDITOR.config.removePlugins="toolbar,elementspath,resize,link",CKEDITOR.config.extraPlugins="justify",CKEDITOR.config.justifyClasses=[TextStyleHelper.ALIGN_PREFIX+"left",TextStyleHelper.ALIGN_PREFIX+"center",TextStyleHelper.ALIGN_PREFIX+"right",TextStyleHelper.ALIGN_PREFIX+"justify"],CKEDITOR.config.coreStyles_bold={element:"span",attributes:{style:"font-weight: bold;"},overrides:[{element:"strong"},{element:"b"}]},CKEDITOR.config.coreStyles_italic={element:"span",attributes:{style:"font-style: italic;"},overrides:"em"},CKEDITOR.config.coreStyles_underline={element:"span",attributes:{style:"text-decoration: underline;"},overrides:"u"},CKEDITOR.config.coreStyles_strike={element:"span",attributes:{style:"text-decoration: line-through;"},overrides:"strike"},CKEDITOR.on(CKEDITOR_EVENTS.INSTANCE_READY,function(e){var elementId=e.editor.element.$.dataset.id;return editorInstancesInitiated[elementId]?(editorInstances[elementId]=e.editor,void emitter.emit(INSIDE_EVENTS.INSTANCE_CREATED)):void Destroy({id:elementId})}));var ON_PASTE="paste",ON_SELECTION_CHANGE="selectionChange",ON_BEFORE_COMMAND_EXEC="beforeCommandExec",KEYDOWN="keydown",CHANGE="change",BOLD="bold",ITALIC="italic",UNDERLINE="underline",STRIKE="strike",LINE_THROUGH="line-through",JUSTIFY_LEFT="justifyleft",JUSTIFY_CENTER="justifycenter",JUSTIFY_RIGHT="justifyright",JUSTIFY_BLOCK="justifyblock",ALIGN_MAP={left:JUSTIFY_LEFT,center:JUSTIFY_CENTER,right:JUSTIFY_RIGHT,justify:JUSTIFY_BLOCK},FONT_VARIANT_NORMAL="normal",FONT_VARIANT_SMALL_CAPS="small-caps",TEXT_TRANSFORM_CAPITALIZE="capitalize",TEXT_TRANSFORM_LOWERCASE="lowercase",TEXT_TRANSFORM_NONE="none",TEXT_TRANSFORM_UPPERCASE="uppercase",TEXT_TRANSFORMS=[TEXT_TRANSFORM_CAPITALIZE,TEXT_TRANSFORM_LOWERCASE,TEXT_TRANSFORM_UPPERCASE],BACKGROUND_COLOR_CONFIG={element:"span",styles:{"background-color":"#(color)"}},COLOR_CONFIG={element:"span",styles:{color:"#(color)"},overrides:[{element:"font",attributes:{color:/#[\w]{3,6}/}}]},SIZE_CONFIG={element:"span",styles:{"font-size":"#(size)"},overrides:[{element:"span",styles:{"font-size":"/w+/"}}]},FONT_CONFIG={element:"span",attributes:{class:"#(font)"},overrides:[{element:"font",attributes:{face:null}},{element:"span",attributes:{class:new RegExp("("+TextStyleHelper.FONT_TYPE_PREFIX+"\\w+|font-\\w+)")}}]},LINE_HEIGHT_CONFIG={element:"p",attributes:{class:"line-height-fix"},styles:{"line-height":"#(height)"}},LETTER_SPACING_CONFIG={element:"span",styles:{"letter-spacing":"#(spacing)"}},ANCHOR_CONFIG={element:"a",attributes:{href:"#(href)"},type:CKEDITOR.STYLE_INLINE,overrides:"a",alwaysRemoveElement:1},TEXT_TRANSFORM_CONFIG={element:"span",styles:{"text-transform":"#(transform)"},overrides:[{element:"span",styles:{"text-transform":"/w+/"}},{element:"span",styles:{"font-variant":"/[w-]+/"}}]},FONT_VARIANT_CONFIG={element:"span",styles:{"font-variant":"#(variant)"},overrides:[{element:"span",styles:{"font-variant":"/[w-]+/"}},{element:"span",styles:{"text-transform":"/w+/"}}]},editorInstances={},editorInstancesInitiated={},eventRefs={},editingElement=null,emitter=new EventEmitter;return Object.freeze({Init:Init,Destroy:Destroy,Edit:Edit,FinishEditing:FinishEditing,GetEditingElement:GetEditingElement,InsertText:InsertText,UpdateInstances:UpdateInstances,GetTextFormat:GetTextFormat,GetAlign:GetAlign,SetAlign:SetAlign,GetBackgroundColor:GetBackgroundColor,SetBackgroundColor:SetBackgroundColor,GetColor:GetColor,SetColor:SetColor,GetFont:GetFont,SetFont:SetFont,GetFontSize:GetFontSize,SetFontSize:SetFontSize,GetLineHeight:GetLineHeight,SetLineHeight:SetLineHeight,GetLetterSpacing:GetLetterSpacing,SetLetterSpacing:SetLetterSpacing,GetBold:GetBold,SetBold:SetBold,GetItalic:GetItalic,SetItalic:SetItalic,GetUnderline:GetUnderline,SetUnderline:SetUnderline,GetLineThrough:GetLineThrough,SetLineThrough:SetLineThrough,GetList:GetList,SetList:SetList,GetListIndentation:GetListIndentation,SetListIndentation:SetListIndentation,SetTextTransform:SetTextTransform,GetTextTransform:GetTextTransform,GetLink:GetLink,SetLink:SetLink,AddListener:emitter.on.bind(emitter),RemoveListener:emitter.off.bind(emitter)})}()},{"../../enums/Events.js":347,"../../enums/Keys.js":353,"../../enums/Properties.js":358,"../../enums/Styles.js":361,"../../utils/Parse.js":415,"./BrowserHelper":245,"./TextStyleHelper.js":261,"event-emitter":98,lodash:161}],261:[function(_dereq_,module,exports){"use strict";function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var _=_dereq_("lodash"),Base32=_dereq_("base32"),ElementTypes=_dereq_("../../enums/ElementTypes.js"),LocalStorage=_dereq_("../../utils/LocalStorage.js"),Parse=_dereq_("../../utils/Parse.js"),Properties=_dereq_("../../enums/Properties.js"),Styles=_dereq_("../../enums/Styles.js");module.exports=function(){function applyParagraphStyles(element,paragraph,props){props[Properties.TEXT_ALIGN]&&element.type===ElementTypes.TEXT_ELEMENT&&paragraph.classList.add(ALIGN_PREFIX+props[Properties.TEXT_ALIGN]),props[Properties.LINE_HEIGHT]&&(paragraph.style[Styles.LINE_HEIGHT]=props[Properties.LINE_HEIGHT])}function getNewSpan(node){var span=document.createElement("span");return span.appendChild(node),span}function getStyledSpans(node,props){return props[Properties.COLOR]&&(node=getNewSpan(node),node.style[Styles.COLOR]=props[Properties.COLOR]),props[Properties.FONT_FAMILY]&&(node=getNewSpan(node),node.classList.add(SanitizeFontName(props[Properties.FONT_FAMILY]))),props[Properties.FONT_SIZE]&&(node=getNewSpan(node),node.style[Styles.FONT_SIZE]=Parse.toPx(props[Properties.FONT_SIZE])),props[Properties.FONT_STYLE]&&(node=getNewSpan(node),node.style[Styles.FONT_STYLE]=props[Properties.FONT_STYLE]),props[Properties.FONT_WEIGHT]&&(node=getNewSpan(node),node.style[Styles.FONT_WEIGHT]=props[Properties.FONT_WEIGHT]),props[Properties.LETTER_SPACING]&&(node=getNewSpan(node),node.style[Styles.LETTER_SPACING]=props[Properties.LETTER_SPACING]),props[Properties.TEXT_DECORATION]&&(node=getNewSpan(node),node.style[Styles.TEXT_DECORATION]=props[Properties.TEXT_DECORATION]),props[Properties.TEXT_TRANSFORM]&&TEXT_TRANSFORM_STYLE_MAP[props[Properties.TEXT_TRANSFORM]]&&(node=getNewSpan(node),node.style[TEXT_TRANSFORM_STYLE_MAP[props[Properties.TEXT_TRANSFORM]]]=props[Properties.TEXT_TRANSFORM]),node}function fontFamilyToClassName(font){return font.replace(/ /g,"_")}function fontClassNameToFamily(fontClassName){return fontClassName.replace(/_/g," ")}function isEmptyInputValue(element){if(!element.inputValue)return!0;var paragraph=document.createElement("p");return paragraph.innerHTML=element.inputValue,""===paragraph.textContent}function setTextAlign(element,align){align&&element.type!==ElementTypes.TEXT_ELEMENT&&(element.textAlign=align)}function getInputValue(element,props){if(isEmptyInputValue(element))return"";var paragraph=document.createElement("p"),text=document.createTextNode(element.inputValue);if("<"===element.inputValue.trim()[0]){var wrapper=document.createElement("div");wrapper.innerHTML=element.inputValue,text=wrapper.children[0]}return applyParagraphStyles(element,paragraph,props),paragraph.appendChild(getStyledSpans(text,props)),paragraph.outerHTML}function removeUnusedElementStyles(element,styles){return element.type===ElementTypes.LINK?_.omit(styles,[Properties.COLOR,Properties.TEXT_DECORATION]):styles}function getAvailableElementStyles(element,styles){return _.pick(removeUnusedElementStyles(element,styles),function(value,property){return ELEMENT_TEXT_STYLES.indexOf(property)!==-1&&element.hasProperty(property)})}function setElementStyles(element,styles){_.forEach(styles,function(value,property){element[property]=value})}function encodeFontFamily(type,fontFamily){switch(type){case"C":case"G":return Base32.encode(fontFamily);case"S":return fontFamilyToClassName(fontFamily);default:return fontFamily}}function setTableColsDefaultStyles(element,styles){element.cellsStyles=_.reduce(element.cellsStyles,function(cellsStyles,cellStyle,cellName){return _.assign({},cellsStyles,_defineProperty({},cellName,_.assign({},cellStyle,styles)))},{})}function GetListTypeFromStyle(listStyle){return LIST_STYLE_MAP[listStyle]}function GetLastUsedStyle(element,property){var styles=defaultStyles.get(element.Page.getProjectId());return styles[property]||element.DefaultProperties[property].value}function IsStyleProperty(element,property){return element.isTextStyleable()&&ELEMENT_TEXT_STYLES.indexOf(property)>-1}function SetDefaultTextStyle(projectId,property,value){defaultStyles.set(projectId,property,value)}function UseDefaultTextStyle(element,props){if(element.isTextStyleable()){var styles=getAvailableElementStyles(element,defaultStyles.get(element.Page.getProjectId()));return element.type===ElementTypes.TABLE&&setTableColsDefaultStyles(element,styles),element.isRichTextEditable()?(element.inputValue=getInputValue(element,_.extend({},styles,props)),void setTextAlign(element,styles.textAlign)):void setElementStyles(element,styles)}}function UseDefaultStyleInRichTextElement(element){
if(isEmptyInputValue(element)){var styles=defaultStyles.get(element.Page.getProjectId());setElementStyles(element,styles)}}function SanitizeFontName(font){if(IsFontClassName(font))return font;var fontData=font.replace(/^"|"$/g,"").split("-");return fontData.length<=1?fontFamilyToClassName(font):(fontData[1]=encodeFontFamily(fontData[0],fontData[1]),FONT_PREFIX+fontData.join("-"))}function SanitizeFontFamily(fontFamily){return'"'!==fontFamily[0]&&fontFamily.indexOf(" ")>-1?'"'+fontFamily+'"':fontFamily}function IsFontClassName(className){return CLASS_NAME_REGEXP.exec(className)}function HasFontPrefix(className){return 0===(className||"").indexOf("font-")}function ClearFontClasses(domElement){domElement.style.fontFamily="",_.forEachRight(domElement.classList,function(className){HasFontPrefix(className)&&domElement.classList.remove(className)})}function SetFontClass(domElement,fontClass){if(ClearFontClasses(domElement),fontClass)return HasFontPrefix(fontClass)?void domElement.classList.add(fontClass):void(domElement.style.fontFamily=fontClassNameToFamily(fontClass))}var _TEXT_TRANSFORM_STYLE,DEFAULT_TEXT="Text ...",ALIGN_PREFIX="uxp-align-",FONT_TYPE_PREFIX="wysiwyg-font-type-",FONT_PREFIX="font-",DEFAULT_FONT="font-S-Arial-n4",CLASS_NAME_REGEXP=/^font-[A-Z]-[^\s]+-[a-z0-9]{1,2}$/i,LIST_STYLE_MAP={decimal:"numberedlist",disc:"bulletedlist"},ELEMENT_TEXT_STYLES=[Properties.COLOR,Properties.FONT_FAMILY,Properties.FONT_SIZE,Properties.FONT_STYLE,Properties.FONT_WEIGHT,Properties.LETTER_SPACING,Properties.LINE_HEIGHT,Properties.TEXT_ALIGN,Properties.TEXT_DECORATION,Properties.TEXT_TRANSFORM],TEXT_TRANSFORM={CAPITALIZE:"capitalize",LOWERCASE:"lowercase",UPPERCASE:"uppercase",SMALL_CAPS:"small-caps"},TEXT_TRANSFORM_STYLE_MAP=(_TEXT_TRANSFORM_STYLE={},_defineProperty(_TEXT_TRANSFORM_STYLE,TEXT_TRANSFORM.CAPITALIZE,Styles.TEXT_TRANSFORM),_defineProperty(_TEXT_TRANSFORM_STYLE,TEXT_TRANSFORM.LOWERCASE,Styles.TEXT_TRANSFORM),_defineProperty(_TEXT_TRANSFORM_STYLE,TEXT_TRANSFORM.UPPERCASE,Styles.TEXT_TRANSFORM),_defineProperty(_TEXT_TRANSFORM_STYLE,TEXT_TRANSFORM.SMALL_CAPS,Styles.FONT_VARIANT),_TEXT_TRANSFORM_STYLE),defaultStyles=function(){var key=function(projectId){return"default_style_"+projectId},get=function(projectId){return LocalStorage.get(key(projectId))||{}},set=function(projectId,property,value){LocalStorage.set(key(projectId),_.assign({},get(projectId),_defineProperty({},property,value)))};return{get:get,set:set}}();return Object.freeze({DEFAULT_TEXT:DEFAULT_TEXT,DEFAULT_FONT:DEFAULT_FONT,ALIGN_PREFIX:ALIGN_PREFIX,FONT_TYPE_PREFIX:FONT_TYPE_PREFIX,FONT_PREFIX:FONT_PREFIX,GetLastUsedStyle:GetLastUsedStyle,SetFontClass:SetFontClass,IsStyleProperty:IsStyleProperty,IsFontClassName:IsFontClassName,SetDefaultTextStyle:SetDefaultTextStyle,UseDefaultTextStyle:UseDefaultTextStyle,UseDefaultStyleInRichTextElement:UseDefaultStyleInRichTextElement,SanitizeFontName:SanitizeFontName,SanitizeFontFamily:SanitizeFontFamily,GetListTypeFromStyle:GetListTypeFromStyle})}()},{"../../enums/ElementTypes.js":346,"../../enums/Properties.js":358,"../../enums/Styles.js":361,"../../utils/LocalStorage.js":411,"../../utils/Parse.js":415,base32:16,lodash:161}],262:[function(_dereq_,module,exports){"use strict";module.exports=function(){function detectServiceByUrl(url){if(url){var regexp,match;for(var service in VIDEO_SERVICES)if(VIDEO_SERVICES.hasOwnProperty(service)&&(regexp=new RegExp(VIDEO_SERVICES[service].REGEXP,"i"),match=url.match(regexp)))return{service:service,match:match};return null}}function getVideoHtml(url,width,height){if(url){var detected=detectServiceByUrl(url);if(detected){var videoHtml=VIDEO_SERVICES[detected.service].SD.replace(/\[\[id\]\]/g,detected.match[1]).replace(/\[\[id2\]\]/g,detected.match[2]).replace(/\[\[width\]\]/g,width||640).replace(/\[\[height\]\]/g,height||385);return videoHtml}}}var VIDEO_SERVICES={YOUTUBE:{REGEXP:"(?:youtube.com/watch\\?v=|youtu.be/)([^$&]+)",SD:'<iframe width="[[width]]" height="[[height]]" src="https://www.youtube.com/embed/[[id]]" frameborder="0" allowfullscreen></iframe>',HD:""},VIMEO:{REGEXP:"vimeo.com/(\\d+)",SD:'<iframe src="https://player.vimeo.com/video/[[id]]" width="[[width]]" height="[[height]]" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>',HD:""},DROPBOX:{REGEXP:"(http.*dropbox.*.([a-z0-9]{3,4}))",SD:'<video width="[[width]]" height="[[height]]" controls><source src="[[id]]?dl=1" type="video/[[id2]]"><p>Your browser does not support HTML5 video</p></video>',HD:""}},VideoHelper={detectServiceByUrl:detectServiceByUrl,getVideoHtml:getVideoHtml};return VideoHelper}()},{}],263:[function(_dereq_,module,exports){"use strict";var SvgSymbol=_dereq_("./SvgSymbol.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),IOS7View=_dereq_("./views/IOS7View.js");module.exports=function(){function iOS7(){SvgSymbol.apply(this,arguments),this.type=ElementTypes.IOS7,this.view=this.createView(IOS7View)}return Base.Extend(iOS7,SvgSymbol),iOS7}()},{"../enums/ElementTypes.js":346,"../utils/Base.js":405,"./SvgSymbol.js":212,"./views/IOS7View.js":319}],264:[function(_dereq_,module,exports){"use strict";var GroupingInstance=_dereq_("./GroupingInstance.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),Base=_dereq_("../utils/Base.js");module.exports=function(){function iOS8(){GroupingInstance.apply(this,arguments),this.type=ElementTypes.IOS8}return Base.Extend(iOS8,GroupingInstance),iOS8}()},{"../enums/ElementTypes.js":346,"../utils/Base.js":405,"./GroupingInstance.js":186}],265:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),AbstractElement=_dereq_("../AbstractElement"),Linked=_dereq_("../behaviors/Linked.js"),IndicatorAlign=_dereq_("../../enums/IndicatorAlign.js"),AttributesIndicatorView=_dereq_("./views/AttributesIndicatorView.js"),Base=_dereq_("../../utils/Base.js"),ClassNames=_dereq_("../../enums/ClassNames.js"),ElementsHelper=_dereq_("../helpers/ElementsHelper.js");module.exports=function(){function AttributesIndicator(id,Page,options){AbstractElement.apply(this,arguments),this.setOptions(options),this.view=new AttributesIndicatorView(options),this.fixed=this.element&&this.element.fixed,this.onElementChangeRef=this.onElementChange.bind(this),this.onElementReorderRef=this.onElementReorder.bind(this),this.onElementDeleteRef=this.onElementDelete.bind(this)}var defaultOptions={align:IndicatorAlign.TOP_LEFT,forceClassName:!1,className:[],content:"",width:12,height:18,element:null};return Base.Extend(AttributesIndicator,AbstractElement),Base.ApplyBehavior(AttributesIndicator,Linked),Object.defineProperties(AttributesIndicator.prototype,{}),AttributesIndicator.prototype.setOptions=function(options){options=_.extend(defaultOptions,options),this.options=options,this.align=options.align,this.className=options.className,this.content=options.content,this.element=options.element},AttributesIndicator.prototype.show=function(element){this.addChangeListener(this.onElementChangeRef),this.addReorderListener(this.onElementReorderRef),this.addDeleteListener(this.onElementDeleteRef),this.onElementChange(element),this._insertIndicatorNode(element)},AttributesIndicator.prototype.remove=function(){this.removeChangeListener(this.onElementChangeRef),this.removeReorderListener(this.onElementReorderRef),this.removeDeleteListener(this.onElementDeleteRef),this._removeIndicatorNode()},AttributesIndicator.prototype.onElementChange=function(element){this.angle=element.angle,this.x=element.x,this.y=element.y,this.width=element.width,this.height=element.height,this.fixed=this.element&&(this.element.fixed||ElementsHelper.isAncestorFixed(this.element)),this.update()},AttributesIndicator.prototype.onElementReorder=function(element){this._insertIndicatorNode(element)},AttributesIndicator.prototype.onElementDelete=function(){this._removeIndicatorNode()},AttributesIndicator.prototype._insertIndicatorNode=function(element){this.view.insertNodeAfter(this.view.domElement,element.view.domElement)},AttributesIndicator.prototype._removeIndicatorNode=function(){this.view.domElement.parentNode&&this.view.domElement.parentNode.removeChild(this.view.domElement)},AttributesIndicator.prototype._updateProperty=function(){},AttributesIndicator.prototype._saveProperty=function(){},AttributesIndicator.prototype.select=function(element){this.view.domElement.classList.add(ClassNames.ACTIVE)},AttributesIndicator.prototype.deselect=function(){this.view.domElement.classList.remove(ClassNames.ACTIVE)},AttributesIndicator.prototype.hover=function(element){this.view.domElement.classList.add(ClassNames.HIGHLIGHTED)},AttributesIndicator.prototype.removeHover=function(){this.view.domElement.classList.remove(ClassNames.HIGHLIGHTED)},AttributesIndicator}()},{"../../enums/ClassNames.js":345,"../../enums/IndicatorAlign.js":349,"../../utils/Base.js":405,"../AbstractElement":166,"../behaviors/Linked.js":231,"../helpers/ElementsHelper.js":250,"./views/AttributesIndicatorView.js":286,lodash:161}],266:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),AbstractElement=_dereq_("../AbstractElement"),Base=_dereq_("../../utils/Base.js"),CollaboratorView=_dereq_("./views/CollaboratorView.js"),ElementTypes=_dereq_("../../enums/ElementTypes.js"),Linked=_dereq_("../behaviors/Linked.js");module.exports=function(){function Collaborator(id,page,collaboratorData,scale){AbstractElement.apply(this,[id,page]),this.type=ElementTypes.COLLABORATION,this.view=new CollaboratorView(collaboratorData),this._pageId=parseInt(collaboratorData.id_page),this._data=collaboratorData,this._scale=scale||1,this._elementIds=[],this.addChangeListener(function(){this.refresh()}.bind(this))}return Base.Extend(Collaborator,AbstractElement),Base.ApplyBehavior(Collaborator,Linked),Collaborator.prototype.activateElement=function(pageId,elementIds,isComponent){var elements=this._getSelectedElements(pageId,elementIds,isComponent);this._pageId=parseInt(pageId),this._elementIds=elementIds,this._isComponent=isComponent,_.forEach(this._elements,function(element){element.removeLinkedElement(this)}.bind(this)),_.forEach(elements,function(element){element.addLinkedElement(this)}.bind(this)),this._elements=elements,this.view.setElements(this.isVisible(this._elements),this._elements,this._scale)},Collaborator.prototype.isVisible=function(elements){return elements.length>0&&(parseInt(this.Page.pageId)===this._pageId||this._isComponent)},Collaborator.prototype.refresh=function(scale){scale&&(this._scale=scale),window.requestAnimationFrame(function(){this._elements=this._getSelectedElements(this._pageId,this._elementIds,this._isComponent);var isVisible=this.isVisible(this._elements);this.view.setElements(isVisible,this._elements,this._scale)}.bind(this))},Collaborator.prototype.setData=function(data,scale){this._scale=scale,this._data=data,this._elementIds=this._pageId===parseInt(data.id_page)?this._elementIds:[],this._pageId=parseInt(data.id_page),this.view.setViewData(data),this.refresh()},Collaborator.prototype.destroy=function(){this.view.destroyDomElement()},Collaborator.prototype._getSelectedElements=function(pageId,elementIds,isComponent){if(isComponent)return _.compact(this.Page.ElementsManager.getElementsByComponentId(pageId))||[];var onlyCanvasSelected=1===elementIds.length&&"canvas"===_.first(elementIds);return onlyCanvasSelected||!elementIds.length||this._pageId!==parseInt(pageId)?[]:_.compact(_.map(elementIds,function(id){return this.Page.ElementsManager.getElementById(id)}.bind(this)))},Collaborator}()},{"../../enums/ElementTypes.js":346,"../../utils/Base.js":405,"../AbstractElement":166,"../behaviors/Linked.js":231,"./views/CollaboratorView.js":287,lodash:161}],267:[function(_dereq_,module,exports){"use strict";var _lodash=_dereq_("lodash"),AbstractElement=_dereq_("../AbstractElement"),Base=_dereq_("../../utils/Base"),DrawIndicatorView=_dereq_("./views/DrawIndicatorView"),ElementTypes=_dereq_("../../enums/ElementTypes"),Properties=_dereq_("../../enums/Properties"),Rectangle=_dereq_("../../primitives/Rectangle"),Snappingable=_dereq_("./behaviors/Snappingable");module.exports=function(){function DrawIndicator(){AbstractElement.apply(this,arguments),this.type=ElementTypes.DRAW_INDICATOR,this.view=new DrawIndicatorView,this.scale=1,this._shouldAppendElement=!1,this.view.setVisibility(!1)}var minMax=function(value,_minMax){return Math.max(_minMax.min,Math.min(_minMax.max,value))},isMinMaxSame=function(minMax){return minMax.min===minMax.max},scaleValues=function(values,scale){return(0,_lodash.mapValues)(values,function(value){return value*scale})},getElementProps=function(element){var properties=[Properties.X,Properties.Y,Properties.WIDTH,Properties.HEIGHT];return(0,_lodash.pick)(element,properties)};return Base.Extend(DrawIndicator,AbstractElement),Base.ApplyBehavior(DrawIndicator,Snappingable),Object.defineProperties(DrawIndicator.prototype,{dirty:{get:function(){return this._dirty},set:function(value){this._dirty=value}},element:{get:function(){return this._element}},x:{get:function(){return Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.X).get.call(this)},set:function(value){Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.X).set.call(this,value),this._element._updateProperty(Properties.X,value/this.scale,!0),this.dirty=!0}},y:{get:function(){return Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.Y).get.call(this)},set:function(value){Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.Y).set.call(this,value),this._element._updateProperty(Properties.Y,value/this.scale,!0),this.dirty=!0}},width:{get:function(){return Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.WIDTH).get.call(this)},set:function(value){Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.WIDTH).set.call(this,value),this._element._updateProperty(Properties.WIDTH,value/this.scale,!0),this.dirty=!0}},height:{get:function(){return Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.HEIGHT).get.call(this)},set:function(value){this._element._updateProperty(Properties.HEIGHT,value/this.scale,!0),Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.HEIGHT).set.call(this,value),this.dirty=!0}},mouseMoved:{get:function(){return this._mouseMoved}}}),DrawIndicator.prototype.setScale=function(value){this.scale=value},DrawIndicator.prototype.drawStart=function(clickPoint,definition){var type=definition.type,props=definition.props;this._definition=definition,this._clickPoint=clickPoint,this._element=this.Page.createGhostElement(type,props),this._element.parent=this.Page.canvas,this._element.getDomElement().style.pointerEvents="none",this._mouseMoved=!1,this._shouldAppendElement=!1,this._initSnapping(new Rectangle)},DrawIndicator.prototype.drawMove=function(movePoint,shift){if(this._mouseMoved||!(0,_lodash.isEqual)(movePoint,this._clickPoint)){!this._mouseMoved&&this.element.isDrawable()?(this._mouseMoved=!0,this._shouldAppendElement=!0):this.element.isDrawable()||(this._clickPoint=movePoint);var _getDrawPositions=this.getDrawPositions(movePoint,shift),x=_getDrawPositions.x,y=_getDrawPositions.y,width=_getDrawPositions.width,height=_getDrawPositions.height;this.x=x,this.y=y,this.width=width,this.height=height,this._appendElementToCanvas()}},DrawIndicator.prototype.drawEnd=function(){this._mouseMoved&&(this._element.view.destroyDomElement(),this.view.setVisibility(!1),this._element=null)},DrawIndicator.prototype.update=function(){AbstractElement.prototype.update.call(this),this._element&&this._element.update()},DrawIndicator.prototype.getDrawPositions=function(movePoint,shift){if(!this._mouseMoved)return scaleValues({x:movePoint.x,y:movePoint.y,width:this._element.width,height:this._element.height},this.scale);movePoint.x=this._getSnappedX(movePoint.x,!0),movePoint.y=this._getSnappedY(movePoint.y,!0);var elementMinMax=this._element.getPropertiesMinMax([Properties.WIDTH,Properties.HEIGHT]),width=minMax(Math.abs(this._clickPoint.x-movePoint.x),elementMinMax[Properties.WIDTH]),height=minMax(Math.abs(this._clickPoint.y-movePoint.y),elementMinMax[Properties.HEIGHT]),dimension={width:shift?Math.min(width,height):width,height:shift?Math.min(width,height):height},x=isMinMaxSame(elementMinMax[Properties.WIDTH])?this._clickPoint.x:Math.max(this._clickPoint.x-dimension.width,Math.min(this._clickPoint.x,movePoint.x)),y=isMinMaxSame(elementMinMax[Properties.HEIGHT])?this._clickPoint.y:Math.max(this._clickPoint.y-dimension.height,Math.min(this._clickPoint.y,movePoint.y));return scaleValues({x:x,y:y,width:dimension.width,height:dimension.height},this.scale)},DrawIndicator.prototype.getElementToAddDefinition=function(){var type=this._definition.type,props=getElementProps(this._element);return this._mouseMoved||(props[Properties.X]=this._clickPoint.x-props[Properties.WIDTH]/2,props[Properties.Y]=this._clickPoint.y-props[Properties.HEIGHT]/2),{type:type,props:props}},DrawIndicator.prototype._appendElementToCanvas=function(){this._shouldAppendElement&&(this._shouldAppendElement=!1,this.Page.canvas.getDomElement().appendChild(this.element.getDomElement()),this.view.setVisibility(!0))},DrawIndicator}()},{"../../enums/ElementTypes":346,"../../enums/Properties":358,"../../primitives/Rectangle":404,"../../utils/Base":405,"../AbstractElement":166,"./behaviors/Snappingable":285,"./views/DrawIndicatorView":288,lodash:161}],268:[function(_dereq_,module,exports){"use strict";var ElementTypes=(_dereq_("lodash"),_dereq_("../../enums/ElementTypes.js")),Base=_dereq_("../../utils/Base.js"),AbstractElement=_dereq_("../AbstractElement"),ElementIndicatorView=_dereq_("./views/ElementIndicatorView.js");module.exports=function(){function ElementIndicator(){AbstractElement.apply(this,arguments),this.type=ElementTypes.ELEMENT_INDICATOR,this.view=new ElementIndicatorView}return ElementIndicator.DefaultProperties={element:{value:null}},Base.Extend(ElementIndicator,AbstractElement),Object.defineProperties(ElementIndicator.prototype,{element:{get:function(){return this._element},set:function(value){this._element=value,this.onUpdateElement()}}}),ElementIndicator.prototype.show=function(element){this.element=element},ElementIndicator.prototype.showCoordinates=function(element){this.element=element,this.view.showCoordinates(this.element.x,this.element.y)},ElementIndicator.prototype.showDimensions=function(element){this.element=element,this.view.showDimensions(this.element.width,this.element.height)},ElementIndicator.prototype.showRotation=function(element){this.element=element,this.view.showRotation(this.element.angle)},ElementIndicator.prototype.hide=function(){this.view.hide()},ElementIndicator.prototype.onUpdateElement=function(){var position=this._getIndicatorPosition();this.rect.x=position.x,this.rect.y=position.y,this.inside=position.inside,this.dirty=!0},ElementIndicator.prototype._getIndicatorPosition=function(){var scale=this.Page.canvas.scale,elementBB=this.element.getBoundingBox(!0).clone().multiply(scale),minWidth=120,minHeight=50,spacing=10,position={};return elementBB.width>=minWidth&&elementBB.height>=minHeight?(position.inside=!0,position.x=elementBB.center,position.y=elementBB.middle):(position.inside=!1,position.x=elementBB.right+spacing,position.y=elementBB.bottom+spacing),position},ElementIndicator}()},{"../../enums/ElementTypes.js":346,"../../utils/Base.js":405,"../AbstractElement":166,"./views/ElementIndicatorView.js":289,lodash:161}],269:[function(_dereq_,module,exports){"use strict";var ElementTypes=_dereq_("../../enums/ElementTypes.js"),ElementNameView=_dereq_("./views/ElementNameView.js"),Base=_dereq_("../../utils/Base.js"),AbstractElement=_dereq_("../AbstractElement");module.exports=function(){function ElementName(){AbstractElement.apply(this,arguments),this.type=ElementTypes.ELEMENT_NAME,this.view=new ElementNameView}return Base.Extend(ElementName,AbstractElement),Object.defineProperties(ElementName.prototype,{}),ElementName.prototype.setPosition=function(x,y){this.view.setPosition(x,y)},ElementName.prototype.setName=function(name){this.view.setName(name)},ElementName.prototype.show=function(){this.view.setVisibility(!0)},ElementName.prototype.hide=function(){this.view.setVisibility(!1)},ElementName}()},{"../../enums/ElementTypes.js":346,"../../utils/Base.js":405,"../AbstractElement":166,"./views/ElementNameView.js":290}],270:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("../AbstractElement"),ElementTypes=_dereq_("../../enums/ElementTypes.js"),GuideView=_dereq_("./views/GuideView.js"),Base=_dereq_("../../utils/Base.js"),Orientations=_dereq_("../../enums/Orientations.js"),Properties=_dereq_("../../enums/Properties.js");module.exports=function(){function Guide(){AbstractElement.apply(this,arguments),this.type=ElementTypes.GUIDE,this.view=new GuideView,this.scale=1}return Guide.DefaultProperties={orientation:{value:Orientations.HORIZONTAL},minX:{value:0},minY:{value:0},x:{value:0},y:{value:0},width:{value:1},height:{value:1},visibility:{value:!0}},Base.Extend(Guide,AbstractElement),Object.defineProperties(Guide.prototype,{dirty:{get:function(){return this._dirty},set:function(value){this._dirty=value}},width:{get:function(){return Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.WIDTH).get.call(this)},set:function(value){this.orientation===Orientations.VERTICAL&&(value=1),Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.WIDTH).set.call(this,value)}},height:{get:function(){return Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.HEIGHT).get.call(this)},set:function(value){this.orientation===Orientations.HORIZONTAL&&(value=1),Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.HEIGHT).set.call(this,value)}},minX:{get:function(){return this._minX},set:function(value){this._minX=value,this.orientation===Orientations.HORIZONTAL&&(this.x=value)}},minY:{get:function(){return this._minY},set:function(value){this._minY=value,this.orientation===Orientations.VERTICAL&&(this.y=value)}},x:{get:function(){return Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.X).get.call(this)},set:function(value){this.orientation===Orientations.HORIZONTAL&&(value=this.minX),Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.X).set.call(this,value)}},y:{get:function(){return Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.Y).get.call(this)},set:function(value){this.orientation===Orientations.VERTICAL&&(value=this.minY),Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.Y).set.call(this,value)}},orientation:{get:function(){return this._orientation},set:function(value){this._orientation=value,value===Orientations.HORIZONTAL?this.height=1:this.width=1,this.view.setOrientation(value),this.dirty=!0}},visibility:{get:function(){return this._visibility},set:function(value){this._visibility=value,this.view.setVisibility(value)}}}),Guide.prototype.setScale=function(value){this._rect.multiply(value/this.scale),this.orientation===Orientations.HORIZONTAL?this._rect.height=1:this.orientation===Orientations.VERTICAL&&(this._rect.width=1),this.scale=value,this.dirty=!0},Guide.prototype.update=function(){this.visibility&&this.view.updateTransform(this)},Guide.prototype.serialize=function(){return{orientation:this.orientation,x:this.x/this.scale,y:this.y/this.scale}},Guide.prototype.getPosition=function(){return(this.orientation===Orientations.HORIZONTAL?this.y:this.x)/this.scale},Guide.prototype.hitTest=function(p){var rect=this.rect.clone();return rect.multiply(1/this.scale),this.orientation===Orientations.HORIZONTAL?(rect.y-=1,rect.height=3):this.orientation===Orientations.VERTICAL&&(rect.x-=1,rect.width=3),rect.hitTest(p)?this:null},Guide}()},{"../../enums/ElementTypes.js":346,"../../enums/Orientations.js":356,"../../enums/Properties.js":358,"../../utils/Base.js":405,"../AbstractElement":166,"./views/GuideView.js":291}],271:[function(_dereq_,module,exports){"use strict";var Base=(_dereq_("lodash"),_dereq_("../../utils/Base.js")),ElementName=_dereq_("./ElementName.js"),Orientations=_dereq_("../../enums/Orientations.js");module.exports=function(){function GuidePosition(){ElementName.apply(this,arguments),this.view.domElement.classList.add("guide-position")}return Base.Extend(GuidePosition,ElementName),GuidePosition.prototype.setGuidePosition=function(position){this.setName(position)},GuidePosition.prototype.show=function(guide){var position,scale=this.Page.canvas.scale;position=guide.orientation===Orientations.HORIZONTAL?Math.round(guide.y):Math.round(guide.x),this.setGuidePosition(Math.round(position/scale)),ElementName.prototype.show.call(this)},GuidePosition}()},{"../../enums/Orientations.js":356,"../../utils/Base.js":405,"./ElementName.js":269,lodash:161}],272:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("../AbstractElement"),ElementTypes=_dereq_("../../enums/ElementTypes.js"),ElementsHelper=_dereq_("../helpers/ElementsHelper.js"),HighlightView=_dereq_("./views/HighlightView.js"),Base=_dereq_("../../utils/Base.js"),Linked=_dereq_("../behaviors/Linked.js");module.exports=function(){function Highlight(){AbstractElement.apply(this,arguments),this.type=ElementTypes.HIGHLIGHT,this.view=new HighlightView,this.scale=1,this.useBoundingBox=!1,this._element=null,this.onElementChangeRef=this.onElementChange.bind(this)}var HIGHLIGHT_CLASS="highlighting",SMALL_CLASS="small-image",IMAGE_ALREADY_UPLOADED_CLASS="image-already-uploaded",MULTISTATE_CLASS="multistate",GROUP_CLASS="group";return Base.Extend(Highlight,AbstractElement),Base.ApplyBehavior(Highlight,Linked),Object.defineProperties(Highlight.prototype,{dirty:{get:function(){return this._dirty},set:function(value){this._dirty=value}},element:{get:function(){return this._element}}}),Highlight.prototype.link=function(element){var useBoundingBox=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.useBoundingBox=useBoundingBox,this._element=element,this.addChangeListener(this.onElementChangeRef),this.onElementChange(element),this.setVisibility(!0)},Highlight.prototype.unlink=function(){this.removeChangeListener(this.onElementChangeRef),this.setVisibility(!1)},Highlight.prototype.show=function(element,interactive){this._element!==element&&(this.initHighlight(element),element.isGroup()?this.view.domElement.classList.add(GROUP_CLASS):this.view.domElement.classList.remove(GROUP_CLASS),element.isMultistate()?this.view.domElement.classList.add(MULTISTATE_CLASS):this.view.domElement.classList.remove(MULTISTATE_CLASS),element.type!==ElementTypes.IMAGE||element.isEmpty()?this.view.domElement.classList.remove(IMAGE_ALREADY_UPLOADED_CLASS):this.view.domElement.classList.add(IMAGE_ALREADY_UPLOADED_CLASS),element.type===ElementTypes.IMAGE&&element.isSmall()?this.view.domElement.classList.add(SMALL_CLASS):this.view.domElement.classList.remove(SMALL_CLASS),interactive&&this.view.domElement.classList.add(HIGHLIGHT_CLASS))},Highlight.prototype.initHighlight=function(element){this._element=element,this.setVisibility(!0),this.view.setVisibility(!0,element.locked||!this.Page.canChangeElements()),this.update(!0)},Highlight.prototype.hide=function(force){(this._element||force)&&(this.setVisibility(!1),this.hideView(),this._element=null,this.view.domElement.classList.remove(HIGHLIGHT_CLASS))},Highlight.prototype.hideView=function(){this.view.setVisibility(!1)},Highlight.prototype.showView=function(){this.view.setVisibility(!0)},Highlight.prototype.setScale=function(value){this._rect.multiply(value/this.scale),this._x=this._rect.x,this._y=this._rect.y,this._width=this._rect.width,this._height=this._rect.height,this.scale=value,this.update()},Highlight.prototype.setUseBoundingBox=function(value){this.useBoundingBox=value},Highlight.prototype.update=function(shouldUpdateBoundingBox){if(this.isVisible()){var bb;shouldUpdateBoundingBox&&this._element&&(bb=this._element.getBoundingBox(this.useBoundingBox),this._rect=bb.clone().multiply(this.scale),this._x=this._rect.x,this._y=this._rect.y,this._width=this._rect.width,this._height=this._rect.height,this._angle=this._rect.angle),AbstractElement.prototype.update.call(this)}},Highlight.prototype.onElementChange=function(element){var highlightRect=this.useBoundingBox?this._element.getBoundingBox(!0):element;this.angle=highlightRect.angle,this.x=highlightRect.x,this.y=highlightRect.y,this.width=highlightRect.width,this.height=highlightRect.height,this.fixed=this._element.fixed||ElementsHelper.isAncestorFixed(this._element),this.update()},Highlight.prototype.validateProperty=function(property,value){return this._element.validateProperty(property,value)},Highlight.prototype._updateProperty=function(){},Highlight.prototype._saveProperty=function(){},Highlight}()},{"../../enums/ElementTypes.js":346,"../../utils/Base.js":405,"../AbstractElement":166,"../behaviors/Linked.js":231,"../helpers/ElementsHelper.js":250,"./views/HighlightView.js":297}],273:[function(_dereq_,module,exports){"use strict";var NumberIndicator=_dereq_("../ui/NumberIndicator"),Highlight=_dereq_("./Highlight"),ClassNames=_dereq_("../../enums/ClassNames.js"),ElementTypes=_dereq_("../../enums/ElementTypes.js"),Base=_dereq_("../../utils/Base.js"),Linked=_dereq_("../behaviors/Linked.js"),IndicatorAlign=_dereq_("../../enums/IndicatorAlign.js");module.exports=function(){function HighlightAnnotation(id,page){var number=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,isSelected=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Highlight.apply(this,arguments),this.type=ElementTypes.HIGHLIGHT_ANNOTATION,this.stateIa="visible",this.number=number,this.setSelection(isSelected)}return Base.Extend(HighlightAnnotation,Highlight),Base.ApplyBehavior(HighlightAnnotation,Linked),Object.defineProperties(HighlightAnnotation.prototype,{}),HighlightAnnotation.prototype.addNumber=function(){this._indicatorDocumentation=new NumberIndicator(null,this.Page,{align:IndicatorAlign.TOP_LEFT,forceClassName:!0,className:["annotation-pin","pinned"],content:this.number,width:20,height:20,element:this.element}),this.addLinkedElement(this._indicatorDocumentation),this.Page.canvas.addAnnotationHighlight(this._indicatorDocumentation),this.isSelected&&this._indicatorDocumentation.select(),this._indicatorDocumentation.show(this)},HighlightAnnotation.prototype.updateNumber=function(){this._indicatorDocumentation&&(this.number=id,this._indicatorDocumentation.content=this.number)},HighlightAnnotation.prototype.removeNumber=function(){this._indicatorDocumentation&&(this.removeLinkedElement(this._indicatorDocumentation),this._indicatorDocumentation.remove(),this._indicatorDocumentation=null)},HighlightAnnotation.prototype.setSelection=function(shouldSelect){return shouldSelect?this.select():this.deselect()},HighlightAnnotation.prototype.select=function(){this.isSelected=!0,this.view.domElement.classList.add(ClassNames.ACTIVE),this._indicatorDocumentation&&this._indicatorDocumentation.select()},HighlightAnnotation.prototype.deselect=function(){this.isSelected=!1,this.view.domElement.classList.remove(ClassNames.ACTIVE),this._indicatorDocumentation&&this._indicatorDocumentation.deselect()},HighlightAnnotation.prototype.hover=function(){this.view.domElement.classList.add(ClassNames.HIGHLIGHTED),this._indicatorDocumentation&&this._indicatorDocumentation.hover()},HighlightAnnotation.prototype.removeHover=function(){this.view.domElement.classList.remove(ClassNames.HIGHLIGHTED),this._indicatorDocumentation&&this._indicatorDocumentation.removeHover()},HighlightAnnotation}()},{"../../enums/ClassNames.js":345,"../../enums/ElementTypes.js":346,"../../enums/IndicatorAlign.js":349,"../../utils/Base.js":405,"../behaviors/Linked.js":231,"../ui/NumberIndicator":283,"./Highlight":272}],274:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Base=_dereq_("../../utils/Base.js"),Highlight=_dereq_("./Highlight.js"),ElementTypes=_dereq_("../../enums/ElementTypes.js"),HighlightCellResizerView=_dereq_("./views/HighlightCellResizerView.js"),Point=_dereq_("../../primitives/Point.js"),Linked=_dereq_("../behaviors/Linked.js"),Orientations=_dereq_("../../enums/Orientations.js");
module.exports=function(){function HighlightCellResizer(){Highlight.apply(this,arguments),this.type=ElementTypes.HIGHLIGHT_CELL_RESIZER,this.view=new HighlightCellResizerView,this._startDragPoint=new Point,this._lowerResizerLimit=null,this._upperResizerLimit=null,this.onElementChangeRef=this.onElementChange.bind(this)}return Base.Extend(HighlightCellResizer,Highlight),Base.ApplyBehavior(HighlightCellResizer,Linked),Object.defineProperties(HighlightCellResizer.prototype,{element:{get:function(){return this._element}}}),HighlightCellResizer.prototype.show=function(element){element.containsRotatedElement()||(this.view.initView(element,this.scale),this.initHighlight(element),this.addChangeListener(this.onElementChangeRef),this.element.addLinkedElement(this))},HighlightCellResizer.prototype.hide=function(force){this.element&&this.element.removeLinkedElement(this),this.view.removeResizers(),this.removeChangeListener(this.onElementChangeRef),Highlight.prototype.hide.call(this,force)},HighlightCellResizer.prototype.startDrag=function(resizer){this.view.setResizerMoving(resizer,!0),this._setResizerLimits("x",parseInt(resizer.getAttribute("data-index")))},HighlightCellResizer.prototype.dragResizer=function(x,y,resizer){if(this._startDragPoint.x=x/this.scale,this._startDragPoint.y=y/this.scale,this.isVertical(resizer)){var resizerIndex=parseInt(resizer.getAttribute("data-index")),position=this._limitResizerPosition(this._startDragPoint.x,"x",resizerIndex);this.view.updateVerticalResizerPosition(resizerIndex,position*this.scale)}},HighlightCellResizer.prototype.commitCellResize=function(resizer){this.isVertical(resizer)&&(this.view.setResizerMoving(resizer,!1),this.element.setColumnWidth(parseInt(resizer.getAttribute("data-index")),this._getColumnWidthFromResizer(resizer)),this._clearResizerLimits())},HighlightCellResizer.prototype.update=function(shouldUpdateBoundingBox){window.requestAnimationFrame(function(){this.element&&!this.element.containsRotatedElement()?this.view.updateResizerPositions(this.element,this.scale):this.element&&this.element.containsRotatedElement()&&this.view.removeResizers()}.bind(this)),Highlight.prototype.update.call(this,shouldUpdateBoundingBox)},HighlightCellResizer.prototype.getResizers=function(){return this.view.domElement.children},HighlightCellResizer.prototype._limitResizerPosition=function(dragPoint,axis){if("x"===axis){var leftLimit=this._element.x+this._lowerResizerLimit,rightLimit=this._element.x+this._upperResizerLimit;if(dragPoint>rightLimit)return rightLimit-this.element[axis];if(dragPoint<leftLimit)return leftLimit-this.element[axis]}return dragPoint-this.element[axis]},HighlightCellResizer.prototype._setResizerLimits=function(axis,resizerIndex){"x"===axis&&(this._lowerResizerLimit=this.element.getLeftOffsetForColumn(resizerIndex)+this.element.getMinColumnWidth(),this._upperResizerLimit=this.element.getLeftOffsetForColumn(resizerIndex+2)-this.element.getMinColumnWidth())},HighlightCellResizer.prototype._clearResizerLimits=function(){this._lowerResizerLimit=this._upperResizerLimit=null},HighlightCellResizer.prototype._getColumnWidthFromResizer=function(resizer){var preColumnsCounter=parseInt(resizer.getAttribute("data-index")),columnWidth=_.reduce(this.element.getRealCellWidths().slice(0,preColumnsCounter),function(sum,value){return sum-parseInt(value)},parseInt(resizer.style.left)/this.scale)-parseInt(this.element.borderLeftWidth)/2;return columnWidth},HighlightCellResizer.prototype.isVertical=function(resizer){return!!resizer.classList.contains(Orientations.VERTICAL)},HighlightCellResizer.prototype.isHorizontal=function(resizer){return!!resizer.classList.contains(Orientations.HORIZONTAL)},HighlightCellResizer}()},{"../../enums/ElementTypes.js":346,"../../enums/Orientations.js":356,"../../primitives/Point.js":403,"../../utils/Base.js":405,"../behaviors/Linked.js":231,"./Highlight.js":272,"./views/HighlightCellResizerView.js":292,lodash:161}],275:[function(_dereq_,module,exports){"use strict";var Highlight=_dereq_("./Highlight.js"),ElementTypes=_dereq_("../../enums/ElementTypes.js"),HighlightEditView=_dereq_("./views/HighlightEditView.js"),Base=_dereq_("../../utils/Base.js");module.exports=function(){function HighlightEdit(){Highlight.apply(this,arguments),this.type=ElementTypes.HIGHLIGHT_EDIT,this.view=new HighlightEditView}return Base.Extend(HighlightEdit,Highlight),Object.defineProperties(HighlightEdit.prototype,{}),HighlightEdit.prototype.show=function(element,isMultistate){Highlight.prototype.show.call(this,element),this.view.setMultistateMode(isMultistate)},HighlightEdit}()},{"../../enums/ElementTypes.js":346,"../../utils/Base.js":405,"./Highlight.js":272,"./views/HighlightEditView.js":294}],276:[function(_dereq_,module,exports){"use strict";var HighlightEdit=_dereq_("./HighlightEdit.js"),ElementTypes=_dereq_("../../enums/ElementTypes.js"),HighlightEditClippedView=_dereq_("./views/HighlightEditClippedView.js"),Base=_dereq_("../../utils/Base.js");module.exports=function(){function HighlightEditClipped(){HighlightEdit.apply(this,arguments),this.type=ElementTypes.HIGHLIGHT_EDIT_CLIPPED,this.view=new HighlightEditClippedView}return Base.Extend(HighlightEditClipped,HighlightEdit),Object.defineProperties(HighlightEditClipped.prototype,{}),HighlightEditClipped.prototype.show=function(element){if(element&&element.isGroup()&&element.isClip){var bb=element.getBoundingBox();this._rect=bb.clone().multiply(this.scale),this.view.setVisibility(!0),this.update()}},HighlightEditClipped}()},{"../../enums/ElementTypes.js":346,"../../utils/Base.js":405,"./HighlightEdit.js":275,"./views/HighlightEditClippedView.js":293}],277:[function(_dereq_,module,exports){"use strict";var Base=_dereq_("../../utils/Base.js"),Highlight=_dereq_("./Highlight.js"),AbstractElement=_dereq_("../AbstractElement"),ElementTypes=_dereq_("../../enums/ElementTypes.js"),HighlightPartView=_dereq_("./views/HighlightPartView.js");module.exports=function(){function HighlightPart(){Highlight.apply(this,arguments),this.type=ElementTypes.HIGHLIGHT_PART,this.view=new HighlightPartView}return Base.Extend(HighlightPart,Highlight),Object.defineProperties(HighlightPart.prototype,{element:{get:function(){return this._element}},partId:{get:function(){return this._partId}}}),HighlightPart.prototype.show=function(element,partId){this._partId=partId,this.initHighlight(element)},HighlightPart.prototype.update=function(shouldUpdateBoundingBox){var bb,elementBb;shouldUpdateBoundingBox&&this._element&&this._partId&&(elementBb=this._element.getBoundingBox(),bb=this._element.getPartBoundingBox(this._partId).clone(),bb.x+=elementBb.x,bb.y+=elementBb.y,this._rect=bb.multiply(this.scale),this._x=this._rect.x,this._y=this._rect.y,this._width=this._rect.width,this._height=this._rect.height,this._angle=this._rect.angle),AbstractElement.prototype.update.call(this)},HighlightPart}()},{"../../enums/ElementTypes.js":346,"../../utils/Base.js":405,"../AbstractElement":166,"./Highlight.js":272,"./views/HighlightPartView.js":295}],278:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),AbstractElement=_dereq_("../AbstractElement.js"),Base=_dereq_("../../utils/Base.js"),Calc=(_dereq_("../helpers/BrowserHelper.js"),_dereq_("../../utils/Calc.js")),ElementTypes=_dereq_("../../enums/ElementTypes.js"),Highlight=_dereq_("./Highlight.js"),HighlightSelectView=_dereq_("./views/HighlightSelectView.js"),MoveTracer=_dereq_("../helpers/MoveTracer.js"),Orientations=_dereq_("../../enums/Orientations.js"),Point=_dereq_("../../primitives/Point.js"),Properties=_dereq_("../../enums/Properties.js"),Rectangle=_dereq_("../../primitives/Rectangle.js"),Snappingable=_dereq_("./behaviors/Snappingable.js");module.exports=function(){function HighlightSelect(){Highlight.apply(this,arguments),this.type=ElementTypes.HIGHLIGHT_SELECT,this.view=new HighlightSelectView,this._startDragPoint=new Point,this._startAngle=0,this._elementStartPoint=new Point,this._elementStartAngle=0,this._resizePoint=new Point,this._mode=HighlightSelect.MODE_RESIZE,this._moveTracer=new MoveTracer,this.adjustCornersThrottled=_.throttle(this._adjustCorners.bind(this),100)}var TINY_DIMENSIONS=15,SMALL_DIMENSIONS=30;return HighlightSelect.MODE_RESIZE="modeResize",HighlightSelect.MODE_CROP="modeCrop",Base.Extend(HighlightSelect,Highlight),Base.ApplyBehavior(HighlightSelect,Snappingable),Object.defineProperties(HighlightSelect.prototype,{element:{get:function(){return this._element}},x:{get:function(){return Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.X).get.call(this)},set:function(value){Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.X).set.call(this,value),this._element._updateProperty(Properties.X,value/this.scale,!0)}},y:{get:function(){return Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.Y).get.call(this)},set:function(value){Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.Y).set.call(this,value),this._element._updateProperty(Properties.Y,value/this.scale,!0)}},width:{get:function(){return Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.WIDTH).get.call(this)},set:function(value){Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.WIDTH).set.call(this,value),this._element._updateProperty(Properties.WIDTH,value/this.scale,!0),this.adjustCornersThrottled()}},height:{get:function(){return Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.HEIGHT).get.call(this)},set:function(value){Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.HEIGHT).set.call(this,value),this._element._updateProperty(Properties.HEIGHT,value/this.scale,!0),this.adjustCornersThrottled()}},angle:{get:function(){return Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.ANGLE).get.call(this)},set:function(value){value=this._element.validateProperty(Properties.ANGLE,value),this._angle=this.rect.angle=value,this._element._updateProperty(Properties.ANGLE,value,!0),this.dirty=!0}},rotatable:{get:function(){return this._rotatable},set:function(value){this._rotatable=value,this.view.enableRotation(value)}}}),HighlightSelect.prototype.showElements=function(elements){var group;1===elements.length?this.show(_.first(elements)):elements.length>1&&(group=this.Page.ElementsManager.createElement("VirtualGroup",{}),group.addChildren(elements),this.show(group))},HighlightSelect.prototype.updateElements=function(){this._element&&this._element.isVirtualGroup()&&(this._element.update(),this.update(!0))},HighlightSelect.prototype.show=function(element){element.isGroup()&&element.isClip?(this.view.domElement.classList.add("ng-highlight-clipped"),this.view.domElement.classList.add("clipped")):(this.view.domElement.classList.remove("ng-highlight-clipped"),this.view.domElement.classList.remove("clipped")),element.type===ElementTypes.TEXT_ELEMENT?this.view.domElement.classList.add("horizontal-transform-only"):this.view.domElement.classList.remove("horizontal-transform-only"),this.view.setTransformEnabled(this._isTransformEnabled()),this.view.setRotationEnabled(this._isRotationEnabled()),this._setMode(element.type===ElementTypes.IMAGE_CROP?HighlightSelect.MODE_CROP:HighlightSelect.MODE_RESIZE),Highlight.prototype.show.call(this,element),this._adjustCorners()},HighlightSelect.prototype.hide=function(){this._element&&this._element.isVirtualGroup()&&this._element.Page.ElementsManager.removeElement(this._element),Highlight.prototype.hide.apply(this,arguments)},HighlightSelect.prototype.update=function(shouldUpdateBoundingBox){Highlight.prototype.update.call(this,shouldUpdateBoundingBox),shouldUpdateBoundingBox&&this._element&&this.adjustCornersThrottled()},HighlightSelect.prototype.startDrag=function(x,y){this._startDragPoint.x=x/this.scale,this._startDragPoint.y=y/this.scale,this._elementStartPoint.x=this._element.x,this._elementStartPoint.y=this._element.y,this._moveTracer.reset(),this._moveTracer.addMove(this._startDragPoint),this._initSnapping(this.getBoundingBox().clone().multiply(1/this.scale))},HighlightSelect.prototype.startResize=function(){this._initSnapping(new Rectangle)},HighlightSelect.prototype.startRotate=function(x,y){var dx,dy,rad;this._startDragPoint=this.getBoundingBox().getCenterPoint(),dx=x-this._startDragPoint.x,dy=y-this._startDragPoint.y,rad=Math.atan2(-dx,dy),this._startAngle=Calc.RadToDeg(rad+Math.PI)%360,this._elementStartAngle=this.angle},HighlightSelect.prototype.drag=function(x,y,moveOnLine){var dragDirection,dx=x/this.scale-this._startDragPoint.x,dy=y/this.scale-this._startDragPoint.y;moveOnLine?(dragDirection=this._moveTracer.getDirection({x:this._startDragPoint.x+dx,y:this._startDragPoint.y+dy}),dragDirection===Orientations.HORIZONTAL?this._moveOnX(dx):this._moveOnY(dy)):this._move(dx,dy)},HighlightSelect.prototype.moveOnX=function(delta){this.x=this._element.validateProperty(Properties.X,this.x/this.scale+delta)*this.scale},HighlightSelect.prototype.moveOnY=function(delta){this.y=this._element.validateProperty(Properties.Y,this.y/this.scale+delta)*this.scale},HighlightSelect.prototype.resize=function(x,y,direction,lockRatio,useAnchor){var bb=this.getBoundingBox(),width=this.width,height=this.height,anchorX=this._element._anchorX,anchorY=this._element._anchorY;this._resizePoint.x=this.angle?x:this._getSnappedX(x),this._resizePoint.y=this.angle?y:this._getSnappedY(y),useAnchor||(this._element._anchorX=0,this._element._anchorY=0),this._element._isResizing=!0,this["_resize"+direction].call(this,bb,width,height,lockRatio,useAnchor),this._element._isResizing=!1,useAnchor||(this._element._anchorX=anchorX,this._element._anchorY=anchorY)},HighlightSelect.prototype.rotate=function(x,y,withShiftKey){var dx=x-this._startDragPoint.x,dy=y-this._startDragPoint.y,rad=Math.atan2(-dx,dy),angle=(this._elementStartAngle+Calc.RadToDeg(rad+Math.PI)-this._startAngle)%360;this.angle=withShiftKey?15*Math.round(angle/15):angle},HighlightSelect.prototype._isRotationEnabled=function(){return!this.Page.isComponentInSelection()},HighlightSelect.prototype._isTransformEnabled=function(){return this.Page.options.resizeSymbolsEnabled||!this.Page.isComponentInSelection()},HighlightSelect.prototype.containsRotatedElement=function(){return(this._element.isGroup()||this._element.isComponent())&&this._element.containsRotatedElement()},HighlightSelect.prototype.shouldLockResizeRatio=function(){return this.containsRotatedElement()&&!this._element.isClip},HighlightSelect.prototype._resizeL=function(bb,width,height,lockRatio,useAnchor){var scale;width=Calc.GetLinePointDistance(bb._p2,bb._p1,this._resizePoint),(lockRatio||this.shouldLockResizeRatio())&&(scale=width/this.width,height=scale*this.height),this._setSize(width,height,useAnchor?0:1,useAnchor?0:.5)},HighlightSelect.prototype._resizeR=function(bb,width,height,lockRatio,useAnchor){var scale;width=Calc.GetLinePointDistance(bb._p0,bb._p3,this._resizePoint),(lockRatio||this.shouldLockResizeRatio())&&(scale=width/this.width,height=scale*this.height),this._setSize(width,height,0,useAnchor?0:.5)},HighlightSelect.prototype._resizeT=function(bb,width,height,lockRatio,useAnchor){var scale;height=Calc.GetLinePointDistance(bb._p3,bb._p2,this._resizePoint),(lockRatio||this.shouldLockResizeRatio())&&(scale=height/this.height,width=scale*this.width),this._setSize(width,height,useAnchor?0:.5,useAnchor?0:1)},HighlightSelect.prototype._resizeB=function(bb,width,height,lockRatio,useAnchor){var scale;height=Calc.GetLinePointDistance(bb._p1,bb._p0,this._resizePoint),(lockRatio||this.shouldLockResizeRatio())&&(scale=height/this.height,width=scale*this.width),this._setSize(width,height,useAnchor?0:.5,0)},HighlightSelect.prototype._resizeTL=function(bb,width,height,lockRatio,useAnchor){var scale;width=Calc.GetLinePointDistance(bb._p2,bb._p1,this._resizePoint),height=Calc.GetLinePointDistance(bb._p3,bb._p2,this._resizePoint),(lockRatio||this.shouldLockResizeRatio())&&(scale=Math.max(width/this.width,height/this.height),width=scale*this.width,height=scale*this.height),this._setSize(width,height,useAnchor?0:1,useAnchor?0:1)},HighlightSelect.prototype._resizeTR=function(bb,width,height,lockRatio,useAnchor){var scale;width=Calc.GetLinePointDistance(bb._p0,bb._p3,this._resizePoint),height=Calc.GetLinePointDistance(bb._p3,bb._p2,this._resizePoint),(lockRatio||this.shouldLockResizeRatio())&&(scale=Math.max(width/this.width,height/this.height),width=scale*this.width,height=scale*this.height),this._setSize(width,height,0,useAnchor?0:1)},HighlightSelect.prototype._resizeBL=function(bb,width,height,lockRatio,useAnchor){var scale;width=Calc.GetLinePointDistance(bb._p2,bb._p1,this._resizePoint),height=Calc.GetLinePointDistance(bb._p1,bb._p0,this._resizePoint),(lockRatio||this.shouldLockResizeRatio())&&(scale=Math.max(width/this.width,height/this.height),width=scale*this.width,height=scale*this.height),this._setSize(width,height,useAnchor?0:1,0)},HighlightSelect.prototype._resizeBR=function(bb,width,height,lockRatio){var scale;width=Calc.GetLinePointDistance(bb._p0,bb._p3,this._resizePoint),height=Calc.GetLinePointDistance(bb._p1,bb._p0,this._resizePoint),(lockRatio||this.shouldLockResizeRatio())&&(scale=Math.max(width/this.width,height/this.height),width=scale*this.width,height=scale*this.height),this._setSize(width,height,0,0)},HighlightSelect.prototype._setSize=function(width,height,anchorX,anchorY){this.anchorX=anchorX,this.anchorY=anchorY;var changeBase={width:width/this.scale,height:height/this.scale},changeByWidth=this._scaleObject(this._calculateWidthRelatedProperties(width,this.x,this.y)),changeByHeight=this._scaleObject(this._calculateHeightRelatedProperties(height,"undefined"==typeof changeByWidth.x?this.x:changeByWidth.x,"undefined"==typeof changeByWidth.y?this.y:changeByWidth.y)),changes=_.extend(changeBase,changeByWidth,changeByHeight),validated=this._element.validateProperties(changes);this.width=validated.width*this.scale,this.height=validated.height*this.scale},HighlightSelect.prototype._scaleObject=function(object){return _.mapValues(object,function(value){return value/this.scale}.bind(this))},HighlightSelect.prototype._setMode=function(mode){this._mode=mode,this.rotatable=mode!==HighlightSelect.MODE_CROP,this.view.setResizeMode(mode===HighlightSelect.MODE_RESIZE)},HighlightSelect.prototype._isSmall=function(){return this.width<SMALL_DIMENSIONS||this.height<SMALL_DIMENSIONS},HighlightSelect.prototype._isTiny=function(){return this.width<TINY_DIMENSIONS||this.height<TINY_DIMENSIONS},HighlightSelect.prototype._adjustCorners=function(){var smallClass="small-corners",tinyClass="tiny-corners";this._isSmall()?(this.view.domElement.classList.add(smallClass),this._isTiny()&&this.view.domElement.classList.add(tinyClass)):this.view.domElement.classList.remove(smallClass,tinyClass)},HighlightSelect.prototype._moveOnX=function(delta){var x=this._getSnappedFromStartingPointX(delta),validatedProperties=this._element.validateProperties({x:x,y:this._elementStartPoint.y});this.x=validatedProperties.x*this.scale,this.y=validatedProperties.y*this.scale},HighlightSelect.prototype._moveOnY=function(delta){var y=this._getSnappedFromStartingPointY(delta),validatedProperties=this._element.validateProperties({x:this._elementStartPoint.x,y:y});this.x=validatedProperties.x*this.scale,this.y=validatedProperties.y*this.scale},HighlightSelect.prototype._move=function(dx,dy){var x=this._getSnappedFromStartingPointX(dx),y=this._getSnappedFromStartingPointY(dy),validatedProperties=this._element.validateProperties({x:x,y:y});this.x=validatedProperties.x*this.scale,this.y=validatedProperties.y*this.scale},HighlightSelect}()},{"../../enums/ElementTypes.js":346,"../../enums/Orientations.js":356,"../../enums/Properties.js":358,"../../primitives/Point.js":403,"../../primitives/Rectangle.js":404,"../../utils/Base.js":405,"../../utils/Calc.js":407,"../AbstractElement.js":166,"../helpers/BrowserHelper.js":245,"../helpers/MoveTracer.js":253,"./Highlight.js":272,"./behaviors/Snappingable.js":285,"./views/HighlightSelectView.js":296,lodash:161}],279:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Base=_dereq_("../../utils/Base.js"),ElementTypes=_dereq_("../../enums/ElementTypes.js"),Events=_dereq_("../../enums/Events.js"),Properties=_dereq_("../../enums/Properties.js"),AbstractElement=_dereq_("../AbstractElement.js"),ImageCropView=_dereq_("./views/ImageCropView.js"),Rectangle=_dereq_("../../primitives/Rectangle.js"),Point=_dereq_("../../primitives/Point.js");module.exports=function(){function ImageCrop(){AbstractElement.apply(this,arguments),this.type=ElementTypes.IMAGE_CROP,this.view=new ImageCropView,this._rectClip=new Rectangle}var bbProperties=[Properties.X,Properties.Y,Properties.WIDTH,Properties.HEIGHT],point0=new Point,positionDelta=new Point,emitChange=_.debounce(function(imageCrop){imageCrop.Page.emit(Events.CROP_CHANGE,imageCrop.getCropSettings())},30);return ImageCrop.DefaultProperties={src:{value:""},originRect:{value:null},image:{value:null}},Base.Extend(ImageCrop,AbstractElement),Object.defineProperties(ImageCrop.prototype,{rect:{get:function(){return this._rectClip}},src:{get:function(){return this._src},set:function(value){this._src=value,this.view.img.src=this._getCdnUrl(value)}},originRect:{get:function(){return this._rect},set:function(value){this._rect=value,this.dirty=!0}},image:{get:function(){return this._image},set:function(value){this._image=value,this._setCropArea(value),this.dirty=!0}}}),ImageCrop.prototype.validateProperty=function(property,value){return _.contains(bbProperties,property)&&(value=this._validateBbProperty(property,value)),AbstractElement.prototype.validateProperty.call(this,property,value)},ImageCrop.prototype.validateProperties=function(properties){var rect,bbChanges=_.pick(properties,bbProperties),stdChanges=_.omit(properties,bbProperties),validated=_.clone(properties);if(!_.isEmpty(bbChanges)&&(rect=_.extend(this._rectClip.clone(),bbChanges),!this._rect.isInBounds(rect))){var maxBounds=this._rect.getMaxBounds(this._rectClip.clone(),rect);validated=_.extend(validated,_.mapValues(bbChanges,function(value,property){return"undefined"!=typeof maxBounds[property]?maxBounds[property]:this[property]}.bind(this)))}return _.isEmpty(stdChanges)||(validated=_.extend(validated,AbstractElement.prototype.validateProperties.call(this,properties))),validated},ImageCrop.prototype._validateBbProperty=function(property,value){var rect=this._rectClip.clone();return rect[property]=value,this._rect.isInBounds(rect)||(value=this[property]),value},ImageCrop.prototype.hitTest=function(p){return this.originRect.hitTest(p)?this:null},ImageCrop.prototype.getPositionDelta=function(){return positionDelta.x=this._rectClip.x-this._rect.x,positionDelta.y=this._rectClip.y-this._rect.y,this.angle&&positionDelta.rotate(point0,-this.angle),positionDelta},ImageCrop.prototype.getCropRectangle=function(){var delta=this.getPositionDelta();return new Rectangle(delta.x,delta.y,this._rectClip.width,this._rectClip.height)},ImageCrop.prototype.getImageRectangle=function(){return this._rectClip.clone()},ImageCrop.prototype.getMaxWidth=function(){return this._rect.x+this._rect.width-this._rectClip.x},ImageCrop.prototype.getMaxHeight=function(){return this._rect.y+this._rect.height-this._rectClip.y},ImageCrop.prototype.getCropSettings=function(){return{width:this.width,height:this.height,maxWidth:this.getMaxWidth(),maxHeight:this.getMaxHeight()}},ImageCrop.prototype.setCropSettings=function(settings){_.forEach(settings,function(value,property){this[property]=value}.bind(this))},ImageCrop.prototype.update=function(){AbstractElement.prototype.update.call(this),emitChange(this)},ImageCrop.prototype.updateProperty=function(property,value){this._updateProperty(property,value)},ImageCrop.prototype.imageProcessingStart=function(){this._disableTransformation(),this.Page.emit(Events.IMAGE_PROCESSING,!0)},ImageCrop.prototype.imageProcessingEnd=function(){this._enableTransformation(),this.Page.emit(Events.IMAGE_PROCESSING,!1)},ImageCrop.prototype._updateProperty=function(property,value){this[property]=value},ImageCrop.prototype._saveProperty=function(){},ImageCrop.prototype._setCropArea=function(image){this._rectClip=image.rect.clone(),_.isEmpty(image.crop)&&(this._rectClip.width=.8*image.width,this._rectClip.height=.8*image.height,this._rectClip.moveAlongAngle(.1*image.width,.1*image.height))},ImageCrop.prototype._getGroupTranslates=function(){return this.image._getGroupTranslates()},ImageCrop}()},{"../../enums/ElementTypes.js":346,"../../enums/Events.js":347,"../../enums/Properties.js":358,"../../primitives/Point.js":403,"../../primitives/Rectangle.js":404,"../../utils/Base.js":405,"../AbstractElement.js":166,"./views/ImageCropView.js":298,lodash:161}],280:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Base=_dereq_("../../utils/Base.js"),Parse=_dereq_("../../utils/Parse.js"),ElementTypes=_dereq_("../../enums/ElementTypes.js"),AbstractElement=_dereq_("../AbstractElement.js"),Linked=_dereq_("../behaviors/Linked.js"),ImageEditView=_dereq_("./views/ImageEditView.js");module.exports=function(){function ImageEdit(){AbstractElement.apply(this,arguments),this.type=ElementTypes.IMAGE_EDIT,this.view=new ImageEditView,this._imageElement=null,this._imageDrawn=!1,this._imageUpdateRef=this._onImageUpdate.bind(this),this._loadedResolve=null,this._loaded=new Promise(function(resolve){this._loadedResolve=resolve}.bind(this)),this.manipulator=null,this._loaded.then(function(){this.manipulator=new GlfxInterface(this.view.domElement,function(instance,canvas){this.view.domElement=canvas,instance.initializeRender(this.getAdjustments())}.bind(this))}.bind(this))}return ImageEdit.DefaultProperties={brightness:{value:0},contrast:{value:0},saturation:{value:0},vibrance:{value:0},exposure:{value:0},sharpen:{value:0},blur:{value:0},src:{value:""},image:{value:null}},Base.Extend(ImageEdit,AbstractElement),Base.ApplyBehavior(ImageEdit,Linked),Object.defineProperties(ImageEdit.prototype,{brightness:{get:function(){return this._brightness},set:function(value){this._brightness=value,this.manipulator&&this.manipulator.renderProperty("brightness",value)}},contrast:{get:function(){return this._contrast},set:function(value){this._contrast=value,this.manipulator&&this.manipulator.renderProperty("contrast",value)}},saturation:{get:function(){return this._saturation},set:function(value){this._saturation=value,this.manipulator&&this.manipulator.renderProperty("saturation",value)}},vibrance:{get:function(){return this._vibrance},set:function(value){this._vibrance=value,this.manipulator&&this.manipulator.renderProperty("vibrance",value)}},exposure:{get:function(){return this._exposure},set:function(value){this._exposure=value,this.manipulator&&this.manipulator.renderProperty("exposure",value)}},sharpen:{get:function(){return this._sharpen},set:function(value){this._sharpen=value,this.manipulator&&this.manipulator.renderProperty("sharpen",value)}},blur:{get:function(){return this._blur},set:function(value){this._blur=value,this.manipulator&&this.manipulator.renderProperty("blur",value)}},src:{get:function(){return this._src},set:function(value){this._src=value,this._imageDrawn=!1,this._imageElement=new Image,this._imageElement.crossOrigin="Anonymous",this._imageElement.onload=function(){this._onImageUpdate(this.image),this._updateAdjustments(),this._drawImage(),this._loadedResolve(this)}.bind(this),this._imageElement.src=this._getCdnUrl(value)}},image:{get:function(){return this._image},set:function(value){this._observeImage(value),this._image=value}}}),ImageEdit.prototype.loaded=function(){return this._loaded},ImageEdit.prototype.getAdjustments=function(){return{brightness:this.brightness,saturation:this.saturation,contrast:this.contrast,vibrance:this.vibrance,exposure:this.exposure,sharpen:this.sharpen,blur:this.blur}},ImageEdit.prototype.getChangedAdjustments=function(){return _.pick(this.getAdjustments(),function(value,property){return value!==this.image[property]}.bind(this))},ImageEdit.prototype.setAdjustments=function(settings){_.forEach(settings,function(value,property){this[property]=value}.bind(this))},ImageEdit.prototype.destroy=function(){this.removeChangeListener(this._imageUpdateRef),this.manipulator&&this.manipulator.destroy()},ImageEdit.prototype._observeImage=function(){this._image&&this.removeChangeListener(this._imageUpdateRef),this.addChangeListener(this._imageUpdateRef)},ImageEdit.prototype._onImageUpdate=function(image){this._rect=image._rect.clone(),this.dirty=!0},ImageEdit.prototype._updateAdjustments=function(){this.brightness=this.image.brightness,this.saturation=this.image.saturation,this.contrast=this.image.contrast,this.vibrance=this.image.vibrance,this.exposure=this.image.exposure,this.sharpen=this.image.sharpen,this.blur=this.image.blur},ImageEdit.prototype._drawImage=function(){var width=this._imageElement.naturalWidth,height=this._imageElement.naturalHeight;this.view.domElement.setAttribute("width",Parse.toPx(width)),this.view.domElement.setAttribute("height",Parse.toPx(height));var ctx=this.view.domElement.getContext("2d");ctx.drawImage(this._imageElement,0,0,width,height),this._imageDrawn=!0},ImageEdit.prototype._getGroupTranslates=function(){return this.image._getGroupTranslates()},ImageEdit}()},{"../../enums/ElementTypes.js":346,"../../utils/Base.js":405,"../../utils/Parse.js":415,"../AbstractElement.js":166,"../behaviors/Linked.js":231,"./views/ImageEditView.js":299,lodash:161}],281:[function(_dereq_,module,exports){"use strict";var Highlight=_dereq_("./Highlight.js"),Linked=_dereq_("../behaviors/Linked.js"),ElementTypes=_dereq_("../../enums/ElementTypes.js"),UploadStatus=_dereq_("../../enums/UploadStatus.js"),ImageUploadView=_dereq_("./views/ImageUploadView.js"),Base=_dereq_("../../utils/Base.js"),Calc=_dereq_("../../utils/Calc.js");module.exports=function(){function ImageUpload(){Highlight.apply(this,arguments),this.type=ElementTypes.IMAGE_UPLOAD,this.view=new ImageUploadView,this._progress=0,this._status=UploadStatus.READY}return Base.Extend(ImageUpload,Highlight),Base.ApplyBehavior(ImageUpload,Linked),Object.defineProperties(ImageUpload.prototype,{dirty:{set:function(value){this._dirty=value,this.update()}},progress:{get:function(){return this._progress},set:function(value){this._progress=value,this.dirty=!0}},status:{get:function(){return this._status},set:function(value){this._status!==value&&(this._status=value,this.dirty=!0)}}}),ImageUpload.prototype.getProgressPercentage=function(){return Calc.Round(100*this.progress,0)},ImageUpload.prototype.show=function(element){Highlight.prototype.show.call(this,element),this.addChangeListener(this.onElementChange.bind(this)),element.view.insertNodeAfter(this.view.domElement,element.view.domElement)},ImageUpload.prototype.remove=function(){this.view.destroyDomElement()},ImageUpload.prototype.onElementChange=function(element){this.x=element.x,this.y=element.y,this.width=element.width,this.height=element.height,this.angle=element.angle},ImageUpload.prototype._getGroupTranslates=function(){return this.element._getGroupTranslates()},ImageUpload}()},{"../../enums/ElementTypes.js":346,"../../enums/UploadStatus.js":362,"../../utils/Base.js":405,"../../utils/Calc.js":407,"../behaviors/Linked.js":231,"./Highlight.js":272,"./views/ImageUploadView.js":300}],282:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("../AbstractElement"),ElementTypes=_dereq_("../../enums/ElementTypes.js"),MultiSelectView=_dereq_("./views/MultiSelectView.js"),Base=_dereq_("../../utils/Base.js");module.exports=function(){function MultiSelect(){AbstractElement.apply(this,arguments),this.type=ElementTypes.MULTI_SELECT,this.view=new MultiSelectView,this.scale=1,this.startPoint=null,this._selection=null}return Base.Extend(MultiSelect,AbstractElement),Object.defineProperties(MultiSelect.prototype,{dirty:{get:function(){return this._dirty},set:function(value){this._dirty=value}}}),MultiSelect.prototype.show=function(selection){
this._selection=selection,this.view.setVisibility(!0),this.update(!0)},MultiSelect.prototype.hide=function(){this.view.setVisibility(!1),this._selection=null},MultiSelect.prototype.hasSelection=function(){return!!this._selection},MultiSelect.prototype.setScale=function(value){this._rect.multiply(value/this.scale),this._x=this._rect.x,this._y=this._rect.y,this._width=this._rect.width,this._height=this._rect.height,this.scale=value,this.update()},MultiSelect.prototype.update=function(shouldUpdateBoundingBox){shouldUpdateBoundingBox&&this._selection&&(this._rect=this._selection.clone().multiply(this.scale),this._x=this._rect.x,this._y=this._rect.y,this._width=this._rect.width,this._height=this._rect.height,this._angle=this._rect.angle),AbstractElement.prototype.update.call(this)},MultiSelect.prototype._updateProperty=function(){},MultiSelect.prototype._saveProperty=function(){},MultiSelect}()},{"../../enums/ElementTypes.js":346,"../../utils/Base.js":405,"../AbstractElement":166,"./views/MultiSelectView.js":301}],283:[function(_dereq_,module,exports){"use strict";var AttributesIndicator=_dereq_("./AttributesIndicator"),Linked=_dereq_("../behaviors/Linked.js"),Base=_dereq_("../../utils/Base.js"),ElementsHelper=_dereq_("../helpers/ElementsHelper.js"),MIN_X=(_dereq_("../../enums/IndicatorAlign.js"),2),MIN_Y=2;module.exports=function(){function NumberIndicator(id,Page,options){AttributesIndicator.apply(this,arguments),this.stateIa="visible"}return Base.Extend(NumberIndicator,AttributesIndicator),Base.ApplyBehavior(NumberIndicator,Linked),Object.defineProperties(NumberIndicator.prototype,{}),NumberIndicator.prototype.onElementChange=function(element){this.x=Math.max(element.x-this.options.width/2,MIN_X),this.y=Math.max(element.y-this.options.height/2,MIN_Y),this.width=this.options.width,this.height=this.options.height,this.fixed=this.element&&(this.element.fixed||ElementsHelper.isAncestorFixed(this.element)),this.update()},NumberIndicator}()},{"../../enums/IndicatorAlign.js":349,"../../utils/Base.js":405,"../behaviors/Linked.js":231,"../helpers/ElementsHelper.js":250,"./AttributesIndicator":265}],284:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("../AbstractElement"),ElementTypes=_dereq_("../../enums/ElementTypes.js"),SmartguideView=_dereq_("./views/SmartguideView.js"),Base=_dereq_("../../utils/Base.js"),Orientations=_dereq_("../../enums/Orientations.js"),Properties=_dereq_("../../enums/Properties.js");module.exports=function(){function Smartguide(id,page,orientation){AbstractElement.apply(this,arguments),this.type=ElementTypes.GUIDE,this.view=new SmartguideView,this.orientation=orientation,this.visibility=!1}return Base.Extend(Smartguide,AbstractElement),Object.defineProperties(Smartguide.prototype,{dirty:{get:function(){return this._dirty},set:function(value){this._dirty=value,value&&this.update()}},x:{get:function(){return Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.X).get.call(this)},set:function(value){this.orientation===Orientations.HORIZONTAL&&(value=0),Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.X).set.call(this,value)}},y:{get:function(){return Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.Y).get.call(this)},set:function(value){this.orientation===Orientations.VERTICAL&&(value=0),Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.Y).set.call(this,value)}},orientation:{get:function(){return this._orientation},set:function(value){this._orientation=value,value===Orientations.HORIZONTAL?this.height=1:this.width=1,this.view.setOrientation(value),this.dirty=!0}},visibility:{get:function(){return this._visibility},set:function(value){this._visibility=value,this.view.setVisibility(value)}}}),Smartguide.prototype.update=function(){this.visibility&&this.dirty&&(this.dirty=!1,this.view.updateTransform(this))},Smartguide.prototype._updateProperty=function(){},Smartguide.prototype._saveProperty=function(){},Smartguide}()},{"../../enums/ElementTypes.js":346,"../../enums/Orientations.js":356,"../../enums/Properties.js":358,"../../utils/Base.js":405,"../AbstractElement":166,"./views/SmartguideView.js":302}],285:[function(_dereq_,module,exports){"use strict";function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var _lodash=_dereq_("lodash"),ElementTypes=_dereq_("../../../enums/ElementTypes"),SnappingHelper=_dereq_("../../helpers/SnappingHelper");module.exports=function(){function Snappingable(){}return Snappingable.prototype._initSnapping=function(boundingBox){SnappingHelper.PrepareData(boundingBox,this._getElementsForSnapping(),this._getGuidesForSnapping(),this._element,this._getCanvasForSnapping(),this._getGridForSnapping())},Snappingable.prototype._getElementsForSnapping=function(){if(!this._isElementsSnappingEnabled())return{};var children=this._element.isVirtualGroup()?this._element.getAllChildrenSiblings():this._element.parent?this._element.parent.children:this.Page.canvas._getChildren();return(0,_lodash.reduce)(children,function(elements,element){return(0,_lodash.assign)(elements,_defineProperty({},element.id,element))},{})},Snappingable.prototype._getGuidesForSnapping=function(){return this._isGuidesSnappingEnabled()?this.Page.canvas.guides:[]},Snappingable.prototype._getCanvasForSnapping=function(){return this._isGuidesSnappingEnabled()?this.Page.canvas.getBoundingBox():{}},Snappingable.prototype._getGridForSnapping=function(){return this._isGuidesSnappingEnabled()?this.Page.getGridOptions():{}},Snappingable.prototype._isGuidesSnappingEnabled=function(){return this.Page.options.enableGuides&&this.Page.options.enableGuidesSnapping&&this._element.type!==ElementTypes.IMAGE_CROP},Snappingable.prototype._isElementsSnappingEnabled=function(){return this.Page.options.enableSmartGuides&&this.Page.options.enableSmartGuidesSnapping&&this._element.type!==ElementTypes.IMAGE_CROP},Snappingable.prototype._getSnappedX=function(x,ignoreScale){var scale=ignoreScale?1:this.scale;return SnappingHelper.GetSnappedX(Math.round(x/scale))*scale},Snappingable.prototype._getSnappedY=function(y,ignoreScale){var scale=ignoreScale?1:this.scale;return SnappingHelper.GetSnappedY(Math.round(y/scale))*scale},Snappingable.prototype._getSnappedFromStartingPointX=function(delta){return SnappingHelper.GetSnappedX(this._elementStartPoint.x+delta)},Snappingable.prototype._getSnappedFromStartingPointY=function(delta){return SnappingHelper.GetSnappedY(this._elementStartPoint.y+delta)},Snappingable}()},{"../../../enums/ElementTypes":346,"../../helpers/SnappingHelper":257,lodash:161}],286:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),ElementView=_dereq_("../../views/ElementView.js"),Parse=_dereq_("../../../utils/Parse.js"),IndicatorAlign=_dereq_("../../../enums/IndicatorAlign.js");module.exports=function(){function getAlignTranslate(element){var x=0,y=0;return alignmentMatch([IndicatorAlign.TOP_RIGHT,IndicatorAlign.BOTTOM_RIGHT],element.align)&&(x=element.width-INDICATOR_WIDTH),alignmentMatch([IndicatorAlign.BOTTOM_LEFT,IndicatorAlign.BOTTOM_RIGHT],element.align)&&(y=element.height),x||y?"translate("+Parse.toPx(x)+","+Parse.toPx(y)+")":""}function AttributesIndicatorView(options){this.options=options,ElementView.call(this)}var INDICATOR_WIDTH=12,alignmentMatch=function(alignments,elementAlignment){return alignments.indexOf(elementAlignment)!==-1};return AttributesIndicatorView.prototype=Object.create(ElementView.prototype),AttributesIndicatorView.constructor=AttributesIndicatorView,AttributesIndicatorView.prototype.createDomElement=function(){var el=document.createElement("FIGURE");return this.options.forceClassName||el.classList.add("el-indicator"),_.each(this.options.className,function(styleClass){return el.classList.add(styleClass)}),this.options.content&&(el.textContent=this.options.content),el},AttributesIndicatorView.prototype.updateTransform=function(element){this.domElement.style.transform="translate("+Parse.toPx(element.x)+","+Parse.toPx(element.y)+")rotate("+element.angle+"deg)"+getAlignTranslate(element),this.domElement.style["-webkit-transform"]=this.domElement.style.transform},AttributesIndicatorView}()},{"../../../enums/IndicatorAlign.js":349,"../../../utils/Parse.js":415,"../../views/ElementView.js":313,lodash:161}],287:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),ElementView=_dereq_("../../views/ElementView.js"),Parse=_dereq_("../../../utils/Parse.js"),Render=_dereq_("../../../utils/Render.js"),SingleCollaborationHighlight=function(){function getName(data){return data.username?data.username:data.email.slice(0,data.email.indexOf("@"))}function SingleCollaborationHighlight(data,element,scale){this.setViewData(data,element,scale,!0),ElementView.call(this),this.updateTransform()}return SingleCollaborationHighlight.prototype=Object.create(ElementView.prototype),SingleCollaborationHighlight.constructor=SingleCollaborationHighlight,SingleCollaborationHighlight.prototype.createDomElement=function(){var el=document.createElement("DIV");return el.classList.add("element-collaboration-indicator"),el.style.borderColor=this.color,el.appendChild(Render.ToDom(['<div class="user-info" style="background-color:',this.color,';">',this.username,"</div>"].join(""))),el},SingleCollaborationHighlight.prototype.setViewData=function(data,element,scale,initial){this._rect=element.getBoundingBox(!0);var rect=this._rect.clone().multiply(scale);this._scale=scale,this._x=rect.x,this._y=rect.y,this._width=rect.width,this._height=rect.height,this._angle=rect.angle,this.color=data.color,this.username=getName(data),!initial&&this.updateTransform(this)},SingleCollaborationHighlight.prototype.setScale=function(scale){if(this._scale!==scale){var rect=this._rect.clone().multiply(scale);this._scale=scale,this._x=rect.x,this._y=rect.y,this._width=rect.width,this._height=rect.height,this._angle=rect.angle}},SingleCollaborationHighlight.prototype.updateTransform=function(){this.domElement.style.width=Parse.toPx(this._width),this.domElement.style.height=Parse.toPx(this._height),this.domElement.style.transform="translate("+Parse.toPx(this._x)+","+Parse.toPx(this._y)+")rotate("+this._angle+"deg)",this.domElement.style["-webkit-transform"]=this.domElement.style.transform},SingleCollaborationHighlight}();module.exports=function(){function removeSingleCollaborationHighlight(highlight){highlight.destroyDomElement()}function CollaboratorView(data){this.data=data,this.viewHighlighters=[],ElementView.call(this)}return CollaboratorView.prototype=Object.create(ElementView.prototype),CollaboratorView.constructor=CollaboratorView,CollaboratorView.prototype.createDomElement=function(){var el=document.createElement("DIV");return el.classList.add("ng-collaboration-wrapper"),el},CollaboratorView.prototype.setViewData=function(data){this.data=data},CollaboratorView.prototype.setElements=function(isVisible,elements,scale){this.setVisibility(isVisible,!1),isVisible&&(this.viewHighlighters.length>elements.length&&this.viewHighlighters.splice(elements.length).forEach(removeSingleCollaborationHighlight),this.viewHighlighters=_.reduce(elements,function(highlighters,element,index){if(highlighters[index])return highlighters[index].setViewData(this.data,element,scale),highlighters;var highlighter=new SingleCollaborationHighlight(this.data,element,scale);return this.domElement.appendChild(highlighter.domElement),highlighters.concat(highlighter)}.bind(this),this.viewHighlighters))},CollaboratorView.prototype.setScale=function(scale){this.viewHighlighters.forEach(function(highlighter){highlighter.setScale(scale)})},CollaboratorView}()},{"../../../utils/Parse.js":415,"../../../utils/Render.js":416,"../../views/ElementView.js":313,lodash:161}],288:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("../../views/ElementView.js");module.exports=function(){function DrawIndicatorView(){ElementView.call(this)}return DrawIndicatorView.prototype=Object.create(ElementView.prototype),DrawIndicatorView.constructor=DrawIndicatorView,DrawIndicatorView.prototype.createDomElement=function(){var el=document.createElement("DIV");return el.classList.add("temporary-element","ghost-element"),el},DrawIndicatorView}()},{"../../views/ElementView.js":313}],289:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("../../views/ElementView.js"),Parse=_dereq_("../../../utils/Parse.js");module.exports=function(){function ElementIndicatorView(){ElementView.call(this)}var CLASS_VISIBLE="visible",CLASS_COORDINATES="element-coordinates",CLASS_DIMENSIONS="element-dimensions",CLASS_ROTATION="element-rotation";return ElementIndicatorView.prototype=Object.create(ElementView.prototype),ElementIndicatorView.constructor=ElementIndicatorView,ElementIndicatorView.prototype.createDomElement=function(){var el=document.createElement("DIV");return el},ElementIndicatorView.prototype.updateTransform=function(element){var transform="translate("+Parse.toPx(element.x)+","+Parse.toPx(element.y)+")"+(element.inside?" translate(-50%, -50%)":"");this.domElement.style.transform=transform,this.domElement.style["-webkit-transform"]=transform},ElementIndicatorView.prototype.showCoordinates=function(x,y){this.domElement.innerHTML="<span>x</span> "+parseInt(x)+"px <span>y</span> "+parseInt(y)+"px",this.domElement.classList.remove(CLASS_DIMENSIONS,CLASS_ROTATION),this.domElement.classList.add(CLASS_COORDINATES,CLASS_VISIBLE)},ElementIndicatorView.prototype.showDimensions=function(width,height){this.domElement.innerHTML="<span>"+parseInt(width)+"px</span><span>"+parseInt(height)+"px</span>",this.domElement.classList.remove(CLASS_COORDINATES,CLASS_ROTATION),this.domElement.classList.add(CLASS_DIMENSIONS,CLASS_VISIBLE)},ElementIndicatorView.prototype.showRotation=function(angle){this.domElement.innerHTML="<span>"+parseInt(angle)+"</span>",this.domElement.classList.remove(CLASS_COORDINATES,CLASS_DIMENSIONS),this.domElement.classList.add(CLASS_ROTATION,CLASS_VISIBLE)},ElementIndicatorView.prototype.hide=function(){this.domElement.classList.remove("visible")},ElementIndicatorView}()},{"../../../utils/Parse.js":415,"../../views/ElementView.js":313}],290:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("../../views/ElementView.js"),Parse=_dereq_("../../../utils/Parse.js");module.exports=function(){function ElementNameView(){ElementView.call(this)}return ElementNameView.prototype=Object.create(ElementView.prototype),ElementNameView.constructor=ElementNameView,ElementNameView.prototype.createDomElement=function(){var el=document.createElement("DIV");return el.classList.add("element-name-box"),el},ElementNameView.prototype.setVisibility=function(visibility){return visibility?void this.domElement.classList.add("visible"):void this.domElement.classList.remove("visible")},ElementNameView.prototype.setName=function(name){this.domElement.textContent=name},ElementNameView.prototype.setPosition=function(x,y){this.domElement.style.left=Parse.toPx(x),this.domElement.style.top=Parse.toPx(y)},ElementNameView}()},{"../../../utils/Parse.js":415,"../../views/ElementView.js":313}],291:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("../../views/ElementView.js"),Parse=_dereq_("../../../utils/Parse.js"),Orientations=_dereq_("../../../enums/Orientations.js");module.exports=function(){function GuideView(){ElementView.call(this)}return GuideView.prototype=Object.create(ElementView.prototype),GuideView.constructor=GuideView,GuideView.prototype.createDomElement=function(){var el=document.createElement("DIV");return el.classList.add("ng-guide"),el.classList.add("guideline"),el},GuideView.prototype.updateTransform=function(element){element.orientation===Orientations.HORIZONTAL?this.domElement.style.width=Parse.toPx(element.width):this.domElement.style.height=Parse.toPx(element.height),this.domElement.style.transform="translate("+Parse.toPx(element.x)+","+Parse.toPx(element.y)+")rotate(0deg)",this.domElement.style["-webkit-transform"]=this.domElement.style.transform},GuideView.prototype.setOrientation=function(value){this.domElement.classList.add(value)},GuideView.prototype.setVisibility=function(value){this.domElement.style.display=value?"block":"none"},GuideView}()},{"../../../enums/Orientations.js":356,"../../../utils/Parse.js":415,"../../views/ElementView.js":313}],292:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),ElementView=_dereq_("../../views/ElementView.js"),Parse=_dereq_("../../../utils/Parse.js"),Orientations=_dereq_("../../../enums/Orientations.js");module.exports=function(){function HighlightCellResizerView(){ElementView.call(this)}function createResizeHandler(className,index,position){var resizeHandler=document.createElement("div");return resizeHandler.style.left=position,resizeHandler.className=className,resizeHandler.classList.add("cell-resizer-handle"),resizeHandler.setAttribute("data-index",index),resizeHandler}return HighlightCellResizerView.prototype=Object.create(ElementView.prototype),HighlightCellResizerView.constructor=HighlightCellResizerView,HighlightCellResizerView.prototype.createDomElement=function(){var el=document.createElement("DIV");return el.classList.add("ng-highlight-cell-resizer","element-transformator","table-cell-resizer"),el},HighlightCellResizerView.prototype.initView=function(element,scale){this.domElement.innerHTML="",_.each(element.getRealCellWidths().slice(0,element.columnWidths.length-1),function(value,index){var position=Parse.toPx(element.getLeftOffsetForColumn(index+1)*scale),resizeHandler=createResizeHandler(Orientations.VERTICAL,index,position);this.domElement.appendChild(resizeHandler)},this)},HighlightCellResizerView.prototype.updateResizerPositions=function(element,scale){var position,cellWidths=element.getRealCellWidths(),iterationArray=new Array(Math.max(cellWidths.length-1,this.domElement.children.length));_.each(iterationArray,function(value,index){position=Parse.toPx(element.getLeftOffsetForColumn(index+1)*scale),this.domElement.children[index]?this.domElement.children[index]&&!cellWidths[index+1]?this.domElement.removeChild(this.domElement.children[index]):this.domElement.children[index].style.left=position:this.domElement.appendChild(createResizeHandler(Orientations.VERTICAL,index,position))},this)},HighlightCellResizerView.prototype.removeResizers=function(){for(var viewContainer=this.domElement;viewContainer.firstChild;)viewContainer.removeChild(viewContainer.firstChild)},HighlightCellResizerView.prototype.setResizerMoving=function(resizer,isMoving){isMoving?resizer.classList.add("moving"):resizer.classList.remove("moving")},HighlightCellResizerView.prototype.updateVerticalResizerPosition=function(index,left){var verticalResizers=this.domElement.getElementsByClassName(Orientations.VERTICAL);verticalResizers[index].style.left=Parse.toPx(left)},HighlightCellResizerView}()},{"../../../enums/Orientations.js":356,"../../../utils/Parse.js":415,"../../views/ElementView.js":313,lodash:161}],293:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("../../views/ElementView.js");module.exports=function(){function HighlightEditClippedView(){ElementView.call(this)}return HighlightEditClippedView.prototype=Object.create(ElementView.prototype),HighlightEditClippedView.constructor=HighlightEditClippedView,HighlightEditClippedView.prototype.createDomElement=function(){var el=document.createElement("DIV");return el.classList.add("clipped"),el.classList.add("clipped-edit"),el},HighlightEditClippedView}()},{"../../views/ElementView.js":313}],294:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("../../views/ElementView.js");module.exports=function(){function HighlightEditView(){ElementView.call(this)}return HighlightEditView.prototype=Object.create(ElementView.prototype),HighlightEditView.constructor=HighlightEditView,HighlightEditView.prototype.createDomElement=function(){var el=document.createElement("DIV");return el.classList.add("ng-highlight-edit","element-transformator","group-editing"),el},HighlightEditView.prototype.setMultistateMode=function(isMultistate){return isMultistate?void this.domElement.classList.add("multistate"):void this.domElement.classList.remove("multistate")},HighlightEditView}()},{"../../views/ElementView.js":313}],295:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("../../views/ElementView.js");module.exports=function(){function HighlightPartView(){ElementView.call(this)}return HighlightPartView.prototype=Object.create(ElementView.prototype),HighlightPartView.constructor=HighlightPartView,HighlightPartView.prototype.createDomElement=function(){var el=document.createElement("DIV");return el.classList.add("element-transformator-part"),el},HighlightPartView}()},{"../../views/ElementView.js":313}],296:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),ElementView=_dereq_("../../views/ElementView.js"),Render=_dereq_("../../../utils/Render.js");module.exports=function(){function getPositiveAngle(angle){return angle<0?360+angle:angle}function getRotatedClassIndex(angle){var STEP=45;return Math.floor(getPositiveAngle(angle-STEP/2)/STEP)}function HighlightSelectView(){this._rotatedClassName=ROTATED_CLASS_NAMES[7],ElementView.call(this)}var ROTATOR_SELECTOR='[data-rotator="1"]',ROTATION_CLASSES=["ng-rotator","rotate-corner"],ROTATED_CLASS_NAMES=["axis-part-7","axis-part-6","axis-part-5","axis-part-4","axis-part-3","axis-part-2","axis-part-1","axis-part-0"],template='<div class="center" title="Rotate"></div><div data-rotator="1" class="ng-rotator ng-rotateTL rotate-corner top-left" title="Rotate"></div><div data-rotator="1" class="ng-rotator ng-rotateTR rotate-corner top-right" title="Rotate"></div><div data-rotator="1" class="ng-rotator ng-rotateBL rotate-corner bottom-left" title="Rotate"></div><div data-rotator="1" class="ng-rotator ng-rotateBR rotate-corner bottom-right" title="Rotate"></div><div data-direction="TL" class="ng-resizer resize-corner top-left ng-resizeTL" title="Resize"></div><div data-direction="T" class="ng-resizer resize-corner top ng-resizeT" title="Resize"></div><div data-direction="TR" class="ng-resizer resize-corner top-right ng-resizeTR" title="Resize"></div><div data-direction="L" class="ng-resizer resize-corner left ng-resizeL" title="Resize"></div><div data-direction="R" class="ng-resizer resize-corner right ng-resizerR" title="Resize"></div><div data-direction="BL" class="ng-resizer resize-corner bottom-left ng-resizeBL" title="Resize"></div><div data-direction="B" class="ng-resizer resize-corner bottom ng-resizeB" title="Resize"></div><div data-direction="BR" class="ng-resizer resize-corner bottom-right ng-resizeBR" title="Resize"></div>';return HighlightSelectView.prototype=Object.create(ElementView.prototype),HighlightSelectView.constructor=HighlightSelectView,HighlightSelectView.prototype.createDomElement=function(){var el=document.createElement("DIV");return el.classList.add("ng-highlight-select","element-transformator","transforming"),el.innerHTML=Render.ToHtml(template),el},HighlightSelectView.prototype.setResizeMode=function(isResizeMode){isResizeMode?this.domElement.classList.remove("cropping"):this.domElement.classList.add("cropping")},HighlightSelectView.prototype.enableRotation=function(value){_.forEach(this.domElement.querySelectorAll(ROTATOR_SELECTOR),function(element){value?element.classList.add.apply(element.classList,ROTATION_CLASSES):element.classList.remove.apply(element.classList,ROTATION_CLASSES)})},HighlightSelectView.prototype.setTransformEnabled=function(value){return value?this.domElement.classList.remove("transform-disabled"):void this.domElement.classList.add("transform-disabled")},HighlightSelectView.prototype.setRotationEnabled=function(value){return value?this.domElement.classList.remove("no-rotate"):void this.domElement.classList.add("no-rotate")},HighlightSelectView.prototype.updateTransform=function(element){ElementView.prototype.updateTransform.call(this,element),this._updateRotatedClass(element.angle)},HighlightSelectView.prototype._updateRotatedClass=function(angle){var className=ROTATED_CLASS_NAMES[getRotatedClassIndex(angle)];this._rotatedClassName!==className&&(this.domElement.classList.remove(this._rotatedClassName),this.domElement.classList.add(className),this._rotatedClassName=className)},HighlightSelectView}()},{"../../../utils/Render.js":416,"../../views/ElementView.js":313,lodash:161}],297:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("../../views/ElementView.js");module.exports=function(){function HighlightView(){ElementView.call(this)}return HighlightView.prototype=Object.create(ElementView.prototype),HighlightView.constructor=HighlightView,HighlightView.prototype.createDomElement=function(){var el=document.createElement("DIV");return el.classList.add("ng-highlight","element-transformator"),el},HighlightView}()},{"../../views/ElementView.js":313}],298:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("../../views/ElementView.js"),Parse=_dereq_("../../../utils/Parse.js");module.exports=function(){function ImageCropView(){this.img=null,this.area=null,ElementView.call(this)}return ImageCropView.prototype=Object.create(ElementView.prototype),ImageCropView.constructor=ImageCropView,ImageCropView.prototype.createDomElement=function(){var el=document.createElement("div");return el.classList.add("ng-element"),el.classList.add("ng-crop-container"),this.img=document.createElement("img"),this.img.classList.add("ng-crop-image"),el.appendChild(this.img),this.area=document.createElement("div"),this.area.classList.add("ng-crop-area"),el.appendChild(this.area),el},ImageCropView.prototype.updateTransform=function(element){var delta=element.getPositionDelta();this.domElement.style.width=Parse.toPx(element.originRect.width),this.domElement.style.height=Parse.toPx(element.originRect.height),this.domElement.style.transform=element._getGroupRotation()+element._getGroupTranslates()+"translate("+Parse.toRealPx(element.originRect.x)+","+Parse.toRealPx(element.originRect.y)+") rotate("+element.originRect.angle+"deg)",this.domElement.style["-webkit-transform"]=this.domElement.style.transform,this.area.style.width=Parse.toPx(element.width),this.area.style.height=Parse.toPx(element.height),this.area.style.transform="translate("+Parse.toRealPx(delta.x)+","+Parse.toRealPx(delta.y)+")",this.area.style["-webkit-transform"]=this.area.style.transform},ImageCropView}()},{"../../../utils/Parse.js":415,"../../views/ElementView.js":313}],299:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("../../views/ElementView.js");module.exports=function(){function ImageEditView(){this.img=null,this.area=null,ElementView.call(this)}return ImageEditView.prototype=Object.create(ElementView.prototype),ImageEditView.constructor=ImageEditView,ImageEditView.prototype.createDomElement=function(){var el=document.createElement("canvas");return el.classList.add("ng-element"),el},ImageEditView}()},{"../../views/ElementView.js":313}],300:[function(_dereq_,module,exports){"use strict";var Render=_dereq_("../../../utils/Render.js"),ElementView=_dereq_("../../views/ElementView.js"),UploadStatus=_dereq_("../../../enums/UploadStatus.js"),VISIBLE_CLASS="visible",UPLOADING_CLASS="uploading-image";module.exports=function(){function ImageUploadView(){ElementView.call(this)}var template='<div class="ng-element upload-image-helper visible"><p class="progress-indicator"><span class="progress-uploading-info">Uploading image <strong class="progress-percentage"><%= progress %>%</strong></span></p><p class="failed-info">Upload failed, please try again.</p></div>';return ImageUploadView.prototype=Object.create(ElementView.prototype),ImageUploadView.constructor=ImageUploadView,ImageUploadView.prototype.createDomElement=function(){var el=Render.ToDom(template,{progress:100});return this.failedInfoEl=el.querySelector(".failed-info"),this.progressEl=el.querySelector(".progress-percentage"),this.progressIndicatorEl=el.querySelector(".progress-indicator"),el},ImageUploadView.prototype.updateTransform=function(element){ElementView.prototype.updateTransform.call(this,element),element.status===UploadStatus.READY?this.setReadyView():element.status===UploadStatus.PENDING?this.setPendingView(element.getProgressPercentage()):element.status===UploadStatus.COMPLETED?this.setCompletedView():element.status===UploadStatus.FAILED&&this.setFailedView()},ImageUploadView.prototype.setReadyView=function(){this.domElement.classList.remove(UPLOADING_CLASS),this.failedInfoEl.classList.remove(VISIBLE_CLASS)},ImageUploadView.prototype.setPendingView=function(progress){this.domElement.classList.add(UPLOADING_CLASS),this.failedInfoEl.classList.remove(VISIBLE_CLASS),this.progressEl.innerHTML=progress+"%",this.progressIndicatorEl.style.width=progress+"%"},ImageUploadView.prototype.setCompletedView=function(){this.setPendingView(100)},ImageUploadView.prototype.setFailedView=function(){this.domElement.classList.remove(UPLOADING_CLASS),this.failedInfoEl.classList.add(VISIBLE_CLASS)},ImageUploadView}()},{"../../../enums/UploadStatus.js":362,"../../../utils/Render.js":416,"../../views/ElementView.js":313}],301:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("../../views/ElementView.js");module.exports=function(){function MultiSelectView(){ElementView.call(this)}return MultiSelectView.prototype=Object.create(ElementView.prototype),MultiSelectView.constructor=MultiSelectView,MultiSelectView.prototype.createDomElement=function(){var el=document.createElement("DIV");return el.classList.add("ng-highlight"),el.classList.add("selector"),el},MultiSelectView}()},{"../../views/ElementView.js":313}],302:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("../../views/ElementView.js"),Parse=_dereq_("../../../utils/Parse.js");module.exports=function(){function SmartguideView(){ElementView.call(this)}return SmartguideView.prototype=Object.create(ElementView.prototype),SmartguideView.constructor=SmartguideView,SmartguideView.prototype.createDomElement=function(){var el=document.createElement("DIV");return el.classList.add("smartguide"),el},SmartguideView.prototype.updateTransform=function(element){this.domElement.style.transform="translate("+Parse.toPx(element.x)+","+Parse.toPx(element.y)+")rotate(0deg)",this.domElement.style["-webkit-transform"]=this.domElement.style.transform},SmartguideView.prototype.setOrientation=function(value){this.domElement.classList.add(value)},SmartguideView.prototype.setVisibility=function(value){this.domElement.style.display=value?"block":"none"},SmartguideView}()},{"../../../utils/Parse.js":415,"../../views/ElementView.js":313}],303:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("./ElementView.js");module.exports=function(){function ArrowView(){ElementView.apply(this,arguments)}var PATH_MARGIN=20;return ArrowView.prototype=Object.create(ElementView.prototype),ArrowView.constructor=ArrowView,ArrowView.prototype.createDomElement=function(){var el=this._createSvgElement("svg");el.classList.add("ng-element","el-arrow"),this.startMarkerId="start_marker_"+this.elementId,this.startMarkerPath=this._createSvgElement("path"),this.startMarkerPath.setAttribute("d","M 0 5 L 10 0 L 10 10 z"),this.endMarkerId="end_marker_"+this.elementId,this.endMarkerPath=this._createSvgElement("path"),this.endMarkerPath.setAttribute("d","M 0 0 L 10 5 L 0 10 z");var startMarker=this._createMarker(this.startMarkerId,4,9,5);startMarker.appendChild(this.startMarkerPath);var endMarker=this._createMarker(this.endMarkerId,4,1,5);endMarker.appendChild(this.endMarkerPath);var markersDefinitions=this._createSvgElement("defs");return markersDefinitions.appendChild(startMarker),markersDefinitions.appendChild(endMarker),this.path=this._createSvgElement("path"),this.path.setAttribute("stroke-width",5),
this.path.setAttribute("fill","none"),el.appendChild(markersDefinitions),el.appendChild(this.path),el},ArrowView.prototype.updateSvgPath=function(element){var pathPoints;pathPoints=element.isHorizontal()?this._createHorizontalPathPoints(element):this._createVerticalPathPoints(element);var path="M"+pathPoints.startX+","+pathPoints.startY+"q"+pathPoints.curveX+","+pathPoints.curveY+" "+pathPoints.endX+","+pathPoints.endY;this.path.setAttribute("d",path),this.path.setAttribute("stroke-width",element.stroke)},ArrowView.prototype.toggleArrowStartMarker=function(value){this.path.setAttribute("marker-start",value?"url(#"+this.startMarkerId+")":"none")},ArrowView.prototype.toggleArrowEndMarker=function(value){this.path.setAttribute("marker-end",value?"url(#"+this.endMarkerId+")":"none")},ArrowView.prototype._createMarker=function(id,size,refX,refY){var marker=this._createSvgElement("marker");return marker.setAttribute("id",id),marker.setAttribute("viewBox","0 0 10 10"),marker.setAttribute("markerUnits","strokeWidth"),marker.setAttribute("markerWidth",size),marker.setAttribute("markerHeight",size),marker.setAttribute("orient","auto"),marker.setAttribute("refX",refX),marker.setAttribute("refY",refY),marker},ArrowView.prototype._createVerticalPathPoints=function(element){var width=parseInt(element.width),height=parseInt(element.height),stroke=element.stroke,strokemod=3.2*stroke,points={};return points.startY=PATH_MARGIN+strokemod,element.isUpperCurve()?(points.startX=PATH_MARGIN+strokemod,points.curveX=2*width-3*points.startX,points.curveX<0&&(points.curveX=0)):element.isLowerCurve()?(points.startX=width-PATH_MARGIN-strokemod,points.curveX=0-2*width+3*PATH_MARGIN+2.5*strokemod,points.curveX>0&&(points.curveX=0)):(points.startX=width/2,points.curveX=0),points.curveY=height/2-points.startY,points.endX=0,points.endY=height-2*points.startY,points},ArrowView.prototype._createHorizontalPathPoints=function(element){var width=parseInt(element.width),height=parseInt(element.height),stroke=element.stroke,strokemod=3.2*stroke,points={};return points.startX=PATH_MARGIN+strokemod,points.curveX=width/2-PATH_MARGIN-strokemod,element.isUpperCurve()?(points.startY=height-PATH_MARGIN-strokemod,points.curveY=0-2*height+3*PATH_MARGIN+2.5*strokemod,points.curveY>0&&(points.curveY=0)):element.isLowerCurve()?(points.startY=PATH_MARGIN+strokemod,points.curveY=2*height-3*PATH_MARGIN-2.5*strokemod,points.curveY<0&&(points.curveY=0)):(points.startY=height/2,points.curveY=0),points.endX=width-PATH_MARGIN-PATH_MARGIN-2*strokemod,points.endY=0,points},ArrowView.prototype.setColor=function(value){this.path.setAttribute("stroke",value),this.startMarkerPath.setAttribute("fill",value),this.endMarkerPath.setAttribute("fill",value)},ArrowView}()},{"./ElementView.js":313}],304:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("./ElementView.js"),Styles=_dereq_("../../enums/Styles.js"),Parse=_dereq_("../../utils/Parse.js");module.exports=function(){function BannerView(){ElementView.apply(this,arguments)}return BannerView.prototype=Object.create(ElementView.prototype),BannerView.constructor=BannerView,BannerView.prototype.createDomElement=function(){var el=document.createElement("DIV");return el.classList.add("ng-element"),el.classList.add("el-banner"),el},BannerView.prototype.setBackgroundImage=function(value){this.setStyle(Styles.BACKGROUND_IMAGE,Parse.backgroundImageString(value))},BannerView}()},{"../../enums/Styles.js":361,"../../utils/Parse.js":415,"./ElementView.js":313}],305:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),ElementView=_dereq_("./ElementView.js"),Styles=_dereq_("../../enums/Styles.js"),Parse=_dereq_("../../utils/Parse.js"),ElementTypes=_dereq_("../../enums/ElementTypes.js");module.exports=function(){function BoxView(){ElementView.apply(this,arguments)}return BoxView.prototype=Object.create(ElementView.prototype),BoxView.constructor=BoxView,BoxView.prototype.createDomElement=function(){this.textElement=document.createElement("p"),this.textElement.id=this.createId(ElementTypes.BOX);var el=document.createElement("DIV");return el.classList.add("ng-element"),el.classList.add("el-box"),el.classList.add("text-editor-light"),el.classList.add("line-height-hack"),el.appendChild(this.textElement),el},BoxView.prototype.setElementId=function(id){ElementView.prototype.setElementId.call(this,id),this.textElement.dataset.id=id},BoxView.prototype.getEditableElement=function(){return this.textElement},BoxView.prototype.setBorderTopWidth=function(value){this.setStyle(Styles.BORDER_TOP_WIDTH,Parse.toPx(value))},BoxView.prototype.setBorderBottomWidth=function(value){this.setStyle(Styles.BORDER_BOTTOM_WIDTH,Parse.toPx(value))},BoxView.prototype.setBorderLeftWidth=function(value){this.setStyle(Styles.BORDER_LEFT_WIDTH,Parse.toPx(value))},BoxView.prototype.setBorderRightWidth=function(value){this.setStyle(Styles.BORDER_RIGHT_WIDTH,Parse.toPx(value))},BoxView.prototype.setBorderTopLeftRadius=function(value){this.setStyle(Styles.BORDER_TOP_LEFT_RADIUS,Parse.toPx(value))},BoxView.prototype.setBorderTopRightRadius=function(value){this.setStyle(Styles.BORDER_TOP_RIGHT_RADIUS,Parse.toPx(value))},BoxView.prototype.setBorderBottomRightRadius=function(value){this.setStyle(Styles.BORDER_BOTTOM_RIGHT_RADIUS,Parse.toPx(value))},BoxView.prototype.setBorderBottomLeftRadius=function(value){this.setStyle(Styles.BORDER_BOTTOM_LEFT_RADIUS,Parse.toPx(value))},BoxView.prototype.setBorderColor=function(value){this.setStyle(Styles.BORDER_COLOR,value)},BoxView.prototype.setBorderStyle=function(value){this.setStyle(Styles.BORDER_STYLE,value)},BoxView.prototype.setBackgroundColor=function(value){this.setStyle(Styles.BACKGROUND_COLOR,value)},BoxView.prototype.setBackgroundImage=function(value){this.setStyle(Styles.BACKGROUND_IMAGE,Parse.backgroundImageString(value))},BoxView.prototype.setBackgroundSize=function(value){this.setStyle(Styles.BACKGROUND_SIZE,value)},BoxView.prototype.setBackgroundRepeat=function(value){this.setStyle(Styles.BACKGROUND_REPEAT,value)},BoxView.prototype.setBackgroundPosition=function(value){this.setStyle(Styles.BACKGROUND_POSITION,value)},BoxView.prototype.setTextAlign=function(value){this.textElement.style[Styles.TEXT_ALIGN]=value},BoxView.prototype.setInputValue=function(value){if(!_.isEmpty(value)){var spanContainer,htmlContainer=document.createElement("div");htmlContainer.innerHTML=value,this.parseTextWhitespaces(htmlContainer);var containerChild=htmlContainer.firstChild;containerChild&&"P"===containerChild.nodeName?containerChild.style.fontSize?(spanContainer=document.createElement("span"),spanContainer.style.fontSize=containerChild.style.fontSize,spanContainer.innerHTML=containerChild.innerHTML,this.textElement.innerHTML="",this.textElement.appendChild(spanContainer)):this.textElement.innerHTML=containerChild.innerHTML:this.textElement.innerHTML=htmlContainer.innerHTML}},BoxView.prototype.setPaddingTop=function(value){this.setStyle(Styles.PADDING_TOP,Parse.toPx(value))},BoxView.prototype.setPaddingRight=function(value){this.setStyle(Styles.PADDING_RIGHT,Parse.toPx(value))},BoxView.prototype.setPaddingBottom=function(value){this.setStyle(Styles.PADDING_BOTTOM,Parse.toPx(value))},BoxView.prototype.setPaddingLeft=function(value){this.setStyle(Styles.PADDING_LEFT,Parse.toPx(value))},BoxView.prototype.setShadowEnabled=function(){},BoxView.prototype.setShadowOffsetX=function(){},BoxView.prototype.setShadowOffsetY=function(){},BoxView.prototype.setShadowBlur=function(){},BoxView.prototype.setShadowColor=function(){},BoxView.prototype.setGrayscale=function(){},BoxView.prototype.setColor=function(value){this.forEachTextParent(function(node){node.style.color=value})},BoxView.prototype.parseTextWhitespaces=function(node){3===node.nodeType?node.textContent=node.textContent.replace(/\B(?!^)\s/g,""):_.forEach(node.childNodes,this.parseTextWhitespaces,this)},BoxView}()},{"../../enums/ElementTypes.js":346,"../../enums/Styles.js":361,"../../utils/Parse.js":415,"./ElementView.js":313,lodash:161}],306:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("./ElementView.js"),ElementTypes=_dereq_("../../enums/ElementTypes.js"),Styles=_dereq_("../../enums/Styles.js"),ClassNames=_dereq_("../../enums/ClassNames.js"),Color=_dereq_("../../utils/Color.js"),Parse=_dereq_("../../utils/Parse.js");module.exports=function(){function insertSpace(){var range=window.getSelection().getRangeAt(0),node=range.createContextualFragment("&nbsp;");range.insertNode(node),window.getSelection().collapseToEnd(),window.getSelection().modify("move","forward","character")}function ButtonView(){ElementView.apply(this,arguments),this.backgroundColorGradient=!1}var STATES={ACTIVE:"active",INACTIVE:"inactive",PUSHED:"pushed"};return ButtonView.prototype=Object.create(ElementView.prototype),ButtonView.constructor=ButtonView,ButtonView.prototype.createDomElement=function(){var el=document.createElement("button");return el.id=this.createId(ElementTypes.BUTTON),el.classList.add("ng-element"),el.classList.add("el-button"),el.addEventListener("keydown",function(e){32===e.keyCode&&el.contentEditable&&(e.preventDefault(),insertSpace())}),el},ButtonView.prototype.setInputValue=function(value){this.domElement.innerHTML=value.replace(/&nbsp;/g," ")},ButtonView.prototype.setColor=function(value){this.setStyle(Styles.COLOR,value)},ButtonView.prototype.setFontSize=function(value){this.setStyle(Styles.FONT_SIZE,Parse.toPx(value))},ButtonView.prototype.setFontWeight=function(value){this.setStyle(Styles.FONT_WEIGHT,value)},ButtonView.prototype.setFontStyle=function(value){this.setStyle(Styles.FONT_STYLE,value)},ButtonView.prototype.setTextDecoration=function(value){this.setStyle(Styles.TEXT_DECORATION,value)},ButtonView.prototype.setTextAlign=function(value){this.setStyle(Styles.TEXT_ALIGN,value)},ButtonView.prototype.setPaddingTop=function(value){this.setStyle(Styles.PADDING_TOP,Parse.toPx(value))},ButtonView.prototype.setPaddingRight=function(value){this.setStyle(Styles.PADDING_RIGHT,Parse.toPx(value))},ButtonView.prototype.setPaddingBottom=function(value){this.setStyle(Styles.PADDING_BOTTOM,Parse.toPx(value))},ButtonView.prototype.setPaddingLeft=function(value){this.setStyle(Styles.PADDING_LEFT,Parse.toPx(value))},ButtonView.prototype.setBorderTopWidth=function(value){this.setStyle(Styles.BORDER_TOP_WIDTH,Parse.toPx(value))},ButtonView.prototype.setBorderBottomWidth=function(value){this.setStyle(Styles.BORDER_BOTTOM_WIDTH,Parse.toPx(value))},ButtonView.prototype.setBorderLeftWidth=function(value){this.setStyle(Styles.BORDER_LEFT_WIDTH,Parse.toPx(value))},ButtonView.prototype.setBorderRightWidth=function(value){this.setStyle(Styles.BORDER_RIGHT_WIDTH,Parse.toPx(value))},ButtonView.prototype.setBorderTopLeftRadius=function(value){this.setStyle(Styles.BORDER_TOP_LEFT_RADIUS,Parse.toPx(value))},ButtonView.prototype.setBorderTopRightRadius=function(value){this.setStyle(Styles.BORDER_TOP_RIGHT_RADIUS,Parse.toPx(value))},ButtonView.prototype.setBorderBottomRightRadius=function(value){this.setStyle(Styles.BORDER_BOTTOM_RIGHT_RADIUS,Parse.toPx(value))},ButtonView.prototype.setBorderBottomLeftRadius=function(value){this.setStyle(Styles.BORDER_BOTTOM_LEFT_RADIUS,Parse.toPx(value))},ButtonView.prototype.setBorderColor=function(value){this.setStyle(Styles.BORDER_COLOR,value)},ButtonView.prototype.setBorderStyle=function(value){this.setStyle(Styles.BORDER_STYLE,value)},ButtonView.prototype.setBackgroundSize=function(value){this.setStyle(Styles.BACKGROUND_SIZE,value)},ButtonView.prototype.setBackgroundRepeat=function(value){this.setStyle(Styles.BACKGROUND_REPEAT,value)},ButtonView.prototype.setBackgroundPosition=function(value){this.setStyle(Styles.BACKGROUND_POSITION,value)},ButtonView.prototype.setBackgroundImage=function(value){value?this.setStyle(Styles.BACKGROUND_IMAGE,Parse.backgroundImageString(value)):this.backgroundColorGradient&&this.setBackgroundColorGradient(this.backgroundColorGradient)},ButtonView.prototype.setBackgroundColor=function(value){this.setStyle(Styles.BACKGROUND_COLOR,value),this.backgroundColorGradient&&this.setBackgroundColorGradient(this.backgroundColorGradient)},ButtonView.prototype.setBackgroundColorGradient=function(value){var gradientColor,gradientStyles,baseColor=Color.rgbaStringToHex(value);return this.backgroundColorGradient=value,baseColor?(gradientColor=Color.illuminate(baseColor,.2),gradientStyles=["linear-gradient(bottom, "+baseColor+" 0%, "+gradientColor+" 100%)","-o-linear-gradient(bottom, "+baseColor+" 0%, "+gradientColor+" 100%)","-moz-linear-gradient(bottom, "+baseColor+" 0%, "+gradientColor+" 100%)","-webkit-linear-gradient(bottom, "+baseColor+" 0%, "+gradientColor+" 100%)","-ms-linear-gradient(bottom, "+baseColor+" 0%, "+gradientColor+" 100%)"],void gradientStyles.forEach(function(styleString){this.setStyle(Styles.BACKGROUND_IMAGE,styleString)}.bind(this))):this.setStyle(Styles.BACKGROUND_IMAGE,"none")},ButtonView.prototype.setOpacity=function(value,state){state===STATES.INACTIVE?this.setStyle(Styles.OPACITY,.5*value):this.setStyle(Styles.OPACITY,value)},ButtonView.prototype.setState=function(value,opacity){value===STATES.INACTIVE?(this.domElement.classList.remove(ClassNames.PUSHED),this.setStyle(Styles.OPACITY,.5*opacity)):value===STATES.PUSHED?(this.domElement.classList.add(ClassNames.PUSHED),this.setStyle(Styles.OPACITY,opacity)):(this.domElement.classList.remove(ClassNames.PUSHED),this.setStyle(Styles.OPACITY,opacity))},ButtonView.prototype.setBoxShadow=function(value){this.setStyle(Styles.BOX_SHADOW,value)},ButtonView.prototype.setShadowEnabled=function(){},ButtonView.prototype.setShadowOffsetX=function(){},ButtonView.prototype.setShadowOffsetY=function(){},ButtonView.prototype.setShadowBlur=function(){},ButtonView.prototype.setShadowColor=function(){},ButtonView.prototype.setGrayscale=function(){},ButtonView.prototype.getDomFocusableElement=function(){return this.domElement},ButtonView}()},{"../../enums/ClassNames.js":345,"../../enums/ElementTypes.js":346,"../../enums/Styles.js":361,"../../utils/Color.js":409,"../../utils/Parse.js":415,"./ElementView.js":313}],307:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),ElementView=_dereq_("./ElementView.js"),Parse=_dereq_("../../utils/Parse.js"),Styles=_dereq_("../../enums/Styles.js"),ClassNames=_dereq_("../../enums/ClassNames.js");module.exports=function(){function getDataSetZoomValueByScale(value){return value>1?"in":value<1?"out":""}function CanvasView(containerEl){this.containerDomElement=containerEl,this.overlayDomElement=null,this.elementsOverlayDomElement=null,this.gridDomElement=null,this.workbenchDomElement=null,this.canvasHelperDomElement=null,ElementView.apply(this,_.rest(arguments))}var gridColor="rgb(255, 229, 229)";return CanvasView.prototype=Object.create(ElementView.prototype),CanvasView.constructor=CanvasView,CanvasView.prototype.setScale=function(value){this.domElement.dataset.zoom=getDataSetZoomValueByScale(value),this.domElement.style.transform="scale("+value+","+value+")",this.domElement.style["-webkit-transform"]=this.domElement.style.transform,this._setGridScale(value)},CanvasView.prototype.createDomElement=function(){this._createContaineromElement();var el=this._createCanvasDomElement();return this._createOverlayDomElement(),this._createElementsOverlayDomElement(),this._createGridDomElement(),this._createCanvasHelperDomElement(),this._setWorkbenchDomElement(),this._initCanvasRulersElement(),el},CanvasView.prototype.setBackgroundColor=function(value){this.setStyle(Styles.BACKGROUND_COLOR,value)},CanvasView.prototype.setBackgroundImage=function(value){this.setStyle(Styles.BACKGROUND_IMAGE,Parse.backgroundImageString(value))},CanvasView.prototype.setBackgroundSize=function(value){this.setStyle(Styles.BACKGROUND_SIZE,value)},CanvasView.prototype.setBackgroundRepeat=function(value){this.setStyle(Styles.BACKGROUND_REPEAT,value)},CanvasView.prototype.setBackgroundPosition=function(value){this.setStyle(Styles.BACKGROUND_POSITION,value)},CanvasView.prototype.updateGrid=function(canvas){return canvas.gridDisplay?(this._moveGridTo(canvas.gridOnTop?this.overlayDomElement:this.domElement),this._setGridScale(canvas.scale),this.gridDomElement.style.display="block",this.gridDomElement.style.width="100%"===canvas.gridWidth?canvas.gridWidth:Parse.toPx(canvas.gridWidth),this.gridDomElement.style.borderLeftWidth=Parse.toPx(canvas.gridMargin),this.gridDomElement.style.borderRightWidth=Parse.toPx(canvas.gridMargin),this.gridDomElement.style.backgroundSize=Parse.toPx(canvas.gridColumnWidth+canvas.gridGutter)+" 100%",void(this.gridDomElement.style.backgroundImage="linear-gradient(to right, "+gridColor+" 0px, "+gridColor+" "+Parse.toPx(canvas.gridColumnWidth)+", transparent "+Parse.toPx(canvas.gridColumnWidth)+", transparent "+Parse.toPx(canvas.gridColumnWidth+canvas.gridGutter)+")")):void(this.gridDomElement.style.display="none")},CanvasView.prototype.clearCanvas=function(){return},CanvasView.prototype.showOverlay=function(){this.overlayDomElement.style.display="block"},CanvasView.prototype.hideOverlay=function(){this.overlayDomElement.style.display="none"},CanvasView.prototype.showElementsOverlay=function(){this.elementsOverlayDomElement.style.display="block"},CanvasView.prototype.hideElementsOverlay=function(){this.elementsOverlayDomElement.style.display="none"},CanvasView.prototype._createContaineromElement=function(){"string"==typeof this.containerDomElement&&(this.containerDomElement=document.querySelector(this.containerDomElement))},CanvasView.prototype._initCanvasRulersElement=function(){this.canvasRulersElement=document.querySelector("."+ClassNames.RULERS_WRAPPER),this.canvasRulersElement||(this.canvasRulersElement=document.createElement("div"))},CanvasView.prototype._createCanvasDomElement=function(){var el=this.containerDomElement.querySelector("."+ClassNames.NG_CANVAS);return el?el.style.zIndex="auto":(el=document.createElement("div"),el.className=ClassNames.NG_CANVAS,this.containerDomElement.appendChild(el)),el},CanvasView.prototype._createOverlayDomElement=function(){this.overlayDomElement=this.containerDomElement.querySelector("."+ClassNames.NG_OVERLAY),this.overlayDomElement||(this.overlayDomElement=document.createElement("div"),this.overlayDomElement.className=ClassNames.NG_OVERLAY,this.containerDomElement.appendChild(this.overlayDomElement))},CanvasView.prototype._createElementsOverlayDomElement=function(){this.elementsOverlayDomElement=document.createElement("div"),this.elementsOverlayDomElement.className=ClassNames.NG_ELEMENTS_OVERLAY,this.overlayDomElement.appendChild(this.elementsOverlayDomElement)},CanvasView.prototype._createGridDomElement=function(){this.gridDomElement=document.createElement("div"),this.gridDomElement.className=ClassNames.NG_GRID,this.overlayDomElement.appendChild(this.gridDomElement)},CanvasView.prototype._createCanvasHelperDomElement=function(){this.canvasHelperDomElement=document.createElement("div"),this.canvasHelperDomElement.className=ClassNames.NG_CANVAS_HELPER,this.containerDomElement.parentNode.appendChild(this.canvasHelperDomElement)},CanvasView.prototype._moveGridTo=function(container){this.gridDomElement.parentNode!==container&&(this.gridDomElement.parentNode&&this.gridDomElement.parentNode.removeChild(this.gridDomElement),container.childNodes.length>0?container.insertBefore(this.gridDomElement,container.childNodes[0]):container.appendChild(this.gridDomElement))},CanvasView.prototype._setGridScale=function(value){this.gridDomElement.parentNode===this.domElement&&(value=1),this.gridDomElement.style.transform="scale("+value+", 1)translate3d(0, 0, 0)"},CanvasView.prototype.appendToOverlay=function(elements){var fragment=document.createDocumentFragment();elements.forEach(function(child){fragment.appendChild(child)}),this.elementsOverlayDomElement.appendChild(fragment)},CanvasView.prototype.removeNode=function(node){node.parentNode.removeChild(node)},CanvasView.prototype._setWorkbenchDomElement=function(){this.workbenchDomElement=document.getElementById("workbench")},CanvasView}()},{"../../enums/ClassNames.js":345,"../../enums/Styles.js":361,"../../utils/Parse.js":415,"./ElementView.js":313,lodash:161}],308:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("./ElementView.js"),Styles=_dereq_("../../enums/Styles.js"),ElementTypes=_dereq_("../../enums/ElementTypes.js"),SIDES=_dereq_("../../enums/Sides"),PageModes=_dereq_("../../enums/PageModes.js");module.exports=function(){function CheckboxView(){ElementView.apply(this,arguments)}return CheckboxView.prototype=Object.create(ElementView.prototype),CheckboxView.constructor=CheckboxView,CheckboxView.prototype.createDomElement=function(){var elementId=this.createId(ElementTypes.CHECKBOX);this.inputElement=document.createElement("input"),this.inputElement.id=elementId,this.inputElement.type="checkbox",this.labelElement=document.createElement("label"),this.labelElement.id="checkbox-label-"+elementId,this.labelElement.dataset.id=this.elementId,this.pageMode===PageModes.PREVIEW&&this.labelElement.setAttribute("for",elementId);var el=document.createElement("div");return el.className="ng-element",el.classList.add("el-form-control"),el.classList.add("line-height-hack"),el.appendChild(this.inputElement),el.appendChild(this.labelElement),el},CheckboxView.prototype.getEditableElement=function(){return this.labelElement},CheckboxView.prototype.getEditableElementId=function(){return this.getEditableElement().id},CheckboxView.prototype.setColor=function(value){this.setStyle(Styles.COLOR,value)},CheckboxView.prototype.setTextAlign=function(value){this.setStyle(Styles.TEXT_ALIGN,value)},CheckboxView.prototype.setInputValue=function(value){var htmlContainer=document.createElement("div");htmlContainer.innerHTML=value;var containerChild=htmlContainer.firstChild;containerChild&&"P"===containerChild.nodeName?(this.setTextAlign(containerChild.style.textAlign),this.labelElement.innerHTML=containerChild.innerHTML,containerChild.style.fontSize&&(this.labelElement.style.fontSize=containerChild.style.fontSize)):this.labelElement.innerHTML=value},CheckboxView.prototype.setChecked=function(value){this.inputElement.checked=value},CheckboxView.prototype.setDisabled=function(value){this.inputElement.disabled=value},CheckboxView.prototype.setPosition=function(value){return value===SIDES.RIGHT?void this.domElement.classList.add("switched-right"):void this.domElement.classList.remove("switched-right")},CheckboxView.prototype.getDomFocusableElement=function(){return this.inputElement},CheckboxView}()},{"../../enums/ElementTypes.js":346,"../../enums/PageModes.js":357,"../../enums/Sides":360,"../../enums/Styles.js":361,"./ElementView.js":313}],309:[function(_dereq_,module,exports){"use strict";var BoxView=_dereq_("./BoxView.js"),ElementTypes=_dereq_("../../enums/ElementTypes.js");module.exports=function(){function CircleView(){BoxView.apply(this,arguments)}return CircleView.prototype=Object.create(BoxView.prototype),CircleView.constructor=CircleView,CircleView.prototype.createDomElement=function(){this.textElement=document.createElement("p"),this.textElement.id=this.createId(ElementTypes.CIRCLE);var el=document.createElement("div");return el.classList.add("ng-element"),el.classList.add("el-circle"),el.classList.add("text-editor-light"),el.appendChild(this.textElement),el},CircleView}()},{"../../enums/ElementTypes.js":346,"./BoxView.js":305}],310:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("./ElementView.js");module.exports=function(){function ClipartView(){ElementView.apply(this,arguments)}return ClipartView.prototype=Object.create(ElementView.prototype),ClipartView.constructor=ClipartView,ClipartView.prototype.createDomElement=function(){var el=document.createElement("IMG");return el.classList.add("ng-element"),el.classList.add("el-image-no-back"),el},ClipartView.prototype.setSrc=function(value){this.domElement.src!==value&&(this.domElement.src=value)},ClipartView}()},{"./ElementView.js":313}],311:[function(_dereq_,module,exports){"use strict";var GroupView=_dereq_("./GroupView.js");module.exports=function(){function ComponentView(){GroupView.apply(this,arguments)}return ComponentView.prototype=Object.create(GroupView.prototype),ComponentView.constructor=ComponentView,ComponentView}()},{"./GroupView.js":316}],312:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("./ElementView.js"),Styles=_dereq_("../../enums/Styles.js"),Parse=_dereq_("../../utils/Parse.js"),ElementTypes=_dereq_("../../enums/ElementTypes.js");module.exports=function(){function DialogView(){ElementView.apply(this,arguments)}return DialogView.prototype=Object.create(ElementView.prototype),DialogView.constructor=DialogView,DialogView.prototype.createDomElement=function(){var containerDiv=document.createElement("div");return this.dialogElement=document.createElement("div"),containerDiv.appendChild(this.dialogElement),this.dialogElement.id=this.createId(ElementTypes.DIALOG),this.dialogElement.classList.add("ng-element"),this.dialogElement.classList.add("el-dialog"),this.closeButtonElement=document.createElement("div"),this.closeButtonElement.innerHTML="",this.closeButtonElement.className="close",this.topbarElement=document.createElement("header"),this.topbarElement.className="topbar",this.contentElement=document.createElement("div"),this.contentElement.className="content",this.bottombarElement=document.createElement("footer"),this.bottombarElement.className="bottombar",this.dialogElement.appendChild(this.topbarElement),this.dialogElement.appendChild(this.closeButtonElement),this.dialogElement.appendChild(this.contentElement),this.dialogElement.appendChild(this.bottombarElement),containerDiv},DialogView.prototype.updateTransform=function(element){this.dialogElement.style.width=Parse.toPx(element.width),this.dialogElement.style.height=Parse.toPx(element.height),this.dialogElement.style.transform=element._getGroupRotation()+element._getGroupTranslates()+"translate("+Parse.toPx(element.x)+","+Parse.toPx(element.y)+")rotate("+element.angle+"deg)",this.dialogElement.style["-webkit-transform"]=this.dialogElement.style.transform},DialogView.prototype.setStyle=function(property,value){this.dialogElement.style[property]=value},DialogView.prototype.setBackgroundColor=function(value){this.setStyle(Styles.BACKGROUND_COLOR,value)},DialogView.prototype.setBorderColor=function(value){this.setStyle(Styles.BORDER_COLOR,value)},DialogView.prototype.setBorderStyle=function(value){this.setStyle(Styles.BORDER_STYLE,value)},DialogView.prototype.setBorderRadius=function(value){this.setStyle(Styles.BORDER_RADIUS,Parse.toPx(value))},DialogView.prototype.setBorderWidth=function(value){this.setStyle(Styles.BORDER_WIDTH,Parse.toPx(value))},DialogView.prototype.setTopbarDisplay=function(value){this.topbarElement.style[Styles.DISPLAY]=value},DialogView.prototype.setTopbarBackgroundColor=function(value){this.topbarElement.style[Styles.BACKGROUND_COLOR]=value},DialogView.prototype.setTopbarText=function(value){this.topbarElement.innerHTML=value},DialogView.prototype.setTopbarColor=function(value){this.topbarElement.style[Styles.COLOR]=value},DialogView.prototype.setTopbarFontWeight=function(value){this.topbarElement.style[Styles.FONT_WEIGHT]=value},DialogView.prototype.setTopbarFontStyle=function(value){this.topbarElement.style[Styles.FONT_STYLE]=value},DialogView.prototype.setTopbarFontSize=function(value){this.topbarElement.style[Styles.FONT_SIZE]=value},DialogView.prototype.setTopbarFontFamily=function(value){this.topbarElement.style[Styles.FONT_FAMILY]=value},DialogView.prototype.setTopbarTextAlign=function(value){this.topbarElement.style[Styles.TEXT_ALIGN]=value},DialogView.prototype.setContentBackgroundColor=function(value){this.contentElement.style[Styles.BACKGROUND_COLOR]=value},DialogView.prototype.setContentText=function(value){this.contentElement.innerHTML=value},DialogView.prototype.setContentColor=function(value){this.contentElement.style[Styles.COLOR]=value},DialogView.prototype.setContentFontWeight=function(value){this.contentElement.style[Styles.FONT_WEIGHT]=value},DialogView.prototype.setContentFontStyle=function(value){this.contentElement.style[Styles.FONT_STYLE]=value},DialogView.prototype.setContentFontSize=function(value){this.contentElement.style[Styles.FONT_SIZE]=value},DialogView.prototype.setContentFontFamily=function(value){this.contentElement.style[Styles.FONT_FAMILY]=value},DialogView.prototype.setContentTextAlign=function(value){this.contentElement.style[Styles.TEXT_ALIGN]=value},DialogView.prototype.setBottombarDisplay=function(value){this.bottombarElement.style[Styles.DISPLAY]=value},DialogView.prototype.setBottombarBackgroundColor=function(value){this.bottombarElement.style[Styles.BACKGROUND_COLOR]=value},DialogView.prototype.setModalOverlayDisplay=function(value){if("block"===value){var modalOverlay=document.createElement("div");modalOverlay.classList.add("modal-overlay"),this.dialogElement.parentElement.insertBefore(modalOverlay,this.dialogElement)}},DialogView}()},{"../../enums/ElementTypes.js":346,"../../enums/Styles.js":361,"../../utils/Parse.js":415,"./ElementView.js":313}],313:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Styles=_dereq_("../../enums/Styles.js"),ClassNames=_dereq_("../../enums/ClassNames.js"),Parse=_dereq_("../../utils/Parse.js"),ElementsHelper=_dereq_("../helpers/ElementsHelper.js"),TextStyleHelper=_dereq_("../helpers/TextStyleHelper.js");module.exports=function(){function ElementView(elementId,pageMode){this.elementId=elementId,this.pageMode=pageMode,this.domElement=this.createDomElement(),this.setElementId(this.elementId)}return ElementView.prototype.createDomElement=function(){return null},ElementView.prototype.createId=function(elementType){return elementType+ElementsHelper.GetUniqueId(elementType)},ElementView.prototype.setElementId=function(id){this.domElement.dataset&&(this.domElement.dataset.id=id)},ElementView.prototype.destroyDomElement=function(){this.domElement.remove(),this.domElement=null},ElementView.prototype.insertNodeAfter=function(newNode,existingNode){existingNode.parentNode&&(existingNode.nextSibling?existingNode.parentNode.insertBefore(newNode,existingNode.nextSibling):existingNode.parentNode.appendChild(newNode))},ElementView.prototype.setEditing=function(value){value?(this.setTextContentEditable(value),this.domElement.classList.add(ClassNames.NG_EDITING)):(this.removeTextFocus(),this.domElement.classList.remove(ClassNames.NG_EDITING))},ElementView.prototype.setTextContentEditable=function(value){this.getEditableElement().setAttribute("contentEditable",value)},ElementView.prototype.forEachTextParent=function(callback){var nodes=this.domElement.querySelectorAll("*");_.each(nodes,function(node){var isTextElementParent=Array.prototype.filter.call(node.childNodes,function(node){return node.nodeType===window.Node.TEXT_NODE}).length>0;isTextElementParent&&callback(node)})},ElementView.prototype.removeTextFocus=function(){this.getEditableElement().blur()},ElementView.prototype.getEditableElement=function(){return this.domElement},ElementView.prototype.getEditableElementId=function(){return this.getEditableElement().id},ElementView.prototype.updateTransform=function(element){this.domElement.style.width=Parse.toPx(element.width),this.domElement.style.height=Parse.toPx(element.height),this.domElement.style.transform=element._getGroupRotation()+element._getGroupTranslates()+"translate("+Parse.toPx(element.x)+","+Parse.toPx(element.y)+")rotate("+element.angle+"deg)",this.domElement.style["-webkit-transform"]=this.domElement.style.transform},ElementView.prototype.removeAllChildren=function(){for(;this.domElement.firstChild;)this.domElement.removeChild(this.domElement.firstChild)},ElementView.prototype.isFixed=function(){return this.domElement.classList.contains(ClassNames.FIXED_POSITION)},ElementView.prototype.setCustomStyles=function(styles){var _this=this;_.forEach(styles,function(value,property){
_this.domElement.style[property]!==value&&(_this.domElement.style[property]=value)})},ElementView.prototype.removeCustomStyles=function(properties){var _this2=this;_.forEach(properties,function(property){_this2.domElement.style.removeProperty(_.kebabCase(property))})},ElementView.prototype.setFixed=function(value){value?this.domElement.classList.add(ClassNames.FIXED_POSITION):this.domElement.classList.remove(ClassNames.FIXED_POSITION)},ElementView.prototype.setFixedOffset=function(point){this.setStyle(Styles.LEFT,Parse.toPx(point.x)),this.setStyle(Styles.TOP,Parse.toPx(point.y))},ElementView.prototype.setStateIa=function(value){this.setVisibility(value)},ElementView.prototype.setVisibility=function(value,isElementLocked){this.setStyle(Styles.DISPLAY,value?"":"none"),void 0!==isElementLocked&&(value&&isElementLocked?this.domElement.classList.add(ClassNames.LOCKED):this.domElement.classList.remove(ClassNames.LOCKED))},ElementView.prototype.setOpacity=function(value){this.setStyle(Styles.OPACITY,value)},ElementView.prototype.setStyle=function(property,value){this.domElement.style[property]=value},ElementView.prototype.setInteractive=function(value){value?this.domElement.classList.add(ClassNames.INTERACTIVE):this.domElement.classList.remove(ClassNames.INTERACTIVE)},ElementView.prototype.setFontFamily=function(value){TextStyleHelper.SetFontClass(this.domElement,value)},ElementView.prototype.getInputValue=function(){return null},ElementView.prototype.getDomFocusableElement=function(){return null},ElementView.prototype.getComputedStyle=function(property,element){return element=element||this.domElement,window.getComputedStyle(element).getPropertyValue(property)},ElementView.prototype._createSvgElement=function(nodeName){var el=document.createElementNS("http://www.w3.org/2000/svg",nodeName);return"svg"===nodeName&&el.setAttribute("version","1.2"),el},ElementView}()},{"../../enums/ClassNames.js":345,"../../enums/Styles.js":361,"../../utils/Parse.js":415,"../helpers/ElementsHelper.js":250,"../helpers/TextStyleHelper.js":261,lodash:161}],314:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),ElementView=_dereq_("./ElementView.js");module.exports=function(){function GeoSVGView(){ElementView.apply(this,arguments)}var SVG_NS="http://www.w3.org/2000/svg";return GeoSVGView.prototype=Object.create(ElementView.prototype),GeoSVGView.constructor=GeoSVGView,GeoSVGView.prototype.createDomElement=function(){var el=document.createElementNS(SVG_NS,"svg");return el.setAttribute("version","1.2"),el.setAttribute("preserveAspectRatio","none"),el.setAttribute("viewBox","0 0 100 100"),el.classList.add("ng-element"),el},GeoSVGView.prototype.setColor=function(value){this.domElement.setAttribute("fill",value)},GeoSVGView.prototype.setElement=function(config){this.removeAllChildren();var element=document.createElementNS(SVG_NS,config.tag);_.forEach(config.data,function(attribute){element.setAttribute(attribute.attributeName,attribute.attributeValue)}),this.domElement.appendChild(element)},GeoSVGView}()},{"./ElementView.js":313,lodash:161}],315:[function(_dereq_,module,exports){"use strict";var BoxView=_dereq_("./BoxView.js");module.exports=function(){function GlassCanvasView(){BoxView.apply(this,arguments)}return GlassCanvasView.prototype=Object.create(BoxView.prototype),GlassCanvasView.constructor=GlassCanvasView,GlassCanvasView.prototype.createDomElement=function(){this.displayElement=document.createElement("div"),this.displayElement.className="glass-display";var el=document.createElement("div");return el.className="ng-element el-glass-canvas",el.appendChild(this.displayElement),el},GlassCanvasView}()},{"./BoxView.js":305}],316:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("./ElementView.js"),Parse=_dereq_("../../utils/Parse.js");module.exports=function(){function GroupView(){ElementView.apply(this,arguments)}return GroupView.prototype=Object.create(ElementView.prototype),GroupView.constructor=GroupView,GroupView.prototype.createDomElement=function(){var el=document.createElement("DIV");return el.classList.add("el-group"),el},GroupView.prototype.setClip=function(value){value?this.domElement.classList.add("clipped"):(this.domElement.classList.remove("clipped"),this.domElement.style.width="",this.domElement.style.height="",this.domElement.style.transform="",this.domElement.style["-webkit-transform"]=this.domElement.style.transform)},GroupView.prototype.setClipScrollX=function(value){value?this.domElement.classList.add("scroll-x"):this.domElement.classList.remove("scroll-x")},GroupView.prototype.setClipScrollY=function(value){value?this.domElement.classList.add("scroll-y"):this.domElement.classList.remove("scroll-y")},GroupView.prototype.updateTransform=function(element){element.isClip&&(this.domElement.style.width=element._clippingRect.width+"px",this.domElement.style.height=element._clippingRect.height+"px",this.domElement.style.transform=element._getGroupRotation()+element._getGroupTranslates()+"translate3d("+Parse.toPx(element._clippingRect.x)+","+Parse.toPx(element._clippingRect.y)+",0)rotate("+element.angle+"deg)",this.domElement.style["-webkit-transform"]=this.domElement.style.transform)},GroupView}()},{"../../utils/Parse.js":415,"./ElementView.js":313}],317:[function(_dereq_,module,exports){"use strict";var ScrollbarView=_dereq_("./ScrollbarView.js"),Properties=_dereq_("../../enums/Properties.js");module.exports=function(){function HorizontalScrollbarView(){ScrollbarView.apply(this,arguments),this.sizeProperty=Properties.WIDTH,this.positionProperty="left"}return HorizontalScrollbarView.prototype=Object.create(ScrollbarView.prototype),HorizontalScrollbarView.constructor=HorizontalScrollbarView,HorizontalScrollbarView.prototype.createDomElement=function(){var el=ScrollbarView.prototype.createDomElement.call(this);return this.topButtonElement.style.removeProperty("width"),this.topButtonElement.style.height="100%",this.topButtonElement.classList.remove("upper"),this.topButtonElement.classList.add("left"),this.barElement.style.removeProperty("width"),this.barElement.style.height="100%",this.barElement.classList.remove("inner"),this.barElement.classList.add("horizontal-inner"),this.bottomButtonElement.style.removeProperty("width"),this.bottomButtonElement.style.height="100%",this.bottomButtonElement.classList.remove("lower"),this.bottomButtonElement.classList.add("right"),this.scrollElement.style.removeProperty("width"),this.scrollElement.style.height="100%",this.scrollElement.classList.remove("scroll"),this.scrollElement.classList.add("horizontal-scroll"),el},HorizontalScrollbarView}()},{"../../enums/Properties.js":358,"./ScrollbarView.js":331}],318:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("./ElementView.js");module.exports=function(){function HotspotView(){ElementView.apply(this,arguments)}return HotspotView.prototype=Object.create(ElementView.prototype),HotspotView.constructor=HotspotView,HotspotView.prototype.createDomElement=function(){var el=document.createElement("DIV");return el.classList.add("ng-element"),el.classList.add("el-hotspot"),el},HotspotView}()},{"./ElementView.js":313}],319:[function(_dereq_,module,exports){"use strict";var SvgSymbolView=_dereq_("./SvgSymbolView.js"),Styles=_dereq_("../../enums/Styles.js"),Parse=_dereq_("../../utils/Parse.js");module.exports=function(){function IOS7View(){SvgSymbolView.apply(this,arguments)}return IOS7View.prototype=Object.create(SvgSymbolView.prototype),IOS7View.constructor=IOS7View,IOS7View.prototype.updateViewBox=function(width,height){this.domElement.setAttribute("viewBox","0 0 "+2*width+" "+2*height),this.setStyle(Styles.WIDTH,Parse.toPx(width)),this.setStyle(Styles.HEIGHT,Parse.toPx(height))},IOS7View}()},{"../../enums/Styles.js":361,"../../utils/Parse.js":415,"./SvgSymbolView.js":335}],320:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("./ElementView.js"),Styles=_dereq_("../../enums/Styles.js"),Parse=_dereq_("../../utils/Parse.js");module.exports=function(){function ImageView(){ElementView.apply(this,arguments)}var placeholderValue="/p/imagepixel.png",nonPlaceHolderClass="el-image-no-back";return ImageView.prototype=Object.create(ElementView.prototype),ImageView.constructor=ImageView,ImageView.prototype.createDomElement=function(){var el=document.createElement("IMG");return el.classList.add("ng-element","el-image",nonPlaceHolderClass),el},ImageView.prototype.setLoading=function(value){value?this.domElement.classList.add("ng-loading"):this.domElement.classList.remove("ng-loading")},ImageView.prototype.setSrc=function(value,cors){var _this=this;this.domElement.src!==value&&(value&&value.indexOf(placeholderValue)>-1?this.domElement.classList.remove(nonPlaceHolderClass):this.domElement.classList.add(nonPlaceHolderClass),cors&&(this.domElement.crossOrigin="Anonymous"),this.domElement.onerror=function(){_this.domElement.src+="?"+Date.now(),_this.domElement.onerror=null},this.domElement.src=value)},ImageView.prototype.setFilter=function(value){this.setStyle(Styles.FILTER,value)},ImageView.prototype.setBorderTopLeftRadius=function(value){this.setStyle(Styles.BORDER_TOP_LEFT_RADIUS,Parse.toPx(value))},ImageView.prototype.setBorderTopRightRadius=function(value){this.setStyle(Styles.BORDER_TOP_RIGHT_RADIUS,Parse.toPx(value))},ImageView.prototype.setBorderBottomRightRadius=function(value){this.setStyle(Styles.BORDER_BOTTOM_RIGHT_RADIUS,Parse.toPx(value))},ImageView.prototype.setBorderBottomLeftRadius=function(value){this.setStyle(Styles.BORDER_BOTTOM_LEFT_RADIUS,Parse.toPx(value))},ImageView}()},{"../../enums/Styles.js":361,"../../utils/Parse.js":415,"./ElementView.js":313}],321:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("./ElementView.js"),Styles=_dereq_("../../enums/Styles.js"),Parse=_dereq_("../../utils/Parse.js");module.exports=function(){function Input2View(){ElementView.apply(this,arguments)}return Input2View.prototype=Object.create(ElementView.prototype),Input2View.constructor=Input2View,Input2View.prototype.createDomElement=function(){var el=document.createElement("input");return el.className="ng-element el-input-without-label",el},Input2View.prototype.setEditing=function(value){value?this.domElement.classList.add("ng-editing"):this.domElement.classList.remove("ng-editing"),this.domElement.focus()},Input2View.prototype.getInputValue=function(){return this.domElement.value},Input2View.prototype.setBorderTopWidth=function(value){this.setStyle(Styles.BORDER_TOP_WIDTH,Parse.toPx(value))},Input2View.prototype.setBorderBottomWidth=function(value){this.setStyle(Styles.BORDER_BOTTOM_WIDTH,Parse.toPx(value))},Input2View.prototype.setBorderLeftWidth=function(value){this.setStyle(Styles.BORDER_LEFT_WIDTH,Parse.toPx(value))},Input2View.prototype.setBorderRightWidth=function(value){this.setStyle(Styles.BORDER_RIGHT_WIDTH,Parse.toPx(value))},Input2View.prototype.setBorderTopLeftRadius=function(value){this.setStyle(Styles.BORDER_TOP_LEFT_RADIUS,Parse.toPx(value))},Input2View.prototype.setBorderTopRightRadius=function(value){this.setStyle(Styles.BORDER_TOP_RIGHT_RADIUS,Parse.toPx(value))},Input2View.prototype.setBorderBottomRightRadius=function(value){this.setStyle(Styles.BORDER_BOTTOM_RIGHT_RADIUS,Parse.toPx(value))},Input2View.prototype.setBorderBottomLeftRadius=function(value){this.setStyle(Styles.BORDER_BOTTOM_LEFT_RADIUS,Parse.toPx(value))},Input2View.prototype.setBorderColor=function(value){this.setStyle(Styles.BORDER_COLOR,value)},Input2View.prototype.setBorderStyle=function(value){this.setStyle(Styles.BORDER_STYLE,value)},Input2View.prototype.setBackgroundColor=function(value){this.setStyle(Styles.BACKGROUND_COLOR,value)},Input2View.prototype.setBackgroundImage=function(value){this.setStyle(Styles.BACKGROUND_IMAGE,"url("+value+")")},Input2View.prototype.setBackgroundSize=function(value){this.setStyle(Styles.BACKGROUND_SIZE,value)},Input2View.prototype.setBackgroundRepeat=function(value){this.setStyle(Styles.BACKGROUND_REPEAT,value)},Input2View.prototype.setBackgroundPosition=function(value){this.setStyle(Styles.BACKGROUND_POSITION,value)},Input2View.prototype.setColor=function(value){this.setStyle(Styles.COLOR,value)},Input2View.prototype.setFontSize=function(value){this.setStyle(Styles.FONT_SIZE,Parse.toPx(value))},Input2View.prototype.setFontWeight=function(value){this.setStyle(Styles.FONT_WEIGHT,value)},Input2View.prototype.setFontStyle=function(value){this.setStyle(Styles.FONT_STYLE,value)},Input2View.prototype.setTextDecoration=function(value){this.setStyle(Styles.TEXT_DECORATION,value)},Input2View.prototype.setTextAlign=function(value){this.setStyle(Styles.TEXT_ALIGN,value)},Input2View.prototype.setPaddingTop=function(value){this.setStyle(Styles.PADDING_TOP,Parse.toPx(value))},Input2View.prototype.setPaddingRight=function(value){this.setStyle(Styles.PADDING_RIGHT,Parse.toPx(value))},Input2View.prototype.setPaddingBottom=function(value){this.setStyle(Styles.PADDING_BOTTOM,Parse.toPx(value))},Input2View.prototype.setPaddingLeft=function(value){this.setStyle(Styles.PADDING_LEFT,Parse.toPx(value))},Input2View.prototype.setInputValue=function(value){this.domElement.value=value},Input2View.prototype.setInactive=function(value){this.domElement.disabled=!!value},Input2View.prototype.setInputType=function(value){this.domElement.type=value},Input2View.prototype.setRequired=function(){},Input2View.prototype.setBoxShadow=function(value){this.setStyle(Styles.BOX_SHADOW,value)},Input2View.prototype.getDomFocusableElement=function(){return this.domElement},Input2View}()},{"../../enums/Styles.js":361,"../../utils/Parse.js":415,"./ElementView.js":313}],322:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("./ElementView.js"),Parse=_dereq_("../../utils/Parse.js"),TextStyleHelper=_dereq_("../helpers/TextStyleHelper.js");module.exports=function(){function InputWithLabelView(){ElementView.apply(this,arguments)}return InputWithLabelView.prototype=Object.create(ElementView.prototype),InputWithLabelView.constructor=InputWithLabelView,InputWithLabelView.prototype.createDomElement=function(){this.labelElement=document.createElement("label"),this.inputElement=document.createElement("input"),this.labelElement.style.display="inline-block",this.labelElement.style.marginRight="20px";var el=document.createElement("div");return el.className="ng-element el-input-with-label",el.appendChild(this.labelElement),el.appendChild(this.inputElement),el},InputWithLabelView.prototype.getComputedHeight=function(){var labelHeight=this.getComputedStyle("height",this.labelElement),inputHeight=this.getComputedStyle("height",this.inputElement);return Parse.toPx(parseInt(labelHeight)+parseInt(inputHeight))},InputWithLabelView.prototype.setBorderTopLeftRadius=function(value){this.inputElement.style.borderTopLeftRadius=Parse.toPx(value)},InputWithLabelView.prototype.setBorderTopRightRadius=function(value){this.inputElement.style.borderTopRightRadius=Parse.toPx(value)},InputWithLabelView.prototype.setBorderBottomRightRadius=function(value){this.inputElement.style.borderBottomRightRadius=Parse.toPx(value)},InputWithLabelView.prototype.setBorderBottomLeftRadius=function(value){this.inputElement.style.borderBottomLeftRadius=Parse.toPx(value)},InputWithLabelView.prototype.setColor=function(value){this.labelElement.style.color=value,this.inputElement.style.color=value},InputWithLabelView.prototype.setFontSize=function(value){this.labelElement.style.fontSize=Parse.toPx(value),this.inputElement.style.fontSize=Parse.toPx(value)},InputWithLabelView.prototype.setFontWeight=function(value){this.labelElement.style.fontWeight=value,this.inputElement.style.fontWeight=value},InputWithLabelView.prototype.setFontStyle=function(value){this.labelElement.style.fontStyle=value,this.inputElement.style.fontStyle=value},InputWithLabelView.prototype.setFontFamily=function(value){TextStyleHelper.SetFontClass(this.labelElement,value),TextStyleHelper.SetFontClass(this.inputElement,value)},InputWithLabelView.prototype.setTextDecoration=function(value){this.labelElement.style.textDecoration=value},InputWithLabelView.prototype.setTextAlign=function(value){this.labelElement.style.textAlign=value},InputWithLabelView.prototype.setLabelPosition=function(value){"top"===value?this.setLabelPositionTop():this.setLabelPositionLeft()},InputWithLabelView.prototype.setLabelPositionLeft=function(){this.labelElement.style.display="inline-block",this.labelElement.style.marginRight="20px"},InputWithLabelView.prototype.setLabelPositionTop=function(){this.labelElement.style.display="block",this.labelElement.style.marginRight="0px"},InputWithLabelView.prototype.setLabelText=function(value){this.labelElement.textContent=value},InputWithLabelView.prototype.setInputValue=function(value){this.inputElement.value=value},InputWithLabelView.prototype.setLabelWidth=function(value){this.labelElement.style.width=Parse.toPx(value)},InputWithLabelView.prototype.setInputWidth=function(value){this.inputElement.style.width=Parse.toPx(value)},InputWithLabelView.prototype.setInactive=function(value){this.inputElement.disabled=!!value},InputWithLabelView.prototype.setInputType=function(value){this.inputElement.type=value},InputWithLabelView.prototype.setRequired=function(){},InputWithLabelView.prototype.getDomFocusableElement=function(){return this.inputElement},InputWithLabelView}()},{"../../utils/Parse.js":415,"../helpers/TextStyleHelper.js":261,"./ElementView.js":313}],323:[function(_dereq_,module,exports){"use strict";var TextElementView=_dereq_("./TextElementView.js"),ElementTypes=_dereq_("../../enums/ElementTypes.js");module.exports=function(){function LabelView(){TextElementView.apply(this,arguments)}return LabelView.prototype=Object.create(TextElementView.prototype),LabelView.constructor=LabelView,LabelView.prototype.createDomElement=function(){var el=TextElementView.prototype.createDomElement.call(this);return el.id=this.createId(ElementTypes.LABEL),el},LabelView}()},{"../../enums/ElementTypes.js":346,"./TextElementView.js":339}],324:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("./ElementView.js"),LINE_BORDER_SPACE=10;module.exports=function(){function LineView(){ElementView.apply(this,arguments)}return LineView.prototype=Object.create(ElementView.prototype),LineView.constructor=LineView,LineView.prototype.createDomElement=function(){var el=this._createSvgElement("svg");return el.classList.add("ng-element"),this.lineElement=this._createSvgElement("line"),this.lineElement.setAttribute("x1","0"),this.lineElement.setAttribute("y1","5"),this.lineElement.setAttribute("x2","300"),this.lineElement.setAttribute("y2","5"),this.lineElement.setAttribute("stroke","black"),this.lineElement.setAttribute("stroke-width",10),el.appendChild(this.lineElement),el},LineView.prototype.updateLineSvg=function(element){var dasharray="",linecap="",strokeWidth=element.height-LINE_BORDER_SPACE,points={x1:0,x2:element.width,y1:element.height/2,y2:element.height/2};switch(element.isVertical()&&(points.x1=element.width/2,points.x2=element.width/2,points.y1=0,points.y2=element.height,strokeWidth=element.width-LINE_BORDER_SPACE),this.lineElement.setAttribute("x1",points.x1),this.lineElement.setAttribute("x2",points.x2),this.lineElement.setAttribute("y1",points.y1),this.lineElement.setAttribute("y2",points.y2),this.lineElement.setAttribute("stroke-width",strokeWidth),element.lineType){case"dotted":linecap="round",dasharray="0.5,"+strokeWidth;break;case"dashed":dasharray=3*strokeWidth+","+3*strokeWidth}this.lineElement.setAttribute("stroke-linecap",linecap),this.lineElement.setAttribute("stroke-dasharray",dasharray)},LineView.prototype.setStroke=function(value){this.lineElement.setAttribute("stroke",value)},LineView}()},{"./ElementView.js":313}],325:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),ElementView=_dereq_("./ElementView.js"),Styles=_dereq_("../../enums/Styles.js"),Parse=_dereq_("../../utils/Parse.js"),TextStyleHelper=_dereq_("../helpers/TextStyleHelper.js");module.exports=function(){function LinkListView(){ElementView.apply(this,arguments)}return LinkListView.prototype=Object.create(ElementView.prototype),LinkListView.constructor=LinkListView,LinkListView.prototype.createDomElement=function(){var el=document.createElement("div");return el.className="ng-element el-link-list",this.headerElement=document.createElement("div"),this.headerElement.className="header",this.listElement=document.createElement("ul"),el.appendChild(this.headerElement),el.appendChild(this.listElement),el},LinkListView.prototype.setHeaderDisplay=function(value){this.headerElement.style.display=value?"block":"none"},LinkListView.prototype.setHeaderText=function(value){this.headerElement.innerHTML=value},LinkListView.prototype.setInputValue=function(value){this.listElement.innerHTML="",value.forEach(function(record){var li=document.createElement("li"),anchor=document.createElement("a");anchor.href="#",anchor.innerHTML=record.text,anchor.addEventListener("click",function(e){e.preventDefault()}),record.page_id&&(anchor.dataset.pageId=record.page_id),li.appendChild(anchor),this.listElement.appendChild(li)}.bind(this))},LinkListView.prototype.setColor=function(value){var links=this.domElement.getElementsByTagName("a");Array.prototype.forEach.call(links,function(link){link.style[Styles.COLOR]=value})},LinkListView.prototype.setFontSize=function(value){this.listElement.style[Styles.FONT_SIZE]=value},LinkListView.prototype.setFontWeight=function(value){this.listElement.style[Styles.FONT_WEIGHT]=value},LinkListView.prototype.setFontStyle=function(value){this.listElement.style[Styles.FONT_STYLE]=value},LinkListView.prototype.setFontFamily=function(value){TextStyleHelper.SetFontClass(this.listElement,value)},LinkListView.prototype.setTextDecoration=function(value){this.listElement.style[Styles.TEXT_DECORATION]=value},LinkListView.prototype.setTextAlign=function(value){this.listElement.style[Styles.TEXT_ALIGN]=value},LinkListView.prototype.setHeaderColor=function(value){this.headerElement.style.color=value},LinkListView.prototype.setHeaderFontSize=function(value){this.headerElement.style.fontSize=Parse.toPx(value)},LinkListView.prototype.setHeaderFontWeight=function(value){this.headerElement.style.fontWeight=value},LinkListView.prototype.setHeaderFontStyle=function(value){this.headerElement.style.fontStyle=value},LinkListView.prototype.setHeaderFontFamily=function(value){this.headerElement.style.fontFamily=value},LinkListView.prototype.setHeaderTextDecoration=function(value){this.headerElement.style.textDecoration=value},LinkListView.prototype.setHeaderTextAlign=function(value){this.headerElement.style.textAlign=value},LinkListView.prototype.getListHeight=function(){var computed=window.getComputedStyle(this.listElement),height=parseInt(computed.getPropertyValue("height"));return height},LinkListView.prototype.getListWidth=function(){var width=0,header=parseInt(window.getComputedStyle(this.headerElement).getPropertyValue("width")),items=this.listElement.querySelectorAll("a");return _.each(items,function(item){var itemWidth=item.offsetWidth;width=itemWidth>width?itemWidth:width}),!header||width>header?width:header},LinkListView}()},{"../../enums/Styles.js":361,"../../utils/Parse.js":415,"../helpers/TextStyleHelper.js":261,"./ElementView.js":313,lodash:161}],326:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("./ElementView.js"),Styles=_dereq_("../../enums/Styles.js"),ElementTypes=_dereq_("../../enums/ElementTypes.js");module.exports=function(){function LinkView(){ElementView.apply(this,arguments)}return LinkView.prototype=Object.create(ElementView.prototype),LinkView.constructor=LinkView,LinkView.prototype.createDomElement=function(){var el=document.createElement("a");return el.href="#",el.id=this.createId(ElementTypes.LINK),el.className="ng-element el-link",el.style.overflow="hidden",el},LinkView.prototype.setTextAlign=function(value){this.setStyle(Styles.TEXT_ALIGN,value)},LinkView.prototype.setInputValue=function(value){var htmlContainer=document.createElement("div");htmlContainer.innerHTML=value;var containerChild=htmlContainer.firstChild;containerChild&&"P"===containerChild.nodeName?(this.setTextAlign(containerChild.style.textAlign),this.domElement.innerHTML=containerChild.innerHTML,containerChild.style.fontSize&&(this.domElement.style.fontSize=containerChild.style.fontSize)):this.domElement.innerHTML=value},LinkView}()},{"../../enums/ElementTypes.js":346,"../../enums/Styles.js":361,"./ElementView.js":313}],327:[function(_dereq_,module,exports){"use strict";var SvgSymbolView=_dereq_("./SvgSymbolView.js"),Styles=_dereq_("../../enums/Styles.js"),Parse=_dereq_("../../utils/Parse.js");module.exports=function(){function MobileSymbolView(){SvgSymbolView.apply(this,arguments)}return MobileSymbolView.prototype=Object.create(SvgSymbolView.prototype),MobileSymbolView.constructor=MobileSymbolView,MobileSymbolView.prototype.createDomElement=function(){var el=document.createElement("img");return el.classList.add("ng-element"),el},MobileSymbolView.prototype.setData=function(){throw Error("data property is not supported on MobileSymbolView")},MobileSymbolView.prototype.setSvgSrc=function(value){"string"==typeof value&&value&&(this.domElement.src=value)},MobileSymbolView.prototype.setCssClass=function(value){value&&this.domElement.classList.add(value)},MobileSymbolView.prototype.updateViewBox=function(width,height){this.setStyle(Styles.WIDTH,Parse.toPx(width)),this.setStyle(Styles.HEIGHT,Parse.toPx(height))},MobileSymbolView}()},{"../../enums/Styles.js":361,"../../utils/Parse.js":415,"./SvgSymbolView.js":335}],328:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),TweenLite=_dereq_("gsap"),GroupView=_dereq_("./GroupView.js"),AnimationsHelper=_dereq_("../../interactions/AnimationsHelper.js"),MultistateAnimations=_dereq_("../../enums/MultistateAnimations.js"),Parse=_dereq_("../../utils/Parse.js"),PageModes=_dereq_("../../enums/PageModes.js");module.exports=function(){function MultistateView(){this.stateContainer=null,this.nextStateContainers=[],GroupView.apply(this,arguments)}return MultistateView.prototype=Object.create(GroupView.prototype),MultistateView.constructor=MultistateView,MultistateView.prototype.createDomElement=function(){var el=document.createElement("DIV");return el.classList.add("el-group"),el.classList.add("el-multistate"),this.stateContainer=document.createElement("DIV"),el.appendChild(this.stateContainer),this.stateContainer.classList.add("el-group"),this.stateContainer.classList.add("ng-state-container"),this.stateContainer.style.perspective="1000px",this.stateContainer.style.position="absolute",this.stateContainer.style.transformOrigin="0 0 0",this.state=document.createElement("DIV"),this.stateContainer.appendChild(this.state),this.state.classList.add("ng-state"),this.pageMode===PageModes.PREVIEW&&(this.state.style.backfaceVisibility="hidden"),el},MultistateView.prototype.updateTransform=function(element){(element.Page.isPreviewMode()||element.Page.isSpecMode())&&(this.state.style.width=Parse.toPx(element.width),this.state.style.height=Parse.toPx(element.height),this.stateContainer.style.width=Parse.toPx(element.width),this.stateContainer.style.height=Parse.toPx(element.height),element.isClip||(this.stateContainer.style.transform=[element._getGroupRotation(),element._getGroupTranslates(),Parse.translate3d(element.x,element.y,0),"rotate("+element.angle+"deg)"].join(" "),_.forEach(this.nextStateContainers,function(container){var stateId=container.dataset.stateId,bb=element._getBoundingBoxForState(parseInt(stateId));container.style.width=Parse.toPx(bb.width),container.style.height=Parse.toPx(bb.height),container.style.transform=[element._getGroupRotation(),element._getGroupTranslates(),Parse.translate3d(bb.x,bb.y,0),"rotate("+bb.angle+"deg)"].join(" "),container.style["-webkit-transform"]=container.style.transform})),this.stateContainer.style["-webkit-transform"]=this.stateContainer.style.transform),GroupView.prototype.updateTransform.call(this,element)},MultistateView.prototype.animateChangeState=function(container,animation,reversed){return animation&&animation.show===MultistateAnimations.FADE?this._animateFade(container,animation):animation&&[MultistateAnimations.FLIP_X,MultistateAnimations.FLIP_Y].indexOf(animation.show)>-1?this._animateFlip(container,animation,reversed):animation&&[MultistateAnimations.SLIDE_LEFT,MultistateAnimations.SLIDE_RIGHT,MultistateAnimations.SLIDE_UP,MultistateAnimations.SLIDE_DOWN].indexOf(animation.show)>-1?this._animateSlide(container,animation,reversed):(this._onComplete(container),Promise.resolve())},MultistateView.prototype.resetAnimation=function(){TweenLite.killTweensOf(this.state),this.state.style.opacity=1,this.state.style.transform="",this.state.style["-webkit-transform"]=this.state.style.transform},MultistateView.prototype.createNextStateContainer=function(stateId,bb,clipped,element){var nextStateContainer=document.createElement("DIV");nextStateContainer.classList.add("el-group"),nextStateContainer.classList.add("ng-state-container"),nextStateContainer.style.perspective="1000px",nextStateContainer.style.position="absolute",nextStateContainer.style.transformOrigin="0 0 0",nextStateContainer.setAttribute("data-state-id",stateId),clipped||(nextStateContainer.style.transform=[element._getGroupRotation(),element._getGroupTranslates(),Parse.translate3d(bb.x,bb.y,0),"rotate("+bb.angle+"deg)"].join(" "),nextStateContainer.style["-webkit-transform"]=nextStateContainer.style.transform);var state=document.createElement("DIV");return nextStateContainer.appendChild(state),state.classList.add("ng-state"),state.style.backfaceVisibility="hidden",state.style.width=Parse.toPx(bb.width),state.style.height=Parse.toPx(bb.height),this.domElement.appendChild(nextStateContainer),this.nextStateContainers.push(nextStateContainer),state},MultistateView.prototype._animateSlide=function(container,animation,reversed){return new Promise(function(resolve){var reverser=reversed?-1:1,transform=[MultistateAnimations.SLIDE_LEFT,MultistateAnimations.SLIDE_RIGHT].indexOf(animation.show)>-1?"x":"y",direction=[MultistateAnimations.SLIDE_LEFT,MultistateAnimations.SLIDE_UP].indexOf(animation.show)>-1?1:-1,value1=("x"===transform?parseInt(container.style.width):parseInt(container.style.height))||0,value2=("x"===transform?parseInt(this.state.style.width):parseInt(this.state.style.height))||0;container.parentNode.style.overflow="hidden",this.state.parentNode.style.overflow="hidden",animation=AnimationsHelper.ParseAnimation(animation),TweenLite.to(container,0,_.set({},transform,value1*reverser*direction)),TweenLite.to(this.state,0,_.set({},transform,0)),TweenLite.to(container,animation.duration/1e3,_.set({ease:AnimationsHelper.GetEasing(animation),onComplete:this._onComplete.bind(this,container)},transform,0)),TweenLite.to(this.state,animation.duration/1e3,_.set({ease:AnimationsHelper.GetEasing(animation),onComplete:function(container){TweenLite.to(container,0,_.set({},transform,0)),container.parentNode.style.overflow="",resolve()}.bind(null,this.state)},transform,-value2*reverser*direction))}.bind(this))},MultistateView.prototype._animateFlip=function(container,animation,reversed){return new Promise(function(resolve){var reverser=reversed?-1:1,transform=animation.show===MultistateAnimations.FLIP_X?"rotationX":"rotationY";animation=AnimationsHelper.ParseAnimation(animation),TweenLite.to(container,0,_.set({},transform,-180*reverser)),TweenLite.to(this.state,0,_.set({},transform,0)),TweenLite.to(container,animation.duration/1e3,_.set({ease:AnimationsHelper.GetEasing(animation),onComplete:this._onComplete.bind(this,container)},transform,0)),TweenLite.to(this.state,animation.duration/1e3,_.set({ease:AnimationsHelper.GetEasing(animation),onComplete:function(container){TweenLite.to(container,0,_.set({},transform,0)),resolve()}.bind(null,this.state)},transform,180*reverser))}.bind(this))},MultistateView.prototype._animateFade=function(container,animation){
return new Promise(function(resolve){animation=AnimationsHelper.ParseAnimation(animation),container.style.opacity=0,TweenLite.to(container,animation.duration/1e3,{opacity:1,ease:AnimationsHelper.GetEasing(animation),onComplete:this._onComplete.bind(this,container)}),TweenLite.to(this.state,animation.duration/1e3,{opacity:0,ease:AnimationsHelper.GetEasing(animation),onComplete:function(container){container.style.opacity=1,resolve()}.bind(null,this.state)})}.bind(this))},MultistateView.prototype._onComplete=function(container){this.domElement.removeChild(container.parentNode),this.nextStateContainers=_.without(this.nextStateContainers,container.parentNode)},MultistateView}()},{"../../enums/MultistateAnimations.js":354,"../../enums/PageModes.js":357,"../../interactions/AnimationsHelper.js":375,"../../utils/Parse.js":415,"./GroupView.js":316,gsap:101,lodash:161}],329:[function(_dereq_,module,exports){"use strict";var ElementTypes=_dereq_("../../enums/ElementTypes.js"),ElementView=_dereq_("./ElementView.js"),Styles=_dereq_("../../enums/Styles.js"),Parse=_dereq_("../../utils/Parse");module.exports=function(){function NavigationView(){ElementView.apply(this,arguments)}return NavigationView.prototype=Object.create(ElementView.prototype),NavigationView.constructor=NavigationView,NavigationView.prototype.createDomElement=function(){var el=document.createElement("ul");return el.id=this.createId(ElementTypes.NAVIGATION),el.classList.add("ng-element"),el.classList.add("el-navigation"),el},NavigationView.prototype.setOrientation=function(value){this.domElement.classList.remove("horizontal","vertical"),this.domElement.classList.add(value)},NavigationView.prototype.setInputValue=function(value){for(;this.domElement.firstChild;)this.domElement.removeChild(this.domElement.firstChild);var parents=[this.domElement];value.forEach(function(item){if(item.text){var depth=0,listElement=document.createElement("li"),span=document.createElement("span");listElement.appendChild(span),item.page_id&&(listElement.dataset.pageId=item.page_id);var indentationMatch=item.text.match(/^\s*(\/+)/),activeMatch=item.text.match(/^[\s\/]*\*/);if(indentationMatch?(depth=indentationMatch[0].trim().length,listElement.classList.add("active"),span.innerHTML=item.text.replace(/\/+/,"")):activeMatch?(listElement.classList.add("active"),span.innerHTML=item.text.replace("*","")):span.innerHTML=item.text,parents.length-1===depth)parents[parents.length-1].appendChild(listElement);else if(parents.length-1<depth){var parentElement=document.createElement("ul");parentElement.appendChild(listElement),parents[parents.length-1].lastChild.appendChild(parentElement),parents.push(parentElement)}else{for(;parents.length-1>depth;)parents.pop();parents[parents.length-1].appendChild(listElement)}}})},NavigationView.prototype.setElementBackgroundColor=function(element,value){element.style[Styles.BACKGROUND_COLOR]=value},NavigationView.prototype.setBackgroundColor=function(value){var items=this.domElement.getElementsByTagName("li");Array.prototype.forEach.call(items,function(item){item.classList.contains("active")||this.setElementBackgroundColor(item,value)},this)},NavigationView.prototype.setActiveBackgroundColor=function(value){var items=this.domElement.getElementsByClassName("active");Array.prototype.forEach.call(items,function(item){this.setElementBackgroundColor(item,value)},this)},NavigationView.prototype.setElementBorder=function(width,color){var boxShadowString="inset 0 0 0 "+width+"px "+color,items=this.domElement.getElementsByTagName("li");Array.prototype.forEach.call(items,function(item){item.style[Styles.BOX_SHADOW]=boxShadowString})},NavigationView.prototype.setColor=function(value){this.domElement.style[Styles.COLOR]=value},NavigationView.prototype.setFontSize=function(value){this.domElement.style[Styles.FONT_SIZE]=Parse.toPx(value)},NavigationView.prototype.setFontWeight=function(value){this.domElement.style[Styles.FONT_WEIGHT]=value},NavigationView.prototype.setFontStyle=function(value){this.domElement.style[Styles.FONT_STYLE]=value},NavigationView.prototype.setTextDecoration=function(value){this.domElement.style[Styles.TEXT_DECORATION]=value},NavigationView.prototype.setTextAlign=function(value){this.domElement.style[Styles.TEXT_ALIGN]=value},NavigationView}()},{"../../enums/ElementTypes.js":346,"../../enums/Styles.js":361,"../../utils/Parse":415,"./ElementView.js":313}],330:[function(_dereq_,module,exports){"use strict";var CheckboxView=_dereq_("./CheckboxView.js");module.exports=function(){function RadioView(){CheckboxView.apply(this,arguments)}return RadioView.prototype=Object.create(CheckboxView.prototype),RadioView.constructor=RadioView,RadioView.prototype.createDomElement=function(){var el=CheckboxView.prototype.createDomElement.call(this);return this.inputElement.type="radio",el},RadioView.prototype.setFormGroupName=function(value){this.inputElement.name=value},RadioView}()},{"./CheckboxView.js":308}],331:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("./ElementView.js"),Parse=_dereq_("../../utils/Parse.js"),Properties=_dereq_("../../enums/Properties.js");module.exports=function(){function ScrollbarView(){ElementView.apply(this,arguments),this.sizeProperty=Properties.HEIGHT,this.positionProperty="top"}var BUTTONS_SIZE=18,SCROLL_SIZE=.33;return ScrollbarView.prototype=Object.create(ElementView.prototype),ScrollbarView.constructor=ScrollbarView,ScrollbarView.prototype.createDomElement=function(){var el=document.createElement("div");return el.classList.add("ng-element"),el.classList.add("el-scrollbar"),this.topButtonElement=document.createElement("div"),this.topButtonElement.className="el-scroll upper",this.topButtonElement.style.width="100%",this.scrollElement=document.createElement("div"),this.scrollElement.className="el-scroll scroll",this.barElement=document.createElement("div"),this.barElement.className="el-scroll inner",this.barElement.style.width="100%",this.barElement.appendChild(this.scrollElement),this.bottomButtonElement=document.createElement("div"),this.bottomButtonElement.className="el-scroll lower",this.bottomButtonElement.style.width="100%",el.appendChild(this.topButtonElement),el.appendChild(this.barElement),el.appendChild(this.bottomButtonElement),el},ScrollbarView.prototype.updateTransform=function(element){ElementView.prototype.updateTransform.call(this,element),this.barElement.style[this.sizeProperty]=Parse.toPx(this._calculateBarSize(element[this.sizeProperty])),this.setScrollPosition(element[Properties.SCROLL_POSITION],element[this.sizeProperty])},ScrollbarView.prototype.setScrollPosition=function(value,elementSize){var position=0;value>0&&(position=this._calculateBarSize(elementSize)*(1-SCROLL_SIZE)*(value/100)),this.scrollElement.style[this.positionProperty]=Parse.toPx(position)},ScrollbarView.prototype._calculateBarSize=function(elementSize){return elementSize-2*BUTTONS_SIZE},ScrollbarView}()},{"../../enums/Properties.js":358,"../../utils/Parse.js":415,"./ElementView.js":313}],332:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),ElementView=_dereq_("./ElementView.js"),Styles=_dereq_("../../enums/Styles.js"),Parse=_dereq_("../../utils/Parse.js"),TextStyleHelper=_dereq_("../helpers/TextStyleHelper.js");module.exports=function(){function SelectlistView(){ElementView.apply(this,arguments)}return SelectlistView.prototype=Object.create(ElementView.prototype),SelectlistView.constructor=SelectlistView,SelectlistView.prototype.createDomElement=function(){this.selectElement=document.createElement("select");var wrapperElement=document.createElement("div");return wrapperElement.className="ng-element el-select-list-wrapper",this.selectElement.className="ng-element el-select-list",wrapperElement.appendChild(this.selectElement),wrapperElement},SelectlistView.prototype.setStyle=function(property,value){[Styles.DISPLAY,Styles.OPACITY].indexOf(property)>-1?this.domElement.style[property]=value:this.selectElement.style[property]=value},SelectlistView.prototype.setCustomStyles=function(styles){var _this=this;_.forEach(styles,function(value,property){[Styles.DISPLAY,Styles.OPACITY].indexOf(property)>-1&&_this.domElement.style[property]!==value?_this.domElement.style[property]=value:_this.selectElement.style[property]!==value&&(_this.selectElement.style[property]=value)})},SelectlistView.prototype.setBorderTopWidth=function(value){this.setStyle(Styles.BORDER_TOP_WIDTH,Parse.toPx(value))},SelectlistView.prototype.setBorderBottomWidth=function(value){this.setStyle(Styles.BORDER_BOTTOM_WIDTH,Parse.toPx(value))},SelectlistView.prototype.setBorderLeftWidth=function(value){this.setStyle(Styles.BORDER_LEFT_WIDTH,Parse.toPx(value))},SelectlistView.prototype.setBorderRightWidth=function(value){this.setStyle(Styles.BORDER_RIGHT_WIDTH,Parse.toPx(value))},SelectlistView.prototype.setBorderTopLeftRadius=function(value){this.setStyle(Styles.BORDER_TOP_LEFT_RADIUS,Parse.toPx(value))},SelectlistView.prototype.setBorderTopRightRadius=function(value){this.setStyle(Styles.BORDER_TOP_RIGHT_RADIUS,Parse.toPx(value))},SelectlistView.prototype.setBorderBottomRightRadius=function(value){this.setStyle(Styles.BORDER_BOTTOM_RIGHT_RADIUS,Parse.toPx(value))},SelectlistView.prototype.setBorderBottomLeftRadius=function(value){this.setStyle(Styles.BORDER_BOTTOM_LEFT_RADIUS,Parse.toPx(value))},SelectlistView.prototype.setBorderColor=function(value){this.setStyle(Styles.BORDER_COLOR,value)},SelectlistView.prototype.setBorderStyle=function(value){this.setStyle(Styles.BORDER_STYLE,value)},SelectlistView.prototype.setColor=function(value){this.setStyle(Styles.COLOR,value)},SelectlistView.prototype.setFontSize=function(value){this.setStyle(Styles.FONT_SIZE,Parse.toPx(value))},SelectlistView.prototype.setFontWeight=function(value){this.setStyle(Styles.FONT_WEIGHT,value)},SelectlistView.prototype.setFontStyle=function(value){this.setStyle(Styles.FONT_STYLE,value)},SelectlistView.prototype.setFontFamily=function(value){TextStyleHelper.SetFontClass(this.selectElement,value)},SelectlistView.prototype.setTextDecoration=function(value){this.setStyle(Styles.TEXT_DECORATION,value)},SelectlistView.prototype.setTextAlign=function(value){this.setStyle(Styles.TEXT_ALIGN,value),this.setStyle(Styles.TEXT_ALIGN_LAST,value)},SelectlistView.prototype.setMultiple=function(value){var selectWrapper=this.selectElement.parentNode;value?(selectWrapper.classList.add("multiple"),this.selectElement.multiple="multiple"):(selectWrapper.classList.remove("multiple"),this.selectElement.removeAttribute("multiple"))},SelectlistView.prototype.setOptions=function(value){var fragment=document.createDocumentFragment();_.forEach(value,function(option){var optionElement=document.createElement("option");optionElement.value=option.id,optionElement.textContent=option.text,fragment.appendChild(optionElement)}),this.selectElement.innerHTML="",this.selectElement.appendChild(fragment)},SelectlistView.prototype.getDomFocusableElement=function(){return this.selectElement},SelectlistView}()},{"../../enums/Styles.js":361,"../../utils/Parse.js":415,"../helpers/TextStyleHelper.js":261,"./ElementView.js":313,lodash:161}],333:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),SvgIconView=_dereq_("./SvgIconView.js");module.exports=function(){function SvgCustomIconView(){SvgIconView.apply(this,arguments)}return SvgCustomIconView.prototype=Object.create(SvgIconView.prototype),SvgCustomIconView.constructor=SvgCustomIconView,SvgCustomIconView.prototype.getElementNodes=function(){for(var treeWalker=document.createTreeWalker(this.domElement,NodeFilter.SHOW_ELEMENT,null,null),nodes=[],node=void 0;node=treeWalker.nextNode();)"g"!==node.tagName.toLowerCase()&&nodes.push(node);return nodes},SvgCustomIconView.prototype.setColor=function(value){value&&(this.domElement.style.fill=value,_.each(this.getElementNodes(),function(node){node.style.fill=value,node.style.stroke=value}))},SvgCustomIconView}()},{"./SvgIconView.js":334,lodash:161}],334:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),SvgSymbolView=_dereq_("./SvgSymbolView.js");module.exports=function(){function SvgIconView(){SvgSymbolView.apply(this,arguments)}return SvgIconView.prototype=Object.create(SvgSymbolView.prototype),SvgIconView.constructor=SvgIconView,SvgIconView.prototype.setColor=function(value){SvgSymbolView.prototype.setColor.call(this,value),_.forEach(["circle","line","ellipse","polyline","path","polygon","rect"],function(nodeName){_.forEach(this.domElement.getElementsByTagName(nodeName),function(node){node.style.fill=value})}.bind(this))},SvgIconView}()},{"./SvgSymbolView.js":335,lodash:161}],335:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),ElementView=_dereq_("./ElementView.js");module.exports=function(){function SvgSymbolView(){ElementView.apply(this,arguments)}return SvgSymbolView.prototype=Object.create(ElementView.prototype),SvgSymbolView.constructor=SvgSymbolView,SvgSymbolView.prototype.createDomElement=function(){var el=this._createSvgElement("svg");return el.setAttribute("preserveAspectRatio","none"),el.setAttribute("viewBox","0 0 100 100"),el.classList.add("ng-element"),el},SvgSymbolView.prototype.setData=function(value){if(value){var container=document.createElement("div");container.innerHTML=value;var svg=container.querySelector("svg");this.removeAllChildren(),_.forEach(_.take(svg.children,svg.childElementCount),function(child){this.domElement.appendChild(child)}.bind(this))}},SvgSymbolView.prototype.setColor=function(value){this.domElement.style.fill=value},SvgSymbolView.prototype.setViewBox=function(value){this.domElement.setAttribute("viewBox",value)},SvgSymbolView.prototype.updateViewBox=function(width,height,ratio){var size=Math.max(width,height),x1=ratio<1?(height*ratio-height)/2:0,y1=ratio>1?(width/ratio-width)/2:0;this.domElement.setAttribute("viewBox",x1+" "+y1+" "+size+" "+size)},SvgSymbolView}()},{"./ElementView.js":313,lodash:161}],336:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),ElementView=_dereq_("./ElementView.js"),Orientations=_dereq_("../../enums/Orientations"),Sides=_dereq_("../../enums/Sides"),Properties=_dereq_("../../enums/Properties"),Styles=_dereq_("../../enums/Styles"),Parse=_dereq_("../../utils/Parse"),InteractionsHelper=_dereq_("../../interactions/InteractionsHelper.js"),InteractionActions=_dereq_("../../enums/InteractionActions.js");module.exports=function(){function formatRadius(r1,r2,r3,r4){return Parse.toPx(r1)+" "+Parse.toPx(r2)+" "+Parse.toPx(r3)+" "+Parse.toPx(r4)}function TabView(){ElementView.apply(this,arguments)}return TabView.prototype=Object.create(ElementView.prototype),TabView.constructor=TabView,TabView.prototype.createDomElement=function(){return this.el=document.createElement("DIV"),this.el.classList.add("ng-element"),this.el.classList.add("el-tab"),this.el},TabView.prototype.renderTabs=function(data){this.el.innerHTML="",this.listEl=document.createElement("ul"),_.forEach(data.inputValue,function(tab){if(!_.isEmpty(tab.text)){var tabNode=document.createElement("li"),activityClass=/^\s*\*/.test(tab.text)?"active":"inactive",link=document.createElement("a");tab.page_id&&(link.dataset.pageId=tab.page_id),tabNode.classList.add("element",activityClass),link.innerHTML=tab.text.replace(/^\*(.*)/,"$1"),tabNode.appendChild(link),this.listEl.appendChild(tabNode)}}.bind(this)),this.addContainerStyles(data),this.addTabStyles(data),this.setTabSizes(data),this.el.appendChild(this.listEl),data.Page.isPreviewMode()&&this.addLinkEvent(data)},TabView.prototype.addLinkEvent=function(element){this.el.addEventListener("mousedown",this.mouseDownHandler.bind(this,element))},TabView.prototype.mouseDownHandler=function(element,e){e.target.dataset.pageId&&InteractionsHelper.ApplyInteractionEffect(element,{action:InteractionActions.LINK_PAGE,value:{id_page:e.target.dataset.pageId,target:!1}})},TabView.prototype.addContainerStyles=function(data){var properties=[Properties.WIDTH,Properties.HEIGHT,Properties.FONT_SIZE,Properties.FONT_FAMILY,Properties.TEXT_ALIGN,Properties.FONT_WEIGHT,Properties.FONT_STYLE,Properties.TEXT_DECORATION,Properties.COLOR];_.forEach(properties,function(property){this.listEl.style[property]=data[property]}.bind(this))},TabView.prototype.addTabStyles=function(data){var tabsAll=this.listEl.querySelectorAll("li"),tabsActive=this.listEl.querySelectorAll("li.active"),tabsInactive=this.listEl.querySelectorAll("li.inactive"),horizontalBorder=data.typeHorizontal===Sides.BOTTOM?Styles.BORDER_TOP_WIDTH:Styles.BORDER_BOTTOM_WIDTH,verticalBorder=data.typeVertical===Sides.RIGHT?Styles.BORDER_LEFT_WIDTH:Styles.BORDER_RIGHT_WIDTH,borderToReset=data.tabType===Orientations.HORIZONTAL?horizontalBorder:verticalBorder,propertiesMap={borderStyle:data.elementBorderStyle,borderWidth:Parse.toPx(data.elementBorderWidth),borderRadius:this.calculateBorderRadius(data),borderColor:data.elementBorderColor,textDecoration:data.textDecoration,float:data.tabType===Orientations.HORIZONTAL?"left":"none"};_.forEach(tabsAll,function(tab){_.forEach(propertiesMap,function(value,property){tab.style[property]=value})}),_.forEach(tabsActive,function(tab){tab.style.backgroundColor=data.activeBackgroundColor,tab.style[borderToReset]=0}),_.forEach(tabsInactive,function(tab){tab.style.backgroundColor=data.inactiveBackgroundColor})},TabView.prototype.setTabSizes=function(data){if(this.listEl){var i,tabsAll=this.listEl.querySelectorAll("li"),tabsActive=this.listEl.querySelectorAll("li.active"),width=data.width,elWidth=Math.floor(width/tabsAll.length),height=data.height,elHeight=Math.floor(height/tabsAll.length);if(data.tabType===Orientations.VERTICAL){for(_.forEach(tabsAll,function(tab){tab.style.lineHeight=Parse.toPx(elHeight),tab.style.height=Parse.toPx(elHeight),tab.style.width=Parse.toPx(width)}),i=0;i<height%tabsAll.length;i++)tabsAll[i].style.height=Parse.toPx(elHeight+1);return void _.forEach(tabsActive,function(tab){tab.style.width=Parse.toPx(width+1),tab.style.marginLeft=data.typeVertical===Sides.RIGHT?"-1px":"0"})}for(_.forEach(tabsAll,function(tab){tab.style.lineHeight=Parse.toPx(height),tab.style.height=Parse.toPx(height),tab.style.width=Parse.toPx(elWidth)}),i=0;i<width%tabsAll.length;i++)tabsAll[i].style.width=Parse.toPx(elWidth+1);_.forEach(tabsActive,function(tab){tab.style.height=Parse.toPx(height+1),tab.style.marginTop=data.typeHorizontal===Sides.BOTTOM?"-1px":"0"})}},TabView.prototype.calculateBorderRadius=function(data){var radius,radiusValue=data.elementBorderRadius;return data.tabType===Orientations.HORIZONTAL&&data.typeHorizontal===Sides.BOTTOM?radius=formatRadius(0,0,radiusValue,radiusValue):data.tabType===Orientations.HORIZONTAL?radius=formatRadius(radiusValue,radiusValue,0,0):data.tabType===Orientations.VERTICAL&&data.typeVertical===Sides.RIGHT?radius=formatRadius(0,radiusValue,radiusValue,0):data.tabType===Orientations.VERTICAL&&(radius=formatRadius(radiusValue,0,0,radiusValue)),radius},TabView}()},{"../../enums/InteractionActions.js":350,"../../enums/Orientations":356,"../../enums/Properties":358,"../../enums/Sides":360,"../../enums/Styles":361,"../../interactions/InteractionsHelper.js":379,"../../utils/Parse":415,"./ElementView.js":313,lodash:161}],337:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),ElementView=_dereq_("./ElementView.js"),Styles=_dereq_("../../enums/Styles.js"),Properties=_dereq_("../../enums/Properties.js"),Parse=_dereq_("../../utils/Parse.js"),TableHelper=_dereq_("../helpers/TableHelper.js"),TextStyleHelper=_dereq_("../helpers/TextStyleHelper.js");module.exports=function(){function TableView(){ElementView.apply(this,arguments)}return TableView.prototype=Object.create(ElementView.prototype),TableView.constructor=TableView,TableView.prototype.createDomElement=function(){var el=document.createElement("div");return el.className="ng-element el-table",this.tableElement=document.createElement("table"),el.appendChild(this.tableElement),el},TableView.prototype.getCell=function(coordinates){return this.getTableElement().querySelector("td[data-coords="+coordinates+"]")},TableView.prototype.getCellValue=function(coordinates){return this.getCell(coordinates).innerHTML},TableView.prototype.getTableElement=function(){return this.tableElement},TableView.prototype.setCurrentlyEditable=function(cell){cell?(this.currentlyEditable=cell,this.setCellEditable(this.getCell(this.currentlyEditable))):this.currentlyEditable&&(this.closeCellEditable(this.getCell(this.currentlyEditable)),this.currentlyEditable=null)},TableView.prototype.getEditableElement=function(){return this.currentlyEditable},TableView.prototype.setCellEditable=function(cellEl){this.insertTextArea(cellEl)},TableView.prototype.closeCellEditable=function(cellEl){var area=this._getTextAreaElement(cellEl),textNode=document.createTextNode(area.value);cellEl.removeChild(area),cellEl.appendChild(textNode)},TableView.prototype.removeTextArea=function(cellEl){var area=this._getTextAreaElement(cellEl);cellEl.removeChild(area)},TableView.prototype.insertTextArea=function(cellEl){var textarea=document.createElement("textarea");textarea.value=cellEl.textContent,textarea.rows="1",cellEl.innerHTML="";var styles={cursor:"text",width:"100%","-webkit-box-sizing":"border-box","-moz-box-sizing":"border-xbox","box-sizing":"border-box",margin:0,background:"transparent",border:"none","vertical-align":"inherit",resize:"none",overflow:"hidden","font-size":"inherit","font-family":"inherit","font-style":"inherit","font-weight":"inherit",color:"inherit","line-height":"inherit","text-align":"inherit"};for(var i in styles)styles.hasOwnProperty(i)&&(textarea.style[i]=styles[i]);textarea.addEventListener("change",this.resizeTextArea.bind(this,cellEl),!1),textarea.addEventListener("cut",this.delayedResizeTextArea.bind(this,cellEl),!1),textarea.addEventListener("paste",this.delayedResizeTextArea.bind(this,cellEl),!1),textarea.addEventListener("keydown",this.delayedResizeTextArea.bind(this,cellEl),!1),cellEl.appendChild(textarea),setTimeout(function(){textarea.focus(),textarea.selectRange(0,textarea.value.length)},200),this.resizeTextArea(cellEl)},TableView.prototype.setStyle=function(property,value){this.getTableElement().style[property]=value},TableView.prototype.setColor=function(value){this.setStyle(Styles.COLOR,value)},TableView.prototype.setFontSize=function(value){this.setStyle(Styles.FONT_SIZE,Parse.toPx(value))},TableView.prototype.setFontWeight=function(value){this.setStyle(Styles.FONT_WEIGHT,value)},TableView.prototype.setFontStyle=function(value){this.setStyle(Styles.FONT_STYLE,value)},TableView.prototype.setTextDecoration=function(value){this.setStyle(Styles.TEXT_DECORATION,value)},TableView.prototype.setTextAlign=function(value){this.setStyle(Styles.TEXT_ALIGN,value)},TableView.prototype.setBorderWidth=function(value){this.setStyle(Styles.BORDER_WIDTH,Parse.toPx(value))},TableView.prototype.setBorderColor=function(value){this.setStyle(Styles.BORDER_COLOR,value)},TableView.prototype.setBorderStyle=function(value){this.setStyle(Styles.BORDER_STYLE,value)},TableView.prototype.setBorderTopWidth=function(value){this.setStyle(Styles.BORDER_TOP_WIDTH,Parse.toPx(value))},TableView.prototype.setBorderBottomWidth=function(value){this.setStyle(Styles.BORDER_BOTTOM_WIDTH,Parse.toPx(value))},TableView.prototype.setBorderLeftWidth=function(value){this.setStyle(Styles.BORDER_LEFT_WIDTH,Parse.toPx(value))},TableView.prototype.setBorderRightWidth=function(value){this.setStyle(Styles.BORDER_RIGHT_WIDTH,Parse.toPx(value))},TableView.prototype.setBackgroundColor=function(value){this.setStyle(Styles.BACKGROUND_COLOR,value)},TableView.prototype.setInputValue=function(){},TableView.prototype.addEditInfo=function(){},TableView.prototype.removeEditInfo=function(){},TableView.prototype.setTableValue=function(content){var rowIndex,columnIndex,tr,td,rowsCount=content.length,columnsCount=TableHelper.GetColumnsCount(content),fragment=document.createElement("tbody");for(rowIndex=0;rowIndex<rowsCount;rowIndex++){for(tr=document.createElement("tr"),0===rowIndex?tr.classList.add("header"):rowIndex%2===0?tr.classList.add("even"):tr.classList.add("odd"),columnIndex=0;columnIndex<columnsCount;columnIndex++)td=document.createElement("td"),td.dataset.coords=TableHelper.GetCellCoordinates(rowIndex,columnIndex),td.id=TableHelper.GetCellCoordinates(rowIndex,columnIndex),td.innerHTML=content[rowIndex][columnIndex],tr.appendChild(td);fragment.appendChild(tr)}this.tableElement.innerHTML="",this.tableElement.appendChild(fragment)},TableView.prototype.setCellsStyles=function(cells){_.forEach(cells,function(styles,coordinates){var cell=this.getCell(coordinates);cell.style.cssText="",_.forEach(styles,function(value,property){property===Properties.FONT_FAMILY?TextStyleHelper.SetFontClass(cell,TextStyleHelper.SanitizeFontName(value)):cell.style[property]=value})}.bind(this))},TableView.prototype.resizeTextArea=function(cellEl){var textarea=this._getTextAreaElement(cellEl);textarea&&(textarea.style.height="auto",textarea.style.height=textarea.scrollHeight+"px")},TableView.prototype.delayedResizeTextArea=function(cellEl){window.setTimeout(this.resizeTextArea.bind(this,cellEl),0)},TableView.prototype._getTextAreaElement=function(cellEl){return cellEl.querySelector("textarea")},TableView}()},{"../../enums/Properties.js":358,"../../enums/Styles.js":361,"../../utils/Parse.js":415,"../helpers/TableHelper.js":258,"../helpers/TextStyleHelper.js":261,"./ElementView.js":313,lodash:161}],338:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),ElementView=_dereq_("./ElementView.js"),TagViewHelper=_dereq_("../helpers/TagViewHelper.js"),Parse=_dereq_("../../utils/Parse.js"),ClassNames=_dereq_("../../enums/ClassNames.js"),TrapScroll=_dereq_("../../utils/TrapScroll.js");module.exports=function(){function TagView(){ElementView.apply(this,arguments)}var HIDE_NOTE_DELAY=200,defaultSrc="/p/elements/standard/pins/black.png",defaultBase64="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAA1QAAANUBVNmqYgAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAQlSURBVEiJxZdNSGNXFMf/7yMmJhPtjGObcWoR6Qdt0IEKWVhKF6kWsa5U0EXdSJ3NUMEKLRSKdFMKrioERJFCIbS4UBd2IZUGFcGVFdoyWHCTxtRovszLy7tJXm4XuS+8PN/Lx2x64XAJ73J/93/uOfeccJRS/B9DbHL924SQT3O53EeU0oTNZvvH6XSGeZ7/G8DPAG4b3YhrUPG7mUzmB1EU3woGg9je3m5xu93weDzweDzU5/PJPp+POByOT3ie/6UhMqW0nr0qy3JicXGx1NraSgGY2tjYGE0kEjlJkn5MJpPtmigrqwd1ZTKZ58vLy3kroN46Ojrozs6OLEnSn0tLSyIAzuoANcGEkO/29/dzPM/XhWomCAI9Pz/PEkKeAuCZ3TlATXA6nb4YGRlpGKqZ3++nuVwufXBw8BCAoMEbBufzeaW3t7dpMAB6eHiYzWQynwFoQTl7quC8VdBxHMcVi0Vit9sbClLjuLi4EEqlUpsOyrNtObAflkNRlNPBwcEXAquqyhcKBTsD34HXBLe1tQWnpqayLwIWBIErFos2ADYGFsCCDABnnmPsYyQSeUwIKbhcrqbu1+Fw0HQ6Tba2tj4G8AqA+wDuAXBU1FsmeBkuxOPxv8bHx5sCBwKBfDQa/R1AL4DHADoBtANwMg8ItaA8AEGW5W9XVlaKjQDdbjfd2NggqVQqNjMz8x6A1wG8plPtAlC+9zpg8fb2dvrk5CRTD+r3+2k0GlXC4fDR5OTkBwDeAfAmgB4AjwA8YO5uDHx5eTkYiUSyVkC73U5XV1cLsiznQqHQVwCeAOhj4DdMwA4AYr2yyHEc51AUpWT2sbOzE7u7u6S7u/v5/Pz8F2tra/+yA5WYUd2slUEKmNRjLcGZagiCcE+SpDu10+l04vj4WBFF8df+/v6vr6+vtTjQoEVmKjP9ISwbgQqc53m3JEl3FgQCgbzL5Trt6ur6EtXuVw1gI5wCoLVczTHwS8lksuqhmZ6exsTERG5ubu5ztrFeqR6sWsFrKeYA8IIgdFxdXVXW9fT0YH19PR8KhZ4Fg8GYDqqazEar3HcVmN2v/o45juMexGIxOwDwPI9gMKjc3Nz8NDo6emiAGsFGD1QFWT3FIIQ8isfjAICFhYWS1+uNDQ0NfQOgUAdKTWYAoLRW/qKc6M5YLPbb7Ows9Xq9VFGU/N7e3ocAXgbwEOXcbEc5P50o56gd1YWh0ghAV49rBRdl7u+QJAmbm5tKKpX6fnh4+NTCjXpX3slbamxnrd5olDsHRzKZDB8dHanpdPqPvr6++wDaDAq1DkNTVlGnV1iz2TOARQAt2Ww2VSgU8mdnZ08YrFUHtJkBG2iZTcFVcFVViSRJC+zu7DqgXmXDQMtmzwjPZrPvDwwMaKCaAdOMmf6FMb7XJsM8YJoY/wFnANLPPi15ggAAAABJRU5ErkJggg==";return TagView.prototype=Object.create(ElementView.prototype),TagView.constructor=TagView,TagView.prototype.createDomElement=function(){var el=document.createElement("figure");return el.className="ng-element el-note",this.noteTitleElement=document.createElement("dt"),this.noteTextElement=document.createElement("dd"),this.noteElement=document.createElement("dl"),this.noteElement.classList.add(ClassNames.NOTE_ELEMENT_CONTENT_WRAPPER),this.noteElement.appendChild(this.noteTitleElement),this.noteElement.appendChild(this.noteTextElement),this.eventsRef=this.getEventsRef(),el.addEventListener("mouseover",this.eventsRef.showNote),el.addEventListener("mouseout",this.eventsRef.hideNote),el},TagView.prototype.getEventsRef=function(){return{showNote:this.showNote.bind(this),hideNote:this.hideNote.bind(this),onNoteTextElementMouseEnter:this.onNoteTextElementMouseEnter.bind(this),onNoteTextElementMouseOut:this.onNoteTextElementMouseOut.bind(this)}},TagView.prototype.setSrc=function(value){value===defaultSrc&&(value=defaultBase64),this.domElement.src=value},TagView.prototype.setTitle=function(value){this.noteTitleElement.style.display=value?"":"none",this.noteTitleElement.textContent=value},TagView.prototype.setText=function(value){this.noteTextElement.style.display=value?"":"none",this.noteTextElement.textContent=value},TagView.prototype.isNoteHidden=function(){return!this.noteElement.parentNode},TagView.prototype.isNoteHovered=function(){var selector="."+ClassNames.NOTE_ELEMENT_CONTENT_WRAPPER+":hover",noteElementParent=this.noteElement.parentNode;return!!noteElementParent&&noteElementParent.querySelector(selector)===this.noteElement},TagView.prototype.setNoteFixed=function(value){value?this.noteElement.classList.add(ClassNames.FIXED_POSITION):this.noteElement.classList.remove(ClassNames.FIXED_POSITION)},TagView.prototype.showNote=function(){var width,position,noteTextElementMaxHeight,isFixed=this.isFixed();this.setNoteFixed(isFixed),this._addNoteElementEvents(),TagViewHelper.appendToCanvasHelper(this.noteElement),position=TagViewHelper.calcNotePosition(this.domElement,this.noteElement,isFixed),width=TagViewHelper.calcNoteWidth(this.domElement),noteTextElementMaxHeight=TagViewHelper.calcNoteTextElementMaxHeight(this.noteTitleElement),this.noteElement.style.top=Parse.toPx(position.y),this.noteElement.style.left=Parse.toPx(position.x),this.noteElement.style.width=Parse.toPx(width),this.noteTextElement.style.maxHeight=Parse.toPx(noteTextElementMaxHeight)},TagView.prototype.hideNote=function(e){function hide(){this.isNoteHidden()||this.isNoteHovered()||e.relatedTarget===this.noteElement||e.relatedTarget.parentNode===this.noteElement||e.relatedTarget===this.domElement||(this.noteElement.parentNode.removeChild(this.noteElement),this.noteTextElement.style.maxHeight=null,this._removeNoteElementEvents())}_.delay(hide.bind(this),HIDE_NOTE_DELAY)},TagView.prototype.onNoteTextElementMouseEnter=function(){TrapScroll.activate(this.noteTextElement)},TagView.prototype.onNoteTextElementMouseOut=function(){TrapScroll.deactivate()},TagView.prototype._addNoteElementEvents=function(){this.noteElement.addEventListener("mouseout",this.eventsRef.hideNote),this.noteTextElement.addEventListener("mouseenter",this.eventsRef.onNoteTextElementMouseEnter),this.noteTextElement.addEventListener("mouseout",this.eventsRef.onNoteTextElementMouseOut)},TagView.prototype._removeNoteElementEvents=function(){this.noteElement.removeEventListener("mouseout",this.eventsRef.hideNote),this.noteTextElement.removeEventListener("mouseenter",this.eventsRef.onNoteTextElementMouseEnter),this.noteTextElement.removeEventListener("mouseout",this.eventsRef.onNoteTextElementMouseOut)},TagView}()},{"../../enums/ClassNames.js":345,"../../utils/Parse.js":415,"../../utils/TrapScroll.js":418,"../helpers/TagViewHelper.js":259,"./ElementView.js":313,lodash:161}],339:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("./ElementView.js"),Styles=_dereq_("../../enums/Styles.js"),Parse=_dereq_("../../utils/Parse.js"),ElementTypes=_dereq_("../../enums/ElementTypes.js"),TextStyleHelper=_dereq_("../helpers/TextStyleHelper");module.exports=function(){function TextElementView(){ElementView.apply(this,arguments)}return TextElementView.prototype=Object.create(ElementView.prototype),TextElementView.constructor=TextElementView,TextElementView.prototype.createDomElement=function(){var el=document.createElement("DIV");return el.id=this.createId(ElementTypes.TEXT_ELEMENT),
el.classList.add("ng-element"),el.classList.add("el-text-2"),el.classList.add("empty-line-hack"),el.classList.add("line-height-hack"),el.classList.add(TextStyleHelper.DEFAULT_FONT),el},TextElementView.prototype.setVisibility=function(value,isElementLocked){this.setStyle(Styles.VISIBILITY,value?"":"hidden"),void 0!==isElementLocked&&(value&&isElementLocked?this.domElement.classList.add("locked"):this.domElement.classList.remove("locked"))},TextElementView.prototype.setInputValue=function(value){this.domElement.innerHTML=value},TextElementView.prototype.setColor=function(value){this.forEachTextParent(function(node){node.style.color=value})},TextElementView.prototype.setFontSize=function(value){this.setStyle(Styles.FONT_SIZE,Parse.toPx(value))},TextElementView.prototype.setFontWeight=function(value){this.setStyle(Styles.FONT_WEIGHT,value)},TextElementView.prototype.setFontStyle=function(value){this.setStyle(Styles.FONT_STYLE,value)},TextElementView.prototype.setFontFamily=function(value){this.setStyle(Styles.FONT_FAMILY,value)},TextElementView.prototype.setTextDecoration=function(value){this.setStyle(Styles.TEXT_DECORATION,value)},TextElementView.prototype.setTextAlign=function(value){this.setStyle(Styles.TEXT_ALIGN,value)},TextElementView.prototype.setBackgroundColor=function(value){this.forEachTextParent(function(node){node.style.backgroundColor=value})},TextElementView}()},{"../../enums/ElementTypes.js":346,"../../enums/Styles.js":361,"../../utils/Parse.js":415,"../helpers/TextStyleHelper":261,"./ElementView.js":313}],340:[function(_dereq_,module,exports){"use strict";var Input2View=_dereq_("./Input2View.js");module.exports=function(){function TextareaView(){Input2View.apply(this,arguments)}return TextareaView.prototype=Object.create(Input2View.prototype),TextareaView.constructor=TextareaView,TextareaView.prototype.createDomElement=function(){var el=document.createElement("textarea");return el.className="ng-element el-textarea",el},TextareaView.prototype.setDisabled=function(value){this.domElement.disabled=!!value},TextareaView.prototype.getDomFocusableElement=function(){return this.domElement},TextareaView}()},{"./Input2View.js":321}],341:[function(_dereq_,module,exports){"use strict";var BoxView=_dereq_("./BoxView.js"),ElementTypes=_dereq_("../../enums/ElementTypes.js"),Styles=_dereq_("../../enums/Styles.js");module.exports=function(){function TooltipView(){BoxView.apply(this,arguments)}return TooltipView.prototype=Object.create(BoxView.prototype),TooltipView.constructor=TooltipView,TooltipView.prototype.createDomElement=function(){this.textElement=document.createElement("p"),this.textElement.id=this.createId(ElementTypes.TOOLTIP);var tooltipWrapper=document.createElement("DIV");return tooltipWrapper.className="ng-element el-tooltip-wrapper",this.tooltipArrow=document.createElement("DIV"),this.tooltipArrow.classList.add("el-tooltip-arrow"),tooltipWrapper.appendChild(this.tooltipArrow),this.tooltipElement=document.createElement("DIV"),this.tooltipElement.classList.add("ng-element"),this.tooltipElement.classList.add("el-tooltip"),this.tooltipElement.classList.add("text-editor-light"),this.tooltipElement.classList.add("line-height-hack"),this.tooltipElement.appendChild(this.textElement),tooltipWrapper.appendChild(this.tooltipElement),tooltipWrapper},TooltipView.prototype.setStyle=function(property,value){[Styles.LEFT,Styles.TOP,Styles.BORDER_COLOR,Styles.OPACITY,Styles.DISPLAY].indexOf(property)>-1&&(this.domElement.style[property]=value),[Styles.LEFT,Styles.TOP,Styles.OPACITY,Styles.DISPLAY].indexOf(property)===-1&&(this.tooltipElement.style[property]=value)},TooltipView.prototype.setPosition=function(value){var classPrefix="arrow-",className=classPrefix+value;if(!this.domElement.classList.contains(className)){for(var i=this.domElement.classList.length-1;i>=0;i--)new RegExp(classPrefix).test(this.domElement.classList[i])&&this.domElement.classList.remove(this.domElement.classList[i]);this.domElement.classList.add(className)}},TooltipView}()},{"../../enums/ElementTypes.js":346,"../../enums/Styles.js":361,"./BoxView.js":305}],342:[function(_dereq_,module,exports){"use strict";var SvgSymbolView=_dereq_("./SvgSymbolView.js"),Styles=_dereq_("../../enums/Styles.js"),Parse=_dereq_("../../utils/Parse.js");module.exports=function(){function UniSvgView(){SvgSymbolView.apply(this,arguments)}return UniSvgView.prototype=Object.create(SvgSymbolView.prototype),UniSvgView.constructor=UniSvgView,UniSvgView.prototype.updateViewBox=function(width,height){this.domElement.setAttribute("viewBox","0 0 "+width+" "+height),this.setStyle(Styles.WIDTH,Parse.toPx(width)),this.setStyle(Styles.HEIGHT,Parse.toPx(height))},UniSvgView}()},{"../../enums/Styles.js":361,"../../utils/Parse.js":415,"./SvgSymbolView.js":335}],343:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("./ElementView.js"),Styles=_dereq_("../../enums/Styles.js"),Parse=_dereq_("../../utils/Parse.js");module.exports=function(){function VideoView(){ElementView.apply(this,arguments)}return VideoView.prototype=Object.create(ElementView.prototype),VideoView.constructor=VideoView,VideoView.prototype.createDomElement=function(){var el=document.createElement("DIV");return el.classList.add("ng-element"),el.classList.add("el-video"),el},VideoView.prototype.setBackgroundImage=function(value){this.setStyle(Styles.BACKGROUND_IMAGE,Parse.backgroundImageString(value))},VideoView.prototype.setVideoHtml=function(value){this.domElement.innerHTML=value},VideoView}()},{"../../enums/Styles.js":361,"../../utils/Parse.js":415,"./ElementView.js":313}],344:[function(_dereq_,module,exports){"use strict";module.exports=function(){var AnimationsMap={easing:{LINEAR:{value:"easeNone",label:"Linear"},EASE_IN:{value:"easeIn",label:"Ease In"},EASE_OUT:{value:"easeOut",label:"Ease Out"},EASE_IN_OUT:{value:"easeInOut",label:"Ease In Out"}},easingType:{POWER0:{value:"Power0",label:"None",hidden:!0},QUAD:{value:"Power1",label:"Quadratic"},CUBIC:{value:"Power2",label:"Cubic"},QUART:{value:"Power3",label:"Quartic"},QUINT:{value:"Power4",label:"Quintic"},SINE:{value:"Sine",label:"Sine"},EXPO:{value:"Expo",label:"Exponential"},CIRC:{value:"Circ",label:"Circular"},ELASTIC:{value:"Elastic",label:"Elastic"},BOUNCE:{value:"Bounce",label:"Bounce"},BACK:{value:"Back",label:"Back"}}};return AnimationsMap.legacyEasing={linear:{easing:AnimationsMap.easing.LINEAR.value,easingType:AnimationsMap.easingType.POWER0.value},"ease-in":{easing:AnimationsMap.easing.EASE_IN.value,easingType:AnimationsMap.easingType.CUBIC.value},"ease-out":{easing:AnimationsMap.easing.EASE_OUT.value,easingType:AnimationsMap.easingType.CUBIC.value},"ease-in-out":{easing:AnimationsMap.easing.EASE_IN_OUT.value,easingType:AnimationsMap.easingType.CUBIC.value},"back-out":{easing:AnimationsMap.easing.EASE_OUT.value,easingType:AnimationsMap.easingType.BACK.value},"elastic-out":{easing:AnimationsMap.easing.EASE_OUT.value,easingType:AnimationsMap.easingType.ELASTIC.value}},AnimationsMap}()},{}],345:[function(_dereq_,module,exports){"use strict";module.exports=function(){return{ACTIVE:"active",FIXED_POSITION:"fixed-position",HIGHLIGHTED:"highlighted",INTERACTIVE:"interactive",LOCKED:"locked",NG_CANVAS_HELPER:"ng-canvas-helper",NG_CANVAS:"ng-canvas",NG_EDITING:"ng-editing",NG_ELEMENTS_OVERLAY:"ng-elements-overlay",NG_GRID:"ng-grid grid-container",NG_OVERLAY:"ng-overlay",NOTE_ELEMENT_CONTENT_WRAPPER:"note-element-content-wrapper",PUSHED:"pushed",RULERS_WRAPPER:"rulers-wrapper"}}()},{}],346:[function(_dereq_,module,exports){"use strict";module.exports=function(){return{ABSTRACT_ELEMENT:"Element",ANDROID_GEAR:"AndroidGear",ANDROID_ICON:"AndroidIcon",ARROW:"Arrow",BANNER:"Banner",BOX:"Box",BUTTON:"Button",CHECKBOX:"Checkbox",CIRCLE:"Circle",CLIPART:"Clipart",COMPONENT:"Component",COSTCO_ICON:"CostcoIcon",DIALOG:"Dialog",DRAW_INDICATOR:"DrawIndicator",FONT_AWESOME:"FontAwesome",FONT_AWESOME47:"FontAwesome47",GEO_SVG:"GeoSvg",GLASS_CANVAS:"GlassCanvas",GROUP:"Group",GROUPING_INSTANCE:"GroupingInstance",HORIZONTAL_SCROLLBAR:"HorizontalScrollbar",HOTSPOT:"Hotspot",ICON:"Icon",IMAGE:"Image",IMAGE_SKETCH:"ImageSketch",INPUT2:"Input2",INPUT:"Input",INPUT_WITH_LABEL:"InputWithLabel",IOS7:"iOS7",IOS8:"iOS8",LABEL:"Label",LINE:"Line",LINE_HORIZONTAL:"LineHorizontal",LINE_VERTICAL:"LineVertical",LINK:"Link",LINK_LIST:"LinkList",MATERIAL_ICON:"MaterialIcon",MENU:"Menu",MOBILE_SYMBOL:"MobileSymbol",MULTISTATE:"Multistate",NAVIGATION:"Navigation",PASSWORD:"Password",PIXLE_ICON:"PixleIcon",RADIO:"Radio",RETINA_ICON:"RetinaIcon",SCROLLBAR:"Scrollbar",SELECTLIST:"Selectlist",STICKY_NOTE:"StickyNote",SVG_CUSTOM_ICON:"SvgCustomIcon",SVG_SYMBOL:"SvgSymbol",SVG_ICON_LEGACY:"SvgIconLegacy",TAB:"Tab",TABLE:"Table",TAG:"Tag",TEXT:"Text",TEXT_ELEMENT:"TextElement",TEXTAREA:"Textarea",TOOLTIP:"Tooltip",UNI_SVG:"UniSvg",UXPIN_ICON_SET:"UXPinIconSet",VIDEO:"Video",VIRTUAL_GROUP:"VirtualGroup",CANVAS:"Canvas",COLLABORATION:"Collaboration",GRID:"Grid",GUIDE:"Guide",ELEMENT_INDICATOR:"ElementIndicator",ELEMENT_NAME:"ElementName",GUIDE_POSITION:"GuidePosition",HIGHLIGHT:"Highlight",HIGHLIGHT_ANNOTATION:"HighlightAnnotation",HIGHLIGHT_EDIT:"HighlightEdit",HIGHLIGHT_EDIT_CLIPPED:"HighlightEditClipped",HIGHLIGHT_SELECT:"HighlightSelect",HIGHLIGHT_CELL_RESIZER:"HighlightCellResizer",IMAGE_CROP:"ImageCrop",IMAGE_EDIT:"ImageEdit",IMAGE_UPLOAD:"ImageUpload",MULTI_SELECT:"MultiSelect"}}()},{}],347:[function(_dereq_,module,exports){"use strict";module.exports=function(){return{ANNOTATION_ELEMENT_HIGHLIGHTED:"annotationElementHighlighted",ANNOTATION_ELEMENT_SELECTED:"annotationElementSelected",CANT_DELETE_ELEMENT:"cantDeleteElement",COMPONENT_ADDED:"componentAdded",COMPONENT_CREATED:"componentCreated",COMPONENT_EDIT_MODE:"componentEditMode",CROP_CHANGE:"cropChange",CROP_DEACTIVATE:"cropDeactivate",DRAW_ELEMENT_ADDED:"drawElementAdded",ELEMENT_ADDED:"elementAdded",ELEMENT_DELETE_CONFIRMATION:"deleteConfirmation",ELEMENT_DRAG:"elementDrag",ELEMENT_DRAG_END:"elementDragEnd",ELEMENT_HOVERED:"elementHovered",ELEMENT_PASTE:"elementPaste",ELEMENT_PICKED:"elementPicked",ELEMENT_RESIZE:"elementResize",ELEMENT_ROTATE:"elementRotate",ELEMENTS_CHANGE:"elementsChange",ELEMENTS_FONTS_LOADED:"elementsFontsLoaded",ELEMENTS_SELECTED:"elementsSelected",ENABLED_DESIGN_MODE:"enabledDesignMode",ENABLED_DRAW_MODE:"enabledDrawMode",ENABLED_PREVIEW_MODE:"enabledPreviewMode",ENABLED_SPEC_MODE:"enabledSpecMode",GRID_UPDATE:"gridUpdate",GROUP_EDIT:"groupEdit",GROUP_REORDER:"groupReorder",GUIDES_UPDATE:"guidesUpdate",HIDE_CONTEXT_MENU:"hideContextMenu",HIGHLIGHT_PART_SELECTED:"highlightPartSelected",HISTORY_CHANGE:"historyChange",IMAGE_DRAWN:"imageDrawn",IMAGE_EDITED:"imageEdited",IMAGE_PROCESSING:"imageProcessing",IMAGES_DROP:"imagesDrop",LOAD_FUNCTION_FINISHED:"loadFunctionFinished",MODE_CHANGE:"modeChange",MULTISTATE_ELEMENT_CLOSED:"multistateElementClosed",MULTISTATE_ELEMENT_OPENED:"multistateElementOpened",NAVIGATE:"navigate",OPEN_IMAGE_UPLOAD_DIALOG:"openImageUploadDialog",SCROLL_TO_Y:"scrollToY",SET_SCALE:"setScale",SHORTCUT_ADD_NEW_STATE:"shortcutAddNewState",SHOW_CONTEXT_MENU:"showContextMenu",SNAPPING_GUIDE_HIDE:"snappingGuideHide",SNAPPING_GUIDE_SHOW:"snappingGuideShow",TEXT_EDITION_FINISHED:"textEditionFinished",TEXT_EDITION_STARTED:"textEditionStarted",TEXT_SELECTION_CHANGED:"textSelectionChanged",ZOOM_IN:"zoomIn",ZOOM_OUT:"zoomOut",ZOOM_RESET:"zoomReset"}}()},{}],348:[function(_dereq_,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var TYPE_CUSTOM=exports.TYPE_CUSTOM="C",TYPE_GOOGLE=exports.TYPE_GOOGLE="G",TYPE_TYPEKIT=exports.TYPE_TYPEKIT="T";exports.TYPE_STANDARD="S",exports.TYPES_WITH_VARIANTS=[TYPE_CUSTOM,TYPE_GOOGLE,TYPE_TYPEKIT],exports.DEFAULT_FONT_CLASS='class="wysiwyg-font-type-arial"',exports.FONTS_LEGACY_MAP={amaticsc:"Amatic SC",comicsans:"Comic Sans MS",couriernew:"Courier New",timesnew:"Times New Roman",trebuchet:"Trebuchet MS",oldstandardtt:"Old Standard TT",ptsans:"PT Sans",ptsanscaption:"PT Sans Caption",ptsansnarrow:"PT Sans Narrow",ptserif:"PT Serif"},exports.FONTS_GOOGLE=["Abel","Allerta","Amaranth","Amatic Sc","Amatic SC","Anton","Arvo","Arimo","Asap","Bitter","Black Ops One","Bree Serif","Cabin","Cabin Condensed","Calligraffitti","Cantarell","Cardo","Changa One","Cherry Cream Soda","Chewy","Coming Soon","Comfortaa","Copse","Covered By Your Grace","Crafty Girls","Crimson Text","Crushed","Cuprum","Dancing Script","Dosis","Droid Sans","Droid Sans Mono","Droid Serif","Economica","Exo","Fjalla One","Francois One","Fredoka One","Goudy Bookletter 1911","Homemade Apple","Inconsolata","Indie Flower","Istok Web","Josefin Sans","Josefin Slab","Just Me Again Down Here","Kreon","Lato","Lobster","Lobster Two","Lora","Luckiest Guy","Marck Script","Marvel","Maven Pro","Merriweather","Metamorphous","Molengo","Montserrat","Muli","News Cycle","Nobile","Nunito","Old Standard Tt","Old Standard TT","Open Sans","Open Sans Condensed","Oswald","Oxygen","Pacifico","Paytone One","Permanent Marker","Philosopher","Play","Pt Sans","PT Sans","Pt Sans Caption","PT Sans Caption","Pt Sans Narrow","PT Sans Narrow","Pt Serif","PT Serif","Questrial","Quicksand","Raleway","Reenie Beanie","Righteous","Roboto","Roboto Condensed","Rock Salt","Rokkitt","Shadows Into Light","Signika","Source Sans Pro","Special Elite","Syncopate","Tangerine","Titillium Web","The Girl Next Door","Ubuntu","Ubuntu Condensed","Unkempt","Vollkorn","Walter Turncoat","Yanone Kaffeesatz"],exports.FONTS_STANDARD=["Arial","Comic Sans MS","Courier New","Georgia","Tahoma","Times New Roman","Trebuchet MS","Verdana"]},{}],349:[function(_dereq_,module,exports){"use strict";module.exports=function(){var IndicatorAlign={BOTTOM_LEFT:"bottomLeft",BOTTOM_RIGHT:"bottomRight",TOP_LEFT:"topLeft",TOP_RIGHT:"topRight"};return IndicatorAlign}()},{}],350:[function(_dereq_,module,exports){"use strict";module.exports=function(){var InteractionActions={BRING_TO_BACK:"bring_to_back",BRING_TO_FRONT:"bring_to_front",CHANGE_STATE:"change_state",CHECK:"check",DISABLE:"disable",ENABLE:"enable",FOCUS:"focus",HIDE:"hide",LINK_BACK:"link_back",LINK_PAGE:"link_page",LINK_URL:"link_url",MOVE:"move",MOVE_TO:"move_to",NEXT_STATE:"next_state",OPACITY:"opacity",PREVIOUS_STATE:"previous_state",RESIZE:"resize",ROTATE:"rotate",SCROLL:"scroll",SHOW:"show",STYLE:"style",TOGGLE:"toggle",UNCHECK:"uncheck"};return InteractionActions}()},{}],351:[function(_dereq_,module,exports){"use strict";module.exports=function(){var InteractionTriggers={BLUR:"blur",CHANGE:"change",CLICK:"click",CONTEXTMENU:"contextmenu",DBLCLICK:"dblclick",FOCUS:"focus",HOVER:"hover",MOUSEENTER:"mouseenter",MOUSELEAVE:"mouseleave",MOUSEMOVE:"mousemove",TOUCH_PRESS:"touch.press",TOUCH_PRESSUP:"touch.pressup",TOUCH_SWIPEDOWN:"touch.swipedown",TOUCH_SWIPELEFT:"touch.swipeleft",TOUCH_SWIPERIGHT:"touch.swiperight",TOUCH_SWIPEUP:"touch.swipeup",WINDOW_KEYDOWN:"window.keydown",WINDOW_SCROLL:"window.scroll",WINDOW_LOAD:"window.load"};return InteractionTriggers}()},{}],352:[function(_dereq_,module,exports){"use strict";var INTERACTION_TRIGGERS=_dereq_("./InteractionTriggers.js"),ELEMENT_TYPES=_dereq_("./ElementTypes.js");module.exports=function(){var InteractionTriggersGrouped={TRIGGERS_GROUP:{SELECT_LIST_EVENTS:[INTERACTION_TRIGGERS.CHANGE],FORM_EVENTS:[INTERACTION_TRIGGERS.FOCUS,INTERACTION_TRIGGERS.BLUR],CANVAS_EVENTS:[INTERACTION_TRIGGERS.WINDOW_KEYDOWN,INTERACTION_TRIGGERS.WINDOW_SCROLL,INTERACTION_TRIGGERS.WINDOW_LOAD],STANDARD_EVENTS:[INTERACTION_TRIGGERS.CLICK,INTERACTION_TRIGGERS.CONTEXTMENU,INTERACTION_TRIGGERS.DBLCLICK,INTERACTION_TRIGGERS.HOVER,INTERACTION_TRIGGERS.MOUSEENTER,INTERACTION_TRIGGERS.MOUSELEAVE,INTERACTION_TRIGGERS.TOUCH_PRESS,INTERACTION_TRIGGERS.TOUCH_PRESSUP,INTERACTION_TRIGGERS.TOUCH_SWIPEDOWN,INTERACTION_TRIGGERS.TOUCH_SWIPELEFT,INTERACTION_TRIGGERS.TOUCH_SWIPERIGHT,INTERACTION_TRIGGERS.TOUCH_SWIPEUP]},EVENTS_SUPPORT:{SELECT_LIST_EVENTS:[ELEMENT_TYPES.SELECTLIST],FORM_EVENTS:[ELEMENT_TYPES.CHECKBOX,ELEMENT_TYPES.RADIO,ELEMENT_TYPES.INPUT_WITH_LABEL,ELEMENT_TYPES.PASSWORD,ELEMENT_TYPES.SELECTLIST,ELEMENT_TYPES.BUTTON,ELEMENT_TYPES.TEXTAREA,ELEMENT_TYPES.INPUT2],CANVAS_EVENTS:[ELEMENT_TYPES.CANVAS]}};return InteractionTriggersGrouped}()},{"./ElementTypes.js":346,"./InteractionTriggers.js":351}],353:[function(_dereq_,module,exports){"use strict";module.exports=function(){return{BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46,KEY_0:48,KEY_1:49,KEY_2:50,KEY_3:51,KEY_4:52,KEY_5:53,KEY_6:54,KEY_7:55,KEY_8:56,KEY_9:57,KEY_A:65,KEY_B:66,KEY_C:67,KEY_D:68,KEY_E:69,KEY_F:70,KEY_G:71,KEY_H:72,KEY_I:73,KEY_J:74,KEY_K:75,KEY_L:76,KEY_M:77,KEY_N:78,KEY_O:79,KEY_P:80,KEY_Q:81,KEY_R:82,KEY_S:83,KEY_T:84,KEY_U:85,KEY_V:86,KEY_W:87,KEY_X:88,KEY_Y:89,KEY_Z:90,LEFT_META:91,RIGHT_META:92,SELECT:93,NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,MULTIPLY:106,ADD:107,SUBTRACT:109,DECIMAL:110,DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUM_LOCK:144,SCROLL_LOCK:145,SEMICOLON:186,EQUALS:187,COMMA:188,DASH:189,PERIOD:190,FORWARD_SLASH:191,GRAVE_ACCENT:192,OPEN_BRACKET:219,BACK_SLASH:220,CLOSE_BRACKET:221,SINGLE_QUOTE:222}}()},{}],354:[function(_dereq_,module,exports){"use strict";module.exports=function(){var MultistateAnimations={FADE:"fade",FLIP_X:"flip-x",FLIP_Y:"flip-y",SLIDE_LEFT:"slide-left",SLIDE_RIGHT:"slide-right",SLIDE_UP:"slide-up",SLIDE_DOWN:"slide-down"};return MultistateAnimations}()},{}],355:[function(_dereq_,module,exports){"use strict";module.exports=function(){var OperationTypes={ADD_ELEMENT:"addElement",CHANGE_PROPERTY:"changeProperty",REMOVE_ELEMENT:"removeElement"};return OperationTypes}()},{}],356:[function(_dereq_,module,exports){"use strict";module.exports=function(){var Orientations={HORIZONTAL:"horizontal",VERTICAL:"vertical"};return Orientations}()},{}],357:[function(_dereq_,module,exports){"use strict";module.exports=function(){return{DESIGN:"design",DOCUMENTATION:"documentation",DRAW:"draw",EXPORT:"export",PREVIEW:"preview",SPEC:"spec"}}()},{}],358:[function(_dereq_,module,exports){"use strict";module.exports=Object.freeze({ACTIONS:"actions",ANCHOR_X:"anchorX",ANCHOR_Y:"anchorY",ANGLE:"angle",ARROW_END_MARKER:"arrowEndMarker",ARROW_START_MARKER:"arrowStartMarker",ARROW_CURVE:"arrowCurve",ARROW_ORIENTATION:"arrowOrientation",BACKGROUND:"background",BACKGROUND_ATTACHMENT:"backgroundAttachment",BACKGROUND_CLIP:"backgroundClip",BACKGROUND_COLOR:"backgroundColor",BACKGROUND_IMAGE:"backgroundImage",BACKGROUND_ORIGIN:"backgroundOrigin",BACKGROUND_POSITION:"backgroundPosition",BACKGROUND_REPEAT:"backgroundRepeat",BACKGROUND_SIZE:"backgroundSize",BLUR:"blur",BORDER:"border",BORDER_BOTTOM:"borderBottom",BORDER_BOTTOM_LEFT_RADIUS:"borderBottomLeftRadius",BORDER_BOTTOM_RIGHT_RADIUS:"borderBottomRightRadius",BORDER_BOTTOM_COLOR:"borderBottomColor",BORDER_BOTTOM_STYLE:"borderBottomStyle",BORDER_BOTTOM_WIDTH:"borderBottomWidth",BORDER_COLOR:"borderColor",BORDER_LEFT:"borderLeft",BORDER_LEFT_COLOR:"borderLeftColor",BORDER_LEFT_STYLE:"borderLeftStyle",BORDER_LEFT_WIDTH:"borderLeftWidth",BORDER_LOCK:"borderLock",BORDER_RADIUS:"borderRadius",BORDER_RIGHT:"borderRight",BORDER_RIGHT_COLOR:"borderRightColor",BORDER_RIGHT_STYLE:"borderRightStyle",BORDER_RIGHT_WIDTH:"borderRightWidth",BORDER_STYLE:"borderStyle",BORDER_TOP:"borderTop",BORDER_TOP_LEFT_RADIUS:"borderTopLeftRadius",BORDER_TOP_RIGHT_RADIUS:"borderTopRightRadius",BORDER_TOP_COLOR:"borderTopColor",BORDER_TOP_STYLE:"borderTopStyle",BORDER_TOP_WIDTH:"borderTopWidth",BORDER_WIDTH:"borderWidth",BOX_SHADOW:"boxShadow",BRIGHTNESS:"brightness",CAPTION:"caption",CLIP:"clip",CELLSSTYLES:"cellsStyles",COLOR:"color",COLUMNWIDTHS:"columnWidths",CONTRAST:"contrast",CROP:"crop",CSS_CLASS:"cssClass",CURRENT_ELEMENT_CATEGORY_ID:"currentElementCategoryId",CURRENT_ELEMENT_ID:"currentElementId",CUSTOM_STYLES:"customStyles",DATA:"data",ELEMENT:"element",ELEMENT_BORDER_COLOR:"elementBorderColor",ELEMENT_BORDER_RADIUS:"elementBorderRadius",ELEMENT_BORDER_STYLE:"elementBorderStyle",ELEMENT_BORDER_WIDTH:"elementBorderWidth",EXPOSURE:"exposure",FIXED:"fixed",FONT_FAMILY:"fontFamily",FONT_SIZE:"fontSize",FONT_STYLE:"fontStyle",FONT_WEIGHT:"fontWeight",GRAYSCALE:"grayscale",HEADER_TEXT:"headerText",HEADER_DISPLAY:"headerDisplay",HEADER_COLOR:"headerColor",HEADER_FONT_WEIGHT:"headerFontWeight",HEADER_FONT_STYLE:"headerFontStyle",HEADER_FONT_SIZE:"headerFontSize",HEADER_FONT_FAMILY:"headerFontFamily",HEADER_TEXT_DECORATION:"headerTextDecoration",HEADER_TEXT_ALIGN:"headerTextAlign",HEIGHT:"height",ID_COMPONENT:"idComponent",ID_STORED_FILE:"idStoredFile",IS_CLIP:"isClip",INIT_ELEMENTS:"initElements",INPUT_VALUE:"inputValue",KEEP_RATIO:"keepRatio",LABEL:"label",LETTER_SPACING:"letterSpacing",LINE_ORIENTATION:"lineOrientation",LINE_HEIGHT:"lineHeight",LINE_TYPE:"lineType",LIST:"list",LIST_INDENTATION:"listIndentation",LOCKED:"locked",MENU_VALUE:"menuValue",METADATA:"metadata",MULTISTATE_ORIGIN:"multistateOrigin",NAME:"name",OPACITY:"opacity",ORIGINAL_HEIGHT:"originalHeight",ORIGINAL_RATIO:"originalRatio",ORIGINAL_WIDTH:"originalWidth",OUTLINE_COLOR:"outlineColor",OUTLINE_STYLE:"outlineStyle",OUTLINE_WIDTH:"outlineWidth",PADDING:"padding",PADDING_BOTTOM:"paddingBottom",PADDING_LEFT:"paddingLeft",PADDING_RIGHT:"paddingRight",PADDING_TOP:"paddingTop",PADDING_LOCK:"paddingLock",RADIUS_LOCK:"radiusLock",SATURATION:"saturation",SCROLL_POSITION:"scrollPosition",SHADOW_BLUR:"shadowBlur",SHADOW_COLOR:"shadowColor",SHADOW_ENABLED:"shadowEnabled",SHADOW_OFFSET_X:"shadowOffsetX",SHADOW_OFFSET_Y:"shadowOffsetY",SHARPEN:"sharpen",SRC:"src",SRC_MOD:"srcMod",SVG_SRC:"svgSrc",SKETCH_ARTBOARD:"sketchArtboard",STATE_IA:"stateIa",STATES:"states",STORED_ELEMENTS:"storedElements",STROKE:"stroke",TABLEVALUE:"tableValue",TAB_TYPE:"tabType",TEXT_ALIGN:"textAlign",TEXT_DECORATION:"textDecoration",TEXT_TRANSFORM:"textTransform",VIBRANCE:"vibrance",VERTICAL_ALIGN:"verticalAlign",WIDTH:"width",X:"x",Y:"y"})},{}],359:[function(_dereq_,module,exports){"use strict";module.exports=function(){var RestrictModes={ALL:"all",ELEMENTS:"elements",NONE:"none"};return RestrictModes}()},{}],360:[function(_dereq_,module,exports){"use strict";module.exports=function(){var Sides={BOTTOM:"bottom",LEFT:"left",RIGHT:"right",TOP:"top"};return Sides}()},{}],361:[function(_dereq_,module,exports){"use strict";module.exports=function(){var Styles={ANGLE:"angle",BACKGROUND_COLOR:"background-color",BACKGROUND_IMAGE:"background-image",BACKGROUND_POSITION:"background-position",BACKGROUND_REPEAT:"background-repeat",BACKGROUND_SIZE:"background-size",BORDER_BOTTOM_LEFT_RADIUS:"border-bottom-left-radius",BORDER_BOTTOM_RIGHT_RADIUS:"border-bottom-right-radius",BORDER_BOTTOM_WIDTH:"border-bottom-width",BORDER_COLOR:"border-color",BORDER_LEFT_WIDTH:"border-left-width",BORDER_RIGHT_WIDTH:"border-right-width",BORDER_RADIUS:"border-radius",BORDER_STYLE:"border-style",BORDER_TOP_LEFT_RADIUS:"border-top-left-radius",BORDER_TOP_RIGHT_RADIUS:"border-top-right-radius",BORDER_TOP_WIDTH:"border-top-width",BORDER_WIDTH:"border-width",BOX_SHADOW:"box-shadow",COLOR:"color",DISPLAY:"display",FILTER:"filter",FONT_FAMILY:"font-family",FONT_SIZE:"font-size",FONT_STYLE:"font-style",FONT_VARIANT:"font-variant",FONT_WEIGHT:"font-weight",HEIGHT:"height",LEFT:"left",LETTER_SPACING:"letter-spacing",LINE_HEIGHT:"line-height",LIST_STYLE:"list-style-type",OPACITY:"opacity",PADDING_BOTTOM:"padding-bottom",PADDING_LEFT:"padding-left",PADDING_RIGHT:"padding-right",PADDING_TOP:"padding-top",POSITION:"position",TEXT_ALIGN:"text-align",TEXT_ALIGN_LAST:"text-align-last",TEXT_DECORATION:"text-decoration",TEXT_TRANSFORM:"text-transform",TOP:"top",VISIBILITY:"visibility",WIDTH:"width",X:"x",Y:"y"};return Styles}()},{}],362:[function(_dereq_,module,exports){"use strict";module.exports=function(){var UploadStatus={COMPLETED:"completed",FAILED:"failed",PENDING:"pending",READY:"ready"};return UploadStatus}()},{}],363:[function(_dereq_,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getFontsFromClasses=exports.getFontDataFromClass=exports.getFvd=exports.parseStyle=exports.parseWeight=exports.getClassesFromFontFamily=exports.getClassesFromText=exports.getFontClassName=exports.getFvdForStyle=exports.getClassFromLegacyFontFamily=exports.decodeFontFamily=exports.encodeFontFamily=exports.getFontFamiliesFromLegacyText=void 0;var _lodash=_dereq_("lodash"),_base=_dereq_("base32"),_Fonts=_dereq_("../enums/Fonts.js"),_TypekitLoader=_dereq_("./TypekitLoader"),TextStyleHelper=_dereq_("./../elements/helpers/TextStyleHelper"),STYLE_FVD_MAP={normal:"n",italic:"i",oblique:"o"},STYLE_FVD_MAP_GOOGLE={regular:"n",italic:"i",oblique:"o"},sanitizeFontFamily=function(fontFamily){var fontKey=(fontFamily||"").replace(/[^A-Za-z0-9]/g,"").toLowerCase();return _Fonts.FONTS_LEGACY_MAP[fontKey]||(0,_lodash.startCase)(fontFamily)},getDisplayFamily=function(type,fontFamily){return type===_Fonts.TYPE_TYPEKIT?(0,_TypekitLoader.getFamilyNameByWebId)(fontFamily):fontFamily},getDisplayVariant=function(type,fontFamily,fvd){return type===_Fonts.TYPE_TYPEKIT?(0,_TypekitLoader.getVariantName)(fontFamily,fvd):null},getFontFamiliesFromLegacyText=exports.getFontFamiliesFromLegacyText=function(text){return(0,_lodash.map)(text.match(/class="wysiwyg-font-type-(\w+)"/g)||[],function(c){return c.match(/class="wysiwyg-font-type-(\w+)"/)[1]})},encodeFontFamily=exports.encodeFontFamily=function(type,fontFamily){var encodeFont=function(family){return(0,_base.encode)(family.replace(/_/g,"="))};switch(type){case _Fonts.TYPE_CUSTOM:case _Fonts.TYPE_GOOGLE:return encodeFont(fontFamily);case _Fonts.TYPE_STANDARD:return fontFamily.replace(/\s/g,"_")}return fontFamily},decodeFontFamily=exports.decodeFontFamily=function(type,data){var decodeFont=function(family){return(0,_base.decode)(family.replace(/_/g,"="))};switch(type){case _Fonts.TYPE_CUSTOM:case _Fonts.TYPE_GOOGLE:return decodeFont(data);case _Fonts.TYPE_STANDARD:return data.replace(/_/g," ")}return data},getClassFromLegacyFontFamily=exports.getClassFromLegacyFontFamily=function(fontFamily){return fontFamily=sanitizeFontFamily(fontFamily),_Fonts.FONTS_GOOGLE.indexOf(fontFamily)>-1?"font-"+_Fonts.TYPE_GOOGLE+"-"+encodeFontFamily(_Fonts.TYPE_GOOGLE,fontFamily)+"-n4":_Fonts.FONTS_STANDARD.indexOf(fontFamily)>-1?"font-"+_Fonts.TYPE_STANDARD+"-"+encodeFontFamily(_Fonts.TYPE_STANDARD,fontFamily)+"-n4":null},getClassesFromLegacyText=function(text){return(0,_lodash.map)(getFontFamiliesFromLegacyText(text),function(fontFamily){return getClassFromLegacyFontFamily(fontFamily)})},getVariant=function(type,fvd){var getVariantGoogle=function(fvd){var weight=parseWeight(fvd),style=parseStyle(fvd);return 400===weight?"normal"===style?"regular":style:weight+("normal"===style?"":style)};return type===_Fonts.TYPE_GOOGLE?getVariantGoogle(fvd):fvd},parseWeight=(exports.getFvdForStyle=function(style,weight){return STYLE_FVD_MAP[style]+parseInt(weight)/100},exports.getFontClassName=function(type,fontFamily,fvd){var fontName=encodeFontFamily(type,fontFamily);return"font-"+type+"-"+fontName+"-"+fvd},exports.getClassesFromText=function(text){if(!text)return[];var classes=(0,_lodash.map)(text.match(/class="(font-[A-Z]-\w+-[a-z]?\d+)"/g)||[],function(c){return c.match(/class="(font-[A-Z]-\w+-[a-z]?\d+)"/)[1]}),allClasses=classes.concat(getClassesFromLegacyText(text));return allClasses.length?allClasses:getClassesFromLegacyText(_Fonts.DEFAULT_FONT_CLASS)},exports.getClassesFromFontFamily=function(fontFamily){if(TextStyleHelper.IsFontClassName(fontFamily))return[fontFamily];var data=fontFamily?fontFamily.match(/^([A-Z])-([\w\s-_]+)-([a-z]?\d+)$/):null,className=void 0;if(!data)return className="undefined"==typeof fontFamily?null:getClassFromLegacyFontFamily(fontFamily),className?[className]:[];var type=data[1],family=data[2],fvd=data[3];return["font-"+type+"-"+encodeFontFamily(type,family)+"-"+fvd]},exports.parseWeight=function(fvd){return 100*(parseInt(fvd[1])||4)}),parseStyle=exports.parseStyle=function(fvd){switch(fvd[0]){case"n":return"normal";case"i":return"italic";case"o":return"oblique"}return""},getFontDataFromClass=(exports.getFvd=function(type,variant){var getFvdGoogle=function(variant){var data=variant.match(/^(\d{3})?([a-z]+)?$/),style=STYLE_FVD_MAP_GOOGLE[data[2]||"regular"],weight=(parseInt(data[1])||400)/100;return style+weight};switch(type){case _Fonts.TYPE_GOOGLE:return getFvdGoogle(variant);case _Fonts.TYPE_TYPEKIT:return variant}return variant},exports.getFontDataFromClass=function(className){var data=className.split("-"),type=data[1],fvd=data[3],family=decodeFontFamily(type,data[2]),displayFamily=getDisplayFamily(type,family),variant=getVariant(type,fvd),displayVariant=getDisplayVariant(type,family,fvd);return{data:data,type:type,fvd:fvd,family:family,displayFamily:displayFamily,variant:variant,displayVariant:displayVariant}});exports.getFontsFromClasses=function(classes){return(0,_lodash.reduce)((0,_lodash.reject)(classes,_lodash.isNull),function(fonts,className){var _getFontDataFromClass=getFontDataFromClass(className),data=_getFontDataFromClass.data,type=_getFontDataFromClass.type,family=_getFontDataFromClass.family,variant=_getFontDataFromClass.variant;return fonts[type]||(fonts[type]={}),fonts[type][family]||(fonts[type][family]={type:data[1],family:family,variants:{}}),_Fonts.TYPES_WITH_VARIANTS.indexOf(type)>-1&&(fonts[type][family].variants[variant]=!0),fonts},{})}},{"../enums/Fonts.js":348,"./../elements/helpers/TextStyleHelper":261,"./TypekitLoader":367,base32:16,lodash:161}],364:[function(_dereq_,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}return Array.from(arr)}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}Object.defineProperty(exports,"__esModule",{value:!0}),exports.loadFonts=exports.unsetLoaded=exports.isLoaded=exports.setCustomFontCssUrl=exports.handleFontActive=void 0;var _TYPE_MAP,_loadFontsDataParsers,_lodash=_dereq_("lodash"),_lodash2=_interopRequireDefault(_lodash),_webfontloader=_dereq_("webfontloader"),_TypekitLoader=_dereq_("./TypekitLoader"),_Fonts=_dereq_("../enums/Fonts.js"),_FontsStyleSheets=_dereq_("./FontsStyleSheets.js"),_FontsHelper=_dereq_("./FontsHelper.js"),CUSTOM_FONT_CSS_URL=void 0,fontsLoaded={},TYPE_MAP=(_TYPE_MAP={},_defineProperty(_TYPE_MAP,_Fonts.TYPE_CUSTOM,"custom"),_defineProperty(_TYPE_MAP,_Fonts.TYPE_GOOGLE,"google"),_defineProperty(_TYPE_MAP,_Fonts.TYPE_TYPEKIT,"typekit"),_TYPE_MAP),getFontDataToLoad=function(type,family,variants){switch(type){case _Fonts.TYPE_CUSTOM:return _lodash2.default.map(variants,function(variant){return type+"-"+family+"-"+variant});case _Fonts.TYPE_GOOGLE:return[family+":"+variants.join(",")];case _Fonts.TYPE_TYPEKIT:return[{id:family,variations:variants}]}return[family]},loadFontsDataParsers=(_loadFontsDataParsers={},_defineProperty(_loadFontsDataParsers,_Fonts.TYPE_CUSTOM,function(data){return{families:[].concat.call(data),urls:[CUSTOM_FONT_CSS_URL]}}),_defineProperty(_loadFontsDataParsers,_Fonts.TYPE_GOOGLE,function(data){return{families:[].concat.call(data)}}),_loadFontsDataParsers),loadTypekitFonts=function(fontsToLoad){return fontsToLoad?(0,_TypekitLoader.load)(fontsToLoad):Promise.resolve()},handleFontActive=exports.handleFontActive=function(type,family,fvd){var match=family.match(/^C-([\w\s-_]+)-(\d+)$/);match&&(family=match[1],fvd=match[2]);var className=(0,_FontsHelper.getFontClassName)(type,family,fvd);fontsLoaded[className]=!0},loadFontsOfType=function(type,fontsToLoad){var fontsToLoadMap=_lodash2.default.reduce(fontsToLoad,function(toLoadMap,family){
var colon=family.indexOf(":"),fontFamily=colon===-1?family:family.slice(0,colon);return toLoadMap[fontFamily]=!1,toLoadMap},{});return new Promise(function(resolve){var resolveWhenReady=function(){_lodash2.default.every(fontsToLoadMap)&&resolve(fontsToLoad)},webFontConfig={classes:!1,fontactive:function(family,fvd){handleFontActive(type,family,fvd),fontsToLoadMap[family]=!0,resolveWhenReady()},fontinactive:function(family,fvd){handleFontActive(type,family,fvd),fontsToLoadMap[family]=!0,resolveWhenReady()}};webFontConfig[TYPE_MAP[type]]=loadFontsDataParsers[type](fontsToLoad),window.requestAnimationFrame(function(){return(0,_webfontloader.load)(webFontConfig)})})},shouldLoadFont=function(font){return[_Fonts.TYPE_CUSTOM,_Fonts.TYPE_GOOGLE,_Fonts.TYPE_TYPEKIT].indexOf(font.type)>-1};exports.setCustomFontCssUrl=function(url){return CUSTOM_FONT_CSS_URL=url},exports.isLoaded=function(className){return!!fontsLoaded[className]},exports.unsetLoaded=function(className){return delete fontsLoaded[className]},exports.loadFonts=function(fonts){var fontsToLoad={},classesToCreate=[],webfontloaderPromises=void 0,typekitloaderPromise=void 0;return _lodash2.default.forEach(_lodash2.default.filter(fonts,shouldLoadFont),function(font){var variants=_lodash2.default.reduce(font.variants,function(variants,value,variant){var fvd=(0,_FontsHelper.getFvd)(font.type,variant),className=(0,_FontsHelper.getFontClassName)(font.type,font.family,fvd);return fontsLoaded[className]||(fontsLoaded[className]=!1,variants.push(variant),classesToCreate.push({type:font.type,className:className,family:font.family,fvd:fvd})),variants},[]);if(variants.length){var _fontsToLoad$font$typ;fontsToLoad[font.type]||(fontsToLoad[font.type]=[]),(_fontsToLoad$font$typ=fontsToLoad[font.type]).push.apply(_fontsToLoad$font$typ,_toConsumableArray(getFontDataToLoad(font.type,font.family,variants)))}}),_lodash2.default.reduce(fontsToLoad,function(length,fontsOfType){return length+fontsOfType.length},0)?(fontsToLoad[_Fonts.TYPE_GOOGLE]&&(0,_FontsStyleSheets.createGoogleFontFaces)(fontsToLoad[_Fonts.TYPE_GOOGLE]),(0,_FontsStyleSheets.createClasses)(classesToCreate),webfontloaderPromises=_lodash2.default.map(_lodash2.default.pick(fontsToLoad,[_Fonts.TYPE_CUSTOM,_Fonts.TYPE_GOOGLE]),function(fontsOfType,type){return loadFontsOfType(type,fontsOfType)}),typekitloaderPromise=loadTypekitFonts(fontsToLoad[_Fonts.TYPE_TYPEKIT]),Promise.all([].concat(_toConsumableArray(webfontloaderPromises),[typekitloaderPromise])).then(function(){return fonts})):Promise.resolve(fonts)}},{"../enums/Fonts.js":348,"./FontsHelper.js":363,"./FontsStyleSheets.js":366,"./TypekitLoader":367,lodash:161,webfontloader:422}],365:[function(_dereq_,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}return Array.from(arr)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.updateFont=exports.loadFontsOnElementUpdate=exports.loadTypekitFontsFromElements=exports.loadFontsFromElements=exports.getClassesFromElement=void 0;var _lodash=_dereq_("lodash"),_lodash2=_interopRequireDefault(_lodash),_FontsHelper=_dereq_("./FontsHelper.js"),_FontsLoader=_dereq_("./FontsLoader.js"),_Fonts=_dereq_("../enums/Fonts"),ElementTypes=_dereq_("../enums/ElementTypes.js"),Properties=_dereq_("../enums/Properties.js"),getClassesFromElement=exports.getClassesFromElement=function(element){var props=element.props||element;switch(element.type){case ElementTypes.BOX:case ElementTypes.CHECKBOX:case ElementTypes.CIRCLE:case ElementTypes.RADIO:case ElementTypes.LINK:case ElementTypes.TEXT_ELEMENT:case ElementTypes.TOOLTIP:return[].concat(_toConsumableArray((0,_FontsHelper.getClassesFromText)(props[Properties.INPUT_VALUE])),_toConsumableArray((0,_FontsHelper.getClassesFromFontFamily)(props[Properties.FONT_FAMILY])));case ElementTypes.BUTTON:case ElementTypes.INPUT2:case ElementTypes.LINK_LIST:case ElementTypes.NAVIGATION:case ElementTypes.SELECTLIST:case ElementTypes.TEXTAREA:return(0,_FontsHelper.getClassesFromFontFamily)(props[Properties.FONT_FAMILY]);case ElementTypes.TABLE:return _lodash2.default.reduce(props[Properties.CELLSSTYLES],function(classes,cellStyle){return[].concat(_toConsumableArray(classes),_toConsumableArray((0,_FontsHelper.getClassesFromFontFamily)(cellStyle[Properties.FONT_FAMILY])))},(0,_FontsHelper.getClassesFromFontFamily)(props[Properties.FONT_FAMILY]))}return[]},getUniqueFontsFromElements=function(elements){var classes=_lodash2.default.uniq(_lodash2.default.reduce(elements,function(classes,element){return[].concat(_toConsumableArray(classes),_toConsumableArray(getClassesFromElement(element)))},[]));return _lodash2.default.reduce((0,_FontsHelper.getFontsFromClasses)(classes),function(fonts,fontFamilyMap){return[].concat(_toConsumableArray(fonts),_toConsumableArray(_lodash2.default.values(fontFamilyMap)))},[])},loadFontsFromElements=exports.loadFontsFromElements=function(elements){return(0,_FontsLoader.loadFonts)(getUniqueFontsFromElements(elements))};exports.loadTypekitFontsFromElements=function(elements){return(0,_FontsLoader.loadFonts)(getUniqueFontsFromElements(elements).filter(function(font){return font.type===_Fonts.TYPE_TYPEKIT}))},exports.loadFontsOnElementUpdate=function(elementType,changes){return loadFontsFromElements([{type:elementType,props:_lodash2.default.merge({},changes)}])},exports.updateFont=function(font){font.variants=_lodash2.default.reduce(font.variants,function(variants,value,variant){var fvd=(0,_FontsHelper.getFvd)(font.type,variant),className=(0,_FontsHelper.getFontClassName)(font.type,font.family,fvd);return(0,_FontsLoader.isLoaded)(className)?((0,_FontsLoader.unsetLoaded)(className),_lodash2.default.assign(variants,_defineProperty({},variant,value))):variants},{}),_lodash2.default.size(font.variants)&&(0,_FontsLoader.loadFonts)([font])}},{"../enums/ElementTypes.js":346,"../enums/Fonts":348,"../enums/Properties.js":358,"./FontsHelper.js":363,"./FontsLoader.js":364,lodash:161}],366:[function(_dereq_,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}return Array.from(arr)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.createClasses=exports.createGoogleFontFaces=exports.createTypekitFontFace=void 0;var _lodash=_dereq_("lodash"),_lodash2=_interopRequireDefault(_lodash);_dereq_("whatwg-fetch");var _FontsHelper=_dereq_("./FontsHelper.js"),_Fonts=_dereq_("../enums/Fonts.js"),Logger=_dereq_("../utils/Logger"),GOOGLE_FONTS_CSS="https://fonts.googleapis.com/css?family=",getFontFaceString=function(fontFamily,src,unicodeRange){return["@font-face {","  font-family: "+fontFamily+";","  src: "+src+";",unicodeRange?"  unicode-range: "+unicodeRange+";":"","}"].join("\n")},getClassString=function(className,fontFamily){return["."+className+" {","  font-family: "+fontFamily+", Arial !important;","}"].join("\n")},getFontFamilyFvd=function(type,fontFamily,fvd){var fontFamilyFvd=type+"-"+fontFamily.match(/^['"]?([\w\s-_]+)['"]?$/)[1]+"-"+fvd;return fontFamilyFvd=fontFamilyFvd.indexOf(" ")===-1?fontFamilyFvd:'"'+fontFamilyFvd+'"'},insertRule=function(stylesheet,type,fontFamily,fontStyle,fontWeight,src,unicodeRange){var fvd=(0,_FontsHelper.getFvdForStyle)(fontStyle,fontWeight),fontFamilyFvd=getFontFamilyFvd(type,fontFamily,fvd);stylesheet.insertRule(getFontFaceString(fontFamilyFvd,src,unicodeRange),stylesheet.cssRules.length)},insertRules=function(type,stylesheet){return _lodash2.default.forEach([].concat(_toConsumableArray(stylesheet.cssRules)),function(rule){return insertRule(stylesheet,type,rule.style.getPropertyValue("font-family"),rule.style.getPropertyValue("font-style"),rule.style.getPropertyValue("font-weight"),rule.style.getPropertyValue("src"),rule.style.getPropertyValue("unicode-range"))})},createStylesheet=function(body){return new Promise(function(resolve){var style=document.createElement("style");style.appendChild(document.createTextNode(body)),document.head.appendChild(style),window.requestAnimationFrame(function(){resolve(_lodash2.default.find(document.styleSheets,{ownerNode:style}))})})},safeGetCssRules=function(styleSheet){try{return styleSheet.cssRules}catch(e){return[]}},getStyleSheet=function(rule){return _lodash2.default.find(document.styleSheets,function(styleSheet){return _lodash2.default.some(safeGetCssRules(styleSheet),function(cssRule){return cssRule===rule})})},getAllCssFontFaceRules=function(){return _lodash2.default.reduce(document.styleSheets,function(styleSheets,styleSheet){return[].concat(_toConsumableArray(styleSheets),_toConsumableArray(_lodash2.default.filter(safeGetCssRules(styleSheet),function(rule){return rule instanceof CSSFontFaceRule})))},[])},findTypekitFontCssRule=function(family,style,weight){return _lodash2.default.find(getAllCssFontFaceRules(),function(rule){return rule.style.getPropertyValue("font-family").replace(/['"]/g,"")===family&&rule.style.getPropertyValue("font-style")===style&&parseInt(rule.style.getPropertyValue("font-weight"))===weight})};exports.createTypekitFontFace=function(family,fvd,familyMap){var fontStyle=(0,_FontsHelper.parseStyle)(fvd),fontWeight=(0,_FontsHelper.parseWeight)(fvd),rule=findTypekitFontCssRule(family,fontStyle,fontWeight);if(!rule)return void Logger.error('Font "'+family+'" with weight "'+fontWeight+'" and style "'+fontStyle+'" not found');var src=rule.style.getPropertyValue("src"),unicodeRange=rule.style.getPropertyValue("unicode-range"),fontFamily=familyMap&&familyMap[family]?familyMap[family]:family;insertRule(getStyleSheet(rule),_Fonts.TYPE_TYPEKIT,fontFamily,fontStyle,fontWeight,src,unicodeRange)},exports.createGoogleFontFaces=function(fonts){var queryString=fonts.join("|").replace(/\s/g,"+");fetch(GOOGLE_FONTS_CSS+queryString).then(function(response){return response.text()}).then(function(body){return createStylesheet(body)}).then(function(stylesheet){return insertRules(_Fonts.TYPE_GOOGLE,stylesheet)})},exports.createClasses=function(fonts){var classesString=_lodash2.default.reduce(fonts,function(classes,font){return[].concat(_toConsumableArray(classes),[getClassString(font.className,getFontFamilyFvd(font.type,font.family,font.fvd))])},[]).join("\n"),style=document.createElement("style");style.appendChild(document.createTextNode(classesString)),document.head.appendChild(style)}},{"../enums/Fonts.js":348,"../utils/Logger":413,"./FontsHelper.js":363,lodash:161,"whatwg-fetch":423}],367:[function(_dereq_,module,exports){"use strict";function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}return Array.from(arr)}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}Object.defineProperty(exports,"__esModule",{value:!0}),exports.getVariantName=exports.getFamilyNameByWebId=exports.init=exports.load=void 0;var _lodash=_dereq_("lodash"),_webfontloader=_dereq_("webfontloader"),_DomHelper=_dereq_("../utils/DomHelper"),_Fonts=_dereq_("../enums/Fonts.js"),_FontsLoader=_dereq_("./FontsLoader"),_FontsStyleSheets=_dereq_("./FontsStyleSheets.js"),Logger=_dereq_("../utils/Logger"),TRY_AGAIN_DELAY=300,LOAD_FONT_RETRIES=3,TYPEKIT_PREVIEW_URL="https://use.typekit.net/previewkits/pk-v1.js",TYPEKIT_PREVIEW_AUTH_ID=void 0,TYPEKIT_PREVIEW_AUTH_TOKEN=void 0,TYPEKIT_KIT=void 0,PAGE=void 0,getFont=function(webId){return TYPEKIT_KIT?(0,_lodash.find)(TYPEKIT_KIT.families,function(family){return family.id===webId}):null},getWebIdByFamilyName=function(familyName){var font=(0,_lodash.find)(TYPEKIT_KIT.families,function(family){return family.css_names.indexOf(familyName)>-1});return font?font.id:null},loadKit=function(fontsToLoad){return new Promise(function(resolve){var fontActiveCallback=function(family,fvd){var webId=getWebIdByFamilyName(family),fontToLoad=(0,_lodash.find)(fontsToLoad,function(font){return font.id===webId});fontToLoad&&fontToLoad.variations.indexOf(fvd)!==-1&&((0,_FontsLoader.handleFontActive)(_Fonts.TYPE_TYPEKIT,webId,fvd),(0,_FontsStyleSheets.createTypekitFontFace)(family,fvd,_defineProperty({},family,webId)))},config={typekit:{id:TYPEKIT_KIT.id},fontactive:fontActiveCallback,fontinactive:fontActiveCallback,active:function(){return resolve(fontsToLoad)}};window.requestAnimationFrame(function(){return(0,_webfontloader.load)(config)})})},getLoader=function(){var loadRemoteScriptPromise=void 0;return function(){return new Promise(function(resolve,reject){return window.TypekitPreview?resolve(window.TypekitPreview):(loadRemoteScriptPromise||(loadRemoteScriptPromise=(0,_DomHelper.loadRemoteScript)(TYPEKIT_PREVIEW_URL).then(function(){window.TypekitPreview.setup({auth_id:TYPEKIT_PREVIEW_AUTH_ID,auth_token:TYPEKIT_PREVIEW_AUTH_TOKEN,default_subset:"default"})}).catch(reject)),loadRemoteScriptPromise.then(function(){return resolve(window.TypekitPreview)}))})}}(),loadFonts=function(fonts){return new Promise(function(resolve,reject){return(0,_lodash.isEmpty)(fonts)?resolve():void getLoader().then(function(TypekitPreview){var loadedFonts=0,fontsToLoadCount=(0,_lodash.reduce)(fonts,function(sum,font){return sum+font.variations.length},0),inactiveFonts={},handleInactiveFont=function(webId,fvd){var font=(0,_lodash.find)(fonts,{id:webId});if(font){var inactiveVariations=inactiveFonts[webId]&&inactiveFonts[webId].variations||[];inactiveFonts[webId]=(0,_lodash.assign)({},font,{variations:inactiveVariations.concat(fvd)})}},handleFontLoad=function(){if(!(++loadedFonts<fontsToLoadCount))return(0,_lodash.isEmpty)(inactiveFonts)?void resolve():reject((0,_lodash.values)(inactiveFonts))};window.requestAnimationFrame(function(){return TypekitPreview.load(fonts,{classes:!0,fontactive:function(webId,fvd){(0,_FontsStyleSheets.createTypekitFontFace)(webId,fvd),handleFontLoad()},fontinactive:function(webId,fvd){handleInactiveFont(webId,fvd),handleFontLoad()}})})})})},loadPreview=function(fontsToLoad,allFonts){return new Promise(function(resolve){if((0,_lodash.isEmpty)(fontsToLoad))return resolve(allFonts);var tryLoadFonts=function tryLoadFonts(fonts){var retries=arguments.length>1&&void 0!==arguments[1]?arguments[1]:LOAD_FONT_RETRIES;loadFonts(fonts).then(function(){return resolve(allFonts)}).catch(function(inactiveFonts){if(0===retries){var ids=(inactiveFonts||[]).map(function(font){return font&&font.id}).join(",");return Logger.error('Load fonts failed: "'+ids+'"'),resolve(allFonts)}setTimeout(function(){return tryLoadFonts(inactiveFonts,retries-1)},TRY_AGAIN_DELAY)})};tryLoadFonts(fontsToLoad)})},getWithoutDeletedFonts=function(kitFonts,fontsToLoad){var getKitFont=function(webId){return(0,_lodash.find)(kitFonts,function(font){return font.webId===webId})};return(0,_lodash.reduce)(fontsToLoad,function(fontsToLoad,font){var kitFont=getKitFont(font.id),variationsToLoad=kitFont?(0,_lodash.intersection)(font.variations,kitFont.variants):[];return(0,_lodash.isEmpty)(variationsToLoad)?fontsToLoad:[].concat(_toConsumableArray(fontsToLoad),[(0,_lodash.assign)({},font,{variations:variationsToLoad})])},[])};exports.load=function(fontsToLoad){return new Promise(function(resolve){return TYPEKIT_KIT?loadKit(fontsToLoad).then(resolve):PAGE.isDesignMode()?PAGE.getTypekitKitFonts().then(function(kitFonts){return getWithoutDeletedFonts(kitFonts,fontsToLoad)}).then(function(fontsToLoadWithoutDeleted){return loadPreview(fontsToLoadWithoutDeleted,fontsToLoad)}).then(resolve):resolve()})},exports.init=function(config,page){PAGE=page,config&&(TYPEKIT_KIT=config.kit,TYPEKIT_PREVIEW_AUTH_ID=config.typekitPreviewAuthId,TYPEKIT_PREVIEW_AUTH_TOKEN=config.typekitPreviewAuthToken)},exports.getFamilyNameByWebId=function(webId){var font=getFont(webId);return font?font.name:webId},exports.getVariantName=function(webId,fvd){var font=getFont(webId);return font&&font.variationsMap?font.variationsMap[fvd]:null}},{"../enums/Fonts.js":348,"../utils/DomHelper":410,"../utils/Logger":413,"./FontsLoader":364,"./FontsStyleSheets.js":366,lodash:161,webfontloader:422}],368:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),EventEmitter=_dereq_("event-emitter"),Calc=_dereq_("../utils/Calc.js"),OperationTypes=_dereq_("../enums/OperationTypes.js"),BatchOperation=_dereq_("./BatchOperation.js"),Properties=_dereq_("../enums/Properties.js"),ElementTypes=_dereq_("../enums/ElementTypes.js");module.exports=function(){function isEqual(property1,property2){return"number"==typeof property1?Calc.Round(property1,2)===Calc.Round(property2,2):_.isEqual(property1,property2)}function getElementChanges(element,serialized,prevSerialized){return _.omit(serialized,function(value,property){return!element._isPropertySerializable(property)||isEqual(prevSerialized[property],value)})}function isComponentCanvasOperation(operation){if(operation.type!==OperationTypes.CHANGE_PROPERTY)return!1;var storedElements1=operation.prevSerialized.props[Properties.STORED_ELEMENTS],storedElements2=operation.serialized.props[Properties.STORED_ELEMENTS];return operation.serialized.type===ElementTypes.COMPONENT&&!_.isEqual(storedElements1,storedElements2)}function getChangedProperties(operations){return _.reduce(_.filter(operations,{type:OperationTypes.CHANGE_PROPERTY}),function(changes,operation){var valueOld=operation.prevSerialized.props[operation.property],valueNew=operation.serialized.props[operation.property];return isEqual(valueOld,valueNew)||(changes[operation.elementId]||(changes[operation.elementId]={}),changes[operation.elementId][operation.property]=valueNew),changes},{})}function Batch(Page,updateOnBatchEnd,addToHistory){this.Page=Page,this.updateOnBatchEnd=updateOnBatchEnd,this.addToHistory=addToHistory,this.operations=[],this.updated={},this.elements={},this.components={}}return Batch.FromSerialized=function(Page,serialized){var batch=new Batch(Page);return batch.operations=_.map(serialized,function(operation){return new BatchOperation.FromSerialized(operation)}),batch},Batch.prototype=Object.create(new EventEmitter),Batch.constructor=Batch,Batch.prototype.setUpdated=function(elementId,property){this.updated[elementId]||(this.updated[elementId]={}),this.updated[elementId][property]=!0},Batch.prototype.canUpdate=function(elementId,property){return!this.updated[elementId]||!this.updated[elementId][property]},Batch.prototype.hasChanges=function(){for(var operation,i=0,len=this.operations.length;i<len;i++)if(operation=this.operations[i],!_.isEmpty(operation.getChanges()))return!0;return!1},Batch.prototype.end=function(){var operation,element,virtualGroup=this._getVirtualGroup(this.operations);if(this.updateOnBatchEnd)for(var i=0,len=this.operations.length;i<len;i++)operation=this.operations[i],element=this.Page.ElementsManager.getElementById(operation.elementId,operation.componentInstanceId),element&&operation.setSerialized(element.serialize());virtualGroup&&(this.operations.unshift(new BatchOperation(OperationTypes.ADD_ELEMENT,virtualGroup.id,"",_.find(this.operations,function(operation){return operation.elementId===virtualGroup.id}).prevSerialized,{})),this.operations.push(new BatchOperation(OperationTypes.REMOVE_ELEMENT,virtualGroup.id,"",{},virtualGroup.serialize())))},Batch.prototype.addSaveOperation=function(element,serialized){this._canAddElement(element.id)&&(this.elements[element.id]=serialized||element.serialize())},Batch.prototype.changeProperty=function(elementId,componentInstanceId,serialized,prevSerialized,property){this._storeSerializedComponent(elementId,componentInstanceId,serialized,prevSerialized,property),isEqual(prevSerialized.props[property],serialized.props[property])&&!this.updateOnBatchEnd||this._addOperation(OperationTypes.CHANGE_PROPERTY,elementId,componentInstanceId,serialized,prevSerialized,property)},Batch.prototype.addElement=function(elementId,componentInstanceId,serialized){this._addOperation(OperationTypes.ADD_ELEMENT,elementId,componentInstanceId,serialized,{})},Batch.prototype.removeElement=function(elementId,componentInstanceId,prevSerialized){this._addOperation(OperationTypes.REMOVE_ELEMENT,elementId,componentInstanceId,{},prevSerialized)},Batch.prototype.undo=function(){var operation,editingComponent=this.Page.ElementsManager.getEditingComponent(),editingComponentInstanceId=editingComponent?editingComponent.id:"",batchComponentInstanceId=this.getComponentInstanceId(),shouldChangeEditingComponent=batchComponentInstanceId&&batchComponentInstanceId!==editingComponentInstanceId;shouldChangeEditingComponent&&this.Page.ElementsManager.editComponent(this.Page.ElementsManager.getElementById(batchComponentInstanceId)),this.Page.ElementsManager.startBatch(!1,!1);for(var i=this.operations.length;i-- >0;)operation=this.operations[i],operation.type===OperationTypes.CHANGE_PROPERTY?this._undoChangeProperty(operation):operation.type===OperationTypes.ADD_ELEMENT?this._undoAddElement(operation):operation.type===OperationTypes.REMOVE_ELEMENT&&this._undoRemoveElement(operation);return this.Page.ElementsManager.endBatch(),shouldChangeEditingComponent&&this.Page.ElementsManager.editComponent(editingComponent),this.Page.canvas.updateHighlightSelect(),!0},Batch.prototype.redo=function(){var editingComponent=this.Page.ElementsManager.getEditingComponent(),editingComponentInstanceId=editingComponent?editingComponent.id:"",batchComponentInstanceId=this.getComponentInstanceId(),shouldChangeEditingComponent=batchComponentInstanceId&&batchComponentInstanceId!==editingComponentInstanceId;return shouldChangeEditingComponent&&this.Page.ElementsManager.editComponent(this.Page.ElementsManager.getElementById(batchComponentInstanceId)),this.Page.ElementsManager.startBatch(!1,!1),_.forEach(this.operations,function(operation){operation.type===OperationTypes.CHANGE_PROPERTY?this._redoChangeProperty(operation):operation.type===OperationTypes.ADD_ELEMENT?this._redoAddElement(operation):operation.type===OperationTypes.REMOVE_ELEMENT&&this._redoRemoveElement(operation)}.bind(this)),this.Page.ElementsManager.endBatch(),shouldChangeEditingComponent&&this.Page.ElementsManager.editComponent(editingComponent),this.Page.canvas.updateHighlightSelect(),!0},Batch.prototype.getComponentInstanceId=function(){return _.first(_.without(_.uniq(_.map(this.operations,function(operation){return isComponentCanvasOperation(operation)?operation.elementId:operation.componentInstanceId})),""))},Batch.prototype.getComponentId=function(){var componentInstanceId=this.getComponentInstanceId(),componentId=componentInstanceId?this.Page.ElementsManager.getElementById(componentInstanceId).idComponent:"";return componentId},Batch.prototype.getChanges=function(){var deletedElements=_.map(_.filter(this.operations,{type:OperationTypes.REMOVE_ELEMENT}),function(operation){return operation.elementId}),elementChanges=_.mapValues(_.omit(this.elements,deletedElements),function(prevSerialized,elementId){var componentInstanceId=this.Page.ElementsManager.getComponentInstanceIdByElementId(elementId),element=this.Page.ElementsManager.getElementById(elementId,componentInstanceId);return{type:element.type,props:getElementChanges(element,element.serialize().props,prevSerialized.props),v:prevSerialized.v}}.bind(this)),changedElements=_.omit(elementChanges,function(changes){return _.isEmpty(changes.props)});return{changed_properties:getChangedProperties(this.operations),changed_elements:changedElements,deleted_elements:_.mapValues(_.countBy(deletedElements),function(){return!0})}},Batch.prototype.getSerializedComponent=function(componentInstanceId){return this.components[componentInstanceId]},Batch.prototype.serialize=function(){return _.map(this.operations,function(operation){return operation.serialize()})},Batch.prototype._addOperation=function(operationType,elementId,componentInstanceId,serialized,prevSerialized,property){this.operations.push(new BatchOperation(operationType,elementId,componentInstanceId,serialized,prevSerialized,property))},Batch.prototype._canAddElement=function(elementId){if(!elementId)return!1;var editingComponent=this.Page.ElementsManager.getEditingComponent(),componentId=this.Page.ElementsManager.getComponentIdByElementId(elementId);return!this.elements[elementId]&&(!componentId||editingComponent&&editingComponent.idComponent===componentId)},Batch.prototype._undoChangeProperty=function(operation){var element=this.Page.ElementsManager.getElementById(operation.elementId,operation.componentInstanceId);element._updateProperty(operation.property,operation.prevSerialized.props[operation.property],!0)},Batch.prototype._undoAddElement=function(operation){var element=this.Page.ElementsManager.getElementById(operation.elementId,operation.componentInstanceId);this.Page.ElementsManager.removeElement(element,operation.componentInstanceId),this.Page.canvas.removeFromSelection(element)},Batch.prototype._undoRemoveElement=function(operation){this.Page.ElementsManager.addElementSerialized(operation.prevSerialized,operation.componentInstanceId)},Batch.prototype._redoChangeProperty=function(operation){var element=this.Page.ElementsManager.getElementById(operation.elementId,operation.componentInstanceId);element._updateProperty(operation.property,operation.serialized.props[operation.property],!0)},Batch.prototype._redoAddElement=function(operation){this.Page.ElementsManager.addElementSerialized(operation.serialized,operation.componentInstanceId)},Batch.prototype._redoRemoveElement=function(operation){var element=this.Page.ElementsManager.getElementById(operation.elementId,operation.componentInstanceId);this.Page.ElementsManager.removeElement(element,operation.componentInstanceId)},Batch.prototype._getVirtualGroup=function(operations){var group=null;return _.forEach(operations,function(operation){var element=this.Page.ElementsManager.getElementById(operation.elementId);if(element&&element.isVirtualGroup())return group=element,!1}.bind(this)),group},Batch.prototype._storeSerializedComponent=function(elementId,componentInstanceId,serialized){componentInstanceId=componentInstanceId||(serialized.type===ElementTypes.COMPONENT?elementId:""),componentInstanceId&&!this.components[componentInstanceId]&&(this.components[componentInstanceId]=this.Page.ElementsManager.getElementById(componentInstanceId).serialize())},Batch}()},{"../enums/ElementTypes.js":346,"../enums/OperationTypes.js":355,"../enums/Properties.js":358,"../utils/Calc.js":407,"./BatchOperation.js":369,"event-emitter":98,lodash:161}],369:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Calc=_dereq_("../utils/Calc.js");module.exports=function(){function BatchOperation(type,elementId,componentInstanceId,serialized,prevSerialized,property){this.type=type,this.elementId=elementId,this.componentInstanceId=componentInstanceId,this.serialized=serialized,this.prevSerialized=prevSerialized,this.property=property}return BatchOperation.FromSerialized=function(serialized){var operation=new BatchOperation(serialized.type,serialized.elementId,serialized.componentInstanceId,serialized.serialized,serialized.prevSerialized,serialized.property);return operation},BatchOperation.prototype.setSerialized=function(serialized){this.serialized=serialized},BatchOperation.prototype.getChanges=function(){return _.omit(this.serialized,function(value,property){return"number"==typeof value?Calc.Round(this.prevSerialized[property],2)===Calc.Round(value,2):_.isEqual(this.prevSerialized[property],value)}.bind(this))},BatchOperation.prototype.serialize=function(){return{type:this.type,elementId:this.elementId,componentInstanceId:this.componentInstanceId,serialized:this.serialized,prevSerialized:this.prevSerialized,property:this.property}},BatchOperation}()},{"../utils/Calc.js":407,lodash:161}],370:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),EventEmitter=_dereq_("event-emitter"),HistoryValidator=_dereq_("./HistoryValidator.js"),Events=_dereq_("../enums/Events.js"),HistoryStorage=_dereq_("./HistoryStorage");module.exports=function(){function updateStoredCurrentBatch(pageId){dontUpdate||HistoryStorage.updateCurrentBatch(pageId,currentBatch)}function serialize(){var serialized={};return serialized.currentBatch=currentBatch,serialized.componentsMap=componentsMap,serialized.batches=_.map(batches,function(batch){return batch.serialize()}),serialized}function emitHistoryChange(){emitter.emit(Events.HISTORY_CHANGE,{undo:CanUndo(),redo:CanRedo()})}function Add(batch){var history=HistoryStorage.addBatch(currentBatch,componentsMap,batch);currentBatch=history.currentBatch,batches=history.batches,emitHistoryChange()}function CanUndo(){return!!(!locked&&batches.length&&currentBatch>-1)}function CanRedo(){return!!(!locked&&batches.length&&currentBatch<batches.length-1)}function Undo(){var batch=batches[currentBatch--];batch.undo(),updateStoredCurrentBatchThrottled(batch.Page.pageId),emitHistoryChange()}function Redo(){var batch=batches[++currentBatch];batch.redo(),updateStoredCurrentBatchThrottled(batch.Page.pageId),emitHistoryChange()}function Load(page){HistoryStorage.load(page).then(function(doc){currentBatch=doc.currentBatch,batches=doc.batches,_.forEach(doc.componentsMap,AddToComponentsMap),ValidateAndStore(page)}).catch(function(){Clear(),HistoryStorage.clear(page.pageId),emitHistoryChange()})}function Clear(){batches=[],currentBatch=-1,storedBatches=null,storedCurrentBatch=null,dontUpdate=!1}function Lock(value){locked=value}function StoreAndClear(){dontUpdate||(dontUpdate=!0,storedBatches=batches,storedCurrentBatch=currentBatch,batches=[],currentBatch=-1,emitHistoryChange())}function Restore(){dontUpdate&&(dontUpdate=!1,batches=storedBatches,currentBatch=storedCurrentBatch,storedBatches=null,storedCurrentBatch=null,emitHistoryChange())}function ValidateAndStore(page){var i,changed=!1;for(i=currentBatch;i>=0;i--)if(!HistoryValidator.IsValidBatch(batches[i],page.ElementsManager.componentsAvailableIds,componentsMap)){clearHistoryRange(0,i+1),changed=!0;break}for(i=currentBatch+1;i<batches.length;i++)if(!HistoryValidator.IsValidBatch(batches[i],page.ElementsManager.componentsAvailableIds,componentsMap)){clearHistoryRange(i,batches.length-i),changed=!0;break}changed&&HistoryStorage.store(page.pageId,serialize()),emitHistoryChange()}function AddToComponentsMap(componentId,instanceId){componentsMap[instanceId]=componentId}function clearHistoryRange(start,length){batches.splice(start,length),start<currentBatch&&(currentBatch-=length)}var updateStoredCurrentBatchThrottled,batches=[],componentsMap={},storedBatches=null,currentBatch=-1,storedCurrentBatch=null,emitter=new EventEmitter,dontUpdate=!1,locked=!1;updateStoredCurrentBatchThrottled=_.throttle(updateStoredCurrentBatch,1e3);var HistoryManager={Add:Add,CanUndo:CanUndo,CanRedo:CanRedo,Undo:Undo,Redo:Redo,Load:Load,Clear:Clear,Lock:Lock,StoreAndClear:StoreAndClear,ValidateAndStore:ValidateAndStore,Restore:Restore,AddToComponentsMap:AddToComponentsMap,AddListener:emitter.on.bind(emitter),RemoveListener:emitter.off.bind(emitter)};return HistoryManager}()},{"../enums/Events.js":347,"./HistoryStorage":371,"./HistoryValidator.js":372,"event-emitter":98,lodash:161}],371:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Batch=_dereq_("./Batch"),StorageUtils=_dereq_("./worker/storageUtils"),Storage=_dereq_("../utils/Storage"),createWorker=_dereq_("../utils/Worker"),HistoryWorker=createWorker(_dereq_("./worker/historyWorker.js"));module.exports=function(){function deserialize(Page,data){return data=data||{},data.batches=_.map(data.batches,function(batch){return Batch.FromSerialized(Page,batch)}),data}function _addBatch(currentBatch,componentsMap,batch){HistoryWorker.postMessage(JSON.stringify({
id:StorageUtils.getDBId(batch.Page.pageId),type:StorageUtils.types.ADD,currentBatch:currentBatch,componentsMap:componentsMap,batch:batch.serialize()}))}var localHistoryData={};return{store:function(pageId,data){localHistoryData[pageId]=data,HistoryWorker.postMessage(JSON.stringify(_.assign({},data,{id:StorageUtils.getDBId(pageId),type:StorageUtils.types.STORE})))},load:function(page){return Storage.Load(StorageUtils.getDBId(page.pageId)).then(function(data){return localHistoryData[page.pageId]=deserialize(page,data),localHistoryData[page.pageId]})},addBatch:function(currentBatch,componentsMap,batch){return localHistoryData[batch.Page.pageId]=StorageUtils.addBatchToHistory(localHistoryData[batch.Page.pageId],{currentBatch:currentBatch,componentsMap:componentsMap,batch:batch}),_addBatch(currentBatch,componentsMap,batch),localHistoryData[batch.Page.pageId]},updateCurrentBatch:function(pageId,currentBatch){localHistoryData[pageId]&&(localHistoryData[pageId].currentBatch=currentBatch),HistoryWorker.postMessage(JSON.stringify({type:StorageUtils.types.UPDATE,id:StorageUtils.getDBId(pageId),currentBatch:currentBatch}))},clear:function(pageId){delete localHistoryData[pageId],Storage.Remove(StorageUtils.getDBId(pageId))}}}()},{"../utils/Storage":417,"../utils/Worker":420,"./Batch":368,"./worker/historyWorker.js":373,"./worker/storageUtils":374,lodash:161}],372:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash");module.exports=function(){function isRemovedComponent(elementId,instanceMap,componentsIds){var componentOriginalId=instanceMap[elementId];return componentOriginalId&&componentsIds.indexOf(componentOriginalId)===-1}function areSomeRemovedComponents(elements,instanceMap,componentsIds){return!_.isEmpty(elements)&&_.some(elements,function(elementId){return isRemovedComponent(elementId,instanceMap,componentsIds)})}function IsValidBatch(batch,componentsIds,instanceMap){return _.every(batch.operations,IsValidOperation.bind(null,componentsIds,instanceMap))}function IsValidOperation(componentsIds,instanceMap,operation){return!isRemovedComponent(operation.elementId,instanceMap,componentsIds)&&((!operation.componentInstanceId||!isRemovedComponent(operation.componentInstanceId,instanceMap,componentsIds))&&((!operation.serialized.props||!areSomeRemovedComponents(operation.serialized.props.storedElements,instanceMap,componentsIds))&&(!operation.prevSerialized.props||!areSomeRemovedComponents(operation.prevSerialized.props.storedElements,instanceMap,componentsIds))))}var HistoryValidator={IsValidBatch:IsValidBatch,IsValidOperation:IsValidOperation};return HistoryValidator}()},{lodash:161}],373:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Storage=_dereq_("../../utils/Storage"),StorageUtils=_dereq_("./storageUtils");module.exports=function(self){function addBatch(data){Storage.Load(data.id).then(function(history){var toSave=StorageUtils.addBatchToHistory(history,{currentBatch:data.currentBatch,componentsMap:data.componentsMap,batch:data.batch});Storage.Save(data.id,toSave)})}function storeHistory(data){Storage.Save(data.id,_.pick(data,["currentBatch","componentsMap","batches"]))}function updateCurrentBatch(data){Storage.Load(data.id).then(function(history){Storage.Save(data.id,_.assign(history,{currentBatch:data.currentBatch}))})}self.addEventListener("message",function(event){var data=JSON.parse(event.data);switch(data.type){case StorageUtils.types.ADD:return addBatch(data);case StorageUtils.types.UPDATE:return updateCurrentBatch(data);case StorageUtils.types.STORE:return storeHistory(data)}})}},{"../../utils/Storage":417,"./storageUtils":374,lodash:161}],374:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash");module.exports=function(){function getDBId(pageId){return DB_ID_PREFIX+pageId}function addBatchToHistory(pageHistory,batchData){pageHistory=_.assign({batches:[]},pageHistory),batchData.currentBatch!==pageHistory.batches.length-1&&pageHistory.batches.splice(batchData.currentBatch+1,pageHistory.batches.length-batchData.currentBatch);var batches=pageHistory.batches.concat([batchData.batch]).slice(-MAX_STEPS);return _.assign(pageHistory,{batches:batches,currentBatch:batches.length-1,componentsMap:batchData.componentsMap})}var DB_ID_PREFIX="batches_",MAX_STEPS=100,TYPE_ADD="ADD",TYPE_UPDATE="UPDATE",TYPE_STORE="STORE",TYPES={ADD:TYPE_ADD,UPDATE:TYPE_UPDATE,STORE:TYPE_STORE};return{types:TYPES,getDBId:getDBId,addBatchToHistory:addBatchToHistory}}()},{lodash:161}],375:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),AnimationsMap=_dereq_("../enums/AnimationsMap.js");module.exports=function(){function ParseAnimation(data){var easingData=_.defaults(data||{},{easing:AnimationsMap.easing.LINEAR.value,easingType:AnimationsMap.easingType.POWER0.value,duration:0});return data&&data.easing||(easingData.duration=0),easingData.style&&Object.keys(AnimationsMap.legacyEasing).indexOf(easingData.style)>-1&&(easingData.duration=easingData.time||easingData.duration||0,easingData.easing=AnimationsMap.legacyEasing[easingData.style].easing,easingData.easingType=AnimationsMap.legacyEasing[easingData.style].easingType),easingData}function GetEasing(data){var easing,springiness;return data.easingType===AnimationsMap.easingType.ELASTIC.value?(springiness=data.springness/Math.pow(10,2*(String(data.springness).length-2)+1),easing=window[data.easingType][data.easing].config(data.amplitude/100,springiness)):easing=window[data.easingType][data.easing],easing}var AnimationsHelper={ParseAnimation:ParseAnimation,GetEasing:GetEasing};return Object.freeze(AnimationsHelper)}()},{"../enums/AnimationsMap.js":344,lodash:161}],376:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),TweenLite=_dereq_("gsap"),AnimationsHelper=_dereq_("./AnimationsHelper.js");module.exports=function(){function Animator(element,property,startValue,endValue,interaction){this.property=property,this.interaction=interaction,this.startValue=startValue,this.endValue=endValue,this.element=element,this.value=null,this.prevValue=null,this.tween=null}return Animator.prototype.play=function(){return this._setStartValue(),new Promise(function(resolve){var animation=AnimationsHelper.ParseAnimation(this.interaction.animation);this.tween=TweenLite.to(this,animation.duration/1e3,this._setEndValue({ease:AnimationsHelper.GetEasing(animation),onUpdate:this._update.bind(this),onComplete:resolve.bind(null,this)}))}.bind(this))},Animator.prototype.cancel=function(){this.tween.kill()},Animator.prototype._setStartValue=function(){this.value=this.prevValue=this.startValue},Animator.prototype._setEndValue=function(props){return _.extend(props,{value:this.endValue})},Animator.prototype._update=function(){var delta=this.value-this.prevValue;this.prevValue=this.value,this.element[this.property]+=delta},Animator}()},{"./AnimationsHelper.js":375,gsap:101,lodash:161}],377:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Animator=_dereq_("./Animator.js"),Color=_dereq_("../utils/Color.js");module.exports=function(){function AnimatorColor(element,property,startValue,endValue,interaction){Animator.call(this,element,property,startValue,endValue,interaction)}return AnimatorColor.prototype=Object.create(Animator.prototype),AnimatorColor.constructor=AnimatorColor,AnimatorColor.prototype._setStartValue=function(){var start=Color.getRgbaIngredients(this.startValue);start||(start=Color.isTransparent(this.startValue)?this.startValue:Color.hexToRgba(this.startValue)),_.extend(this,start)},AnimatorColor.prototype._setEndValue=function(props){var end=Color.getRgbaIngredients(this.endValue);return end||(end=Color.hexToRgba(this.endValue)),_.extend(props,end)},AnimatorColor.prototype._update=function(){this.element[this.property]=Color.rgbaToString(Math.round(this.r),Math.round(this.g),Math.round(this.b),this.a)},AnimatorColor}()},{"../utils/Color.js":409,"./Animator.js":376,lodash:161}],378:[function(_dereq_,module,exports){"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_=_dereq_("lodash"),InteractionActions=_dereq_("../enums/InteractionActions.js");module.exports=function(){function parseDelay(delay){return parseInt("object"===("undefined"==typeof delay?"undefined":_typeof(delay))?delay.value:delay)||0}function isCancelable(action,value){var isMoveBy=action===InteractionActions.MOVE,isRotateBy=action===InteractionActions.ROTATE&&"object"===("undefined"==typeof value?"undefined":_typeof(value))&&"to"===value.type;return!(isMoveBy||isRotateBy)}function Interaction(action){this.id=_.uniqueId("interaction"),this.trigger=action.event,this.action=action.action,this.value=action.action_value,this.triggerValue=action.event_value||action.trigger_value,this.elements=action.elements,this.animation=action.animation,this.delay=parseDelay(action.delay),this.isCancelable=isCancelable(this.action,this.value),this.step=action.step,this.initialState={}}return Interaction.prototype.getInitialState=function(id){return this.initialState[id]},Interaction.prototype.setInitialState=function(element,property){var endValue=element.getPropertyEndValue(property);_.set(this.initialState,[element.id,property],"undefined"!=typeof endValue?endValue:element[property])},Interaction}()},{"../enums/InteractionActions.js":350,lodash:161}],379:[function(_dereq_,module,exports){"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_=_dereq_("lodash"),Events=_dereq_("../enums/Events.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),Properties=_dereq_("../enums/Properties.js"),InteractionTriggers=_dereq_("../enums/InteractionTriggers.js"),Color=_dereq_("../utils/Color.js"),Animator=_dereq_("./Animator.js"),AnimatorColor=_dereq_("./AnimatorColor.js");module.exports=function(){function shouldSetInitialState(trigger){return trigger===InteractionTriggers.HOVER||trigger===InteractionTriggers.WINDOW_SCROLL}function setInteractionInitialState(element,interaction,property){shouldSetInitialState(interaction.trigger)&&interaction.setInitialState(element,property)}function getPropertyEndValue(element,property){var endValue=element.getPropertyEndValue(property);return"undefined"!=typeof endValue?endValue:element[property]}function getAngle(value){return parseInt("object"===("undefined"==typeof value?"undefined":_typeof(value))?value.angle:value,10)||0}function getUniqueElementId(element){return element.componentInstance?element.id.concat(element.componentInstance.id):element.id}function toCamelCase(str){return str.replace(/[_]([a-z])/g,function(match,p1){return p1.toUpperCase()})}function getBackgroundColor(value){return value["background-color"]}function getBorderColor(value){return value["border-color"]}function getColor(value,elementType){return!value.color&&mayHaveBrokenColorProperty(elementType)?getBackgroundColor(value):value.color}function isColorProperty(property){return[Properties.BACKGROUND_COLOR,Properties.BORDER_COLOR,Properties.COLOR].indexOf(property)>-1}function mayHaveBrokenColorProperty(elementType){return[ElementTypes.ANDROID_ICON,ElementTypes.COSTCO_ICON,ElementTypes.FONT_AWESOME,ElementTypes.GEO_SVG,ElementTypes.ICON,ElementTypes.LINE,ElementTypes.MATERIAL_ICON,ElementTypes.PIXLE_ICON,ElementTypes.RETINA_ICON,ElementTypes.UXPIN_ICON_SET].indexOf(elementType)>-1}function isEqual(property,valueStart,valueEnd){return isColorProperty(property)&&(valueStart=valueStart?Color.toRgba(valueStart):0,valueEnd=valueEnd?Color.toRgba(valueEnd):0),valueStart===valueEnd}function borderRadius(element,interaction,reversed){var borderBottomLeftRadius=reversed?interaction.getInitialState(element.id).borderBottomLeftRadius:interaction.value.borderBottomLeftRadius,borderBottomRightRadius=reversed?interaction.getInitialState(element.id).borderBottomRightRadius:interaction.value.borderBottomRightRadius,borderTopLeftRadius=reversed?interaction.getInitialState(element.id).borderTopLeftRadius:interaction.value.borderTopLeftRadius,borderTopRightRadius=reversed?interaction.getInitialState(element.id).borderTopRightRadius:interaction.value.borderTopRightRadius;animate(element,Properties.BORDER_BOTTOM_LEFT_RADIUS,parseInt(borderBottomLeftRadius)||0,interaction),animate(element,Properties.BORDER_BOTTOM_RIGHT_RADIUS,parseInt(borderBottomRightRadius)||0,interaction),animate(element,Properties.BORDER_TOP_LEFT_RADIUS,parseInt(borderTopLeftRadius)||0,interaction),animate(element,Properties.BORDER_TOP_RIGHT_RADIUS,parseInt(borderTopRightRadius)||0,interaction)}function borderWidth(element,interaction,reversed){var borderBottomWidth=reversed?interaction.getInitialState(element.id).borderBottomWidth:interaction.value.borderBottomWidth,borderTopWidth=reversed?interaction.getInitialState(element.id).borderTopWidth:interaction.value.borderTopWidth,borderLeftWidth=reversed?interaction.getInitialState(element.id).borderLeftWidth:interaction.value.borderLeftWidth,borderRightWidth=reversed?interaction.getInitialState(element.id).borderRightWidth:interaction.value.borderRightWidth;animate(element,Properties.BORDER_BOTTOM_WIDTH,parseInt(borderBottomWidth)||0,interaction),animate(element,Properties.BORDER_TOP_WIDTH,parseInt(borderTopWidth)||0,interaction),animate(element,Properties.BORDER_LEFT_WIDTH,parseInt(borderLeftWidth)||0,interaction),animate(element,Properties.BORDER_RIGHT_WIDTH,parseInt(borderRightWidth)||0,interaction)}function bringToBack(element,interaction,reversed){element.parent.moveChildAt(element,reversed?element.parent.children.length:0)}function bringToFront(element,interaction,reversed){element.parent.moveChildAt(element,reversed?0:element.parent.children.length)}function bringForward(element,interaction,reversed){var elementPosition=element.parent.getChildIndex(element);element.parent.moveChildAt(element,reversed?elementPosition-1:elementPosition+1)}function bringBackward(element,interaction,reversed){var elementPosition=element.parent.getChildIndex(element);element.parent.moveChildAt(element,reversed?elementPosition+1:elementPosition-1)}function changeState(element,interaction,reversed){element.animateChangeState(interaction.value,interaction.animation,reversed,interaction)}function check(element,interaction,reversed){element.getDomFocusableElement().checked=!reversed}function disable(element,interaction,reversed){element.getDomFocusableElement().disabled=!reversed}function enable(element,interaction,reversed){element.getDomFocusableElement().disabled=!!reversed}function focus(element,interaction,reversed){reversed?element.getDomFocusableElement().blur():element.getDomFocusableElement().focus()}function hide(element,interaction,reversed){var opacity=reversed?getPropertyEndValue(element,"finalOpacity")||element.opacity:0,finalOpacity=reversed?interaction.getInitialState(element.id).finalOpacity:getPropertyEndValue(element,"finalOpacity")||element.opacity;element.setPropertyEndValue("finalOpacity",finalOpacity),interaction.setInitialState(element,"finalOpacity"),reversed&&(element.stateIa="visible",element.opacity=0),animate(element,Properties.OPACITY,opacity,interaction).then(function(finalOpacity){reversed||(element.stateIa="hidden",element.opacity=finalOpacity)}.bind(null,finalOpacity))}function linkBack(element,interaction){element.Page.emit(Events.NAVIGATE,interaction.action)}function linkPage(element,interaction){element.Page.emit(Events.NAVIGATE,interaction.action,interaction.value)}function linkUrl(element,interaction){element.Page.emit(Events.NAVIGATE,interaction.action,interaction.value)}function move(element,interaction,reversed){var scale=element.getScale(),reverser=reversed?-1:1,x=getPropertyEndValue(element,Properties.X)+interaction.value.x*reverser*scale.x,y=getPropertyEndValue(element,Properties.Y)+interaction.value.y*reverser*scale.x;animate(element,Properties.X,x,interaction),animate(element,Properties.Y,y,interaction)}function moveTo(element,interaction,reversed){var scale=element.getScale(),x=reversed?interaction.getInitialState(element.id).x:interaction.value.x*scale.x,y=reversed?interaction.getInitialState(element.id).y:interaction.value.y*scale.y;animate(element,Properties.X,x,interaction),animate(element,Properties.Y,y,interaction)}function nextState(element,interaction,reversed){element.animateNextState(interaction.animation,reversed)}function opacity(element,interaction,reversed){var alpha=reversed?interaction.getInitialState(element.id).opacity:interaction.value;animate(element,Properties.OPACITY,alpha,interaction)}function previousState(element,interaction,reversed){element.animatePreviousState(interaction.animation,reversed)}function resize(element,interaction,reversed){var scale=element.getScale(),width=reversed?interaction.getInitialState(element.id).width:interaction.value.w*scale.x,height=reversed?interaction.getInitialState(element.id).height:interaction.value.h*scale.y;animate(element,Properties.WIDTH,width,interaction),animate(element,Properties.HEIGHT,height,interaction)}function rotate(element,interaction,reversed){var angle,reverser=reversed?-1:1;angle="to"===interaction.value.type?reversed?interaction.getInitialState(element.id).angle:getAngle(interaction.value):getPropertyEndValue(element,Properties.ANGLE)+getAngle(interaction.value)*reverser,animate(element,Properties.ANGLE,angle,interaction)}function scroll(element,interaction){element.Page.emit(Events.SCROLL_TO_Y,element.y,interaction.animation,interaction.delay)}function show(element,interaction,reversed){if("hidden"===interaction.value)return hide(element,interaction,reversed);var opacity=reversed?0:getPropertyEndValue(element,"finalOpacity")||element.opacity||100,finalOpacity=reversed?interaction.getInitialState(element.id).finalOpacity:opacity;element.setPropertyEndValue("finalOpacity",finalOpacity),interaction.setInitialState(element,"finalOpacity"),reversed||"visible"===element.stateIa||(element.stateIa="visible",element.opacity=0),animate(element,Properties.OPACITY,opacity,interaction).then(function(finalOpacity){reversed&&(element.stateIa="hidden",element.opacity=finalOpacity)}.bind(null,finalOpacity))}function style(element,interaction,reversed){var backgroundColor=getBackgroundColor(interaction.value),borderColor=getBorderColor(interaction.value),color=getColor(interaction.value,element.type);backgroundColor&&element.hasProperty(Properties.BACKGROUND_COLOR)&&(reversed&&(backgroundColor=interaction.getInitialState(element.id).backgroundColor),animate(element,Properties.BACKGROUND_COLOR,backgroundColor,interaction)),borderColor&&element.hasProperty(Properties.BORDER_COLOR)&&(reversed&&(borderColor=interaction.getInitialState(element.id).borderColor),animate(element,Properties.BORDER_COLOR,borderColor,interaction)),color&&element.hasProperty(Properties.COLOR)&&(reversed&&(color=interaction.getInitialState(element.id).color),animate(element,Properties.COLOR,color,interaction))}function toggle(element,interaction){"visible"===element.stateIa?hide(element,interaction):show(element,interaction)}function uncheck(element,interaction,reversed){element.getDomFocusableElement().checked=!!reversed}function animate(element,property,valueEnd,interaction){var valueStart=element[property];return isEqual(property,valueStart,valueEnd)||_.isUndefined(valueEnd)||_.isNull(valueEnd)?(cancelAnimatorsOf(element,property),Promise.resolve()):(isColorProperty(property)&&Color.isTransparent(valueStart)&&(valueStart=Color.makeColorTransparent(valueEnd)),setInteractionInitialState(element,interaction,property),element.setPropertyEndValue(property,valueEnd),cancelAnimatorsOf(element,property),startAnimator(element,createAnimator(element,property,valueStart,valueEnd,interaction)).then(function(animator){removeAnimator(element,animator),element.deletePropertyEndValue(property)}))}function createAnimator(element,property,valueStart,valueEnd,interaction){return isColorProperty(property)?new AnimatorColor(element,property,valueStart,valueEnd,interaction):new Animator(element,property,valueStart,valueEnd,interaction)}function cancelAnimatorsOf(element,property){animators[getUniqueElementId(element)]&&(animators[getUniqueElementId(element)]=_.filter(animators[getUniqueElementId(element)],function(animator){return animator.property!==property||(animator.cancel(),!1)}))}function removeAnimator(element,animator){animators[getUniqueElementId(element)]=_.without(animators[getUniqueElementId(element)],animator)}function startAnimator(element,animator){return animators[getUniqueElementId(element)]||(animators[getUniqueElementId(element)]=[]),animators[getUniqueElementId(element)].push(animator),animator.play()}function applyInteraction(element,interaction,reversed){var fn=FUNCTIONS[toCamelCase(interaction.action)];("style"!==interaction.action||reversed&&!interaction.getInitialState(element.id))&&"style"===interaction.action||fn.apply(null,arguments)}function ApplyInteractionEffect(element,interaction,reversed){var fn=FUNCTIONS[toCamelCase(interaction.action)];"function"==typeof fn&&0!==interaction.step&&(interaction.delay>0?setTimeout(applyInteraction.bind(null,element,interaction,reversed),interaction.delay):applyInteraction.apply(null,arguments))}var animators={},FUNCTIONS={borderRadius:borderRadius,borderWidth:borderWidth,bringToBack:bringToBack,bringToFront:bringToFront,bringForward:bringForward,bringBackward:bringBackward,changeState:changeState,check:check,disable:disable,enable:enable,focus:focus,hide:hide,linkBack:linkBack,linkPage:linkPage,linkUrl:linkUrl,move:move,moveTo:moveTo,nextState:nextState,opacity:opacity,previousState:previousState,resize:resize,rotate:rotate,scroll:scroll,show:show,style:style,toggle:toggle,uncheck:uncheck},InteractionsHelper={ApplyInteractionEffect:ApplyInteractionEffect};return Object.freeze(InteractionsHelper)}()},{"../enums/ElementTypes.js":346,"../enums/Events.js":347,"../enums/InteractionTriggers.js":351,"../enums/Properties.js":358,"../utils/Color.js":409,"./Animator.js":376,"./AnimatorColor.js":377,lodash:161}],380:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Interaction=_dereq_("./Interaction.js"),InteractionsHelper=_dereq_("./InteractionsHelper.js"),InteractionActions=_dereq_("../enums/InteractionActions.js"),InteractionTriggers=_dereq_("../enums/InteractionTriggers.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),ElementsHelper=_dereq_("../elements/helpers/ElementsHelper.js"),Tree=_dereq_("../utils/Tree.js");module.exports=function(){function getAllActionsExceptLegacyWindow(type,actions){return _.filter(actions,function(action){return type===ElementTypes.CANVAS||[InteractionTriggers.WINDOW_KEYDOWN,InteractionTriggers.WINDOW_LOAD,InteractionTriggers.WINDOW_SCROLL].indexOf(action.event)===-1})}function getLegacyWindowActions(element){return _.filter(element.actions,function(action){return element.type!==ElementTypes.CANVAS&&[InteractionTriggers.WINDOW_KEYDOWN,InteractionTriggers.WINDOW_LOAD,InteractionTriggers.WINDOW_SCROLL].indexOf(action.event)>-1})}function getComponents(elements){return _.filter(elements,function(element){return element.isComponent()})}function getElementsWithoutCanvas(elements){return _.omit(elements,ElementsHelper.CANVAS_ID)}function getElementsInteractions(elements){return _.reduce(elements,function(interactions,element){return interactions[element.id]=_.groupBy(_.map(getAllActionsExceptLegacyWindow(element.type,element.actions),function(action){return new Interaction(action)}),"trigger"),interactions},{})}function getComponentElementsInteractions(elements){return _.reduce(elements,function(interactions,element,elementId){return interactions[elementId]=_.groupBy(_.map(getAllActionsExceptLegacyWindow(element.type,element.props.actions),function(action){return new Interaction(action)}),"trigger"),interactions},{})}function getLegacyCanvasInteractions(elements){return _.groupBy(_.reduce(elements,function(interactions,element){return interactions.concat(_.map(getLegacyWindowActions(element),function(action){return new Interaction(_.extend(action,{elements:[element.id]}))}))},[]),"trigger")}function getComponentsInteractions(ElementsManager,elements){return _.reduce(getComponents(elements),function(interactions,component){var componentDefinition=ElementsManager.getComponentById(component.idComponent);return componentDefinition&&(interactions[component.id]=getComponentElementsInteractions(componentDefinition)),interactions},{})}function isKey(elementId,trigger){return elementId===ElementsHelper.CANVAS_ID&&trigger===InteractionTriggers.WINDOW_KEYDOWN}function isScroll(elementId,trigger){return elementId===ElementsHelper.CANVAS_ID&&trigger===InteractionTriggers.WINDOW_SCROLL}function isChange(trigger){return trigger===InteractionTriggers.CHANGE}function isContextMenu(trigger){return trigger===InteractionTriggers.CONTEXTMENU}function isMouseLeaveOnRemovedNode(trigger,e){return trigger===InteractionTriggers.MOUSELEAVE&&e&&e.target&&!document.body.contains(e.target)}function isReversed(trigger,e){return e&&trigger===InteractionTriggers.HOVER&&e.type===InteractionTriggers.MOUSELEAVE}function preventMultipleTriggers(elementId,trigger){var key=elementId+":"+trigger;return!!triggerInProgress[key]||(triggerInProgress[key]=!0,window.requestAnimationFrame(function(){triggerInProgress[key]=!1}),!1)}function addLegacyCanvasInteractions(triggers,componentsTriggers,ElementsManager,elements){function processElements(triggers,elements){_.forEach(getLegacyCanvasInteractions(elements),function(interactions,trigger){triggers[trigger]||(triggers[trigger]=[]),triggers[trigger]=triggers[trigger].concat(interactions)})}function prepareComponentDefinitionData(elements){return _.map(elements,function(element,id){return{id:id,type:element.type,actions:element.props.actions}})}processElements(triggers,elements),_.forEach(getComponents(elements),function(component){var componentDefinition=ElementsManager.getComponentById(component.idComponent);componentDefinition&&processElements(componentsTriggers[component.id][ElementsHelper.CANVAS_ID],prepareComponentDefinitionData(componentDefinition))})}function isSelfTrigger(interaction){return[InteractionActions.LINK_BACK,InteractionActions.LINK_PAGE,InteractionActions.LINK_URL].indexOf(interaction.action)>-1}function InteractionsManager(ElementsManager){this.ElementsManager=ElementsManager,this.interactionsElements={},this.interactionsComponents={},this.scrollValues=[],this.scrolledValues=[],this.scrollPosition=0}var triggerInProgress={};return InteractionsManager.prototype.loadInteractions=function(elements){this.interactionsElements=getElementsInteractions(elements),this.interactionsComponents=getComponentsInteractions(this.ElementsManager,elements),addLegacyCanvasInteractions(this.interactionsElements[ElementsHelper.CANVAS_ID],this.interactionsComponents,this.ElementsManager,elements),this.scrollValues=this.getScrollValues(),window.requestAnimationFrame(function(){window.requestAnimationFrame(this.addTriggers.bind(this))}.bind(this))},InteractionsManager.prototype.getScrollValues=function(){var elementsInteractions=this.interactionsElements[ElementsHelper.CANVAS_ID][InteractionTriggers.WINDOW_SCROLL],componentInteractions=_.reduce(this.interactionsComponents,function(interactions,interactionsComponent){return interactionsComponent[ElementsHelper.CANVAS_ID]?interactions.concat(interactionsComponent[ElementsHelper.CANVAS_ID][InteractionTriggers.WINDOW_SCROLL]):interactions},[]);return _.sortBy(_.uniq(_.map(_.reject(componentInteractions.concat(elementsInteractions),_.isUndefined),function(interaction){return interaction.triggerValue})))},InteractionsManager.prototype.addTriggers=function(){_.forEach(this.interactionsElements,function(elementInteractions,elementId){_.forEach(_.sortBy(_.keys(elementInteractions)),function(trigger){this.ElementsManager.getElementById(elementId).addTrigger(trigger)}.bind(this))}.bind(this)),_.forEach(this.interactionsComponents,function(elements,componentId){_.forEach(getElementsWithoutCanvas(elements),function(elementInteractions,elementId){_.forEach(_.sortBy(_.keys(elementInteractions)),function(trigger){this.ElementsManager.getElementById(elementId,componentId).addTrigger(trigger,componentId)}.bind(this))}.bind(this))}.bind(this))},InteractionsManager.prototype.getInteractionsForTriggerValue=function(elementId,componentInstanceId,trigger,value){return componentInstanceId?_.reduce(this.interactionsComponents,function(interactions,elements){return elements[elementId]&&elements[elementId][trigger]?interactions.concat(_.filter(elements[elementId][trigger],function(interaction){return interaction.triggerValue===value})):interactions},[]):_.filter(this.interactionsElements[elementId][trigger],function(interaction){return interaction.triggerValue===value})},InteractionsManager.prototype.getValuesToScroll=function(direction,e){return this.scrollPosition=e.target.scrollTop,_.filter(this.scrollValues,function(value){return direction>0&&this.scrollPosition>=value&&this.scrolledValues.indexOf(value)===-1?(this.scrolledValues.push(value),!0):direction<0&&this.scrollPosition<value&&this.scrolledValues.indexOf(value)!==-1&&(this.scrolledValues=_.without(this.scrolledValues,value),!0)}.bind(this))},InteractionsManager.prototype.getElementInteractionsByTrigger=function(elementId,componentInstanceId,trigger){return componentInstanceId?this.interactionsComponents[componentInstanceId][elementId][trigger]:this.interactionsElements[elementId][trigger]},InteractionsManager.prototype.hasOnPageLoadInteractions=function(){return!!this.interactionsElements[ElementsHelper.CANVAS_ID][InteractionTriggers.WINDOW_LOAD]},InteractionsManager.prototype.interactWithElement=function(elementId,componentInstanceId,trigger,e){var page=this.ElementsManager.Page;isScroll(elementId,trigger)?this.interactWithElementOnScroll(elementId,componentInstanceId,trigger,e):isKey(elementId,trigger)?this.interactWithElementOnKey(elementId,componentInstanceId,trigger,e):isChange(trigger)?this.interactWithElementOnChange(elementId,componentInstanceId,trigger,e):page.isInteractableMode()&&this.interactWithElementGeneric(elementId,componentInstanceId,trigger,e)},InteractionsManager.prototype.interactWithElementGeneric=function(elementId,componentInstanceId,trigger,e){var reversed=isReversed(trigger,e),interactions=this.getElementInteractionsByTrigger(elementId,componentInstanceId,trigger);isContextMenu(trigger)&&e.preventDefault(),isMouseLeaveOnRemovedNode(trigger,e)||this.applyInteractionEffect(elementId,componentInstanceId,interactions,reversed,trigger)},InteractionsManager.prototype.interactWithElementOnChange=function(elementId,componentInstanceId,trigger,e){var interactions=this.getInteractionsForTriggerValue(elementId,componentInstanceId,trigger,e.target.value);this.applyInteractionEffect(elementId,componentInstanceId,interactions,!1,trigger)},InteractionsManager.prototype.interactWithElementOnKey=function(elementId,componentInstanceId,trigger,e){var interactions=this.getInteractionsForTriggerValue(elementId,componentInstanceId,trigger,e.which);this.applyInteractionEffect(elementId,componentInstanceId,interactions,!1,trigger)},InteractionsManager.prototype.interactWithElementOnScroll=function(elementId,componentInstanceId,trigger,e){var direction=e.target.scrollTop>this.scrollPosition?1:-1,reversed=direction<0;_.forEach(this.getValuesToScroll(direction,e),function(value){var interactions=this.getInteractionsForTriggerValue(elementId,componentInstanceId,trigger,value);this.applyInteractionEffect(elementId,componentInstanceId,interactions,reversed,trigger),_.forEach(this.interactionsComponents,function(interactionsComponent,componentInstanceId){var interactions=this.getInteractionsForTriggerValue(elementId,componentInstanceId,trigger,value);
this.applyInteractionEffect(elementId,componentInstanceId,interactions,reversed,trigger)}.bind(this))}.bind(this))},InteractionsManager.prototype.applyInteractionEffect=function(elementId,componentInstanceId,interactions,reversed,trigger){if(!preventMultipleTriggers(elementId,trigger)){var interactionsOrder=this.sortInteractionsByElementsHierarchy(interactions);_.forEach(interactionsOrder,function(interactionId){_.forEach(isSelfTrigger(interactions[interactionId])?[elementId]:interactions[interactionId].elements,function(targetElementId){var element=this.ElementsManager.getElementById(targetElementId,componentInstanceId);InteractionsHelper.ApplyInteractionEffect(element,interactions[interactionId],reversed)}.bind(this))}.bind(this))}},InteractionsManager.prototype.sortInteractionsByElementsHierarchy=function(interactions){var interactionsOrder=_.keys(interactions);return interactionsOrder.sort(function(a,b){var firstInteractionElement=this.ElementsManager.getElementById(interactions[a].elements[0]),secondInteractionElement=this.ElementsManager.getElementById(interactions[b].elements[0]);return!firstInteractionElement||Tree.IsAncestorOf(firstInteractionElement,secondInteractionElement)?1:!secondInteractionElement||Tree.IsAncestorOf(secondInteractionElement,firstInteractionElement)?-1:0}.bind(this)),interactionsOrder},InteractionsManager.prototype.destroy=function(){this.interactionsElements=null,this.interactionsComponents=null,this.scrollValues=null,this.scrolledValues=null},InteractionsManager}()},{"../elements/helpers/ElementsHelper.js":250,"../enums/ElementTypes.js":346,"../enums/InteractionActions.js":350,"../enums/InteractionTriggers.js":351,"../utils/Tree.js":419,"./Interaction.js":378,"./InteractionsHelper.js":379,lodash:161}],381:[function(_dereq_,module,exports){"use strict";!function(a){var b=a.HTMLCanvasElement&&a.HTMLCanvasElement.prototype,c=a.Blob&&function(){try{return Boolean(new Blob)}catch(a){return!1}}(),d=c&&a.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(a){return!1}}(),e=a.BlobBuilder||a.WebKitBlobBuilder||a.MozBlobBuilder||a.MSBlobBuilder,f=(c||e)&&a.atob&&a.ArrayBuffer&&a.Uint8Array&&function(a){var b,f,g,h,i,j;for(b=a.split(",")[0].indexOf("base64")>=0?atob(a.split(",")[1]):decodeURIComponent(a.split(",")[1]),f=new ArrayBuffer(b.length),g=new Uint8Array(f),h=0;h<b.length;h+=1)g[h]=b.charCodeAt(h);return i=a.split(",")[0].split(":")[1].split(";")[0],c?new Blob([d?g:f],{type:i}):(j=new e,j.append(f),j.getBlob(i))};a.HTMLCanvasElement&&!b.toBlob&&(b.mozGetAsFile?b.toBlob=function(a,c,d){a(d&&b.toDataURL&&f?f(this.toDataURL(c,d)):this.mozGetAsFile("blob",c))}:b.toDataURL&&f&&(b.toBlob=function(a,b,c){a(f(this.toDataURL(b,c)))})),"function"==typeof define&&define.amd?define(function(){return f}):a.dataURLtoBlob=f}(window)},{}],382:[function(_dereq_,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_lodash=_dereq_("lodash"),_Events=_dereq_("../enums/Events"),_Events2=_interopRequireDefault(_Events),AbstractMode=function(){function AbstractMode(Page,overlay,shortcuts){if(_classCallCheck(this,AbstractMode),this.Page=Page,!overlay)throw new Error("missing overlay");this.shortcuts=null,this.overlay=overlay,shortcuts&&(this.shortcuts=[].concat(shortcuts),(0,_lodash.forEach)(this.shortcuts,function(shortcut){shortcut.overlay=overlay}))}return _createClass(AbstractMode,[{key:"addListeners",value:function(){var overlayOnly=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.overlay.addEvents(),overlayOnly||(0,_lodash.forEach)(this.shortcuts,function(shortcut){shortcut.addEvents()})}},{key:"removeListeners",value:function(){var overlayOnly=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.overlay.removeEvents(),overlayOnly||(0,_lodash.forEach)(this.shortcuts,function(shortcut){shortcut.removeEvents()})}},{key:"afterCreate",value:function(){}},{key:"beforeSwitch",value:function(from){}},{key:"updateOverlay",value:function(elementsChanged){this.overlay.update(elementsChanged)}},{key:"onDestroy",value:function(){this.overlay&&(this.overlay.clear(),this.overlay.destroy(),this.overlay=null),(0,_lodash.forEach)(this.shortcuts,function(shortcut){shortcut.destroy()}),this.shortcuts=null}},{key:"handleCanvas",value:function(canvas){this.overlay.appendToCanvas(canvas),canvas.overlay=this.overlay}},{key:"getPickerConfig",value:function(){var _this=this;return{ignoreMultistateChildren:!1,returnNullOnCanvas:!1,singlePick:!0,pickerResolver:function(elementId){return elementId},handlePickedElement:function(elementId,pickedElement,resolve){pickedElement&&pickedElement!==_this.Page.getSelectedElement()?(_this.Page.canvas.select(pickedElement),_this.Page.emit(_Events2.default.ELEMENT_PICKED,{element:pickedElement}),resolve(elementId)):(_this.Page.deselectSpecElements(),resolve(null))},onEndPickMode:function(){_this.Page.canvas.endPickMode()}}}},{key:"name",get:function(){throw new Error("Missing mode name")}}]),AbstractMode}();exports.default=AbstractMode},{"../enums/Events":347,lodash:161}],383:[function(_dereq_,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_AbstractMode2=(_dereq_("lodash"),_dereq_("./AbstractMode")),_AbstractMode3=_interopRequireDefault(_AbstractMode2),_DesignOverlay=_dereq_("./overlay/DesignOverlay"),_DesignOverlay2=_interopRequireDefault(_DesignOverlay),_DesignShortcuts=_dereq_("./shortcuts/DesignShortcuts"),_DesignShortcuts2=_interopRequireDefault(_DesignShortcuts),_ZoomShortcuts=_dereq_("./shortcuts/ZoomShortcuts"),_ZoomShortcuts2=_interopRequireDefault(_ZoomShortcuts),PageModes=_dereq_("../enums/PageModes"),DesignMode=function(_AbstractMode){function DesignMode(Page){return _classCallCheck(this,DesignMode),_possibleConstructorReturn(this,(DesignMode.__proto__||Object.getPrototypeOf(DesignMode)).call(this,Page,new _DesignOverlay2.default(Page),[new _DesignShortcuts2.default(Page),new _ZoomShortcuts2.default(Page)]))}return _inherits(DesignMode,_AbstractMode),_createClass(DesignMode,[{key:"afterCreate",value:function(){this.Page.showOverlay(),this.Page.canvas.editingGroup&&this.overlay.showGroupHighlight(this.Page.canvas.editingGroup)}},{key:"beforeSwitch",value:function(){this.Page.endPickMode(),this.Page.canvas.deselectWithoutEditingGroup(),this.overlay.isTextEditActive()&&this.overlay.endTextEdit()}},{key:"name",get:function(){return PageModes.DESIGN}}]),DesignMode}(_AbstractMode3.default);exports.default=DesignMode},{"../enums/PageModes":357,"./AbstractMode":382,"./overlay/DesignOverlay":391,"./shortcuts/DesignShortcuts":398,"./shortcuts/ZoomShortcuts":402,lodash:161}],384:[function(_dereq_,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_AbstractMode2=_dereq_("./AbstractMode"),_AbstractMode3=_interopRequireDefault(_AbstractMode2),_DocumentationOverlay=_dereq_("./overlay/DocumentationOverlay"),_DocumentationOverlay2=_interopRequireDefault(_DocumentationOverlay),_Events=_dereq_("../enums/Events"),_Events2=_interopRequireDefault(_Events),_lodash=_dereq_("lodash"),_ZoomShortcuts=_dereq_("./shortcuts/ZoomShortcuts"),_ZoomShortcuts2=_interopRequireDefault(_ZoomShortcuts),_DocumentationShortcuts=_dereq_("./shortcuts/DocumentationShortcuts"),_DocumentationShortcuts2=_interopRequireDefault(_DocumentationShortcuts),PageModes=_dereq_("../enums/PageModes"),DocumentationMode=function(_AbstractMode){function DocumentationMode(Page){_classCallCheck(this,DocumentationMode);var _this=_possibleConstructorReturn(this,(DocumentationMode.__proto__||Object.getPrototypeOf(DocumentationMode)).call(this,Page,new _DocumentationOverlay2.default(Page),[new _DocumentationShortcuts2.default(Page),new _ZoomShortcuts2.default(Page)]));return _this.highlightedElements=[],_this.highlightDocumentedElements(),_this}return _inherits(DocumentationMode,_AbstractMode),_createClass(DocumentationMode,[{key:"afterCreate",value:function(){this.Page.deselectAllElements()}},{key:"beforeSwitch",value:function(){this.Page.endPickMode(),this.hideDocumentedElementsHighlight()}},{key:"updateOverlay",value:function(elementsChanged){this.hideDocumentedElementsHighlight(),this.highlightDocumentedElements(),this.overlay.update(elementsChanged)}},{key:"getAnnotationsElements",value:function(){var _this2=this,pinnedAnnotations=(0,_lodash.filter)(this.Page.canvas.annotations,function(annotation){return!(0,_lodash.isEmpty)(annotation.idElement)});return(0,_lodash.map)(pinnedAnnotations,function(annotation){return(0,_lodash.assign)({},annotation,{element:_this2.Page.getElementById(annotation.idElement)})})}},{key:"highlightDocumentedElements",value:function(){var _this3=this,annotations=this.getAnnotationsElements();this.highlightedElements=(0,_lodash.map)(annotations,"element"),(0,_lodash.each)(annotations,function(annotation){return _this3.highlightDocumentedElement(annotation.element,annotation.idPin)})}},{key:"highlightDocumentedElement",value:function(element,number){var isSelected=!1;this.pickedElement===element&&(isSelected=!0,this.pickedElement=null),element.setAnnotation(number,isSelected),this.Page.canvas.addAnnotationHighlight(element.highlight)}},{key:"hideDocumentedElementsHighlight",value:function(){(0,_lodash.each)(this.highlightedElements,function(element){element.removeAnnotation()}),this.Page.canvas.clearAnnotationHighlights()}},{key:"getPickerConfig",value:function(){var _this4=this,defaultConfig=_AbstractMode3.default.prototype.getPickerConfig.call(this),customConfig={returnNullOnCanvas:!0,pickerResolver:function(elementId,componentInstanceId){return{elementId:elementId,componentInstanceId:componentInstanceId}},endCallback:function(){_this4.overlay.hideHighlight()},handlePickedElement:function(elementId,pickedElement,resolve){return(0,_lodash.find)(_this4.Page.canvas.annotations,function(documentedElement){return documentedElement.idElement===elementId})?resolve(elementId):(_this4.Page.canvas.select(pickedElement),_this4.Page.emit(_Events2.default.ELEMENT_PICKED,{element:pickedElement}),_this4.pickedElement=pickedElement,resolve(elementId))},onEndPickMode:function(){return _this4.Page.canvas.deselect(),_this4.Page.canvas.endPickMode()}};return(0,_lodash.assign)({},defaultConfig,customConfig)}},{key:"name",get:function(){return PageModes.DOCUMENTATION}}]),DocumentationMode}(_AbstractMode3.default);exports.default=DocumentationMode},{"../enums/Events":347,"../enums/PageModes":357,"./AbstractMode":382,"./overlay/DocumentationOverlay":392,"./shortcuts/DocumentationShortcuts":399,"./shortcuts/ZoomShortcuts":402,lodash:161}],385:[function(_dereq_,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_AbstractMode2=_dereq_("./AbstractMode"),_AbstractMode3=_interopRequireDefault(_AbstractMode2),_DrawOverlay=_dereq_("./overlay/DrawOverlay"),_DrawOverlay2=_interopRequireDefault(_DrawOverlay),_DrawShortcuts=_dereq_("./shortcuts/DrawShortcuts"),_DrawShortcuts2=_interopRequireDefault(_DrawShortcuts),PageModes=_dereq_("../enums/PageModes"),DrawMode=function(_AbstractMode){function DrawMode(Page){return _classCallCheck(this,DrawMode),_possibleConstructorReturn(this,(DrawMode.__proto__||Object.getPrototypeOf(DrawMode)).call(this,Page,new _DrawOverlay2.default(Page),new _DrawShortcuts2.default(Page)))}return _inherits(DrawMode,_AbstractMode),_createClass(DrawMode,[{key:"setDrawElementDefinition",value:function(definition,config){this.overlay.config=config,this.overlay.elementDefinition=definition}},{key:"afterCreate",value:function(){this.Page.canvas.editingGroup&&this.overlay.showGroupHighlight(this.Page.canvas.editingGroup)}},{key:"name",get:function(){return PageModes.DRAW}}]),DrawMode}(_AbstractMode3.default);exports.default=DrawMode},{"../enums/PageModes":357,"./AbstractMode":382,"./overlay/DrawOverlay":393,"./shortcuts/DrawShortcuts":400}],386:[function(_dereq_,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_PreviewMode2=_dereq_("./PreviewMode"),_PreviewMode3=_interopRequireDefault(_PreviewMode2),PageModes=_dereq_("../enums/PageModes"),ExportMode=function(_PreviewMode){function ExportMode(){return _classCallCheck(this,ExportMode),_possibleConstructorReturn(this,(ExportMode.__proto__||Object.getPrototypeOf(ExportMode)).apply(this,arguments))}return _inherits(ExportMode,_PreviewMode),_createClass(ExportMode,[{key:"name",get:function(){return PageModes.EXPORT}}]),ExportMode}(_PreviewMode3.default);exports.default=ExportMode},{"../enums/PageModes":357,"./PreviewMode":387}],387:[function(_dereq_,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_AbstractMode2=_dereq_("./AbstractMode"),_AbstractMode3=_interopRequireDefault(_AbstractMode2),_NoopOverlay=_dereq_("./overlay/NoopOverlay"),_NoopOverlay2=_interopRequireDefault(_NoopOverlay),_ZoomShortcuts=_dereq_("./shortcuts/ZoomShortcuts"),_ZoomShortcuts2=_interopRequireDefault(_ZoomShortcuts),PageModes=_dereq_("../enums/PageModes"),PreviewMode=function(_AbstractMode){function PreviewMode(Page){return _classCallCheck(this,PreviewMode),_possibleConstructorReturn(this,(PreviewMode.__proto__||Object.getPrototypeOf(PreviewMode)).call(this,Page,new _NoopOverlay2.default(Page),new _ZoomShortcuts2.default(Page)))}return _inherits(PreviewMode,_AbstractMode),_createClass(PreviewMode,[{key:"afterCreate",value:function(){this.Page.hideOverlay(),this.Page.deselectAllElements(),this.Page._updateOffset(this.Page.ElementsManager.getElements())}},{key:"name",get:function(){return PageModes.PREVIEW}}]),PreviewMode}(_AbstractMode3.default);exports.default=PreviewMode},{"../enums/PageModes":357,"./AbstractMode":382,"./overlay/NoopOverlay":394,"./shortcuts/ZoomShortcuts":402}],388:[function(_dereq_,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_lodash=_dereq_("lodash"),_AbstractMode2=_dereq_("./AbstractMode"),_AbstractMode3=_interopRequireDefault(_AbstractMode2),_SpecModeOverlay=_dereq_("./overlay/SpecModeOverlay"),_SpecModeOverlay2=_interopRequireDefault(_SpecModeOverlay),_SpecModeShortcuts=_dereq_("./shortcuts/SpecModeShortcuts"),_SpecModeShortcuts2=_interopRequireDefault(_SpecModeShortcuts),_ZoomShortcuts=_dereq_("./shortcuts/ZoomShortcuts"),_ZoomShortcuts2=_interopRequireDefault(_ZoomShortcuts),PageModes=_dereq_("../enums/PageModes"),SpecMode=function(_AbstractMode){function SpecMode(Page){return _classCallCheck(this,SpecMode),_possibleConstructorReturn(this,(SpecMode.__proto__||Object.getPrototypeOf(SpecMode)).call(this,Page,new _SpecModeOverlay2.default(Page),[new _SpecModeShortcuts2.default(Page),new _ZoomShortcuts2.default(Page)]))}return _inherits(SpecMode,_AbstractMode),_createClass(SpecMode,[{key:"removeListeners",value:function(){var overlayOnly=arguments.length>0&&void 0!==arguments[0]&&arguments[0];overlayOnly||(0,_lodash.forEach)(this.shortcuts,function(shortcut){shortcut.removeEvents()})}},{key:"afterCreate",value:function(){this.Page.showOverlay(),this.Page.clearSpecMode(),this.Page.canvas.deselect()}},{key:"beforeSwitch",value:function(){this.Page.endPickMode()}},{key:"getPickerConfig",value:function(){var defaultConfig=_AbstractMode3.default.prototype.getPickerConfig.call(this),customConfig={returnNullOnCanvas:!0,singlePick:!1,pickerResolver:function(elementId,componentInstanceId){return{elementId:elementId,componentInstanceId:componentInstanceId}}};return(0,_lodash.assign)({},defaultConfig,customConfig)}},{key:"name",get:function(){return PageModes.SPEC}}]),SpecMode}(_AbstractMode3.default);exports.default=SpecMode},{"../enums/PageModes":357,"./AbstractMode":382,"./overlay/SpecModeOverlay":396,"./shortcuts/SpecModeShortcuts":401,"./shortcuts/ZoomShortcuts":402,lodash:161}],389:[function(_dereq_,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function factory(mode,Page){switch(mode){case _PageModes.DESIGN:return new _DesignMode2.default(Page);case _PageModes.DOCUMENTATION:return new _DocumentationMode2.default(Page);case _PageModes.DRAW:return new _DrawMode2.default(Page);case _PageModes.EXPORT:return new _ExportMode2.default(Page);case _PageModes.PREVIEW:return new _PreviewMode2.default(Page);case _PageModes.SPEC:return new _SpecMode2.default(Page)}throw new Error('Unknown mode "'+mode+'"')}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=factory;var _PageModes=_dereq_("../enums/PageModes"),_DesignMode=_dereq_("./DesignMode"),_DesignMode2=_interopRequireDefault(_DesignMode),_DocumentationMode=_dereq_("./DocumentationMode"),_DocumentationMode2=_interopRequireDefault(_DocumentationMode),_DrawMode=_dereq_("./DrawMode"),_DrawMode2=_interopRequireDefault(_DrawMode),_ExportMode=_dereq_("./ExportMode"),_ExportMode2=_interopRequireDefault(_ExportMode),_PreviewMode=_dereq_("./PreviewMode"),_PreviewMode2=_interopRequireDefault(_PreviewMode),_SpecMode=_dereq_("./SpecMode"),_SpecMode2=_interopRequireDefault(_SpecMode)},{"../enums/PageModes":357,"./DesignMode":383,"./DocumentationMode":384,"./DrawMode":385,"./ExportMode":386,"./PreviewMode":387,"./SpecMode":388}],390:[function(_dereq_,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _applyDecoratedDescriptor(target,property,decorators,descriptor,context){var desc={};return Object.keys(descriptor).forEach(function(key){desc[key]=descriptor[key]}),desc.enumerable=!!desc.enumerable,desc.configurable=!!desc.configurable,("value"in desc||desc.initializer)&&(desc.writable=!0),desc=decorators.slice().reverse().reduce(function(desc,decorator){return decorator(target,property,desc)||desc},desc),context&&void 0!==desc.initializer&&(desc.value=desc.initializer?desc.initializer.call(context):void 0,desc.initializer=void 0),void 0===desc.initializer&&(Object.defineProperty(target,property,desc),desc=null),desc}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _class,_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_lodash=_dereq_("lodash"),_autobindDecorator=_dereq_("autobind-decorator"),_autobindDecorator2=_interopRequireDefault(_autobindDecorator),_OverlayView=_dereq_("./OverlayView"),_OverlayView2=_interopRequireDefault(_OverlayView),AbstractOverlay=(_class=function(){function AbstractOverlay(Page){var _this=this,views=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,AbstractOverlay),this.Page=Page,this.views=views,this.view=new _OverlayView2.default,this.scale=1,this._eventsAdded=!1,this.zoomInThrottled=(0,_lodash.throttle)(function(params){return _this.Page.zoomIn(params)},16,{trailing:!1}),this.zoomOutThrottled=(0,_lodash.throttle)(function(params){return _this.Page.zoomOut(params)},16,{trailing:!1})}return _createClass(AbstractOverlay,[{key:"destroy",value:function(){this.removeEvents(),(0,_lodash.forEach)(this.views,function(view){view.destroyDomElement()}),this.view.destroyDomElement()}},{key:"addEvents",value:function(){this.view.containerDomElement.addEventListener("wheel",this._handleWheel)}},{key:"removeEvents",value:function(){this.view.containerDomElement.removeEventListener("wheel",this._handleWheel)}},{key:"appendToCanvas",value:function(canvas){var _canvas$view=canvas.view,containerDomElement=_canvas$view.containerDomElement,overlayDomElement=_canvas$view.overlayDomElement,canvasRulersElement=_canvas$view.canvasRulersElement,workbenchDomElement=_canvas$view.workbenchDomElement;this.canvas=canvas,this.view.setDOMElements(overlayDomElement,containerDomElement,canvasRulersElement,workbenchDomElement);var views=this.views;if((0,_lodash.isFunction)(this.__getViewsOrder)){var order=this.__getViewsOrder();views=(0,_lodash.sortBy)(this.views,function(view,key){return order.indexOf(key)})}this.view.appendChildren((0,_lodash.map)(views,function(node){return node.view.domElement})),this.setScale(this.canvas.scale),this.addEvents(),this.clear()}},{key:"setScale",value:function(scale){this.scale=scale,(0,_lodash.forEach)(this.views,function(handler){(0,_lodash.isFunction)(handler.setScale)&&handler.setScale(scale)})}},{key:"clear",value:function(){(0,_lodash.forEach)(this.views,function(view){return(0,_lodash.isFunction)(view.hide)&&view.hide(!0)})}},{key:"getSelectedElement",value:function(){return null}},{key:"update",value:function(elementsChanged){}},{key:"highlightElement",value:function(element,interactive){}},{key:"removeHighlight",value:function(){}},{key:"selectElement",value:function(element){}},{key:"highlightElements",value:function(elements){}},{key:"hideHighlight",value:function(){}},{key:"showGroupHighlight",value:function(editingGroup){}},{key:"hideGroupHighlight",value:function(){}},{key:"hideMultipartHighlight",value:function(){}},{key:"updateHighlightSelect",value:function(){}},{key:"editSelectedElement",value:function(){}},{key:"_handleWheel",value:function(e){var params=void 0,ratio=void 0;(e.metaKey||e.ctrlKey)&&(e.preventDefault(),ratio=(e.deltaY<0?1:-1)*(e.altKey?10:1),params={delta:Math.ceil(Math.sqrt(Math.abs(e.deltaY)))*ratio,x:e.layerX/this.scale,y:e.layerY/this.scale},e.deltaY>0?this.zoomInThrottled(params):e.deltaY<0&&this.zoomOutThrottled(params))}},{key:"_getRelativeMousePosition",value:function(e){var _canvas$domElementRec=this.canvas.domElementRect,left=_canvas$domElementRec.left,top=_canvas$domElementRec.top,pageX=e.pageX,pageY=e.pageY;return{x:pageX-left,y:pageY-top}}},{key:"_getRelativeScaledMousePosition",value:function(e){var mousePosition=this._getRelativeMousePosition(e);return{x:mousePosition.x/this.canvas.scale,y:mousePosition.y/this.canvas.scale}}}]),AbstractOverlay}(),_applyDecoratedDescriptor(_class.prototype,"_handleWheel",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"_handleWheel"),_class.prototype),_class);exports.default=AbstractOverlay},{"./OverlayView":395,"autobind-decorator":15,lodash:161}],391:[function(_dereq_,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call;
}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function _applyDecoratedDescriptor(target,property,decorators,descriptor,context){var desc={};return Object.keys(descriptor).forEach(function(key){desc[key]=descriptor[key]}),desc.enumerable=!!desc.enumerable,desc.configurable=!!desc.configurable,("value"in desc||desc.initializer)&&(desc.writable=!0),desc=decorators.slice().reverse().reduce(function(desc,decorator){return decorator(target,property,desc)||desc},desc),context&&void 0!==desc.initializer&&(desc.value=desc.initializer?desc.initializer.call(context):void 0,desc.initializer=void 0),void 0===desc.initializer&&(Object.defineProperty(target,property,desc),desc=null),desc}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _class,_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function get(object,property,receiver){null===object&&(object=Function.prototype);var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0===desc){var parent=Object.getPrototypeOf(object);return null===parent?void 0:get(parent,property,receiver)}if("value"in desc)return desc.value;var getter=desc.get;if(void 0!==getter)return getter.call(receiver)},_lodash=_dereq_("lodash"),_autobindDecorator=_dereq_("autobind-decorator"),_autobindDecorator2=_interopRequireDefault(_autobindDecorator),_SpecModeOverlay2=_dereq_("./SpecModeOverlay"),_SpecModeOverlay3=_interopRequireDefault(_SpecModeOverlay2),_Locker=_dereq_("../../utils/Locker"),_DomHelper=_dereq_("../../utils/DomHelper"),DragAndDropHelper=_dereq_("../../elements/helpers/DragAndDropHelper"),ElementIndicator=_dereq_("../../elements/ui/ElementIndicator"),ElementName=_dereq_("../../elements/ui/ElementName"),GuidePosition=_dereq_("../../elements/ui/GuidePosition"),Highlight=_dereq_("../../elements/ui/Highlight"),HighlightCellResizer=_dereq_("../../elements/ui/HighlightCellResizer"),HighlightEdit=_dereq_("../../elements/ui/HighlightEdit"),HighlightEditClipped=_dereq_("../../elements/ui/HighlightEditClipped"),HighlightPart=_dereq_("../../elements/ui/HighlightPart"),HighlightSelect=_dereq_("../../elements/ui/HighlightSelect"),ImageEditor=_dereq_("../../elements/helpers/ImageEditor"),Mouse=_dereq_("../../elements/helpers/MouseHelper.js"),MultiSelect=_dereq_("../../elements/ui/MultiSelect"),Point=_dereq_("../../primitives/Point.js"),Smartguide=_dereq_("../../elements/ui/Smartguide"),SnappingHelper=_dereq_("../../elements/helpers/SnappingHelper"),ElementTypes=_dereq_("../../enums/ElementTypes"),Events=_dereq_("../../enums/Events"),Orientations=_dereq_("../../enums/Orientations"),Properties=_dereq_("../../enums/Properties"),Rectangle=_dereq_("../../primitives/Rectangle.js"),INDICATOR_POSITION_DELTA=25,DRAG_LOCK_TIME=60,isTransformatorPointClick=function(e){return e.target.classList.contains("ng-resizer")||e.target.classList.contains("ng-rotator")},getSelectionRectangle=function(p1,p2){var x=Math.min(p1.x,p2.x),y=Math.min(p1.y,p2.y);return new Rectangle(x,y,Math.abs(p2.x-p1.x),Math.abs(p2.y-p1.y))},clickedOutsideActivePart=function(element,target){return element.activeParts&&element.getPart(element.activeParts[0])&&!element.getPart(element.activeParts[0]).domElement.contains(target)},getImageSizePromise=function(imageData){return ImageEditor.GetImageSize(imageData.src).then(function(size){return(0,_lodash.extend)(imageData,size)})},DesignOverlay=(_class=function(_SpecModeOverlay){function DesignOverlay(){var Page=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,DesignOverlay);var _this=_possibleConstructorReturn(this,(DesignOverlay.__proto__||Object.getPrototypeOf(DesignOverlay)).call(this,Page,{elementIndicator:new ElementIndicator(null,Page),elementName:new ElementName(null,Page),guidePosition:new GuidePosition(null,Page),highlight:new Highlight(null,Page),highlightCellResizer:new HighlightCellResizer(null,Page),highlightEdit:new HighlightEdit(null,Page),highlightEditClipped:new HighlightEditClipped(null,Page),highlightPart:new HighlightPart(null,Page),highlightSelect:new HighlightSelect(null,Page),highlightSelectedPart:new HighlightPart(null,Page),multiSelect:new MultiSelect(null,Page),smartguideHorizontal:new Smartguide(null,Page,Orientations.HORIZONTAL),smartguideVertical:new Smartguide(null,Page,Orientations.VERTICAL)}));return _this.dragLocker=null,_this.lastMouseMoveEvent=null,_this.eventsRef={onGuideShow:function(data){return _this._handleSetGuideVisibility(!0,data)},onGuideHide:function(data){return _this._handleSetGuideVisibility(!1,data)},handleBlockElementHighlight:(0,_DomHelper.throttleFrame)(_this._handleBlockElementHighlight),handleHighlightElement:(0,_DomHelper.throttleFrame)(_this._handleHighlightElement)},_this}return _inherits(DesignOverlay,_SpecModeOverlay),_createClass(DesignOverlay,[{key:"__getViewsOrder",value:function(){return["highlightEdit","highlightEditClipped","highlight","elementName","highlightSelect","highlightCellResizer","elementIndicator","guidePosition","highlightPart","highlightSelectedPart","multiSelect","smartguideHorizontal","smartguideVertical"]}},{key:"addEvents",value:function(){this._eventsAdded||(this._eventsAdded=!0,this.views.highlightPart.view.domElement.addEventListener("mousedown",this._handleHighlightPartMouseDown),this.views.highlightSelect.view.domElement.addEventListener("mousemove",this.eventsRef.handleBlockElementHighlight),this.views.highlightSelect.view.domElement.addEventListener("mousedown",this._onStartDrag),this.view.canvasRulersElement.addEventListener("mousedown",this._handleRulerMouseDown),this.view.containerDomElement.addEventListener("mousemove",this.eventsRef.handleHighlightElement),this.view.containerDomElement.addEventListener("mousedown",this._handleMouseDown),this.view.containerDomElement.addEventListener("mouseleave",this._handleMouseLeave),this.view.containerDomElement.addEventListener("dblclick",this._handleDoubleClick),this.view.containerDomElement.addEventListener("dragenter",this._handleDragEnter),this.view.containerDomElement.addEventListener("dragover",this._handleDragOver),this.view.containerDomElement.addEventListener("dragleave",this._handleDragleave),this.view.containerDomElement.addEventListener("drop",this._handleDrop),_get(DesignOverlay.prototype.__proto__||Object.getPrototypeOf(DesignOverlay.prototype),"addEvents",this).call(this))}},{key:"removeEvents",value:function(){this._eventsAdded&&(this._eventsAdded=!1,this.views.highlightPart.view.domElement.removeEventListener("mousedown",this._handleHighlightPartMouseDown),this.views.highlightSelect.view.domElement.removeEventListener("mousedown",this._onStartDrag),this.views.highlightSelect.view.domElement.removeEventListener("mousemove",this.eventsRef.handleBlockElementHighlight),this.view.canvasRulersElement.removeEventListener("mousedown",this._handleRulerMouseDown),this.view.containerDomElement.removeEventListener("mousemove",this.eventsRef.handleHighlightElement),this.view.containerDomElement.removeEventListener("mousedown",this._handleMouseDown),this.view.containerDomElement.removeEventListener("mouseleave",this._handleMouseLeave),this.view.containerDomElement.removeEventListener("dblclick",this._handleDoubleClick),this.view.containerDomElement.removeEventListener("dragenter",this._handleDragEnter),this.view.containerDomElement.removeEventListener("dragover",this._handleDragOver),this.view.containerDomElement.removeEventListener("dragleave",this._handleDragleave),this.view.containerDomElement.removeEventListener("drop",this._handleDrop),_get(DesignOverlay.prototype.__proto__||Object.getPrototypeOf(DesignOverlay.prototype),"removeEvents",this).call(this))}},{key:"appendToCanvas",value:function(canvas){_get(DesignOverlay.prototype.__proto__||Object.getPrototypeOf(DesignOverlay.prototype),"appendToCanvas",this).call(this,canvas),SnappingHelper.AddListener(Events.SNAPPING_GUIDE_SHOW,this.eventsRef.onGuideShow),SnappingHelper.AddListener(Events.SNAPPING_GUIDE_HIDE,this.eventsRef.onGuideHide)}},{key:"destroy",value:function(){return SnappingHelper.RemoveListener(Events.SNAPPING_GUIDE_SHOW,this.eventsRef.onGuideShow),SnappingHelper.RemoveListener(Events.SNAPPING_GUIDE_HIDE,this.eventsRef.onGuideHide),this._removeEventsOnTableResizers(),(0,_lodash.forEach)([this.eventsRef.onMouseMove,this.eventsRef.handleBlockElementHighlight,this.eventsRef.handleHighlightElement],function(fn){return fn&&fn.cancel()}),_get(DesignOverlay.prototype.__proto__||Object.getPrototypeOf(DesignOverlay.prototype),"destroy",this).call(this)}},{key:"clear",value:function(){(0,_lodash.forEach)((0,_lodash.pick)(this.views,["highlight","highlightCellResizer","highlightEdit","highlightEditClipped","highlightPart","highlightSelect","highlightSelectedPart","multiSelect"]),function(view){return view.hide(!0)})}},{key:"hideHighlight",value:function(){return this.views.highlightCellResizer.hide(),_get(DesignOverlay.prototype.__proto__||Object.getPrototypeOf(DesignOverlay.prototype),"hideHighlight",this).call(this)}},{key:"update",value:function(elementsChanged){elementsChanged&&(this.views.highlightEdit.update(!0),this.views.highlightEditClipped.update(!0),this.views.highlight.update(!0),this.views.highlightSelect.update(!0),this.views.highlightPart.update(!0),this.views.highlightSelectedPart.update(!0),this.views.highlightCellResizer.update(!0),this.views.multiSelect.update(!0),this.getSelectedElement()&&this.views.elementIndicator.update())}},{key:"highlightElement",value:function(element,interactive){this.views.highlight.show(element,interactive)}},{key:"selectElement",value:function(element){this.views.highlightSelect.show(element)}},{key:"removeHighlight",value:function(){this.views.highlight.hide()}},{key:"highlightElements",value:function(elements){var multiple=elements.length>1;(0,_lodash.forEach)(elements,function(element){element.highlightSelect(multiple)}),1===elements.length&&elements[0].type===ElementTypes.TABLE?(this.views.highlightCellResizer.show(elements[0]),this._addEventsOnTableResizers()):this.views.highlightCellResizer.hide(),this.views.highlightSelect.showElements(elements),this.views.elementIndicator.hide(),this.views.highlightSelectedPart.hide(),this.views.highlightPart.hide()}},{key:"hideMultipartHighlight",value:function(){this.views.highlightSelectedPart.hide(),this.views.highlightPart.hide()}},{key:"showGroupHighlight",value:function(editingGroup){this.views.highlightEdit.show(editingGroup,editingGroup.isMultistate()),this.views.highlightEditClipped.show(editingGroup)}},{key:"hideGroupHighlight",value:function(){this.views.highlightEdit.hide(),this.views.highlightEditClipped.hide()}},{key:"getSelectedElement",value:function(){return this.views.highlightSelect.element}},{key:"editSelectedElement",value:function(){this._editElement(this.getSelectedElement())}},{key:"_handleHighlightPartMouseDown",value:function(){this.views.highlightSelectedPart.show()}},{key:"_onStartDrag",value:function(e){if(Mouse.rightButtonPressed(e))return this.canvas.showContextMenu(e),this.canvas.editingMultipart||e.stopImmediatePropagation(),!1;if(this.canvas.editingMultipart)return!1;var transformatorPointClick=isTransformatorPointClick(e),isGuide=e.target.classList.contains("ng-guide"),mousePosition=void 0,element=void 0,shouldDeselect=void 0;this.clickPoint=this._getRelativeScaledMousePosition(e),Mouse.leftButtonPressed(e)&&e.altKey&&this.getSelectedElement()&&this.canvas.duplicateInPlace(),element=this.canvas.getCollidedChild(this.clickPoint),shouldDeselect=!(isGuide||transformatorPointClick||!element)&&this.canvas.changeSelection(element,e);var isDragging=e.target.classList.contains("ng-highlight-select")||e.target.classList.contains("ng-highlight"),cantDragElement=!isGuide&&!transformatorPointClick&&!element||element&&(element.locked||element.isTransformationDisabled)||!this.Page.canChangeElements();return(!cantDragElement||!isDragging)&&(this.mouseMoved=!1,this.eventsRef.onDragEnd=this._onDragEnd.bind(this,element,shouldDeselect,transformatorPointClick),this.eventsRef.onMouseMove&&this.eventsRef.onMouseMove.cancel(),isDragging?(mousePosition=this._getRelativeMousePosition(e),this.views.highlightSelect.startDrag(mousePosition.x,mousePosition.y),this.eventsRef.onMouseMove=(0,_DomHelper.throttleFrame)(this._onDrag),this.view.containerDomElement.addEventListener("mousemove",this.eventsRef.onMouseMove),this.view.containerDomElement.addEventListener("mouseup",this.eventsRef.onDragEnd),this.removeEvents()):e.target.classList.contains("ng-resizer")?(this.views.highlightSelect.startResize(),this.eventsRef.onMouseMove=(0,_DomHelper.throttleFrame)(this._onResize.bind(this,e.target.getAttribute("data-direction"))),this.view.containerDomElement.addEventListener("mousemove",this.eventsRef.onMouseMove),this.view.containerDomElement.addEventListener("mouseup",this.eventsRef.onDragEnd),this.removeEvents()):e.target.classList.contains("ng-rotator")?(mousePosition=this._getRelativeMousePosition(e),this.views.highlightSelect.startRotate(mousePosition.x,mousePosition.y),this.eventsRef.onMouseMove=(0,_DomHelper.throttleFrame)(this._onRotate),this.view.containerDomElement.addEventListener("mousemove",this.eventsRef.onMouseMove),this.view.containerDomElement.addEventListener("mouseup",this.eventsRef.onDragEnd),this.removeEvents()):isGuide?(this.view.workbenchDomElement.addEventListener("mousemove",this._handleGuideDrag),this.view.workbenchDomElement.addEventListener("mouseup",this._handleGuideDragEnd),this.removeEvents()):void 0)}},{key:"_handleBlockElementHighlight",value:function(e){var element=this.getSelectedElement(),point=void 0,relativePoint=void 0,partId=void 0;return!(!element||!element.isMultipart())&&(point=Point.FromObject(this._getRelativeScaledMousePosition(e)),relativePoint=new Point(point.x-element.x,point.y-element.y),void(element.hitTest(point)?(partId=this.canvas.editingMultipart&&element.isMultipart()?element.partHitTest(relativePoint):null,partId?this.views.highlightPart.show(element,partId):this.views.highlightPart.hide(),e.stopPropagation(),this.views.highlight.hide()):this.views.highlightPart.hide()))}},{key:"_handleRulerMouseDown",value:function(e){var ruler=e.target.classList.contains(this.Page.options.rulerElClass)?e.target:null;ruler&&(this.canvas.activeGuide=this.canvas.createGuide(ruler.classList.contains(Orientations.HORIZONTAL)?Orientations.HORIZONTAL:Orientations.VERTICAL,this.clickPoint.x,this.clickPoint.y),this._onStartDrag({target:this.canvas.activeGuide.view.domElement}))}},{key:"_handleMouseDown",value:function(e){this.clickPoint=this._getRelativeScaledMousePosition(e),this.dragLocker=(0,_Locker.getLocker)(DRAG_LOCK_TIME);var actions=[this._onSelectGuide,this._onSelectElement,this._onDeselectElement,this._onStartMultiSelect];(0,_lodash.some)(actions,function(action){return action(e)})}},{key:"_handleMouseLeave",value:function(){this.views.highlight.hide(),this.views.highlightPart.hide(),this._elementNameHide()}},{key:"_handleHighlightElement",value:function(e){var element=this.canvas.getCollidedChild(this.clickPoint);return this.clickPoint=this._getRelativeScaledMousePosition(e),element?(this.views.highlight.show(element),void this._elementNameShow(element,e)):(this.views.highlight.hide(),this.views.highlightPart.hide(),this._elementNameHide())}},{key:"_handleDoubleClick",value:function(e){this.clickPoint=this._getRelativeScaledMousePosition(e);var element=this.canvas.getCollidedChild(this.clickPoint);this._editElement(element,e)}},{key:"_editElement",value:function(element,e){return!(!element||element.locked||!this.Page.canAddDeleteElements())&&void(element.isComponent()?this.canvas.editComponent(element):element.isGroup()?this.canvas.editGroup(element,!0):element.isTextInput()?this._editTextInput(element):element.isTextEditable()?this._editTextElement(element):element.isMultipart()?(this.canvas.enablePartSelection(element),this._handleBlockElementHighlight(e)):element.type===ElementTypes.IMAGE&&this.canvas.openUploadDialog())}},{key:"_handleDragEnter",value:function(e){e.preventDefault()}},{key:"_handleDragOver",value:function(e){if(this.Page.canAddDeleteElements()){this.clickPoint=this._getRelativeScaledMousePosition(e);this.canvas.getCollidedChild(this.clickPoint);e.preventDefault()}}},{key:"_handleDragleave",value:function(e){e.preventDefault()}},{key:"_handleDrop",value:function(e){var _this2=this;if(e.preventDefault(),this.Page.canAddDeleteElements()&&DragAndDropHelper.ContainsImageFile(e.dataTransfer)){var dropPoint=Point.FromObject(this._getRelativeScaledMousePosition(e)),imagesData=DragAndDropHelper.GetImages(e.dataTransfer);Promise.all((0,_lodash.map)(imagesData,getImageSizePromise)).then(function(readyImagesData){_this2.Page.emit(Events.IMAGES_DROP,{files:readyImagesData,point:dropPoint,nativeEvent:e})})}}},{key:"_onSelectGuide",value:function(e){if(!this.Page.options.enableGuides)return!1;var guide=this.canvas.getCollidedElement(this.canvas.guides,!1,!1,this.clickPoint);return!!guide&&(this.canvas.activeGuide=guide,this._onStartDrag(e),!0)}},{key:"_handleSetGuideVisibility",value:function(visible,data){var guide=data.axis===Properties.X?this.views.smartguideVertical:this.views.smartguideHorizontal;guide.visibility=visible,visible&&(guide[data.axis]=data.value*this.canvas.scale)}},{key:"_handleGuideDrag",value:function(e){if(e.preventDefault(),this.canvas.activeGuide){var _getRelativeMousePosi=this._getRelativeMousePosition(e),x=_getRelativeMousePosi.x,y=_getRelativeMousePosi.y;this.canvas.activeGuide.x=x,this.canvas.activeGuide.y=y,this.views.guidePosition.setPosition(x,y+INDICATOR_POSITION_DELTA),this.views.guidePosition.show(this.canvas.activeGuide)}}},{key:"_handleGuideDragEnd",value:function(e){var ruler=this.canvas._getRulerRef(this.canvas.activeGuide.orientation);Mouse.isEventOnElement(e,ruler)&&this.canvas.removeGuide(this.canvas.activeGuide),this.canvas.activeGuide=null,this.view.workbenchDomElement.removeEventListener("mousemove",this._handleGuideDrag),this.view.workbenchDomElement.removeEventListener("mouseup",this._handleGuideDragEnd),this.Page.emit(Events.GUIDES_UPDATE,this.canvas.serializeGuides()),this.views.guidePosition.hide(),this.addEvents()}},{key:"_handleCropStart",value:function(){this.views.highlightSelect.view.domElement.addEventListener("dblclick",this._onCrop)}},{key:"_handleCropEnd",value:function(){this.views.highlightSelect.view.domElement.removeEventListener("dblclick",this._onCrop)}},{key:"_onDrag",value:function(e){var mousePosition=this._getRelativeMousePosition(e);e.preventDefault(),this.dragLocker&&this.dragLocker.isLocked()||(this.mouseMoved||this._mouseMove(),Mouse.leftButtonPressed(e)&&this.views.highlightSelect.drag(mousePosition.x,mousePosition.y,e.shiftKey),this.Page.emit(Events.ELEMENT_DRAG),this.views.elementIndicator.showCoordinates(this.getSelectedElement()))}},{key:"_onDragEnd",value:function(element,shouldDeselect,transformatorPointClick,e){this.eventsRef.onMouseMove&&this.eventsRef.onMouseMove.cancel(),this.mouseMoved||transformatorPointClick||(element?shouldDeselect?this.canvas._updateSelection(element):!Mouse.addToSelection(e)&&this.canvas.selectedElements.length>1&&this.canvas._select([element]):this._onDeselectElement(e)),this.Page.ElementsManager.endBatch(),this.view.containerDomElement.removeEventListener("mousemove",this.eventsRef.onMouseMove),this.view.containerDomElement.removeEventListener("mouseup",this.eventsRef.onDragEnd),this.views.elementIndicator.hide(),this.views.smartguideHorizontal.visibility=!1,this.views.smartguideVertical.visibility=!1,this.Page.emit(Events.ELEMENT_DRAG_END),this.addEvents()}},{key:"_onResize",value:function(direction,e){var lockRatio=e.shiftKey||this.getSelectedElement().keepRatio,useAnchor=e.altKey,mousePosition=this._getRelativeMousePosition(e);e.preventDefault(),this.mouseMoved||this._mouseMove(),this.views.highlightSelect.resize(mousePosition.x,mousePosition.y,direction,lockRatio,useAnchor),this.views.elementIndicator.showDimensions(this.getSelectedElement()),this.Page.emit(Events.ELEMENT_RESIZE)}},{key:"_onRotate",value:function(e){var mousePosition=this._getRelativeMousePosition(e);e.preventDefault(),this.mouseMoved||this._mouseMove(),this.views.highlightSelect.rotate(mousePosition.x,mousePosition.y,e.shiftKey),this.views.elementIndicator.showRotation(this.getSelectedElement()),this.Page.emit(Events.ELEMENT_ROTATE)}},{key:"_onCrop",value:function(){this.canvas.onCrop()}},{key:"_onSelectElement",value:function(e){var addToSelection=Mouse.addToSelection(e),element=this.canvas.getCollidedChild(this.clickPoint);return!(!element||addToSelection&&(element.locked||this.canvas.isLockedElementOnSelectedElementsList()))&&(this.canvas.editingMultipart===element?(Mouse.rightButtonPressed(e)?element.getActiveParts().indexOf(this.views.highlightPart.partId)===-1&&this._editingMultipartSelect(element,!1):(this.views.highlightSelect.view.domElement.addEventListener("mousemove",this._onMultipartMove),this.views.highlightSelect.view.domElement.addEventListener("mouseup",this._onMultipartUp),this._editingMultipartSelect(element,addToSelection)),!0):this.canvas.editingMultipart?this.canvas.disablePartSelection():(this._onStartDrag(e),element.type===ElementTypes.TABLE&&this._onTableSelect(e),!0))}},{key:"_onTableSelect",value:function(e){e.stopImmediatePropagation(),this._addEventsOnTableResizers()}},{key:"_onStartCellResize",value:function(e){this._cellResizer=e.target,this.views.highlightCellResizer.startDrag(this._cellResizer),this.view.containerDomElement.addEventListener("mousemove",this._onMoveCellResize),this.view.containerDomElement.addEventListener("mouseup",this._onCellResizeEnd),this.removeEvents()}},{key:"_onMoveCellResize",value:function(e){var mousePosition=this._getRelativeMousePosition(e);this.views.highlightCellResizer.dragResizer(mousePosition.x,mousePosition.y,this._cellResizer)}},{key:"_onCellResizeEnd",value:function(){this.views.highlightCellResizer.commitCellResize(this._cellResizer),this._cellResizer=null,this.view.containerDomElement.removeEventListener("mousemove",this._onMoveCellResize),this.view.containerDomElement.removeEventListener("mouseup",this._onCellResizeEnd),this.addEvents()}},{key:"_onMultipartMove",value:function(){this._editingMultipartSelect(this.canvas.editingMultipart,!0)}},{key:"_onMultipartUp",value:function(){this.views.highlightSelect.view.domElement.removeEventListener("mousemove",this._onMultipartMove),this.views.highlightSelect.view.domElement.removeEventListener("mouseup",this._onMultipartUp),this._editingMultipartSelect(this.canvas.editingMultipart,!0)}},{key:"_onDeselectElement",value:function(e){if(Mouse.addToSelection(e)||(this.canvas.deselect(),this.canvas.setGroupEditable(!1),this.canvas.editingGroup=null,this.canvas.editingMultipart&&this.canvas.disablePartSelection()),Mouse.rightButtonPressed(e))return this.canvas.showContextMenu(e),!0}},{key:"_onStartMultiSelect",value:function(e){var _this3=this;if(!Mouse.rightButtonPressed(e)){if(this.views.multiSelect.hasSelection())return this._onEndMultiSelect(this.views.multiSelect.startPoint,e);var startMultiSelectPoint=Point.FromObject(this._getRelativeScaledMousePosition(e));this.eventsRef.onEndMultiSelect=function(e){return _this3._onEndMultiSelect(startMultiSelectPoint,e)},this.eventsRef.onMultiSelect=function(e){return _this3._onMultiSelect(startMultiSelectPoint,e)},this.view.containerDomElement.addEventListener("mouseup",this.eventsRef.onEndMultiSelect),this.view.containerDomElement.addEventListener("mousemove",this.eventsRef.onMultiSelect),this.mouseMoved=!1,this.removeEvents()}}},{key:"_onMultiSelect",value:function(startMultiSelectPoint,e){var endMultiSelectPoint=Point.FromObject(this._getRelativeScaledMousePosition(e)),selection=getSelectionRectangle(startMultiSelectPoint,endMultiSelectPoint);this.mouseMoved=!0,this.views.multiSelect.show(selection),this.views.multiSelect.startPoint=startMultiSelectPoint}},{key:"_onEndMultiSelect",value:function(startMultiSelectPoint,e){var endMultiSelectPoint=void 0,selection=void 0,elements=void 0;this.mouseMoved&&(this.mouseMoved=!1,endMultiSelectPoint=Point.FromObject(this._getRelativeScaledMousePosition(e)),selection=getSelectionRectangle(startMultiSelectPoint,endMultiSelectPoint),elements=(0,_lodash.filter)(this.canvas.children,function(element){return element.isVisible()&&element.isUnlocked()&&!element.isEditByCollaborator()&&element.getBoundingBox(!0).overlaps(selection)}),this.canvas._select(Mouse.addToSelection(e)?(0,_lodash.union)(this.canvas.selectedElements,elements):elements)),this.views.multiSelect.hide(),this.view.containerDomElement.removeEventListener("mouseup",this.eventsRef.onEndMultiSelect),this.view.containerDomElement.removeEventListener("mousemove",this.eventsRef.onMultiSelect),this.addEvents()}},{key:"_editTextInput",value:function(element){var _this4=this;this._elementNameHide(),this.views.highlightSelect.hideView(),this.views.highlightSelectedPart.hideView(),this.views.highlightPart.hideView(),this.eventsRef.finishEditTextElement=function(e){return _this4._finishEditingTextInput(e,element)},this.removeEvents(),(0,_lodash.forEach)(this.Page.currentMode.shortcuts,function(shortcut){shortcut.removeEvents()}),this.view.domElement.style.pointerEvents="none",this.view.containerDomElement.addEventListener("mousedown",this.eventsRef.finishEditTextElement),element.setEditing(!0,this.views.highlightPart.partId)}},{key:"_finishEditingTextInput",value:function(e,element){element.view.domElement.contains(e.target)&&!clickedOutsideActivePart(element,e.target)||(e.stopPropagation(),element.setEditing(!1),element.updateProperty(Properties.INPUT_VALUE,element.view.getInputValue()),this.addEvents(),(0,_lodash.forEach)(this.Page.currentMode.shortcuts,function(shortcut){shortcut.addEvents()}),this.views.highlightSelect.showView(),this.views.highlightSelectedPart.showView(),this.views.highlightPart.showView(),this.view.domElement.style.pointerEvents="auto",this.view.containerDomElement.removeEventListener("mousedown",this.eventsRef.finishEditTextElement))}},{key:"_editTextElement",value:function(element){var _this5=this;this.removeEvents(),(0,_lodash.forEach)(this.Page.currentMode.shortcuts,function(shortcut){shortcut.removeEvents()}),this.eventsRef.finishEditingTextElement=function(e){return _this5._finishEditingTextElement(e,element)},this.canvas.editTextElement(element,function(){_this5.views.highlightSelect.hideView(),_this5._elementNameHide(),_this5.view.domElement.style.pointerEvents="none",_this5.view.containerDomElement.addEventListener("mousedown",_this5.eventsRef.finishEditingTextElement,!0)})}},{key:"_finishEditingTextElement",value:function(e,element){var editableElementDOM=element.view.domElement;(!editableElementDOM.contains(e.target)||element.type!==ElementTypes.BUTTON&&editableElementDOM===e.target)&&(e.stopPropagation(),this.endTextEdit())}},{key:"endTextEdit",value:function(){this.canvas.finishEditingTextElement(),this.addEvents(),(0,_lodash.forEach)(this.Page.currentMode.shortcuts,function(shortcut){shortcut.addEvents()}),this.views.highlightSelect.showView(),this.view.domElement.style.pointerEvents="auto",this.view.containerDomElement.removeEventListener("mousedown",this.eventsRef.finishEditingTextElement,!0),this.eventsRef.finishEditingTextElement=null}},{key:"isTextEditActive",value:function(){return!!this.eventsRef.finishEditingTextElement}},{key:"_editingMultipartSelect",value:function(element,addToSelection){element&&(addToSelection&&element.anyPartsSelected()&&element.addActivePart?(element.addActivePart(this.views.highlightPart.partId),this.views.highlightSelectedPart.show(element,element.getActiveParts())):(element.setActiveParts([this.views.highlightPart.partId]),this.views.highlightSelectedPart.show(element,this.views.highlightPart.partId),this.Page.emit(Events.HIGHLIGHT_PART_SELECTED)),this.Page.emit(Events.ELEMENTS_SELECTED,(0,_lodash.clone)(this.canvas.selectedElements)))}},{key:"_mouseMove",value:function(){this.mouseMoved=!0,this.views.elementName.hide(),this.views.highlight.hide(),this.canvas._mouseMove()}},{key:"_addEventsOnTableResizers",value:function(){var _this6=this;(0,_lodash.forEach)(this.views.highlightCellResizer.getResizers(),function(resizer){resizer.addEventListener("mousedown",_this6._onStartCellResize)})}},{key:"_removeEventsOnTableResizers",value:function(){var _this7=this;(0,_lodash.forEach)(this.views.highlightCellResizer.getResizers(),function(resizer){resizer.removeEventListener("mousedown",_this7._onStartCellResize)})}},{key:"clickPoint",set:function(clickPoint){this.canvas&&(this.canvas.clickPoint=clickPoint),this._clickPoint=clickPoint},get:function(){return this._clickPoint}}]),DesignOverlay}(_SpecModeOverlay3.default),_applyDecoratedDescriptor(_class.prototype,"_handleHighlightPartMouseDown",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"_handleHighlightPartMouseDown"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"_onStartDrag",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"_onStartDrag"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"_handleBlockElementHighlight",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"_handleBlockElementHighlight"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"_handleRulerMouseDown",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"_handleRulerMouseDown"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"_handleMouseDown",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"_handleMouseDown"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"_handleMouseLeave",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"_handleMouseLeave"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"_handleHighlightElement",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"_handleHighlightElement"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"_handleDoubleClick",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"_handleDoubleClick"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"_handleDragEnter",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"_handleDragEnter"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"_handleDragOver",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"_handleDragOver"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"_handleDragleave",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"_handleDragleave"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"_handleDrop",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"_handleDrop"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"_onSelectGuide",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"_onSelectGuide"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"_handleGuideDrag",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"_handleGuideDrag"),_class.prototype),
_applyDecoratedDescriptor(_class.prototype,"_handleGuideDragEnd",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"_handleGuideDragEnd"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"_handleCropStart",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"_handleCropStart"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"_handleCropEnd",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"_handleCropEnd"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"_onDrag",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"_onDrag"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"_onDragEnd",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"_onDragEnd"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"_onResize",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"_onResize"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"_onRotate",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"_onRotate"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"_onCrop",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"_onCrop"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"_onSelectElement",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"_onSelectElement"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"_onTableSelect",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"_onTableSelect"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"_onStartCellResize",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"_onStartCellResize"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"_onMoveCellResize",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"_onMoveCellResize"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"_onCellResizeEnd",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"_onCellResizeEnd"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"_onMultipartMove",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"_onMultipartMove"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"_onMultipartUp",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"_onMultipartUp"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"_onDeselectElement",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"_onDeselectElement"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"_onStartMultiSelect",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"_onStartMultiSelect"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"_onMultiSelect",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"_onMultiSelect"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"_onEndMultiSelect",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"_onEndMultiSelect"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"_finishEditingTextElement",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"_finishEditingTextElement"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"endTextEdit",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"endTextEdit"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"_editingMultipartSelect",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"_editingMultipartSelect"),_class.prototype),_class);exports.default=DesignOverlay},{"../../elements/helpers/DragAndDropHelper":248,"../../elements/helpers/ImageEditor":251,"../../elements/helpers/MouseHelper.js":252,"../../elements/helpers/SnappingHelper":257,"../../elements/ui/ElementIndicator":268,"../../elements/ui/ElementName":269,"../../elements/ui/GuidePosition":271,"../../elements/ui/Highlight":272,"../../elements/ui/HighlightCellResizer":274,"../../elements/ui/HighlightEdit":275,"../../elements/ui/HighlightEditClipped":276,"../../elements/ui/HighlightPart":277,"../../elements/ui/HighlightSelect":278,"../../elements/ui/MultiSelect":282,"../../elements/ui/Smartguide":284,"../../enums/ElementTypes":346,"../../enums/Events":347,"../../enums/Orientations":356,"../../enums/Properties":358,"../../primitives/Point.js":403,"../../primitives/Rectangle.js":404,"../../utils/DomHelper":410,"../../utils/Locker":412,"./SpecModeOverlay":396,"autobind-decorator":15,lodash:161}],392:[function(_dereq_,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function _applyDecoratedDescriptor(target,property,decorators,descriptor,context){var desc={};return Object.keys(descriptor).forEach(function(key){desc[key]=descriptor[key]}),desc.enumerable=!!desc.enumerable,desc.configurable=!!desc.configurable,("value"in desc||desc.initializer)&&(desc.writable=!0),desc=decorators.slice().reverse().reduce(function(desc,decorator){return decorator(target,property,desc)||desc},desc),context&&void 0!==desc.initializer&&(desc.value=desc.initializer?desc.initializer.call(context):void 0,desc.initializer=void 0),void 0===desc.initializer&&(Object.defineProperty(target,property,desc),desc=null),desc}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _class,_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function get(object,property,receiver){null===object&&(object=Function.prototype);var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0===desc){var parent=Object.getPrototypeOf(object);return null===parent?void 0:get(parent,property,receiver)}if("value"in desc)return desc.value;var getter=desc.get;if(void 0!==getter)return getter.call(receiver)},_lodash=_dereq_("lodash"),_autobindDecorator=_dereq_("autobind-decorator"),_autobindDecorator2=_interopRequireDefault(_autobindDecorator),_Events=_dereq_("../../enums/Events"),_Events2=_interopRequireDefault(_Events),_SpecModeOverlay2=_dereq_("./SpecModeOverlay"),_SpecModeOverlay3=_interopRequireDefault(_SpecModeOverlay2),ElementName=_dereq_("../../elements/ui/ElementName"),Highlight=_dereq_("../../elements/ui/Highlight"),DocumentationModeOverlay=(_class=function(_SpecModeOverlay){function DocumentationModeOverlay(Page){var views=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,DocumentationModeOverlay);var _this=_possibleConstructorReturn(this,(DocumentationModeOverlay.__proto__||Object.getPrototypeOf(DocumentationModeOverlay)).call(this,Page,(0,_lodash.assign)({},views,{elementName:new ElementName(null,Page),highlight:new Highlight(null,Page)})));return _this.highlightedElement=null,_this.mouseEvent=null,_this.views.highlight.setUseBoundingBox(!0),_this.views.highlightEdit.stateIa="hidden",_this.views.highlightSelect.stateIa="hidden",_this}return _inherits(DocumentationModeOverlay,_SpecModeOverlay),_createClass(DocumentationModeOverlay,[{key:"highlightElement",value:function(element,interactive){this.views.highlight.show(element,interactive)}},{key:"hideHighlight",value:function(){this.views.highlight.hide(),this.views.elementName.hide()}},{key:"addEvents",value:function(){this.view.containerDomElement.addEventListener("mousemove",this._onMouseMove),this.view.containerDomElement.addEventListener("mousedown",this._onMouseDown),_get(DocumentationModeOverlay.prototype.__proto__||Object.getPrototypeOf(DocumentationModeOverlay.prototype),"addEvents",this).call(this)}},{key:"removeEvents",value:function(){this.view.containerDomElement.removeEventListener("mousemove",this._onMouseMove),this.view.containerDomElement.removeEventListener("mousedown",this._onMouseDown),_get(DocumentationModeOverlay.prototype.__proto__||Object.getPrototypeOf(DocumentationModeOverlay.prototype),"removeEvents",this).call(this)}},{key:"_onMouseDown",value:function(e){this.clickPoint=this._getRelativeScaledMousePosition(e);var annotation=this.canvas.getCollidedElement(this.canvas.getSortedAnnotationHighlights(),!1,!0,this.clickPoint),annotationElement=annotation?annotation.element:null;return annotationElement&&annotationElement.isAnnotationSelected()?(annotationElement.deselectAnnotation(),this.Page.emit(_Events2.default.ANNOTATION_ELEMENT_SELECTED,null)):(this._removeSelections(),annotationElement&&annotationElement.selectAnnotation(),void this.Page.emit(_Events2.default.ANNOTATION_ELEMENT_SELECTED,annotationElement))}},{key:"_removeSelections",value:function(){(0,_lodash.forEach)(this.canvas.annotationHighlights,function(annotation){return annotation.element.deselectAnnotation()})}},{key:"_onMouseMove",value:function(e){this.mouseEvent||window.requestAnimationFrame(this._handleHighlightElement),this.mouseEvent=e}},{key:"_handleHighlightElement",value:function(){var e=this.mouseEvent;this.mouseEvent=null,this.clickPoint=this._getRelativeScaledMousePosition(e);var annotation=this.canvas.getCollidedElement(this.canvas.getSortedAnnotationHighlights(),!1,!0,this.clickPoint),annotationElement=annotation?annotation.element:null;annotationElement&&this.highlightedElement===annotation.element||this._removeHighlights(),this.highlightedElement!==annotationElement&&(this.highlightedElement=annotationElement,annotationElement&&annotationElement.highlightAnnotation(),this.Page.emit(_Events2.default.ANNOTATION_ELEMENT_HIGHLIGHTED,annotationElement))}},{key:"_removeHighlights",value:function(){(0,_lodash.forEach)(this.canvas.annotationHighlights,function(annotation){return annotation.element.removeAnnotationHighlight()})}},{key:"clear",value:function(){(0,_lodash.forEach)((0,_lodash.pick)(this.views,["highlight","elementName"]),function(view){return view.hide(!0)})}},{key:"__getViewsOrder",value:function(){return["highlight","elementName"]}}]),DocumentationModeOverlay}(_SpecModeOverlay3.default),_applyDecoratedDescriptor(_class.prototype,"_onMouseDown",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"_onMouseDown"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"_onMouseMove",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"_onMouseMove"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"_handleHighlightElement",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"_handleHighlightElement"),_class.prototype),_class);exports.default=DocumentationModeOverlay},{"../../elements/ui/ElementName":269,"../../elements/ui/Highlight":272,"../../enums/Events":347,"./SpecModeOverlay":396,"autobind-decorator":15,lodash:161}],393:[function(_dereq_,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}return Array.from(arr)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function _applyDecoratedDescriptor(target,property,decorators,descriptor,context){var desc={};return Object.keys(descriptor).forEach(function(key){desc[key]=descriptor[key]}),desc.enumerable=!!desc.enumerable,desc.configurable=!!desc.configurable,("value"in desc||desc.initializer)&&(desc.writable=!0),desc=decorators.slice().reverse().reduce(function(desc,decorator){return decorator(target,property,desc)||desc},desc),context&&void 0!==desc.initializer&&(desc.value=desc.initializer?desc.initializer.call(context):void 0,desc.initializer=void 0),void 0===desc.initializer&&(Object.defineProperty(target,property,desc),desc=null),desc}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _class,_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function get(object,property,receiver){null===object&&(object=Function.prototype);var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0===desc){var parent=Object.getPrototypeOf(object);return null===parent?void 0:get(parent,property,receiver)}if("value"in desc)return desc.value;var getter=desc.get;if(void 0!==getter)return getter.call(receiver)},_lodash=_dereq_("lodash"),_autobindDecorator=_dereq_("autobind-decorator"),_autobindDecorator2=_interopRequireDefault(_autobindDecorator),_AbstractOverlay2=_dereq_("./AbstractOverlay"),_AbstractOverlay3=_interopRequireDefault(_AbstractOverlay2),_Locker=_dereq_("../../utils/Locker"),DrawIndicator=_dereq_("../../elements/ui/DrawIndicator"),ElementIndicator=_dereq_("../../elements/ui/ElementIndicator"),HighlightEdit=_dereq_("../../elements/ui/HighlightEdit"),Smartguide=_dereq_("../../elements/ui/Smartguide"),SnappingHelper=_dereq_("../../elements/helpers/SnappingHelper"),ElementTypes=_dereq_("../../enums/ElementTypes"),Events=_dereq_("../../enums/Events"),Keys=_dereq_("../../enums/Keys"),Orientations=_dereq_("../../enums/Orientations"),PageModes=_dereq_("../../enums/PageModes"),Properties=_dereq_("../../enums/Properties"),DRAW_MODE_CLASSES=["add-element-mode-wrapper"],DRAG_LOCK_TIME=60,getClassesFromConfig=function(config){var classes=[];return config.className&&classes.push(config.className),config.drawable&&classes.push("drawable"),classes},DrawOverlay=(_class=function(_AbstractOverlay){function DrawOverlay(Page){_classCallCheck(this,DrawOverlay);var _this=_possibleConstructorReturn(this,(DrawOverlay.__proto__||Object.getPrototypeOf(DrawOverlay)).call(this,Page,{drawIndicator:new DrawIndicator(null,Page),elementIndicator:new ElementIndicator(null,Page),highlightEdit:new HighlightEdit(null,Page),smartguideHorizontal:new Smartguide(null,Page,Orientations.HORIZONTAL),smartguideVertical:new Smartguide(null,Page,Orientations.VERTICAL)}));return _this.dragLocker=null,_this._containerClasses=[],_this.eventsRef={onGuideShow:function(data){return _this._handleSetGuideVisibility(!0,data)},onGuideHide:function(data){return _this._handleSetGuideVisibility(!1,data)}},_this}return _inherits(DrawOverlay,_AbstractOverlay),_createClass(DrawOverlay,[{key:"addEvents",value:function(){document.body.addEventListener("click",this._handleClickOnBody),this.view.containerDomElement.addEventListener("mousedown",this._handleMouseDown),_get(DrawOverlay.prototype.__proto__||Object.getPrototypeOf(DrawOverlay.prototype),"addEvents",this).call(this)}},{key:"removeEvents",value:function(){document.body.removeEventListener("click",this._handleClickOnBody),this.view.containerDomElement.removeEventListener("mousedown",this._handleMouseDown),_get(DrawOverlay.prototype.__proto__||Object.getPrototypeOf(DrawOverlay.prototype),"removeEvents",this).call(this)}},{key:"update",value:function(elementsChanged){(elementsChanged||this.views.drawIndicator.dirty)&&(this.views.drawIndicator.update(),this.views.drawIndicator.element&&this.views.elementIndicator.update())}},{key:"appendToCanvas",value:function(canvas){var _view$containerDomEle;_get(DrawOverlay.prototype.__proto__||Object.getPrototypeOf(DrawOverlay.prototype),"appendToCanvas",this).call(this,canvas),(_view$containerDomEle=this.view.containerDomElement.classList).add.apply(_view$containerDomEle,DRAW_MODE_CLASSES),SnappingHelper.AddListener(Events.SNAPPING_GUIDE_SHOW,this.eventsRef.onGuideShow),SnappingHelper.AddListener(Events.SNAPPING_GUIDE_HIDE,this.eventsRef.onGuideHide)}},{key:"showGroupHighlight",value:function(editingGroup){this.views.highlightEdit.show(editingGroup,editingGroup.isMultistate())}},{key:"destroy",value:function(){var _view$containerDomEle2,_view$containerDomEle3;return(_view$containerDomEle2=this.view.containerDomElement.classList).remove.apply(_view$containerDomEle2,DRAW_MODE_CLASSES),(_view$containerDomEle3=this.view.containerDomElement.classList).remove.apply(_view$containerDomEle3,_toConsumableArray(this._containerClasses)),this._removeMouseDownEvents(),SnappingHelper.RemoveListener(Events.SNAPPING_GUIDE_SHOW,this.eventsRef.onGuideShow),SnappingHelper.RemoveListener(Events.SNAPPING_GUIDE_HIDE,this.eventsRef.onGuideHide),_get(DrawOverlay.prototype.__proto__||Object.getPrototypeOf(DrawOverlay.prototype),"destroy",this).call(this)}},{key:"_handleMouseDown",value:function(e){this.removeEvents(),(0,_lodash.forEach)(this.Page.currentMode.shortcuts,function(shortcut){shortcut.removeEvents()}),this.dragLocker=(0,_Locker.getLocker)(DRAG_LOCK_TIME),this.views.drawIndicator.drawStart(this._getRelativeScaledMousePosition(e),this.elementDefinition),this._addMouseDownEvents()}},{key:"_handleMouseMove",value:function(e){this.dragLocker.isLocked()||(this.views.drawIndicator.drawMove(this._getRelativeScaledMousePosition(e),e.shiftKey),this.views.drawIndicator.mouseMoved&&this.views.elementIndicator.showDimensions(this.views.drawIndicator.element))}},{key:"_handleMouseUp",value:function(){var drawIndicator=this.views.drawIndicator,_drawIndicator$getEle=drawIndicator.getElementToAddDefinition(),type=_drawIndicator$getEle.type,props=_drawIndicator$getEle.props;return this._removeMouseDownEvents(),type===ElementTypes.IMAGE?this.Page.emit(Events.IMAGE_DRAWN,drawIndicator._mouseMoved,props,this._finishDrawMode):(this._finishDrawMode(),void setTimeout(function(element,Page,shouldEdit){return function(){Page.selectElement(element.id,!0),shouldEdit&&Page.editSelectedElements()}}(this.Page.createElement(type,(0,_lodash.assign)({},this.elementDefinition.props,props),!1),this.Page,this.config.edit)))}},{key:"_handleKeyDown",value:function(e){if(e.which===Keys.ESCAPE){var _views=this.views,drawIndicator=_views.drawIndicator,elementIndicator=_views.elementIndicator,smartguideHorizontal=_views.smartguideHorizontal,smartguideVertical=_views.smartguideVertical;drawIndicator.drawEnd(),elementIndicator.hide(),smartguideHorizontal.visibility=!1,smartguideVertical.visibility=!1,this._removeMouseDownEvents(),this.addEvents(),(0,_lodash.forEach)(this.Page.currentMode.shortcuts,function(shortcut){shortcut.addEvents()})}}},{key:"_finishDrawMode",value:function(error){error||this.Page.emit(Events.DRAW_ELEMENT_ADDED,this.elementDefinition);var _views2=this.views,drawIndicator=_views2.drawIndicator,elementIndicator=_views2.elementIndicator;drawIndicator.drawEnd(),elementIndicator.hide(),this.Page.setMode(PageModes.DESIGN)}},{key:"_addMouseDownEvents",value:function(){this.view.containerDomElement.addEventListener("mousemove",this._handleMouseMove),document.addEventListener("mouseup",this._handleMouseUp),document.addEventListener("keydown",this._handleKeyDown,!0)}},{key:"_removeMouseDownEvents",value:function(){this.view.containerDomElement.removeEventListener("mousemove",this._handleMouseMove),document.removeEventListener("mouseup",this._handleMouseUp),document.removeEventListener("keydown",this._handleKeyDown,!0)}},{key:"_handleClickOnBody",value:function(e){this.view.containerDomElement.contains(e.target)||this.Page.setMode(PageModes.DESIGN)}},{key:"_handleSetGuideVisibility",value:function(visible,data){var guide=data.axis===Properties.X?this.views.smartguideVertical:this.views.smartguideHorizontal;guide.visibility=visible,visible&&(guide[data.axis]=data.value*this.canvas.scale)}},{key:"elementDefinition",set:function(definition){this._definition=definition},get:function(){return this._definition}},{key:"config",set:function(config){var _view$containerDomEle5;if(this._containerClasses.length){var _view$containerDomEle4;(_view$containerDomEle4=this.view.containerDomElement.classList).remove.apply(_view$containerDomEle4,_toConsumableArray(this._containerClasses)),this._containerClasses.length=0}this._config=config,this._containerClasses=getClassesFromConfig(config),(_view$containerDomEle5=this.view.containerDomElement.classList).add.apply(_view$containerDomEle5,_toConsumableArray(this._containerClasses))},get:function(){return this._config}}]),DrawOverlay}(_AbstractOverlay3.default),_applyDecoratedDescriptor(_class.prototype,"_handleMouseDown",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"_handleMouseDown"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"_handleMouseMove",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"_handleMouseMove"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"_handleMouseUp",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"_handleMouseUp"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"_handleKeyDown",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"_handleKeyDown"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"_finishDrawMode",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"_finishDrawMode"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"_handleClickOnBody",[_autobindDecorator2.default],Object.getOwnPropertyDescriptor(_class.prototype,"_handleClickOnBody"),_class.prototype),_class);exports.default=DrawOverlay},{"../../elements/helpers/SnappingHelper":257,"../../elements/ui/DrawIndicator":267,"../../elements/ui/ElementIndicator":268,"../../elements/ui/HighlightEdit":275,"../../elements/ui/Smartguide":284,"../../enums/ElementTypes":346,"../../enums/Events":347,"../../enums/Keys":353,"../../enums/Orientations":356,"../../enums/PageModes":357,"../../enums/Properties":358,"../../utils/Locker":412,"./AbstractOverlay":390,"autobind-decorator":15,lodash:161}],394:[function(_dereq_,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _AbstractOverlay2=_dereq_("./AbstractOverlay"),_AbstractOverlay3=_interopRequireDefault(_AbstractOverlay2),NoopOverlay=function(_AbstractOverlay){function NoopOverlay(){return _classCallCheck(this,NoopOverlay),_possibleConstructorReturn(this,(NoopOverlay.__proto__||Object.getPrototypeOf(NoopOverlay)).apply(this,arguments))}return _inherits(NoopOverlay,_AbstractOverlay),NoopOverlay}(_AbstractOverlay3.default);exports.default=NoopOverlay},{"./AbstractOverlay":390}],395:[function(_dereq_,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),ClassNames=_dereq_("../../enums/ClassNames.js"),OverlayView=function(){function OverlayView(){_classCallCheck(this,OverlayView),this.elementsOverlayDomElement=document.createElement("div"),this.elementsOverlayDomElement.className=ClassNames.NG_ELEMENTS_OVERLAY}return _createClass(OverlayView,[{key:"setDOMElements",value:function(overlayDomElement,containerDomElement,canvasRulersElement,workbenchDomElement){this.domElement=overlayDomElement,this.containerDomElement=containerDomElement,this.canvasRulersElement=canvasRulersElement,this.workbenchDomElement=workbenchDomElement,this.domElement.appendChild(this.elementsOverlayDomElement)}},{key:"destroyDomElement",value:function(){this.elementsOverlayDomElement&&this.elementsOverlayDomElement.parentNode&&this.elementsOverlayDomElement.parentNode.removeChild(this.elementsOverlayDomElement)}},{key:"appendChildren",value:function(children){var fragment=document.createDocumentFragment();children.forEach(function(child){fragment.appendChild(child)}),this.elementsOverlayDomElement.appendChild(fragment)}}]),OverlayView}();exports.default=OverlayView},{"../../enums/ClassNames.js":345}],396:[function(_dereq_,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_AbstractOverlay2=_dereq_("./AbstractOverlay"),_AbstractOverlay3=_interopRequireDefault(_AbstractOverlay2),_lodash=_dereq_("lodash"),ElementIndicator=_dereq_("../../elements/ui/ElementIndicator"),ElementName=_dereq_("../../elements/ui/ElementName"),Highlight=_dereq_("../../elements/ui/Highlight"),HighlightEdit=_dereq_("../../elements/ui/HighlightEdit"),HighlightEditClipped=_dereq_("../../elements/ui/HighlightEditClipped"),HighlightSelect=_dereq_("../../elements/ui/HighlightSelect"),INDICATOR_POSITION_DELTA=25,SpecModeOverlay=function(_AbstractOverlay){function SpecModeOverlay(Page){var views=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return _classCallCheck(this,SpecModeOverlay),_possibleConstructorReturn(this,(SpecModeOverlay.__proto__||Object.getPrototypeOf(SpecModeOverlay)).call(this,Page,(0,_lodash.assign)({},views,{elementIndicator:new ElementIndicator(null,Page),elementName:new ElementName(null,Page),highlight:new Highlight(null,Page),highlightEdit:new HighlightEdit(null,Page),highlightEditClipped:new HighlightEditClipped(null,Page),highlightSelect:new HighlightSelect(null,Page)})))}return _inherits(SpecModeOverlay,_AbstractOverlay),_createClass(SpecModeOverlay,[{key:"getSelectedElement",value:function(){return this.views.highlightSelect.element}},{key:"showGroupHighlight",value:function(editingGroup){this.views.highlightEdit.show(editingGroup,editingGroup.isMultistate()),this.views.highlightEditClipped.show(editingGroup)}},{key:"hideGroupHighlight",value:function(){this.views.highlightEdit.hide(),this.views.highlightEditClipped.hide()}},{key:"hideHighlight",value:function(){this.views.highlightSelect.hide()}},{key:"updateHighlightSelect",value:function(){this.views.highlightSelect.updateElements()}},{key:"clear",value:function(){(0,_lodash.forEach)((0,_lodash.pick)(this.views,["highlight","highlightEdit","highlightEditClipped","highlightSelect"]),function(view){return view.hide(!0)})}},{key:"_elementNameHide",value:function(){this.views.elementName.hide()}},{key:"_elementNameShow",value:function(element,e){var mousePosition=this._getRelativeMousePosition(e);this.views.elementName.setName(element.name),this.views.elementName.setPosition(mousePosition.x+INDICATOR_POSITION_DELTA,mousePosition.y+INDICATOR_POSITION_DELTA),this.views.elementName.show()}},{key:"__getViewsOrder",value:function(){return["highlightSelect","highlightEditClipped","highlight","highlightEdit","elementName","elementIndicator"]}}]),SpecModeOverlay}(_AbstractOverlay3.default);exports.default=SpecModeOverlay},{"../../elements/ui/ElementIndicator":268,"../../elements/ui/ElementName":269,"../../elements/ui/Highlight":272,"../../elements/ui/HighlightEdit":275,"../../elements/ui/HighlightEditClipped":276,"../../elements/ui/HighlightSelect":278,"./AbstractOverlay":390,lodash:161}],397:[function(_dereq_,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){
var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),AbstractShortcuts=function(){function AbstractShortcuts(Page){var _this=this;_classCallCheck(this,AbstractShortcuts),this.Page=Page,this.listenerRef=function(e){return _this.listener(e)},this.addEvents()}return _createClass(AbstractShortcuts,[{key:"addEvents",value:function(){document.body.addEventListener("keydown",this.listenerRef)}},{key:"removeEvents",value:function(){document.body.removeEventListener("keydown",this.listenerRef)}},{key:"listener",value:function(){throw new Error("Listener not implemented!")}},{key:"destroy",value:function(){this.removeEvents()}}],[{key:"isEventTriggeredInInputElement",value:function(e){return["INPUT","TEXTELEMENT","TEXTAREA"].indexOf(e.target.tagName)!==-1}}]),AbstractShortcuts}();exports.default=AbstractShortcuts},{}],398:[function(_dereq_,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_AbstractShortcuts2=_dereq_("./AbstractShortcuts"),_AbstractShortcuts3=_interopRequireDefault(_AbstractShortcuts2),Events=_dereq_("../../enums/Events"),Keys=_dereq_("../../enums/Keys"),KeydownPreventNodes=["input","select","textarea"],DesignShortcuts=function(_AbstractShortcuts){function DesignShortcuts(){return _classCallCheck(this,DesignShortcuts),_possibleConstructorReturn(this,(DesignShortcuts.__proto__||Object.getPrototypeOf(DesignShortcuts)).apply(this,arguments))}return _inherits(DesignShortcuts,_AbstractShortcuts),_createClass(DesignShortcuts,[{key:"listener",value:function(e){var Page=this.Page,highlightSelect=this.overlay.views.highlightSelect,canvas=Page.canvas,selectedElement=canvas.getSelectedElement(),preventListener=KeydownPreventNodes.indexOf(e.target.nodeName.toLowerCase())>-1,cmdKey=e.metaKey||e.ctrlKey,delta=void 0;if(!_AbstractShortcuts3.default.isEventTriggeredInInputElement(e)&&(e.which===Keys.KEY_V&&cmdKey?canvas.paste():e.which===Keys.KEY_A&&cmdKey?(e.preventDefault(),canvas.selectAll()):e.which===Keys.KEY_Z&&cmdKey?(e.preventDefault(),Page.undo()):e.which===Keys.KEY_Y&&cmdKey?(e.preventDefault(),Page.redo()):e.which===Keys.KEY_G&&e.altKey?(e.preventDefault(),Page.setGridOptions({gridDisplay:!canvas.getGridOption("gridDisplay")})):e.which===Keys.KEY_S&&e.altKey?(e.preventDefault(),Page.ElementsManager.getEditingComponent()&&canvas.finishEditingComponent()):e.which!==Keys.BACKSPACE||document.activeElement!==document.body&&document.activeElement!==document.body.parentElement||e.preventDefault(),selectedElement&&!preventListener)){if(delta=e.shiftKey?10:1,!selectedElement.locked&&Page.canChangeElements())if(e.which===Keys.LEFT_ARROW)e.preventDefault(),Page.ElementsManager.startBatch(),highlightSelect.moveOnX(-delta),Page.ElementsManager.endBatch();else if(e.which===Keys.UP_ARROW)e.preventDefault(),Page.ElementsManager.startBatch(),highlightSelect.moveOnY(-delta),Page.ElementsManager.endBatch();else if(e.which===Keys.RIGHT_ARROW)e.preventDefault(),Page.ElementsManager.startBatch(),highlightSelect.moveOnX(delta),Page.ElementsManager.endBatch();else if(e.which===Keys.DOWN_ARROW)e.preventDefault(),Page.ElementsManager.startBatch(),highlightSelect.moveOnY(delta),Page.ElementsManager.endBatch();else if(e.which===Keys.KEY_G&&cmdKey&&!e.shiftKey)e.preventDefault(),canvas.group();else if(e.which===Keys.KEY_G&&cmdKey&&e.shiftKey)e.preventDefault(),canvas.ungroup();else if(e.which===Keys.KEY_K&&cmdKey&&!e.shiftKey)e.preventDefault(),canvas.lock();else if(e.keyCode!==Keys.ESCAPE||canvas.isAddElementMode)e.keyCode===Keys.ENTER&&canvas.imageCrop&&Page.applyImageCrop();else{if(e.preventDefault(),canvas.editingMultipart)return canvas.clearMultipartSelection(),void canvas.disablePartSelection();canvas.deselect(),e.stopImmediatePropagation()}else e.preventDefault();e.which===Keys.KEY_K&&cmdKey&&e.shiftKey?(e.preventDefault(),canvas.unlock()):e.which===Keys.BACKSPACE||e.which===Keys.DELETE?(e.preventDefault(),canvas.delete()):e.which===Keys.KEY_E&&e.altKey?(e.preventDefault(),1===canvas.selectedElements.length&&canvas.selectedElements[0].isComponent()&&canvas.editComponent(canvas.selectedElements[0])):e.which===Keys.CLOSE_BRACKET&&cmdKey&&!e.altKey?(e.preventDefault(),canvas.moveForward()):e.which===Keys.OPEN_BRACKET&&cmdKey&&!e.altKey?(e.preventDefault(),canvas.moveBehind()):e.which===Keys.CLOSE_BRACKET&&cmdKey&&e.altKey?(e.preventDefault(),canvas.moveToFront()):e.which===Keys.OPEN_BRACKET&&cmdKey&&e.altKey&&(e.preventDefault(),canvas.moveToBack()),selectedElement.isUnlocked()&&(e.which===Keys.KEY_S&&e.altKey?(e.preventDefault(),Page.isComponentEditMode()||Page.isComponentInSelection()||canvas.createComponent()):e.which===Keys.KEY_C&&cmdKey?(e.preventDefault(),canvas.copy()):e.which===Keys.KEY_X&&cmdKey?(e.preventDefault(),canvas.cut()):e.which===Keys.KEY_S&&cmdKey&&e.shiftKey&&(e.preventDefault(),selectedElement.isMultistate()?(Page.ElementsManager.startBatch(),selectedElement.addState(),Page.ElementsManager.endBatch()):canvas.createMultistate(),Page.emit(Events.SHORTCUT_ADD_NEW_STATE,selectedElement))),selectedElement.isTextEditable()&&(e.which===Keys.KEY_B&&cmdKey?(Page.ElementsManager.startBatch(),selectedElement.toggleBold(),Page.ElementsManager.endBatch()):e.which===Keys.KEY_I&&cmdKey?(Page.ElementsManager.startBatch(),selectedElement.toggleItalic(),Page.ElementsManager.endBatch()):e.which===Keys.KEY_U&&cmdKey&&(Page.ElementsManager.startBatch(),selectedElement.toggleUnderline(),Page.ElementsManager.endBatch()))}}}]),DesignShortcuts}(_AbstractShortcuts3.default);exports.default=DesignShortcuts},{"../../enums/Events":347,"../../enums/Keys":353,"./AbstractShortcuts":397}],399:[function(_dereq_,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_AbstractShortcuts2=_dereq_("./AbstractShortcuts"),_AbstractShortcuts3=_interopRequireDefault(_AbstractShortcuts2),Keys=(_dereq_("../../enums/Events"),_dereq_("../../enums/Keys")),DesignShortcuts=function(_AbstractShortcuts){function DesignShortcuts(){return _classCallCheck(this,DesignShortcuts),_possibleConstructorReturn(this,(DesignShortcuts.__proto__||Object.getPrototypeOf(DesignShortcuts)).apply(this,arguments))}return _inherits(DesignShortcuts,_AbstractShortcuts),_createClass(DesignShortcuts,[{key:"listener",value:function(e){var Page=this.Page,cmdKey=e.metaKey||e.ctrlKey;_AbstractShortcuts3.default.isEventTriggeredInInputElement(e)||(e.which===Keys.KEY_Z&&cmdKey?(e.preventDefault(),Page.undo()):e.which===Keys.KEY_Y&&cmdKey&&(e.preventDefault(),Page.redo()))}}]),DesignShortcuts}(_AbstractShortcuts3.default);exports.default=DesignShortcuts},{"../../enums/Events":347,"../../enums/Keys":353,"./AbstractShortcuts":397}],400:[function(_dereq_,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_AbstractShortcuts2=_dereq_("./AbstractShortcuts"),_AbstractShortcuts3=_interopRequireDefault(_AbstractShortcuts2),Keys=_dereq_("../../enums/Keys"),PageModes=_dereq_("../../enums/PageModes"),DrawShortcuts=function(_AbstractShortcuts){function DrawShortcuts(){return _classCallCheck(this,DrawShortcuts),_possibleConstructorReturn(this,(DrawShortcuts.__proto__||Object.getPrototypeOf(DrawShortcuts)).apply(this,arguments))}return _inherits(DrawShortcuts,_AbstractShortcuts),_createClass(DrawShortcuts,[{key:"listener",value:function(e){e.which===Keys.ESCAPE&&(e.preventDefault(),this.Page.setMode(PageModes.DESIGN))}}]),DrawShortcuts}(_AbstractShortcuts3.default);exports.default=DrawShortcuts},{"../../enums/Keys":353,"../../enums/PageModes":357,"./AbstractShortcuts":397}],401:[function(_dereq_,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_AbstractShortcuts2=_dereq_("./AbstractShortcuts"),_AbstractShortcuts3=_interopRequireDefault(_AbstractShortcuts2),Keys=_dereq_("../../enums/Keys"),SpecModeShortcuts=function(_AbstractShortcuts){function SpecModeShortcuts(){return _classCallCheck(this,SpecModeShortcuts),_possibleConstructorReturn(this,(SpecModeShortcuts.__proto__||Object.getPrototypeOf(SpecModeShortcuts)).apply(this,arguments))}return _inherits(SpecModeShortcuts,_AbstractShortcuts),_createClass(SpecModeShortcuts,[{key:"listener",value:function(e){e.which===Keys.ESCAPE&&(e.preventDefault(),this.Page.deselectSpecElements())}}]),SpecModeShortcuts}(_AbstractShortcuts3.default);exports.default=SpecModeShortcuts},{"../../enums/Keys":353,"./AbstractShortcuts":397}],402:[function(_dereq_,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_AbstractShortcuts2=_dereq_("./AbstractShortcuts"),_AbstractShortcuts3=_interopRequireDefault(_AbstractShortcuts2),Keys=_dereq_("../../enums/Keys"),ZoomShortcuts=function(_AbstractShortcuts){function ZoomShortcuts(){return _classCallCheck(this,ZoomShortcuts),_possibleConstructorReturn(this,(ZoomShortcuts.__proto__||Object.getPrototypeOf(ZoomShortcuts)).apply(this,arguments))}return _inherits(ZoomShortcuts,_AbstractShortcuts),_createClass(ZoomShortcuts,[{key:"listener",value:function(e){var Page=this.Page,cmdKey=e.metaKey||e.ctrlKey;e.which===Keys.EQUALS&&cmdKey?(e.preventDefault(),Page.zoomIn()):e.which===Keys.DASH&&cmdKey?(e.preventDefault(),Page.zoomOut()):e.which===Keys.KEY_0&&cmdKey&&(e.preventDefault(),Page.zoomReset())}}]),ZoomShortcuts}(_AbstractShortcuts3.default);exports.default=ZoomShortcuts},{"../../enums/Keys":353,"./AbstractShortcuts":397}],403:[function(_dereq_,module,exports){"use strict";module.exports=function(){function Point(x,y){this.x=x||0,this.y=y||0}return Point.FromObject=function(coords){return new Point(coords.x,coords.y)},Point.prototype.translate=function(dx,dy,angle){var point;angle?(point=this.clone(),this.x+=dx,this.y+=dy,this.rotate(point,angle)):(this.x+=dx,this.y+=dy)},Point.prototype.rotate=function(origin,angle){var point=this.clone(),rad=angle*Math.PI/180,cos=Math.cos(rad),sin=Math.sin(rad);this.x=cos*(point.x-origin.x)-sin*(point.y-origin.y)+origin.x,this.y=sin*(point.x-origin.x)+cos*(point.y-origin.y)+origin.y},Point.prototype.dot=function(p){return this.x*p.x+this.y*p.y},Point.prototype.distanceTo=function(p){var dx=this.x-p.x,dy=this.y-p.y;return Math.sqrt(dx*dx+dy*dy)},Point.prototype.clone=function(){return new Point(this.x,this.y)},Point.prototype.toString=function(){return"Point(x = "+this.x+", y = "+this.y+")"},Point}()},{}],404:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Point=_dereq_("./Point.js"),Calc=_dereq_("../utils/Calc.js");module.exports=function(){function Rectangle(x,y,w,h,a){x=x||0,y=y||0,w=w||0,h=h||0,a=a||0,this._p0=new Point,this._p1=new Point,this._p2=new Point,this._p3=new Point,this._points=[this._p0,this._p1,this._p2,this._p3],this._x=0,this._y=0,this._width=0,this._height=0,this._angle=0,this._scrollOffset=new Point,this._boxMargin=5,this.x=x,this.y=y,this.width=w,this.height=h,a&&this.rotate(this._p0,a)}return Rectangle.FromSerialized=function(serialized){return new Rectangle(serialized.x,serialized.y,serialized.width,serialized.height,serialized.angle)},Object.defineProperties(Rectangle.prototype,{x:{get:function(){return this._x},set:function(value){var delta=value-this._x;this._x=value,this._p0.translate(delta,0),this._p1.translate(delta,0),this._p2.translate(delta,0),this._p3.translate(delta,0)}},y:{get:function(){return this._y},set:function(value){var delta=value-this._y;this._y=value,this._p0.translate(0,delta),this._p1.translate(0,delta),this._p2.translate(0,delta),this._p3.translate(0,delta)}},width:{get:function(){return this._width},set:function(value){var delta=value-this._width;this._width=value,this._angle?(this._p1.translate(delta,0,this._angle),this._p2.translate(delta,0,this._angle)):(this._p1.translate(delta,0),this._p2.translate(delta,0))}},height:{get:function(){return this._height},set:function(value){var delta=value-this._height;this._height=value,this._angle?(this._p2.translate(0,delta,this._angle),this._p3.translate(0,delta,this._angle)):(this._p2.translate(0,delta),this._p3.translate(0,delta))}},top:{get:function(){return this.y}},left:{get:function(){return this.x}},right:{get:function(){return this.x+this.width}},bottom:{get:function(){return this.y+this.height}},middle:{get:function(){return this.top+this.height/2}},center:{get:function(){return this.left+this.width/2}},aspectRatio:{get:function(){return this.width/this.height}},angle:{get:function(){return this._angle},set:function(value){var p=this.getCenterPoint();this.rotate(p,value)}},boxMargin:{get:function(){return this._boxMargin},set:function(value){this._boxMargin=value}}}),Rectangle.prototype.multiply=function(value){return this.x*=value,this.y*=value,this.width*=value,this.height*=value,this},Rectangle.prototype.add=function(rectangle){var r1=this,r2=rectangle,x=Math.min(r1._p0.x,r1._p1.x,r1._p2.x,r1._p3.x,r2._p0.x,r2._p1.x,r2._p2.x,r2._p3.x),y=Math.min(r1._p0.y,r1._p1.y,r1._p2.y,r1._p3.y,r2._p0.y,r2._p1.y,r2._p2.y,r2._p3.y);return new Rectangle(x,y,Math.max(r1._p0.x,r1._p1.x,r1._p2.x,r1._p3.x,r2._p0.x,r2._p1.x,r2._p2.x,r2._p3.x)-x,Math.max(r1._p0.y,r1._p1.y,r1._p2.y,r1._p3.y,r2._p0.y,r2._p1.y,r2._p2.y,r2._p3.y)-y)},Rectangle.prototype.addTo=function(rectangle){var r1=this,r2=rectangle,x=Math.min(r1._p0.x,r1._p1.x,r1._p2.x,r1._p3.x,r2._p0.x,r2._p1.x,r2._p2.x,r2._p3.x),y=Math.min(r1._p0.y,r1._p1.y,r1._p2.y,r1._p3.y,r2._p0.y,r2._p1.y,r2._p2.y,r2._p3.y),w=Math.max(r1._p0.x,r1._p1.x,r1._p2.x,r1._p3.x,r2._p0.x,r2._p1.x,r2._p2.x,r2._p3.x)-x,h=Math.max(r1._p0.y,r1._p1.y,r1._p2.y,r1._p3.y,r2._p0.y,r2._p1.y,r2._p2.y,r2._p3.y)-y;return this._x=x,this._y=y,this._width=w,this._height=h,this._angle=0,this._p0.x=x,this._p0.y=y,this._p1.x=x+w,this._p1.y=y,this._p2.x=x+w,this._p2.y=y+h,this._p3.x=x,this._p3.y=y+h,this},Rectangle.prototype.rotate=function(p,angle){this.rotateBy(p,angle-this._angle)},Rectangle.prototype.rotateBy=function(p,delta){this._angle+=delta,this._p0.rotate(p,delta),this._p1.rotate(p,delta),this._p2.rotate(p,delta),this._p3.rotate(p,delta),this._x=this._p0.x,this._y=this._p0.y},Rectangle.prototype.moveAlongAngle=function(deltaX,deltaY){this._p0.translate(deltaX,deltaY,this._angle),this._p1.translate(deltaX,deltaY,this._angle),this._p2.translate(deltaX,deltaY,this._angle),this._p3.translate(deltaX,deltaY,this._angle),this._x=this._p0.x,this._y=this._p0.y},Rectangle.prototype.resizeFromPoint=function(scaleX,scaleY,point){_.forEach(this._points,function(p){p.x=point.x+(p.x-point.x)*scaleX,p.y=point.y+(p.y-point.y)*scaleY}),this._width*=scaleX,this._height*=scaleY,this._x=this._p0.x,this._y=this._p0.y},Rectangle.prototype.absoluteResizeFromPoint=function(width,height,point){0===this._width&&(this._p0.x=point.x,this._p1.x=this._p0.x+width,this._p2.x=this._p1.x,this._p3.x=this._p0.x,this._width=width),0===this._height&&(this._p0.y=point.y,this._p1.y=this._p0.y,this._p2.y=this._p0.y+height,this._p3.y=this._p2.y,this._height=height),this._x=this._p0.x,this._y=this._p0.y},Rectangle.prototype.hitTest=function(p){var am=new Point(this._p0.x-(p.x-this._scrollOffset.x),this._p0.y-(p.y-this._scrollOffset.y)),ab=new Point(this._p0.x-this._p1.x,this._p0.y-this._p1.y),ad=new Point(this._p0.x-this._p3.x,this._p0.y-this._p3.y);return am.dot(ab)>=0&&am.dot(ab)<=ab.dot(ab)&&am.dot(ad)>=0&&am.dot(ad)<=ad.dot(ad)},Rectangle.prototype.hitTestMargin=function(p){var amM=new Point(this._p0.x-(p.x+this._boxMargin-this._scrollOffset.x),this._p0.y-(p.y+this._boxMargin-this._scrollOffset.y)),abM=new Point(this._p0.x-this._boxMargin-(this._p1.x+this._boxMargin),this._p0.y-this._boxMargin-(this._p1.y-this._boxMargin)),adM=new Point(this._p0.x-this._boxMargin-(this._p3.x-this._boxMargin),this._p0.y-this._boxMargin-(this._p3.y+this._boxMargin));return amM.dot(abM)>=0&&amM.dot(abM)<=abM.dot(abM)&&amM.dot(adM)>=0&&amM.dot(adM)<=adM.dot(adM)},Rectangle.prototype.updateScrollOffset=function(offset){this._scrollOffset.x=offset&&offset.x||0,this._scrollOffset.y=offset&&offset.y||0},Rectangle.prototype.overlaps=function(rectangle){var r1=this.getBoundingBox(!0),r2=rectangle.getBoundingBox(!0);return!(r2._p0.x>r1._p2.x||r2._p2.x<r1._p0.x||r2._p0.y>r1._p2.y||r2._p2.y<r1._p0.y)},Rectangle.prototype.isInBounds=function(rectangle){var angleDelta=-this.angle,outer=this.clone(),inner=rectangle.clone(),rotatePoint=outer.getCenterPoint();return outer.rotateBy(rotatePoint,angleDelta),inner.rotateBy(rotatePoint,angleDelta),inner=inner.getBoundingBox(!0),outer._p0.x<=inner._p0.x&&outer._p0.y<=inner._p0.y&&outer._p1.x>=inner._p1.x&&outer._p1.y<=inner._p1.y&&outer._p2.x>=inner._p2.x&&outer._p2.y>=inner._p2.y&&outer._p3.x<=inner._p3.x&&outer._p3.y>=inner._p3.y},Rectangle.prototype.getMaxBounds=function(current,changed){var inner=changed.clone();return this.angle?inner:current.width!==changed.width||current.height!==changed.height?this.getMaxBoundsResize(current,inner):(Calc.Between(this._p0.x,this._p1.x,inner._p1.x)?Calc.Between(this._p0.x,this._p1.x,inner._p0.x)||(inner.x=this.x):inner.x-=inner._p1.x-this._p1.x,Calc.Between(this._p0.y,this._p3.y,inner._p3.y)?Calc.Between(this._p0.y,this._p3.y,inner._p0.y)||(inner.y=this.y):inner.y-=inner._p3.y-this._p3.y,inner)},Rectangle.prototype.getMaxBoundsResize=function(current,changed){var inner=changed.clone();return current.width!==changed.width&&(current.x!==changed.x?(inner.x=Math.max(this.x,changed.x),inner.width=Math.min(current.width+current.x-this.x,changed.width)):inner.width=Math.min(this.width-inner.x+this.x,changed.width)),current.height!==changed.height&&(current.y!==changed.y?(inner.y=Math.max(this.y,changed.y),inner.height=Math.min(current.height+current.y-this.y,changed.height)):inner.height=Math.min(this.height-inner.y+this.y,changed.height)),inner},Rectangle.prototype.isEqual=function(rectangle){return this._angle===rectangle._angle&&_.isEqual(this._p0,rectangle._p0)&&_.isEqual(this._p1,rectangle._p1)&&_.isEqual(this._p2,rectangle._p2)&&_.isEqual(this._p3,rectangle._p3)},Rectangle.prototype.getBoundingBox=function(projected){var x,y;return projected&&this._angle?(x=this.getMinX(),y=this.getMinY(),new Rectangle(x,y,this.getMaxX()-x,this.getMaxY()-y)):this},Rectangle.prototype.getMinX=function(){return Math.min(this._p0.x,this._p1.x,this._p2.x,this._p3.x)},Rectangle.prototype.getMinY=function(){return Math.min(this._p0.y,this._p1.y,this._p2.y,this._p3.y)},Rectangle.prototype.getMaxX=function(){return Math.max(this._p0.x,this._p1.x,this._p2.x,this._p3.x)},Rectangle.prototype.getMaxY=function(){return Math.max(this._p0.y,this._p1.y,this._p2.y,this._p3.y)},Rectangle.prototype.getCenterPoint=function(){return new Point(this._p0.x+(this._p2.x-this._p0.x)/2,this._p0.y+(this._p2.y-this._p0.y)/2)},Rectangle.prototype.clone=function(){var r=new Rectangle;return r._x=this._x,r._y=this._y,r._width=this._width,r._height=this._height,r._angle=this._angle,r._p0=this._p0.clone(),r._p1=this._p1.clone(),r._p2=this._p2.clone(),r._p3=this._p3.clone(),r},Rectangle.prototype.serialize=function(){return{x:this.x,y:this.y,width:this.width,height:this.height,angle:this.angle}},Rectangle.prototype.toString=function(){return"Rectangle(x = "+this.x+", y = "+this.y+", w = "+this.width+", h = "+this.height+")"},Rectangle}()},{"../utils/Calc.js":407,"./Point.js":403,lodash:161}],405:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash");module.exports=function(){function Extend(objectClass,baseClass){objectClass.prototype=Object.create(baseClass.prototype),objectClass.constructor=objectClass,objectClass.prototype.AppliedBehaviors=_.clone(baseClass.prototype.AppliedBehaviors),objectClass.prototype.DefaultProperties={},_.extend(objectClass.prototype.DefaultProperties,baseClass.prototype.DefaultProperties),_.extend(objectClass.prototype.DefaultProperties,objectClass.DefaultProperties),objectClass.prototype.ExcludedProperties={},_.extend(objectClass.prototype.ExcludedProperties,baseClass.prototype.ExcludedProperties),_.extend(objectClass.prototype.ExcludedProperties,objectClass.ExcludedProperties)}function ApplyBehavior(objectClass,behaviorClass){var property,descriptor;objectClass.prototype.AppliedBehaviors.push(behaviorClass),_.extend(objectClass.prototype,behaviorClass.prototype),_.defaults(objectClass.prototype.DefaultProperties,behaviorClass.DefaultProperties),_.defaults(objectClass.prototype.ExcludedProperties,behaviorClass.ExcludedProperties);for(property in behaviorClass.DefaultProperties)behaviorClass.DefaultProperties.hasOwnProperty(property)&&(descriptor=Object.getOwnPropertyDescriptor(behaviorClass.prototype,property),descriptor&&Object.defineProperty(objectClass.prototype,property,descriptor))}var Base={Extend:Extend,ApplyBehavior:ApplyBehavior};return Base}()},{lodash:161}],406:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash");module.exports=function(){function Init(options){_userContentPrefix=options.userContentPrefix,_userContentPrefixCached=options.userContentPrefixCached,_staticContentPrefixCached=options.staticContentPrefixCached}function IsStatic(url){return 0===url.indexOf("/p/")||0===url.indexOf("/pics/")||0===url.indexOf("/app/")}function IsUserContent(url){return url.indexOf(_userContentPrefix)>-1}function GetStaticUrl(url){return _.isEmpty(_staticContentPrefixCached)?url:_staticContentPrefixCached+url}function GetUserContentUrl(url){return _.isEmpty(_userContentPrefixCached)?url:url.replace(_userContentPrefix,_userContentPrefixCached)}function GetCdnUrl(url){return IsStatic(url)?GetStaticUrl(url):IsUserContent(url)?GetUserContentUrl(url):url}var _userContentPrefix=null,_userContentPrefixCached=null,_staticContentPrefixCached=null,CDNHelper={Init:Init,IsStatic:IsStatic,IsUserContent:IsUserContent,GetCdnUrl:GetCdnUrl,GetStaticUrl:GetStaticUrl,GetUserContentUrl:GetUserContentUrl};return CDNHelper}()},{lodash:161}],407:[function(_dereq_,module,exports){"use strict";module.exports=function(){function GetLinePointDistance(p0,p1,p){var d=((p1.y-p0.y)*p.x-(p1.x-p0.x)*p.y+p1.x*p0.y-p1.y*p0.x)/p1.distanceTo(p0);return d>1?d:1}function DegToRad(angle){return angle*Math.PI/180}function RadToDeg(rad){return 180*rad/Math.PI}function Round(value,numberOfDecimalPlaces){var p=Math.pow(10,numberOfDecimalPlaces);return Math.round(value*p)/p}function Between(a,b,value){var min=Math.min(a,b),max=Math.max(a,b);return value>=min&&value<=max}var Calc={GetLinePointDistance:GetLinePointDistance,DegToRad:DegToRad,RadToDeg:RadToDeg,Round:Round,Between:Between};return Calc}()},{}],408:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),ElementTypes=_dereq_("../enums/ElementTypes"),ElementsHelper=_dereq_("../elements/helpers/ElementsHelper"),EventEmitter=_dereq_("event-emitter");module.exports=function(){function CollaborationUtils(canvas,Page){this.canvas=canvas,this.Page=Page,this.activeElements={},this.editingComponents={},this.events=EVENTS}function handleStoredElements(Page,changedData,component){var elementsToAdd=[],unshift=[].unshift,add=function(storedElements){return function(toAdd){storedElements.indexOf(toAdd)>-1||storedElements.push(toAdd)}},remove=function(storedElements){return function(toRemove){storedElements.indexOf(toRemove)!==-1&&storedElements.splice(storedElements.indexOf(toRemove),1)}},handleNewElement=function(elementData,id){var index=elementsToAdd.indexOf(id);elementData.props.storedElements&&(elementsToAdd=index!==-1?elementsToAdd.slice(0,index).concat(elementData.props.storedElements).concat(elementsToAdd.slice(index)):elementsToAdd.concat(elementData.props.storedElements)),elementData.props.states&&_.forEach(elementData.props.states,function(state){unshift.apply(elementsToAdd,state.elements)})};_.forEach(changedData.changed_elements,function(elementData,id){var element=id===ElementsHelper.CANVAS_ID&&component?component:Page.ElementsManager.getElementById(id,component&&component.id);if(!element)return handleNewElement(elementData,id);if(_.isUndefined(elementData.props.storedElements)&&!elementData.props.states)return void(elementsToAdd=elementsToAdd.concat(element.storedElements||[]));if(elementData.props.states)return void _.forEach(elementData.props.states,function(state){unshift.apply(elementsToAdd,state.elements)});var storedElements=_.clone(element.storedElements);_.difference(elementData.props.storedElements,element.storedElements).forEach(add(storedElements)),_.difference(element.storedElements,elementData.props.storedElements).forEach(remove(storedElements)),storedElements=_.sortBy(storedElements,function(id){var newElementsId=elementData.props.storedElements.indexOf(id);return newElementsId===-1?element.storedElements.indexOf(id):newElementsId}),elementData.props.storedElements=storedElements,elementsToAdd=elementsToAdd.concat(storedElements)});var elementsToAddPosition=function(data){var position=elementsToAdd.indexOf(data.id);return position===-1?elementsToAdd.length:position;
},withoutDeleted=function(data){return!changedData.deleted_elements[data.id]};return _.sortBy(_.filter(mapChangedElements(changedData.changed_elements),withoutDeleted),elementsToAddPosition)}function mapChangedElements(changedElements){return _.map(changedElements,function(data,id){return{id:id,data:data}})}var EVENTS={NEW_COLLABORATOR:"newCollaborator"};return CollaborationUtils.constructor=CollaborationUtils,CollaborationUtils.prototype=Object.create(EventEmitter.methods),CollaborationUtils.prototype.refreshCollaborators=function(scale){_.forEach(this.canvas.collaborators,function(collaborator){collaborator.refresh(scale)})},CollaborationUtils.prototype.cleanupCollaborator=function(id){delete this.activeElements[id]},CollaborationUtils.prototype.isElementEditing=function(id){return _.some(this.activeElements,function(elementIds){return elementIds.indexOf(id)>-1})},CollaborationUtils.prototype.isComponentEditing=function(componentId){return componentId=parseInt(componentId,10),_.some(this.editingComponents,function(editingComponentId){return editingComponentId===componentId})},CollaborationUtils.prototype.isElementEditingByAnotherUser=function(userId,elementId){var activeElements=_.clone(this.activeElements);return delete activeElements[userId],_.some(activeElements,function(elementIds){return elementIds.indexOf(elementId)>-1})},CollaborationUtils.prototype.setCollaborators=function(collaborators){this.canvas.setCollaborators(collaborators);var newCollaborators=_.difference(Object.keys(collaborators),Object.keys(this.activeElements)),disconnectedCollaborators=_.difference(Object.keys(this.activeElements),Object.keys(collaborators));disconnectedCollaborators.length&&disconnectedCollaborators.forEach(this.cleanupCollaborator.bind(this)),newCollaborators.length&&this.emit(EVENTS.NEW_COLLABORATOR,newCollaborators)},CollaborationUtils.prototype.setActiveElements=function(userId,data){data.is_component?this.editingComponents[userId]=parseInt(data.id_page,10):delete this.editingComponents[userId],this.activeElements[userId]=data.element_ids},CollaborationUtils.prototype.activateElement=function(data){var collaborator=this.canvas.getCollaborator(data.id_user);collaborator&&(collaborator.activateElement(data.id_page,data.element_ids,data.is_component),this.setActiveElements(data.id_user,data))},CollaborationUtils.prototype.elementsChanged=function(changedData){if(parseInt(changedData.is_component)&&parseInt(changedData.id_page)!==parseInt(this.Page.pageId))return this._componentChanged(changedData);if(parseInt(changedData.id_page)===parseInt(this.Page.pageId)){var changedElements=handleStoredElements(this.Page,changedData),collaborator=this.canvas.getCollaborator(changedData.id_user);_.isEmpty(changedElements)||(_.forEach(changedElements,function(element){this.Page.collaborationUpdateElement(element.id,element.data)},this),collaborator&&collaborator.refresh()),_.forEach(changedData.deleted_elements,function(remove,id){this.Page.ElementsManager.removeElementById(id)}.bind(this))}},CollaborationUtils.prototype._componentChanged=function(changedData){var component=this.Page.getComponentById(changedData.id_page),oldComponentData=_.cloneDeep(component);if(!component)return this.Page.collaborationCreateComponent(changedData);var changedElements=mapChangedElements(changedData.changed_elements),componentInstances=this.Page.ElementsManager.getElementsByComponentId(changedData.id_page);_.isEmpty(componentInstances)||(changedElements=handleStoredElements(this.Page,changedData,_.first(componentInstances))),_.forEach(changedData.changed_elements,function(element,id){if(element.type!==ElementTypes.VIRTUAL_GROUP)return component[id]?(element.props=_.assign({},changedData.changed_properties[id],element.props),void _.assign(component[id].props,element.props)):void(component[id]=element)}),_.forEach(changedData.deleted_elements,function(noop,id){delete component[id]}),_.forEach(componentInstances,function(componentInstance){componentInstance.collaborationUpdateComponent(oldComponentData,component,changedElements)}.bind(this))},CollaborationUtils}()},{"../elements/helpers/ElementsHelper":250,"../enums/ElementTypes":346,"event-emitter":98,lodash:161}],409:[function(_dereq_,module,exports){"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_=_dereq_("lodash");module.exports=function(){function addZeroes(str,len){return _.range(0,len-str.length,0).join("")+str}function expand(str){return _.reduce(str,function(s,c){return s+c+c},"")}function isHex(value){return value&&/^#([0-9a-f]{6})$/i.test(value)}function isShortHex(value){return value&&/^#([0-9a-f]{3})$/i.test(value)}function isColorHex(value){return isHex(value)||isShortHex(value)}function isGradient(value){return/^linear-gradient/.test(value)||/^radial-gradient/.test(value)}function isRgba(value){return/^rgb/.test(value)}function isTransparent(value){var colorsSet=getColorsSet(value)||{};return value===TRANSPARENT||0===colorsSet.alpha}function getAlpha(value){return"undefined"==typeof value||value>1?1:value}function hexToRgba(hex){hex=hex.substr(1),3===hex.length&&(hex=expand(hex));var r=parseInt(hex.substr(0,2),16),g=parseInt(hex.substr(2,2),16),b=parseInt(hex.substr(4,2),16),a=getAlpha();return{r:r,g:g,b:b,a:a}}function rgbToHex(r,g,b){return"#"+addZeroes(r.toString(16),2)+addZeroes(g.toString(16),2)+addZeroes(b.toString(16),2)}function getRgbaIngredients(value){var colorMatches=/rgba?\((\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,)?(\s*\d+[\.\d+]*)*\)/g.exec(value);return colorMatches?{r:parseInt(colorMatches[1]),g:parseInt(colorMatches[2]),b:parseInt(colorMatches[3]),a:getAlpha(colorMatches[5])}:null}function rgbaStringToHex(value){var rgbMatch=/rgba?\((\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,)(\s*\d+[\.\d+]*)*\)/g.exec(value);return isColorHex(value)?value:null!==rgbMatch&&rgbMatch[5]?rgbToHex(parseInt(rgbMatch[1],10),parseInt(rgbMatch[2],10),parseInt(rgbMatch[3],10)):null}function rgbaToString(r,g,b,a){return"rgba("+[r,g,b,getAlpha(a)].join(",")+")"}function toRgba(color){var rgba;return rgba=isColorHex(color)?hexToRgba(color):getRgbaIngredients(color),!!rgba&&rgbaToString(rgba.r,rgba.g,rgba.b,rgba.a)}function makeColorTransparent(color){var rgba;return isColorHex(color)?rgba=hexToRgba(color):"string"==typeof color?rgba=getRgbaIngredients(color):"object"===("undefined"==typeof color?"undefined":_typeof(color))&&(rgba=void 0!==color.r&&color),!!rgba&&rgbaToString(rgba.r,rgba.g,rgba.b,0)}function illuminate(hex,lum){var rgb,c,i,illuminated="#";if(isTransparent(hex))return hex;if(isRgba(hex)&&(rgb=getRgbaIngredients(hex),hex=rgbToHex(rgb.r,rgb.g,rgb.b)),!isHex(hex)&&!isShortHex(hex))throw Error("Not hex color value provided");for(hex=String(hex).replace(/[^0-9a-f]/gi,""),lum=lum||0,hex.length<6&&(hex=hex[0]+hex[0]+hex[1]+hex[1]+hex[2]+hex[2]),i=0;i<3;i++)c=parseInt(hex.substr(2*i,2),16),c=Math.round(Math.min(Math.max(0,c+c*lum),255)).toString(16),illuminated+=("00"+c).substr(c.length);return illuminated}function isValid(color){return _.isString(color)&&(isRgba(color)||isColorHex(color))}function removeDuplicates(){var colors=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return _.uniq(_.compact(colors),function(color){return color.hex+color.alpha})||[]}function getColorsSet(color){var colorsSet={};if(!_.isString(color))return null;if(color=color.toLowerCase(),isRgba(color)){var rgbaIngredients=getRgbaIngredients(color);if(!rgbaIngredients)return{};colorsSet={hex:rgbToHex(rgbaIngredients.r,rgbaIngredients.g,rgbaIngredients.b),rgba:rgbaToString(rgbaIngredients.r,rgbaIngredients.g,rgbaIngredients.b,_.round(rgbaIngredients.a,1)),alpha:parseFloat(_.round(rgbaIngredients.a,2))}}else isColorHex(color)&&(colorsSet={hex:color,rgba:toRgba(color),alpha:1});return colorsSet}var TRANSPARENT="transparent",Color={isHex:isHex,isRgba:isRgba,isValid:isValid,isTransparent:isTransparent,isGradient:isGradient,hexToRgba:hexToRgba,rgbToHex:rgbToHex,rgbaStringToHex:rgbaStringToHex,rgbaToString:rgbaToString,getRgbaIngredients:getRgbaIngredients,toRgba:toRgba,illuminate:illuminate,makeColorTransparent:makeColorTransparent,getColorsSet:getColorsSet,removeDuplicates:removeDuplicates};return Color}()},{lodash:161}],410:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash");module.exports=function(){function elementGetter(selector){var element;return function(){return _.isUndefined(element)&&(element=document.querySelector(selector)),element}}function loadRemoteScript(src){return new Promise(function(resolve,reject){var script=document.createElement("script");script.type="text/javascript",script.async=!0,script.onload=resolve,script.onerror=reject,script.src=src,window.document.body.appendChild(script)})}function throttleFrame(func){var _this=this,animationFrame=void 0,throttledFunction=function(){for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];animationFrame||(animationFrame=window.requestAnimationFrame(function(){func.apply(_this,args),animationFrame=null}))};return throttledFunction.cancel=function(){animationFrame&&(window.cancelAnimationFrame(animationFrame),animationFrame=null)},throttledFunction}return{elementGetter:elementGetter,throttleFrame:throttleFrame,loadRemoteScript:loadRemoteScript}}()},{lodash:161}],411:[function(_dereq_,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var getStorage=function(){var failure=!1,isOutOfSpace=function(error){return error&&["QUOTA_EXCEEDED_ERR","NS_ERROR_DOM_QUOTA_REACHED","QuotaExceededError"].indexOf(error.name)!==-1},_fallbackStorage={_data:{},setItem:function(key,value){this._data[key]=value},getItem:function(key){return this._data[key]||null}},storage={setItem:function(key,value){_fallbackStorage.setItem(key,value);try{localStorage.setItem(key,JSON.stringify(value))}catch(e){isOutOfSpace(e)&&(failure=!0)}},getItem:function(key){var value=JSON.parse(localStorage.getItem(key));return _fallbackStorage.setItem(key,value),value}};return function(){return failure?_fallbackStorage:storage}}();exports.set=function(key,value){getStorage().setItem(key,value)},exports.get=function(key){return getStorage().getItem(key)}},{}],412:[function(_dereq_,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.getLocker=function(delay){var locked=!0;return setTimeout(function(){return locked=!1},delay),{isLocked:function(){return locked}}}},{}],413:[function(_dereq_,module,exports){"use strict";module.exports=function(){function log(type){return function(message){"undefined"!=typeof Rollbar&&Rollbar[type](message),"undefined"!=typeof console&&"function"==typeof console.error&&console.error(message)}}var TYPE={CRITICAL:"critical",INFO:"info",ERROR:"error"};return{critical:log(TYPE.CRITICAL),info:log(TYPE.INFO),error:log(TYPE.ERROR)}}()},{}],414:[function(_dereq_,module,exports){"use strict";module.exports=function(string){function RotateLeft(lValue,iShiftBits){return lValue<<iShiftBits|lValue>>>32-iShiftBits}function AddUnsigned(lX,lY){var lX4,lY4,lX8,lY8,lResult;return lX8=2147483648&lX,lY8=2147483648&lY,lX4=1073741824&lX,lY4=1073741824&lY,lResult=(1073741823&lX)+(1073741823&lY),lX4&lY4?2147483648^lResult^lX8^lY8:lX4|lY4?1073741824&lResult?3221225472^lResult^lX8^lY8:1073741824^lResult^lX8^lY8:lResult^lX8^lY8}function F(x,y,z){return x&y|~x&z}function G(x,y,z){return x&z|y&~z}function H(x,y,z){return x^y^z}function I(x,y,z){return y^(x|~z)}function FF(a,b,c,d,x,s,ac){return a=AddUnsigned(a,AddUnsigned(AddUnsigned(F(b,c,d),x),ac)),AddUnsigned(RotateLeft(a,s),b)}function GG(a,b,c,d,x,s,ac){return a=AddUnsigned(a,AddUnsigned(AddUnsigned(G(b,c,d),x),ac)),AddUnsigned(RotateLeft(a,s),b)}function HH(a,b,c,d,x,s,ac){return a=AddUnsigned(a,AddUnsigned(AddUnsigned(H(b,c,d),x),ac)),AddUnsigned(RotateLeft(a,s),b)}function II(a,b,c,d,x,s,ac){return a=AddUnsigned(a,AddUnsigned(AddUnsigned(I(b,c,d),x),ac)),AddUnsigned(RotateLeft(a,s),b)}function ConvertToWordArray(string){for(var lWordCount,lMessageLength=string.length,lNumberOfWords_temp1=lMessageLength+8,lNumberOfWords_temp2=(lNumberOfWords_temp1-lNumberOfWords_temp1%64)/64,lNumberOfWords=16*(lNumberOfWords_temp2+1),lWordArray=Array(lNumberOfWords-1),lBytePosition=0,lByteCount=0;lByteCount<lMessageLength;)lWordCount=(lByteCount-lByteCount%4)/4,lBytePosition=lByteCount%4*8,lWordArray[lWordCount]=lWordArray[lWordCount]|string.charCodeAt(lByteCount)<<lBytePosition,lByteCount++;return lWordCount=(lByteCount-lByteCount%4)/4,lBytePosition=lByteCount%4*8,lWordArray[lWordCount]=lWordArray[lWordCount]|128<<lBytePosition,lWordArray[lNumberOfWords-2]=lMessageLength<<3,lWordArray[lNumberOfWords-1]=lMessageLength>>>29,lWordArray}function WordToHex(lValue){var lByte,lCount,WordToHexValue="",WordToHexValue_temp="";for(lCount=0;lCount<=3;lCount++)lByte=lValue>>>8*lCount&255,WordToHexValue_temp="0"+lByte.toString(16),WordToHexValue+=WordToHexValue_temp.substr(WordToHexValue_temp.length-2,2);return WordToHexValue}function Utf8Encode(string){string=string.replace(/\r\n/g,"\n");for(var utftext="",n=0;n<string.length;n++){var c=string.charCodeAt(n);c<128?utftext+=String.fromCharCode(c):c>127&&c<2048?(utftext+=String.fromCharCode(c>>6|192),utftext+=String.fromCharCode(63&c|128)):(utftext+=String.fromCharCode(c>>12|224),utftext+=String.fromCharCode(c>>6&63|128),utftext+=String.fromCharCode(63&c|128))}return utftext}var k,AA,BB,CC,DD,a,b,c,d,x=Array(),S11=7,S12=12,S13=17,S14=22,S21=5,S22=9,S23=14,S24=20,S31=4,S32=11,S33=16,S34=23,S41=6,S42=10,S43=15,S44=21;for(string=Utf8Encode(string),x=ConvertToWordArray(string),a=1732584193,b=4023233417,c=2562383102,d=271733878,k=0;k<x.length;k+=16)AA=a,BB=b,CC=c,DD=d,a=FF(a,b,c,d,x[k+0],S11,3614090360),d=FF(d,a,b,c,x[k+1],S12,3905402710),c=FF(c,d,a,b,x[k+2],S13,606105819),b=FF(b,c,d,a,x[k+3],S14,3250441966),a=FF(a,b,c,d,x[k+4],S11,4118548399),d=FF(d,a,b,c,x[k+5],S12,1200080426),c=FF(c,d,a,b,x[k+6],S13,2821735955),b=FF(b,c,d,a,x[k+7],S14,4249261313),a=FF(a,b,c,d,x[k+8],S11,1770035416),d=FF(d,a,b,c,x[k+9],S12,2336552879),c=FF(c,d,a,b,x[k+10],S13,4294925233),b=FF(b,c,d,a,x[k+11],S14,2304563134),a=FF(a,b,c,d,x[k+12],S11,1804603682),d=FF(d,a,b,c,x[k+13],S12,4254626195),c=FF(c,d,a,b,x[k+14],S13,2792965006),b=FF(b,c,d,a,x[k+15],S14,1236535329),a=GG(a,b,c,d,x[k+1],S21,4129170786),d=GG(d,a,b,c,x[k+6],S22,3225465664),c=GG(c,d,a,b,x[k+11],S23,643717713),b=GG(b,c,d,a,x[k+0],S24,3921069994),a=GG(a,b,c,d,x[k+5],S21,3593408605),d=GG(d,a,b,c,x[k+10],S22,38016083),c=GG(c,d,a,b,x[k+15],S23,3634488961),b=GG(b,c,d,a,x[k+4],S24,3889429448),a=GG(a,b,c,d,x[k+9],S21,568446438),d=GG(d,a,b,c,x[k+14],S22,3275163606),c=GG(c,d,a,b,x[k+3],S23,4107603335),b=GG(b,c,d,a,x[k+8],S24,1163531501),a=GG(a,b,c,d,x[k+13],S21,2850285829),d=GG(d,a,b,c,x[k+2],S22,4243563512),c=GG(c,d,a,b,x[k+7],S23,1735328473),b=GG(b,c,d,a,x[k+12],S24,2368359562),a=HH(a,b,c,d,x[k+5],S31,4294588738),d=HH(d,a,b,c,x[k+8],S32,2272392833),c=HH(c,d,a,b,x[k+11],S33,1839030562),b=HH(b,c,d,a,x[k+14],S34,4259657740),a=HH(a,b,c,d,x[k+1],S31,2763975236),d=HH(d,a,b,c,x[k+4],S32,1272893353),c=HH(c,d,a,b,x[k+7],S33,4139469664),b=HH(b,c,d,a,x[k+10],S34,3200236656),a=HH(a,b,c,d,x[k+13],S31,681279174),d=HH(d,a,b,c,x[k+0],S32,3936430074),c=HH(c,d,a,b,x[k+3],S33,3572445317),b=HH(b,c,d,a,x[k+6],S34,76029189),a=HH(a,b,c,d,x[k+9],S31,3654602809),d=HH(d,a,b,c,x[k+12],S32,3873151461),c=HH(c,d,a,b,x[k+15],S33,530742520),b=HH(b,c,d,a,x[k+2],S34,3299628645),a=II(a,b,c,d,x[k+0],S41,4096336452),d=II(d,a,b,c,x[k+7],S42,1126891415),c=II(c,d,a,b,x[k+14],S43,2878612391),b=II(b,c,d,a,x[k+5],S44,4237533241),a=II(a,b,c,d,x[k+12],S41,1700485571),d=II(d,a,b,c,x[k+3],S42,2399980690),c=II(c,d,a,b,x[k+10],S43,4293915773),b=II(b,c,d,a,x[k+1],S44,2240044497),a=II(a,b,c,d,x[k+8],S41,1873313359),d=II(d,a,b,c,x[k+15],S42,4264355552),c=II(c,d,a,b,x[k+6],S43,2734768916),b=II(b,c,d,a,x[k+13],S44,1309151649),a=II(a,b,c,d,x[k+4],S41,4149444226),d=II(d,a,b,c,x[k+11],S42,3174756917),c=II(c,d,a,b,x[k+2],S43,718787259),b=II(b,c,d,a,x[k+9],S44,3951481745),a=AddUnsigned(a,AA),b=AddUnsigned(b,BB),c=AddUnsigned(c,CC),d=AddUnsigned(d,DD);var temp=WordToHex(a)+WordToHex(b)+WordToHex(c)+WordToHex(d);return temp.toLowerCase()}},{}],415:[function(_dereq_,module,exports){"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_=_dereq_("lodash");module.exports=function(){function toPx(value){return Math.round(parseFloat(value)||0)+"px"}function toRealPx(value){return(parseFloat(value)||0)+"px"}function cloneDeep(obj){var cloned=_.clone(obj);return"object"===("undefined"==typeof obj?"undefined":_typeof(obj))&&_.forEach(obj,function(o,i){cloned[i]=cloneDeep(o)}),cloned}function getElementsMap(elements){return _.reduce(elements,function(map,element){return map[element.id]=element,map},{})}function backgroundImageString(backgroundImage){return backgroundImage?/^linear\-gradient/.test(backgroundImage)||/^radial\-gradient/.test(backgroundImage)?backgroundImage:"url("+backgroundImage+")":"none"}function translate3d(x,y,z){return"translate3d("+[x,y,z].map(toPx).join()+")"}function roundAngle(angle){var modulo=360,roundAngles=[0,90,180,270];return angle=(angle%modulo+modulo)%modulo,roundAngles.indexOf(parseInt(angle,10))!==-1?parseInt(angle,10):angle}var Parse={toPx:toPx,toRealPx:toRealPx,cloneDeep:cloneDeep,getElementsMap:getElementsMap,backgroundImageString:backgroundImageString,translate3d:translate3d,roundAngle:roundAngle};return Parse}()},{lodash:161}],416:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash");module.exports=function(){function ToHtml(template,params){return _.template(template)(params)}function ToDom(template,params){var container=document.createElement("div");return container.innerHTML=ToHtml(template,params),container.childNodes[0]}return Object.freeze({ToHtml:ToHtml,ToDom:ToDom})}()},{lodash:161}],417:[function(_dereq_,module,exports){"use strict";var Logger=_dereq_("./Logger"),localforage=_dereq_("localforage");module.exports=function(){function getStorage(){return _exceptionOccurred?_fallbackStorage:_storage}function Load(key){var storage=getStorage();return storage.get(key)}function Save(key,value){var storage=getStorage();storage.set(key,value)}function Update(key,property,value){var storage=getStorage();storage.get(key).then(function(data){data[property]=value,storage.set(key,data)})}function Remove(key){var storage=getStorage();storage.remove(key)}var DB_NAME="uxpin",_exceptionOccurred=!1,_fallbackStorage=function(){var storageData={};return{get:function(key){return Promise.resolve(storageData[key])},set:function(key,value){storageData[key]=value},remove:function(key){delete storageData[key]}}}(),_storage=function(){var store=localforage.createInstance({name:DB_NAME,driver:[localforage.INDEXEDDB,localforage.WEBSQL]});return function(){var STORAGE_PREFIX="uxpeng_";try{for(var i=localStorage.length;--i>=0;){var key=localStorage.key(i);0===key.indexOf(STORAGE_PREFIX)&&localStorage.removeItem(key)}}catch(e){}}(),{get:function(key){return store.getItem(key).then(function(value){try{return JSON.parse(value)}catch(e){}return null})},set:function(key,value){return new Promise(function(){return store.setItem(key,JSON.stringify(value)).catch(function(error){Logger.error(error),store.removeItem(key),_exceptionOccurred=!0,_fallbackStorage.set(key,value)})})},remove:function(key){store.removeItem(key)}}}();return Object.freeze({Load:Load,Save:Save,Update:Update,Remove:Remove})}()},{"./Logger":413,localforage:115}],418:[function(_dereq_,module,exports){"use strict";module.exports=function(){function isActive(){return _isActive}function activate(trapElement){_isActive||(_isActive=!0,_trapElement=trapElement,_scrollableDist=trapElement.scrollHeight-trapElement.clientHeight,document.addEventListener("wheel",_onWheel))}function deactivate(){_isActive=!1,_trapElement=null,_scrollableDist=0,document.removeEventListener("wheel",_onWheel)}function _onWheel(event){var dY=event.deltaY,scrollPosition=_trapElement.scrollTop;(dY>0&&scrollPosition>=_scrollableDist||dY<0&&scrollPosition<=0)&&event.preventDefault()}var _trapElement,_scrollableDist,_isActive=!1,TrapScroll={isActive:isActive,activate:activate,deactivate:deactivate};return TrapScroll}()},{}],419:[function(_dereq_,module,exports){"use strict";module.exports=function(){function getAncestors(element){for(var ancestors=[];element.parent;)ancestors.push(element.parent),element=element.parent;return ancestors}function IsAncestorOf(element,ancestor){return getAncestors(element).indexOf(ancestor)!==-1}function IsDescendantOf(element,descendant){return getAncestors(descendant).indexOf(element)!==-1}function GetRootElement(element,maxDepthParent){for(;element.parent&&!element.parent.isCanvas()&&element.parent!==maxDepthParent;)element=element.parent;return element}function GetAllAncestors(element){return getAncestors(element)}function GetAncestorGroup(element,maxDepthParent){for(var groups=[];element.parent&&!element.parent.isCanvas()&&element.parent!==maxDepthParent;)element=element.parent,element.isGroup()&&groups.unshift(element);return groups.length?groups[0]:maxDepthParent}function GetFirstAncestorGroup(element){return element.parent&&element.parent.isGroup()&&!element.parent.isCanvas()?element.parent:null}function GetClosestAncestor(element1,element2){for(var ancestor1,ancestor2,ancestors1=getAncestors(element1),ancestors2=getAncestors(element2),i=0;i<ancestors1.length;i++){ancestor1=ancestors1[i];for(var j=0;j<ancestors2.length;j++)if(ancestor2=ancestors2[j],ancestor1===ancestor2)return ancestor1}return null}function GetAllDescendants(element,descendants){var child;if(descendants||(descendants=[]),element.children)for(var i=0,len=element.children.length;i<len;i++)child=element.children[i],descendants.push(child),GetAllDescendants(child,descendants);return descendants}var Tree={IsAncestorOf:IsAncestorOf,IsDescendantOf:IsDescendantOf,GetRootElement:GetRootElement,GetAncestorGroup:GetAncestorGroup,GetFirstAncestorGroup:GetFirstAncestorGroup,GetClosestAncestor:GetClosestAncestor,GetAllDescendants:GetAllDescendants,GetAllAncestors:GetAllAncestors};return Tree}()},{}],420:[function(_dereq_,module,exports){"use strict";function createWorker(workerUrl){return BrowserHelper.isSafari()?new PseudoWorker(workerUrl):new Worker(workerUrl)}var PseudoWorker=_dereq_("pseudo-worker/polyfill"),BrowserHelper=_dereq_("../elements/helpers/BrowserHelper"),bundleFn=arguments[3],sources=arguments[4],cache=arguments[5],stringify=JSON.stringify;module.exports=function(fn){for(var wkey,cacheKeys=Object.keys(cache),i=0,l=cacheKeys.length;i<l;i++){var key=cacheKeys[i],exp=cache[key].exports;if(exp===fn||exp&&exp.default===fn){wkey=key;break}}if(!wkey){wkey=Math.floor(Math.pow(16,8)*Math.random()).toString(16);for(var wcache={},i=0,l=cacheKeys.length;i<l;i++){var key=cacheKeys[i];wcache[key]=key}sources[wkey]=[Function(["require","module","exports"],"("+fn+")(self)"),wcache]}var skey=Math.floor(Math.pow(16,8)*Math.random()).toString(16),scache={};scache[wkey]=wkey,sources[skey]=[Function(["require"],"var f = require("+stringify(wkey)+");(f.default ? f.default : f)(self);"),scache];var src=["(",bundleFn,")({",Object.keys(sources).map(function(key){return[stringify(key),":[",sources[key][0],",",stringify(sources[key][1]),"]"].join("")}).join(","),"},{},[",stringify(skey),"])"].join(""),URL=window.URL||window.webkitURL||window.mozURL||window.msURL,blob=new Blob([src],{type:"text/javascript"}),workerUrl=URL.createObjectURL(blob),worker=createWorker(workerUrl);return worker.objectURL=workerUrl,worker}},{"../elements/helpers/BrowserHelper":245,"pseudo-worker/polyfill":129}],421:[function(_dereq_,module,exports){function Context(){}var indexOf=_dereq_("indexof"),Object_keys=function(obj){if(Object.keys)return Object.keys(obj);var res=[];for(var key in obj)res.push(key);return res},forEach=function(xs,fn){if(xs.forEach)return xs.forEach(fn);for(var i=0;i<xs.length;i++)fn(xs[i],i,xs)},defineProp=function(){try{return Object.defineProperty({},"_",{}),function(obj,name,value){Object.defineProperty(obj,name,{writable:!0,enumerable:!1,configurable:!0,value:value})}}catch(e){return function(obj,name,value){obj[name]=value}}}(),globals=["Array","Boolean","Date","Error","EvalError","Function","Infinity","JSON","Math","NaN","Number","Object","RangeError","ReferenceError","RegExp","String","SyntaxError","TypeError","URIError","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","eval","isFinite","isNaN","parseFloat","parseInt","undefined","unescape"];Context.prototype={};var Script=exports.Script=function(code){return this instanceof Script?void(this.code=code):new Script(code)};Script.prototype.runInContext=function(context){if(!(context instanceof Context))throw new TypeError("needs a 'context' argument.");var iframe=document.createElement("iframe");iframe.style||(iframe.style={}),iframe.style.display="none",document.body.appendChild(iframe);var win=iframe.contentWindow,wEval=win.eval,wExecScript=win.execScript;!wEval&&wExecScript&&(wExecScript.call(win,"null"),wEval=win.eval),forEach(Object_keys(context),function(key){win[key]=context[key]}),forEach(globals,function(key){context[key]&&(win[key]=context[key])});var winKeys=Object_keys(win),res=wEval.call(win,this.code);return forEach(Object_keys(win),function(key){(key in context||indexOf(winKeys,key)===-1)&&(context[key]=win[key])}),forEach(globals,function(key){key in context||defineProp(context,key,win[key])}),document.body.removeChild(iframe),res},Script.prototype.runInThisContext=function(){return eval(this.code)},Script.prototype.runInNewContext=function(context){var ctx=Script.createContext(context),res=this.runInContext(ctx);return forEach(Object_keys(ctx),function(key){context[key]=ctx[key]}),res},forEach(Object_keys(Script.prototype),function(name){exports[name]=Script[name]=function(code){var s=Script(code);return s[name].apply(s,[].slice.call(arguments,1))}}),exports.createScript=function(code){return exports.Script(code)},exports.createContext=Script.createContext=function(context){var copy=new Context;return"object"==typeof context&&forEach(Object_keys(context),function(key){copy[key]=context[key]}),copy}},{indexof:111}],422:[function(_dereq_,module,exports){!function(){function aa(a,b,c){return a.call.apply(a.bind,arguments)}function ba(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(c,d),a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function p(a,b,c){return p=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?aa:ba,p.apply(null,arguments)}function ca(a,b){this.a=a,this.m=b||a,this.c=this.m.document}function t(a,b,c,d){if(b=a.c.createElement(b),c)for(var e in c)c.hasOwnProperty(e)&&("style"==e?b.style.cssText=c[e]:b.setAttribute(e,c[e]));return d&&b.appendChild(a.c.createTextNode(d)),b}function u(a,b,c){a=a.c.getElementsByTagName(b)[0],a||(a=document.documentElement),a.insertBefore(c,a.lastChild)}function v(a){a.parentNode&&a.parentNode.removeChild(a)}function w(a,b,c){b=b||[],c=c||[];for(var d=a.className.split(/\s+/),e=0;e<b.length;e+=1){for(var f=!1,g=0;g<d.length;g+=1)if(b[e]===d[g]){f=!0;break}f||d.push(b[e])}for(b=[],e=0;e<d.length;e+=1){for(f=!1,g=0;g<c.length;g+=1)if(d[e]===c[g]){f=!0;break}f||b.push(d[e])}a.className=b.join(" ").replace(/\s+/g," ").replace(/^\s+|\s+$/,"")}function y(a,b){for(var c=a.className.split(/\s+/),d=0,e=c.length;d<e;d++)if(c[d]==b)return!0;return!1}function z(a){if("string"==typeof a.f)return a.f;var b=a.m.location.protocol;return"about:"==b&&(b=a.a.location.protocol),"https:"==b?"https:":"http:"}function ea(a){return a.m.location.hostname||a.a.location.hostname}function A(a,b,c){function d(){k&&e&&f&&(k(g),k=null)}b=t(a,"link",{rel:"stylesheet",href:b,media:"all"});var e=!1,f=!0,g=null,k=c||null;da?(b.onload=function(){e=!0,d()},b.onerror=function(){e=!0,g=Error("Stylesheet failed to load"),d()}):setTimeout(function(){e=!0,d()},0),u(a,"head",b)}function B(a,b,c,d){var e=a.c.getElementsByTagName("head")[0];if(e){var f=t(a,"script",{src:b}),g=!1;return f.onload=f.onreadystatechange=function(){g||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(g=!0,c&&c(null),f.onload=f.onreadystatechange=null,"HEAD"==f.parentNode.tagName&&e.removeChild(f))},e.appendChild(f),setTimeout(function(){g||(g=!0,c&&c(Error("Script load timeout")))},d||5e3),f}return null}function C(){this.a=0,this.c=null}function D(a){return a.a++,function(){a.a--,E(a)}}function F(a,b){a.c=b,E(a)}function E(a){0==a.a&&a.c&&(a.c(),a.c=null)}function G(a){this.a=a||"-"}function H(a,b){this.c=a,this.f=4,this.a="n";var c=(b||"n4").match(/^([nio])([1-9])$/i);c&&(this.a=c[1],this.f=parseInt(c[2],10))}function fa(a){return I(a)+" "+(a.f+"00")+" 300px "+J(a.c)}function J(a){var b=[];a=a.split(/,\s*/);for(var c=0;c<a.length;c++){var d=a[c].replace(/['"]/g,"");-1!=d.indexOf(" ")||/^\d/.test(d)?b.push("'"+d+"'"):b.push(d)}return b.join(",")}function K(a){return a.a+a.f}function I(a){var b="normal";return"o"===a.a?b="oblique":"i"===a.a&&(b="italic"),b}function ga(a){var b=4,c="n",d=null;return a&&((d=a.match(/(normal|oblique|italic)/i))&&d[1]&&(c=d[1].substr(0,1).toLowerCase()),(d=a.match(/([1-9]00|normal|bold)/i))&&d[1]&&(/bold/i.test(d[1])?b=7:/[1-9]00/.test(d[1])&&(b=parseInt(d[1].substr(0,1),10)))),c+b}function ha(a,b){this.c=a,this.f=a.m.document.documentElement,this.h=b,this.a=new G("-"),this.j=!1!==b.events,this.g=!1!==b.classes}function ia(a){a.g&&w(a.f,[a.a.c("wf","loading")]),L(a,"loading")}function M(a){if(a.g){var b=y(a.f,a.a.c("wf","active")),c=[],d=[a.a.c("wf","loading")];b||c.push(a.a.c("wf","inactive")),w(a.f,c,d)}L(a,"inactive")}function L(a,b,c){a.j&&a.h[b]&&(c?a.h[b](c.c,K(c)):a.h[b]())}function ja(){this.c={}}function ka(a,b,c){var e,d=[];for(e in b)if(b.hasOwnProperty(e)){var f=a.c[e];f&&d.push(f(b[e],c))}return d}function N(a,b){this.c=a,this.f=b,this.a=t(this.c,"span",{"aria-hidden":"true"},this.f)}function O(a){u(a.c,"body",a.a)}function P(a){return"display:block;position:absolute;top:-9999px;left:-9999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:"+J(a.c)+";"+("font-style:"+I(a)+";font-weight:"+(a.f+"00")+";")}function Q(a,b,c,d,e,f){this.g=a,this.j=b,this.a=d,this.c=c,this.f=e||3e3,this.h=f||void 0}function R(a,b,c,d,e,f,g){this.v=a,this.B=b,this.c=c,this.a=d,this.s=g||"BESbswy",this.f={},this.w=e||3e3,this.u=f||null,this.o=this.j=this.h=this.g=null,this.g=new N(this.c,this.s),this.h=new N(this.c,this.s),this.j=new N(this.c,this.s),this.o=new N(this.c,this.s),a=new H(this.a.c+",serif",K(this.a)),a=P(a),this.g.a.style.cssText=a,a=new H(this.a.c+",sans-serif",K(this.a)),a=P(a),this.h.a.style.cssText=a,a=new H("serif",K(this.a)),a=P(a),this.j.a.style.cssText=a,a=new H("sans-serif",K(this.a)),a=P(a),this.o.a.style.cssText=a,O(this.g),O(this.h),O(this.j),O(this.o)}function U(){if(null===T){var a=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent);T=!!a&&(536>parseInt(a[1],10)||536===parseInt(a[1],10)&&11>=parseInt(a[2],10))}return T}function ma(a,b,c){for(var d in S)if(S.hasOwnProperty(d)&&b===a.f[S[d]]&&c===a.f[S[d]])return!0;return!1}function la(a){var d,b=a.g.a.offsetWidth,c=a.h.a.offsetWidth;(d=b===a.f.serif&&c===a.f["sans-serif"])||(d=U()&&ma(a,b,c)),d?q()-a.A>=a.w?U()&&ma(a,b,c)&&(null===a.u||a.u.hasOwnProperty(a.a.c))?V(a,a.v):V(a,a.B):na(a):V(a,a.v)}function na(a){setTimeout(p(function(){la(this)},a),50)}function V(a,b){setTimeout(p(function(){v(this.g.a),v(this.h.a),v(this.j.a),v(this.o.a),
b(this.a)},a),0)}function W(a,b,c){this.c=a,this.a=b,this.f=0,this.o=this.j=!1,this.s=c}function oa(a){0==--a.f&&a.j&&(a.o?(a=a.a,a.g&&w(a.f,[a.a.c("wf","active")],[a.a.c("wf","loading"),a.a.c("wf","inactive")]),L(a,"active")):M(a.a))}function pa(a){this.j=a,this.a=new ja,this.h=0,this.f=this.g=!0}function ra(a,b,c,d,e){var f=0==--a.h;(a.f||a.g)&&setTimeout(function(){var a=e||null,k=d||null||{};if(0===c.length&&f)M(b.a);else{b.f+=c.length,f&&(b.j=f);var h,m=[];for(h=0;h<c.length;h++){var l=c[h],n=k[l.c],r=b.a,x=l;if(r.g&&w(r.f,[r.a.c("wf",x.c,K(x).toString(),"loading")]),L(r,"fontloading",x),r=null,null===X)if(window.FontFace){var x=/Gecko.*Firefox\/(\d+)/.exec(window.navigator.userAgent),ya=/OS X.*Version\/10\..*Safari/.exec(window.navigator.userAgent)&&/Apple/.exec(window.navigator.vendor);X=x?42<parseInt(x[1],10):!ya}else X=!1;r=X?new Q(p(b.g,b),p(b.h,b),b.c,l,b.s,n):new R(p(b.g,b),p(b.h,b),b.c,l,b.s,a,n),m.push(r)}for(h=0;h<m.length;h++)m[h].start()}},0)}function qa(a,b,c){var d=[],e=c.timeout;ia(b);var d=ka(a.a,c,a.c),f=new W(a.c,b,e);for(a.h=d.length,b=0,c=d.length;b<c;b++)d[b].load(function(b,d,c){ra(a,f,b,d,c)})}function sa(a,b){this.c=a,this.a=b}function ta(a,b,c){var d=z(a.c);return a=(a.a.api||"fast.fonts.net/jsapi").replace(/^.*http(s?):(\/\/)?/,""),d+"//"+a+"/"+b+".js"+(c?"?v="+c:"")}function ua(a,b){this.c=a,this.a=b}function va(a,b,c){a?this.c=a:this.c=b+wa,this.a=[],this.f=[],this.g=c||""}function xa(a,b){for(var c=b.length,d=0;d<c;d++){var e=b[d].split(":");3==e.length&&a.f.push(e.pop());var f="";2==e.length&&""!=e[1]&&(f=":"),a.a.push(e.join(f))}}function za(a){if(0==a.a.length)throw Error("No fonts to load!");if(-1!=a.c.indexOf("kit="))return a.c;for(var b=a.a.length,c=[],d=0;d<b;d++)c.push(a.a[d].replace(/ /g,"+"));return b=a.c+"?family="+c.join("%7C"),0<a.f.length&&(b+="&subset="+a.f.join(",")),0<a.g.length&&(b+="&text="+encodeURIComponent(a.g)),b}function Aa(a){this.f=a,this.a=[],this.c={}}function Fa(a){for(var b=a.f.length,c=0;c<b;c++){var d=a.f[c].split(":"),e=d[0].replace(/\+/g," "),f=["n4"];if(2<=d.length){var g,k=d[1];if(g=[],k)for(var k=k.split(","),h=k.length,m=0;m<h;m++){var l;if(l=k[m],l.match(/^[\w-]+$/)){var n=Ea.exec(l.toLowerCase());if(null==n)l="";else{if(l=n[2],l=null==l||""==l?"n":Da[l],n=n[1],null==n||""==n)n="4";else var r=Ca[n],n=r?r:isNaN(n)?"4":n.substr(0,1);l=[l,n].join("")}}else l="";l&&g.push(l)}0<g.length&&(f=g),3==d.length&&(d=d[2],g=[],d=d?d.split(","):g,0<d.length&&(d=Ba[d[0]])&&(a.c[e]=d))}for(a.c[e]||(d=Ba[e])&&(a.c[e]=d),d=0;d<f.length;d+=1)a.a.push(new H(e,f[d]))}}function Ga(a,b){this.c=a,this.a=b}function Ia(a,b){this.c=a,this.a=b}function Ja(a,b){this.c=a,this.f=b,this.a=[]}var q=Date.now||function(){return+new Date},da=!!window.FontFace;G.prototype.c=function(a){for(var b=[],c=0;c<arguments.length;c++)b.push(arguments[c].replace(/[\W_]+/g,"").toLowerCase());return b.join(this.a)},Q.prototype.start=function(){var a=this.c.m.document,b=this,c=q(),d=new Promise(function(d,e){function k(){q()-c>=b.f?e():a.fonts.load(fa(b.a),b.h).then(function(a){1<=a.length?d():setTimeout(k,25)},function(){e()})}k()}),e=new Promise(function(a,d){setTimeout(d,b.f)});Promise.race([e,d]).then(function(){b.g(b.a)},function(){b.j(b.a)})};var S={D:"serif",C:"sans-serif"},T=null;R.prototype.start=function(){this.f.serif=this.j.a.offsetWidth,this.f["sans-serif"]=this.o.a.offsetWidth,this.A=q(),la(this)};var X=null;W.prototype.g=function(a){var b=this.a;b.g&&w(b.f,[b.a.c("wf",a.c,K(a).toString(),"active")],[b.a.c("wf",a.c,K(a).toString(),"loading"),b.a.c("wf",a.c,K(a).toString(),"inactive")]),L(b,"fontactive",a),this.o=!0,oa(this)},W.prototype.h=function(a){var b=this.a;if(b.g){var c=y(b.f,b.a.c("wf",a.c,K(a).toString(),"active")),d=[],e=[b.a.c("wf",a.c,K(a).toString(),"loading")];c||d.push(b.a.c("wf",a.c,K(a).toString(),"inactive")),w(b.f,d,e)}L(b,"fontinactive",a),oa(this)},pa.prototype.load=function(a){this.c=new ca(this.j,a.context||this.j),this.g=!1!==a.events,this.f=!1!==a.classes,qa(this,new ha(this.c,a),a)},sa.prototype.load=function(a){function b(){if(f["__mti_fntLst"+d]){var h,c=f["__mti_fntLst"+d](),e=[];if(c)for(var m=0;m<c.length;m++){var l=c[m].fontfamily;void 0!=c[m].fontStyle&&void 0!=c[m].fontWeight?(h=c[m].fontStyle+c[m].fontWeight,e.push(new H(l,h))):e.push(new H(l))}a(e)}else setTimeout(function(){b()},50)}var c=this,d=c.a.projectId,e=c.a.version;if(d){var f=c.c.m;B(this.c,ta(c,d,e),function(e){e?a([]):(f["__MonotypeConfiguration__"+d]=function(){return c.a},b())}).id="__MonotypeAPIScript__"+d}else a([])},ua.prototype.load=function(a){var b,c,d=this.a.urls||[],e=this.a.families||[],f=this.a.testStrings||{},g=new C;for(b=0,c=d.length;b<c;b++)A(this.c,d[b],D(g));var k=[];for(b=0,c=e.length;b<c;b++)if(d=e[b].split(":"),d[1])for(var h=d[1].split(","),m=0;m<h.length;m+=1)k.push(new H(d[0],h[m]));else k.push(new H(d[0]));F(g,function(){a(k,f)})};var wa="//fonts.googleapis.com/css",Ba={latin:"BESbswy","latin-ext":"",cyrillic:"",greek:"",khmer:"",Hanuman:""},Ca={thin:"1",extralight:"2","extra-light":"2",ultralight:"2","ultra-light":"2",light:"3",regular:"4",book:"4",medium:"5","semi-bold":"6",semibold:"6","demi-bold":"6",demibold:"6",bold:"7","extra-bold":"8",extrabold:"8","ultra-bold":"8",ultrabold:"8",black:"9",heavy:"9",l:"3",r:"4",b:"7"},Da={i:"i",italic:"i",n:"n",normal:"n"},Ea=/^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$/,Ha={Arimo:!0,Cousine:!0,Tinos:!0};Ga.prototype.load=function(a){var b=new C,c=this.c,d=new va(this.a.api,z(c),this.a.text),e=this.a.families;xa(d,e);var f=new Aa(e);Fa(f),A(c,za(d),D(b)),F(b,function(){a(f.a,f.c,Ha)})},Ia.prototype.load=function(a){var b=this.a.id,c=this.c.m;b?B(this.c,(this.a.api||"https://use.typekit.net")+"/"+b+".js",function(b){if(b)a([]);else if(c.Typekit&&c.Typekit.config&&c.Typekit.config.fn){b=c.Typekit.config.fn;for(var e=[],f=0;f<b.length;f+=2)for(var g=b[f],k=b[f+1],h=0;h<k.length;h++)e.push(new H(g,k[h]));try{c.Typekit.load({events:!1,classes:!1,async:!0})}catch(m){}a(e)}},2e3):a([])},Ja.prototype.load=function(a){var b=this.f.id,c=this.c.m,d=this;b?(c.__webfontfontdeckmodule__||(c.__webfontfontdeckmodule__={}),c.__webfontfontdeckmodule__[b]=function(b,c){for(var g=0,k=c.fonts.length;g<k;++g){var h=c.fonts[g];d.a.push(new H(h.name,ga("font-weight:"+h.weight+";font-style:"+h.style)))}a(d.a)},B(this.c,z(this.c)+(this.f.api||"//f.fontdeck.com/s/css/js/")+ea(this.c)+"/"+b+".js",function(b){b&&a([])})):a([])};var Y=new pa(window);Y.a.c.custom=function(a,b){return new ua(b,a)},Y.a.c.fontdeck=function(a,b){return new Ja(b,a)},Y.a.c.monotype=function(a,b){return new sa(b,a)},Y.a.c.typekit=function(a,b){return new Ia(b,a)},Y.a.c.google=function(a,b){return new Ga(b,a)};var Z={load:p(Y.load,Y)};"function"==typeof define&&define.amd?define(function(){return Z}):"undefined"!=typeof module&&module.exports?module.exports=Z:(window.WebFont=Z,window.WebFontConfig&&Y.load(window.WebFontConfig))}()},{}],423:[function(_dereq_,module,exports){!function(self){"use strict";function normalizeName(name){if("string"!=typeof name&&(name=String(name)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(name))throw new TypeError("Invalid character in header field name");return name.toLowerCase()}function normalizeValue(value){return"string"!=typeof value&&(value=String(value)),value}function iteratorFor(items){var iterator={next:function(){var value=items.shift();return{done:void 0===value,value:value}}};return support.iterable&&(iterator[Symbol.iterator]=function(){return iterator}),iterator}function Headers(headers){this.map={},headers instanceof Headers?headers.forEach(function(value,name){this.append(name,value)},this):headers&&Object.getOwnPropertyNames(headers).forEach(function(name){this.append(name,headers[name])},this)}function consumed(body){return body.bodyUsed?Promise.reject(new TypeError("Already read")):void(body.bodyUsed=!0)}function fileReaderReady(reader){return new Promise(function(resolve,reject){reader.onload=function(){resolve(reader.result)},reader.onerror=function(){reject(reader.error)}})}function readBlobAsArrayBuffer(blob){var reader=new FileReader,promise=fileReaderReady(reader);return reader.readAsArrayBuffer(blob),promise}function readBlobAsText(blob){var reader=new FileReader,promise=fileReaderReady(reader);return reader.readAsText(blob),promise}function readArrayBufferAsText(buf){for(var view=new Uint8Array(buf),chars=new Array(view.length),i=0;i<view.length;i++)chars[i]=String.fromCharCode(view[i]);return chars.join("")}function bufferClone(buf){if(buf.slice)return buf.slice(0);var view=new Uint8Array(buf.byteLength);return view.set(new Uint8Array(buf)),view.buffer}function Body(){return this.bodyUsed=!1,this._initBody=function(body){if(this._bodyInit=body,body)if("string"==typeof body)this._bodyText=body;else if(support.blob&&Blob.prototype.isPrototypeOf(body))this._bodyBlob=body;else if(support.formData&&FormData.prototype.isPrototypeOf(body))this._bodyFormData=body;else if(support.searchParams&&URLSearchParams.prototype.isPrototypeOf(body))this._bodyText=body.toString();else if(support.arrayBuffer&&support.blob&&isDataView(body))this._bodyArrayBuffer=bufferClone(body.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!support.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(body)&&!isArrayBufferView(body))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=bufferClone(body)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof body?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):support.searchParams&&URLSearchParams.prototype.isPrototypeOf(body)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},support.blob&&(this.blob=function(){var rejected=consumed(this);if(rejected)return rejected;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?consumed(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(readBlobAsArrayBuffer)}),this.text=function(){var rejected=consumed(this);if(rejected)return rejected;if(this._bodyBlob)return readBlobAsText(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(readArrayBufferAsText(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},support.formData&&(this.formData=function(){return this.text().then(decode)}),this.json=function(){return this.text().then(JSON.parse)},this}function normalizeMethod(method){var upcased=method.toUpperCase();return methods.indexOf(upcased)>-1?upcased:method}function Request(input,options){options=options||{};var body=options.body;if("string"==typeof input)this.url=input;else{if(input.bodyUsed)throw new TypeError("Already read");this.url=input.url,this.credentials=input.credentials,options.headers||(this.headers=new Headers(input.headers)),this.method=input.method,this.mode=input.mode,body||null==input._bodyInit||(body=input._bodyInit,input.bodyUsed=!0)}if(this.credentials=options.credentials||this.credentials||"omit",!options.headers&&this.headers||(this.headers=new Headers(options.headers)),this.method=normalizeMethod(options.method||this.method||"GET"),this.mode=options.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&body)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(body)}function decode(body){var form=new FormData;return body.trim().split("&").forEach(function(bytes){if(bytes){var split=bytes.split("="),name=split.shift().replace(/\+/g," "),value=split.join("=").replace(/\+/g," ");form.append(decodeURIComponent(name),decodeURIComponent(value))}}),form}function parseHeaders(rawHeaders){var headers=new Headers;return rawHeaders.split("\r\n").forEach(function(line){var parts=line.split(":"),key=parts.shift().trim();if(key){var value=parts.join(":").trim();headers.append(key,value)}}),headers}function Response(bodyInit,options){options||(options={}),this.type="default",this.status="status"in options?options.status:200,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in options?options.statusText:"OK",this.headers=new Headers(options.headers),this.url=options.url||"",this._initBody(bodyInit)}if(!self.fetch){var support={searchParams:"URLSearchParams"in self,iterable:"Symbol"in self&&"iterator"in Symbol,blob:"FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in self,arrayBuffer:"ArrayBuffer"in self};if(support.arrayBuffer)var viewClasses=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],isDataView=function(obj){return obj&&DataView.prototype.isPrototypeOf(obj)},isArrayBufferView=ArrayBuffer.isView||function(obj){return obj&&viewClasses.indexOf(Object.prototype.toString.call(obj))>-1};Headers.prototype.append=function(name,value){name=normalizeName(name),value=normalizeValue(value);var list=this.map[name];list||(list=[],this.map[name]=list),list.push(value)},Headers.prototype.delete=function(name){delete this.map[normalizeName(name)]},Headers.prototype.get=function(name){var values=this.map[normalizeName(name)];return values?values[0]:null},Headers.prototype.getAll=function(name){return this.map[normalizeName(name)]||[]},Headers.prototype.has=function(name){return this.map.hasOwnProperty(normalizeName(name))},Headers.prototype.set=function(name,value){this.map[normalizeName(name)]=[normalizeValue(value)]},Headers.prototype.forEach=function(callback,thisArg){Object.getOwnPropertyNames(this.map).forEach(function(name){this.map[name].forEach(function(value){callback.call(thisArg,value,name,this)},this)},this)},Headers.prototype.keys=function(){var items=[];return this.forEach(function(value,name){items.push(name)}),iteratorFor(items)},Headers.prototype.values=function(){var items=[];return this.forEach(function(value){items.push(value)}),iteratorFor(items)},Headers.prototype.entries=function(){var items=[];return this.forEach(function(value,name){items.push([name,value])}),iteratorFor(items)},support.iterable&&(Headers.prototype[Symbol.iterator]=Headers.prototype.entries);var methods=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];Request.prototype.clone=function(){return new Request(this,{body:this._bodyInit})},Body.call(Request.prototype),Body.call(Response.prototype),Response.prototype.clone=function(){return new Response(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new Headers(this.headers),url:this.url})},Response.error=function(){var response=new Response(null,{status:0,statusText:""});return response.type="error",response};var redirectStatuses=[301,302,303,307,308];Response.redirect=function(url,status){if(redirectStatuses.indexOf(status)===-1)throw new RangeError("Invalid status code");return new Response(null,{status:status,headers:{location:url}})},self.Headers=Headers,self.Request=Request,self.Response=Response,self.fetch=function(input,init){return new Promise(function(resolve,reject){var request=new Request(input,init),xhr=new XMLHttpRequest;xhr.onload=function(){var options={status:xhr.status,statusText:xhr.statusText,headers:parseHeaders(xhr.getAllResponseHeaders()||"")};options.url="responseURL"in xhr?xhr.responseURL:options.headers.get("X-Request-URL");var body="response"in xhr?xhr.response:xhr.responseText;resolve(new Response(body,options))},xhr.onerror=function(){reject(new TypeError("Network request failed"))},xhr.ontimeout=function(){reject(new TypeError("Network request failed"))},xhr.open(request.method,request.url,!0),"include"===request.credentials&&(xhr.withCredentials=!0),"responseType"in xhr&&support.blob&&(xhr.responseType="blob"),request.headers.forEach(function(value,name){xhr.setRequestHeader(name,value)}),xhr.send("undefined"==typeof request._bodyInit?null:request._bodyInit)})},self.fetch.polyfill=!0}}("undefined"!=typeof self?self:this)},{}]},{},[165])(165)});
//# sourceMappingURL=maps/engine.js.map
